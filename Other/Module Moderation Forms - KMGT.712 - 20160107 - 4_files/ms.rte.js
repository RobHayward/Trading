function ULSdmo(){var o=new Object;o.ULSTeamName="Microsoft SharePoint Foundation";o.ULSFileName="Ms.Rte.js";return o;}
if("undefined"==typeof g_all_modules)g_all_modules={};g_all_modules["ms.rte.js"]={version:{rmj:16,rmm:0,rup:5312,rpr:1208}};typeof spWriteProfilerMark=="function"&&spWriteProfilerMark("perfMarkBegin_ms.rte.js");Type.registerNamespace("RTE");RTE.Rectangle=function(){};RTE.Alignment=function(){};RTE.Alignment.prototype={left:0,right:1,center:2,justify:3};RTE.Alignment.registerEnum("RTE.Alignment",false);RTE.ApplyType=function(){};RTE.ApplyType.prototype={tag:0,className:1,style:2,attribute:3};RTE.ApplyType.registerEnum("RTE.ApplyType",false);RTE.ApplyRestrictions=function(){};RTE.ApplyRestrictions.prototype={none:0,nonBlock:1};RTE.ApplyRestrictions.registerEnum("RTE.ApplyRestrictions",false);RTE.ShortcutEventArgs=function(){};RTE.HtmlCleanupArgs=function(){};RTE.IAutocomplete=function(){};RTE.IAutocomplete.registerInterface("RTE.IAutocomplete");RTE.ICommandProcessor=function(){};RTE.ICommandProcessor.registerInterface("RTE.ICommandProcessor");RTE.InsertTableCommandType=function(){};RTE.InsertTableCommandType.prototype={insert:0,preview:1,revertPreview:2};RTE.InsertTableCommandType.registerEnum("RTE.InsertTableCommandType",false);RTE.InsertTableOptions=function(){};RTE.InsertLinkOptions=function(){ULSdmo:;this.fixLinkHierarchy=false};RTE.InsertImageOptions=function(){};RTE.RangeEndPointOption=function(){};RTE.RangeEndPointOption.prototype={startToEnd:0,startToStart:1,endToStart:2,endToEnd:3};RTE.RangeEndPointOption.registerEnum("RTE.RangeEndPointOption",false);RTE.TableCellInfo=function(){};RTE.TableColumnInfo=function(){};RTE.TableGrid=function(){};RTE.UiExperiences=function(){};RTE.UiExperiences.prototype={edit:0,link:1,image:2,table:3};RTE.UiExperiences.registerEnum("RTE.UiExperiences",false);RTE.WaitDialog=function(){};RTE.WaitDialog.prototype={generic:0,paste:1,xhtmlProcessing:2};RTE.WaitDialog.registerEnum("RTE.WaitDialog",false);RTE.ErrorCode=function(){};RTE.ErrorCode.prototype={unknown:0,copyPasteNotAllowed:1,layoutsNotSupported:2,invalidTableMerge:3};RTE.ErrorCode.registerEnum("RTE.ErrorCode",false);RTE.CircularArray=function(a){ULSdmo:;this.$1p_0=new Array(a)};RTE.CircularArray.prototype={$1p_0:null,$1q_0:0,$a_0:0,push:function(a){ULSdmo:;this.$1p_0[this.$1q_0]=a;this.$1q_0++;if(this.$1q_0>=this.$1p_0.length)this.$1q_0=0;if(this.$a_0<this.$1p_0.length)this.$a_0++},pop:function(){ULSdmo:;if(this.$a_0<=0)return null;this.$1q_0--;this.$a_0--;var a=this.$1p_0[this.$1q_0];this.$1p_0[this.$1q_0]=null;return a},get_length:function(){ULSdmo:;return this.$a_0},getItemAt:function(b){ULSdmo:;if(b>=this.$a_0)return null;var a=this.$1q_0-this.$a_0+b;if(a<0)a+=this.$1p_0.length;return this.$1p_0[a]}};RTE.HtmlTagName=function(){};RTE.SelectionNodesProcessor=function(){};RTE.SelectionNodesProcessor.prototype={$E_0:null,$3J_0:null,setSelectionSettings:function(a){ULSdmo:;this.$E_0=a;this.$3J_0=null},get_parentElement:function(){ULSdmo:;return this.$E_0.parentElement()},get_range:function(){ULSdmo:;return this.$E_0},get_innerNodes:function(){ULSdmo:;if(!this.$3J_0){var a=this.$E_0.isEmpty();this.$3J_0=this.$E_0.getReducedInnerNodes(!a);RTE.RteUtility.$DD(this.$3J_0)}return this.$3J_0}};RTE.ApplyOnSelectionProcessor=function(){ULSdmo:;this.$$d_$Ae_1=Function.createDelegate(this,this.$Ae_1);this.$$d_$Ag_1=Function.createDelegate(this,this.$Ag_1);this.$$d_$Am_1=Function.createDelegate(this,this.$Am_1);this.$1R_1=new RTE.NodeDictionaryCache;RTE.ApplyOnSelectionProcessor.initializeBase(this)};RTE.ApplyOnSelectionProcessor.$An=function(a,c){ULSdmo:;if(RTE.ApplyOnSelectionProcessor.$4M(a)){var b=a.ownerDocument.createElement(c.$26_1[0]);RTE.RteUtility.insertBefore(b,a);b.appendChild(a)}};RTE.ApplyOnSelectionProcessor.$Ah=function(c,a){ULSdmo:;var b=RTE.ApplyOnSelectionProcessor.$Al(c,a.$8_1);a.$4U_1(b)};RTE.ApplyOnSelectionProcessor.$7u=function(c,a){ULSdmo:;var b=RTE.ApplyOnSelectionProcessor.$7s(c,a.$H_1,a.$8_1);a.$4U_1(b)};RTE.ApplyOnSelectionProcessor.$Al=function(a,c){ULSdmo:;if(RTE.ApplyOnSelectionProcessor.$4M(a)){var b=a.ownerDocument.createElement("SPAN");RTE.RteUtility.insertBefore(b,a);b.appendChild(a);b.className=c;return b}return a};RTE.ApplyOnSelectionProcessor.$7s=function(a,c,d){ULSdmo:;if(RTE.ApplyOnSelectionProcessor.$4M(a)){var b=a.ownerDocument.createElement("SPAN");RTE.RteUtility.insertBefore(b,a);b.appendChild(a);b.style[c]=d;return b}return a};RTE.ApplyOnSelectionProcessor.$Af=function(a,c){ULSdmo:;if(RTE.ApplyOnSelectionProcessor.$4M(a)){var b=a.ownerDocument.createElement("SPAN");RTE.RteUtility.insertBefore(b,a);b.appendChild(a);b[c.$H_1]=c.$8_1}};RTE.ApplyOnSelectionProcessor.$4M=function(a){ULSdmo:;var b=RTE.RteUtility.isEmptyTextNode(a,true)&&(!a.previousSibling||RTE.RteUtility.isBlockNode(a.previousSibling)||RTE.RteUtility.$i(a.previousSibling))&&(!a.nextSibling||RTE.RteUtility.isBlockNode(a.nextSibling)||RTE.RteUtility.$i(a.nextSibling));return!b};RTE.ApplyOnSelectionProcessor.$B9=function(){};RTE.ApplyOnSelectionProcessor.prototype={$26_1:null,$1O_1:null,$3y_1:null,$25_1:null,$Z_1:0,$H_1:null,$8_1:null,$2c_1:null,$71_1:0,$2J_1:null,$1i_1:null,setSettings:function(a,h,i,c,j,k,l,d,e,m){ULSdmo:;RTE.SelectionNodesProcessor.prototype.setSelectionSettings.call(this,a);this.$Z_1=h;this.$26_1=i;this.$1O_1=c;this.$3y_1=m;this.$H_1=j;this.$8_1=k;this.$2c_1=l;this.$71_1=!RTE.SU.isNullOrUndefined(e)?e:0;this.$25_1=!RTE.SU.isNullOrUndefined(d)?d:new Array(0);if(!RTE.SU.isNullOrEmptyString(this.$H_1))this.$25_1[this.$25_1.length]=this.$H_1;this.$1R_1=new RTE.NodeDictionaryCache;if(!this.$26_1)this.$26_1=[];if(!c)this.$1O_1=[];if(!this.$Z_1){this.$2J_1=RTE.ApplyOnSelectionProcessor.$An;this.$1i_1=RTE.ApplyOnSelectionProcessor.$B9}else if(this.$Z_1===1){var f=a.getEditableRegion(),g=RTE.Canvas.getCachedRestriction(f,"UseInlineStyle",false);if(g){this.$Z_1=2;this.$2J_1=RTE.ApplyOnSelectionProcessor.$7u;this.$1i_1=this.$$d_$Am_1;var b=a.$1_0;this.$8_1=RTE.RteUtility.$BW(b.ownerDocument,b,this.$8_1,this.$H_1)}else{this.$2J_1=RTE.ApplyOnSelectionProcessor.$Ah;this.$1i_1=this.$$d_$Ag_1}}else if(this.$Z_1===2){this.$2J_1=RTE.ApplyOnSelectionProcessor.$7u;this.$1i_1=this.$$d_$Am_1}else if(this.$Z_1===3){this.$2J_1=RTE.ApplyOnSelectionProcessor.$Af;this.$1i_1=this.$$d_$Ae_1}},$AF_1:function(){ULSdmo:;var a=this.$E_0.getCurrentStateNode();return!this.$5R_1(a)},$9a_1:function(a){ULSdmo:;return RTE.RteUtility.isStringInArray(a.tagName,this.$26_1)},$9Y_1:function(b){ULSdmo:;if(this.$Z_1===1){var c=b.className;if(this.$2h_1){for(var a=0;a<this.$1O_1.length;a++)if(c.indexOf(this.$1O_1[a])!==-1)return true}else return RTE.RteUtility.hasClass(b,this.$8_1)}return false},$9Z_1:function(b){ULSdmo:;var a=b.style[this.$H_1];return a===this.$8_1||this.$2h_1&&!RTE.SU.isNullOrEmptyString(a)?true:false},$9X_1:function(b){ULSdmo:;var a=b.getAttribute(this.$H_1);return a===this.$8_1?true:false},$9O_1:function(a){ULSdmo:;if(a.nodeType===1)if(this.$2h_1){var b=this.$9a_1(a),c=this.$9Y_1(a);if(this.$H_1){var d=this.$9Z_1(a),e=this.$9X_1(a);return b||c||d||e}return b||c}else if(this.$Z_1===1)return this.$9Y_1(a);else if(!this.$Z_1)return this.$9a_1(a);else if(this.$Z_1===3)return this.$9X_1(a);else if(this.$Z_1===2)return this.$9Z_1(a);return false},$8m_1:function(b){ULSdmo:;var a=b;while(a&&!RTE.Canvas.$S(a)){if(this.$9O_1(a))return a;a=a.parentNode}return null},$5R_1:function(a){ULSdmo:;var b=false,d=this.$1R_1.getEntry(a);if(!RTE.SU.isNullOrUndefined(d))return d;if((this.$8_1||this.$2c_1)&&this.$H_1&&this.$H_1.toLowerCase()!=="textdecoration"){var f=RTE.RteUtility.getCurrentStyle(a);if(f){var c=f[this.$H_1];if(this.$8_1&&c===this.$8_1){this.$4h_1(a,true);return true}if(this.$2c_1&&c===this.$2c_1){this.$4h_1(a,false);return false}if(this.$H_1==="fontWeight"&&this.$8_1==="bold"&&typeof c==="number"){b=c>400;this.$4h_1(a,b);return b}}}var e=this.$8m_1(a);if(e&&e.parentNode)b=true;this.$4h_1(a,b);return b},$4h_1:function(a,b){ULSdmo:;!RTE.RteUtility.$i(a)&&this.$1R_1.addEntry(a,b)},queryApply:function(){ULSdmo:;this.$1R_1=new RTE.NodeDictionaryCache;var a=new RTE.CommandState;a.$D_0=true;a.$j_0=!this.$AF_1();return a},process:function(){ULSdmo:;if(this.$AF_1())this.apply();else this.remove()},apply:function(){ULSdmo:;this.$1R_1=new RTE.NodeDictionaryCache;var c=this.$E_0.isEmpty(),d=!c?this.get_innerNodes():[];if(!d.length){var b=this.$E_0.$1_0.ownerDocument,a=null;switch(this.$Z_1){case 0:a=b.createElement(this.$26_1[0]);break;case 2:a=b.createElement("SPAN");a.style[this.$H_1]=this.$8_1;break;case 3:a=b.createElement("SPAN");a.setAttribute(this.$H_1,this.$8_1);break;case 1:a=b.createElement("SPAN");a.className=this.$8_1}this.$4U_1(a);this.$9k_1();RTE.RteUtility.insertBefore(a,this.$E_0.$1_0);this.$E_0.moveToStartOfNode(a);this.$67_1(a);RTE.RteUtility.$3F(a)&&RTE.RteUtility.removeNodeAndKeepChildNodes(a)}else this.$7q_1(d);!c&&this.$E_0.normalize();this.$E_0.resetCacheRange()},$Ag_1:function(a,b){ULSdmo:;if(RTE.RteUtility.$i(a)||this.$3s_1(a))return;RTE.RteUtility.$1V(a,b.$8_1,b.$1O_1);b.$4U_1(a)},$Am_1:function(a,b){ULSdmo:;if(RTE.RteUtility.$i(a)||this.$3s_1(a))return;if(a.style){RTE.SnapshotManager.setCurrentRegionDirtyIf(a.style[b.$H_1]!==b.$8_1);a.style[b.$H_1]=b.$8_1}b.$4U_1(a)},$4U_1:function(b){ULSdmo:;if(this.$H_1==="color"&&b.nodeType===1){var d=RTE.Canvas.getEditableRegion(b),a=b;while(a&&a!==d){var c=RTE.RteUtility.getCurrentStyle(a);if(c&&c.textDecoration!=="none"){b.style.textDecoration=c.textDecoration;return}a=a.parentNode}}},$Ae_1:function(a,b){ULSdmo:;if(RTE.RteUtility.$i(a)||this.$3s_1(a))return;RTE.SnapshotManager.setCurrentRegionDirtyIf(a.getAttribute(b.$H_1)!==b.$8_1);a.setAttribute(b.$H_1,b.$8_1)},$7q_1:function(g){ULSdmo:;for(var e=null,h=this.$E_0.parentElement(),f=[],b=[],c=0;c<g.length;c++){var a=g[c];this.$4B_1(a);if(!RTE.RteUtility.$M(a,e,h)){if(a.nodeType===3)this.$2J_1(a,this);else{this.$1R_1.clearEntry(a);this.$1i_1(a,this)}if(this.$5R_1(a))e=a}if(Array.indexOf(f,a.parentNode)===-1){Array.add(f,a.parentNode);Array.add(b,a)}}for(var d=0;d<b.length;d++)this.$67_1(b[d])},$67_1:function(h){ULSdmo:;if(!this.$Z_1)return;if(this.$2h_1)return;var a=h.parentNode;if(!RTE.Canvas.isEditable(a)||RTE.Canvas.$S(a))return;if(this.$3s_1(a)&&RTE.RteUtility.getRealFirstChild(a,true)===RTE.RteUtility.getRealLastChild(a,true))return;for(var g=a.childNodes,i=RTE.RteUtility.isBlockNode(a),j=g.length,c=0;c<j;c++){var b=g[c];if(RTE.RteUtility.isTextNode(b)&&(b.nodeValue.replace(RTE.RteUtility.$1t,"")===""||i&&(!b.nextSibling||!b.previousSibling)&&RTE.RteUtility.isEmptyString(b.nodeValue,false)))continue;if(b.nodeType===3&&!RTE.ApplyOnSelectionProcessor.$4M(b))continue;if(this.$9O_1(b))continue;if(this.$5R_1(b))continue;if(!RTE.RteUtility.$3F(b)||b.childNodes.length>0)return}for(var d=0;d<a.childNodes.length;d++){var e=a.childNodes[d];(this.$Z_1===1&&e.className===this.$8_1||this.$Z_1!==1&&RTE.SU.isNullOrEmptyString(e.className))&&this.$4B_1(e)}RTE.RteUtility.$9x(a);if(this.$3s_1(a)){var f=document.createElement("SPAN");RTE.RteUtility.moveChildNodes(a,f);a.appendChild(f);this.$1i_1(f,this)}else{this.$1R_1.clearEntry(h);this.$1i_1(a,this);this.$67_1(a)}},$3s_1:function(a){ULSdmo:;if(this.$71_1===1&&a.nodeType===1){if(RTE.RteUtility.isBlockNode(a)||a.tagName==="A")return true;if(this.$3y_1&&a.className)for(var b=0;b<this.$3y_1.length;b++)if(a.className.indexOf(this.$3y_1[b])!==-1)return true}return false},$DH_1:function(a){ULSdmo:;if(RTE.RteUtility.isStringInArray(a.tagName,this.$26_1)){var c=!RTE.SU.isNullOrEmptyString(a.style.cssText),d=!RTE.SU.isNullOrEmptyString(a.className);if(c||d){var b=document.createElement("SPAN");if(c)b.style.cssText=a.style.cssText;if(d)b.className=a.className;RTE.RteUtility.moveChildNodes(a,b);a.parentNode.replaceChild(b,a)}else RTE.RteUtility.removeNodeAndKeepChildNodes(a);return true}return false},$DA_1:function(a){ULSdmo:;var c=a.className;RTE.RteUtility.$7B(a,RTE.ApplyOnSelectionProcessor.$1S.$1O_1);var b=a.className;RTE.SnapshotManager.setCurrentRegionDirtyIf(c!==b);if(b===""){a.removeAttribute("class");a.removeAttribute("className")}return c!==b},$DG_1:function(a){ULSdmo:;var b=false;if(a.style)for(var c=0;c<this.$25_1.length;c++){var d=this.$25_1[c],g=a.style[d];if(!RTE.SU.isNullOrEmptyString(g)){RTE.SnapshotManager.setCurrentRegionDirty();if(a.style.removeAttribute){a.style.removeAttribute(d);b=true}else{a.style[d]="";b=true}}}if(a.nodeType===1&&a.tagName==="FONT")for(var e=0;e<this.$25_1.length;e++){var f=RTE.ApplyOnSelectionProcessor.$8R[this.$25_1[e]];if(!RTE.SU.isNullOrEmptyString(f)){a.removeAttribute(f);b=true}}return b},$D8_1:function(a){ULSdmo:;var b=a.getAttribute(this.$H_1);if(!RTE.SU.isNullOrEmptyString(b)){a.removeAttribute(this.$H_1);RTE.SnapshotManager.setCurrentRegionDirty();return true}return false},$4B_1:function(a){ULSdmo:;this.$1R_1.clearEntry(a);if(!RTE.RteUtility.isTextNode(a)){var b=this.$DA_1(a),c=this.$DG_1(a),d=this.$D8_1(a),e=this.$DH_1(a);return b||c||d||e}return false},$D7_1:function(f,i){ULSdmo:;var c=[],a=this.$8m_1(f);if(a){var d=new RTE.CanvasRange("parent");d.moveToNode(a);var g=d.getReducedInnerNodes(true);d.dispose();this.$4B_1(a);var h=this.$8_1;if(this.$1O_1&&this.$1O_1.length>0&&this.$Z_1===1)this.$8_1=RTE.RteUtility.$BY(a,this.$1O_1);for(var e=0;e<g.length;e++){var b=g[e];!Array.contains(i,b)&&!Array.contains(c,b)&&!RTE.RteUtility.$M(this.$E_0.$1_0,b,a)&&!RTE.RteUtility.$M(this.$E_0.$2_0,b,a)&&Array.add(c,b)}this.$7q_1(c);this.$8_1=h}else if(this.$2c_1){this.$1R_1.clearEntry(f);RTE.ApplyOnSelectionProcessor.$7s(f,this.$H_1,this.$2c_1)}},$2h_1:false,remove:function(){ULSdmo:;var c=this.$E_0.isEmpty();this.$2h_1=true;var a=!c?this.get_innerNodes():[];if(!a.length)this.$4B_1(this.$E_0.$1_0);else for(var b=0;b<a.length;b++){var d=a[b];this.$4B_1(d);RTE.RteUtility.$DC(d)}this.$9y_1(this.$E_0.$1_0,a);this.$9y_1(this.$E_0.$2_0,a);RTE.RteUtility.$9x(this.$E_0.$1_0.parentNode);this.$2h_1=false;if(!c)this.$E_0.normalize();else this.$9k_1();this.$E_0.resetCacheRange()},$9k_1:function(){ULSdmo:;if(RTE.RteUtility.isInternetExplorer()){var a=this.$E_0.$1_0.parentNode;if(a&&a===this.$E_0.$2_0.parentNode&&a.childNodes.length===2&&a.tagName==="P"){var b=a.cloneNode(false);RTE.RteUtility.moveChildNodes(a,b);a.parentNode.insertBefore(b,a);a.parentNode.removeChild(a)}}},$9y_1:function(a,b){ULSdmo:;this.$5R_1(a)&&this.$D7_1(a,b)}};RTE.AtomicManager=function(){};RTE.AtomicManager.$7a=function(){ULSdmo:;RTE.CanvasEvents.dispatchAtomicUpdate("AtomicStoreCurrent",null)};RTE.AtomicManager.$4C=function(){ULSdmo:;RTE.CanvasEvents.dispatchAtomicUpdate("AtomicRestoreCurrent",null)};RTE.AtomicManager.$4m=function(a){ULSdmo:;RTE.CanvasEvents.dispatchAtomicUpdate("AtomicDisconnect",a)};RTE.AutocompleteParseData=function(a,b){ULSdmo:;this.$5N_0=a;this.$70_0=b};RTE.AutocompleteParseData.parseCurrent=function(e){ULSdmo:;if(RTE.SU.isNullOrUndefined(RTE.Canvas.currentEditableRegion()))return null;if(!e||e.length!==2)return null;var j=RTE.Cursor.get_range();if(!j.isValid())return null;var h=e.charAt(0),i=e.charAt(1),f=h===" ",b="",a=new RTE.DOMTreePosition(j.$1_0,0);while(true){if(RTE.RteUtility.isTextNode(a.$0_0)){var g=a.$0_0.data,c=a.$7_0,d=g.substring(0,c).lastIndexOf(e);if(d===-1&&f)d=g.substring(0,c).lastIndexOf(RTE.RteUtility.$1X+i);if(d>=0){if(f)d++;b=g.substring(d,c)+b;a.setOffset(d);return new RTE.AutocompleteParseData(a,b)}var k=g.substring(0,c);if(c>0&&(k.endsWith(h)||f&&k.endsWith(RTE.RteUtility.$1X))&&b.startsWith(i)){if(!f){b=h+b;a.setOffset(c-1)}else{a.moveToNextElement();a.setOffset(0)}return new RTE.AutocompleteParseData(a,b)}b=g.substring(0,c).replace(String.fromCharCode(8203),"")+b}else if(f&&b.startsWith(i)){a.moveToNextElement();a.setOffset(0);return new RTE.AutocompleteParseData(a,b)}if(!RTE.RteUtility.isInlineNode(a.$0_0)||Sys.UI.DomElement.containsCssClass(a.$0_0.parentNode,"ms-rtestate-read")||!a.moveToPreviousElement())break}return null};RTE.AutocompleteParseData.getLastWord=function(){ULSdmo:;if(RTE.SU.isNullOrUndefined(RTE.Canvas.currentEditableRegion()))return null;var f=RTE.Cursor.get_range();if(!f.isValid())return null;var c="",a=new RTE.DOMTreePosition(f.$1_0,0);while(true){if(RTE.RteUtility.isTextNode(a.$0_0)){var b=a.$0_0.data;if(b.endsWith(" ")||b.endsWith(RTE.RteUtility.$1X)){a.moveToNextElement();a.setOffset(0);break}var d=a.$7_0,e=Math.max(b.substring(0,d).lastIndexOf(" "),b.substring(0,d).lastIndexOf(RTE.RteUtility.$1X));if(e>=0){e++;c=b.substring(e,d)+c;a.setOffset(e);break}var g=b.substring(0,d);if(d>0&&(g.endsWith(" ")||g.endsWith(RTE.RteUtility.$1X))){a.moveToNextElement();a.setOffset(0);break}c=b.substring(0,d).replace(String.fromCharCode(8203),"")+c}else if(c.length>0&&a.$0_0.nodeName==="BR"){a.moveToNextElement();a.setOffset(0);break}if(!RTE.RteUtility.isInlineNode(a.$0_0)||Sys.UI.DomElement.containsCssClass(a.$0_0.parentNode,"ms-rtestate-read")||!a.moveToPreviousElement())break}return new RTE.AutocompleteParseData(a,c)};RTE.AutocompleteParseData.prototype={$5N_0:null,$70_0:null,get_treePosition:function(){ULSdmo:;return this.$5N_0},get_parsedText:function(){ULSdmo:;return this.$70_0},replaceWith:function(g){ULSdmo:;var c=RTE.Cursor.get_range(),d=c.$1_0,b=c.$2_0,e=document.createElement("SPAN"),a=document.createElement("SPAN");d.parentNode.insertBefore(e,d);c.insertBefore(g);b.parentNode.insertBefore(a,b.nextSibling);var f=this.$5N_0;RTE.RteUtility.isTextNode(f.$0_0)&&f.moveCount(true,0);f.insertMarker(d);b.parentNode.removeChild(b);e.parentNode.replaceChild(b,e);c.deleteContent();a.parentNode.insertBefore(d,a);a.parentNode.insertBefore(b,a);a.parentNode.removeChild(a)}};RTE.RTFieldFlags=function(){};RTE.Canvas=function(){};RTE.Canvas.$De=function(){ULSdmo:;return!RTE.Canvas.$5A||RTE.UiServices.$I.initialFocusOnRichText()};RTE.Canvas.setIgnoreClear=function(a){ULSdmo:;RTE.Canvas.$6g=a};RTE.Canvas.getIgnoreClear=function(){ULSdmo:;return RTE.Canvas.$6g};RTE.Canvas.setIgnoreUpDownArrows=function(a){ULSdmo:;RTE.Canvas.$6h=a};RTE.Canvas.getIgnoreUpDownArrows=function(){ULSdmo:;return RTE.Canvas.$6h};RTE.Canvas.get_isFocused=function(){ULSdmo:;return RTE.Canvas.$1W};RTE.Canvas.set_isFocused=function(a){ULSdmo:;RTE.Canvas.$1W=a;return a};RTE.Canvas.$2N=function(d){ULSdmo:;var b=d,a=d;while(a){var c=a.className;if(!RTE.SU.isNullOrEmptyString(c)&&c.indexOf("ms-rtestate-field")!==-1){b=a;break}a=a.parentNode}return b};RTE.Canvas.getEditableRegion=function(a){ULSdmo:;return RTE.Canvas.$8l(RTE.Canvas.$S,a)};RTE.Canvas.getRegion=function(a){ULSdmo:;return RTE.Canvas.$8l(RTE.Canvas.$6n,a)};RTE.Canvas.$8l=function(b,a){ULSdmo:;a=RTE.Canvas.$1M(a);while(a){if(b(a))return a;a=RTE.Canvas.$1M(a.parentNode)}return null};RTE.Canvas.getNonEditableRegion=function(a){ULSdmo:;var b=null;a=RTE.Canvas.$1M(a);while(a){if(RTE.Canvas.$t(a))b=a;else if(b)return b;a=RTE.Canvas.$1M(a.parentNode)}return b};RTE.Canvas.getDirectAtomicParent=function(a){ULSdmo:;var b=null;a=RTE.Canvas.$1M(a);while(a){if(RTE.Canvas.$S(a))break;else if(RTE.Canvas.$t(a))b=a;else if(b)return b;a=RTE.Canvas.$1M(a.parentNode)}return b};RTE.Canvas.isEditable=function(b){ULSdmo:;var a=RTE.Canvas.$1M(b);if(a&&RTE.Canvas.$6r===a)return true;while(a){if(RTE.Canvas.$S(a)){RTE.Canvas.$6r=a;return true}else if(RTE.Canvas.$t(a))return false;a=RTE.Canvas.$1M(a.parentNode)}return false};RTE.Canvas.isInEditable=function(b){ULSdmo:;var a=RTE.Canvas.$1M(b);while(a){if(RTE.Canvas.$S(a))return true;a=RTE.Canvas.$1M(a.parentNode)}return false};RTE.Canvas.$1M=function(a){ULSdmo:;while(a){if(RTE.Canvas.$CZ(a))return a;a=a.parentNode}return null};RTE.Canvas.isInRedirect=function(a){ULSdmo:;a=RTE.Canvas.$8h(a);return!!a};RTE.Canvas.getRedirectEditableRegion=function(a){ULSdmo:;a=RTE.Canvas.$8h(a);if(!a)return null;var b=RTE.RteUtility.getAttribute(a,"RteRedirect");if(b){var c=b;return $get(c)}return null};RTE.Canvas.$8h=function(a){ULSdmo:;while(a&&a.nodeType!==11&&a.nodeType!==9){var b=RTE.RteUtility.getAttribute(a,"RteRedirect");if(b)return a;a=a.parentNode}return null};RTE.Canvas.$S=function(b){ULSdmo:;var a=b.className;return!RTE.SU.isNullOrEmptyString(a)&&a.indexOf("ms-rtestate-write")>=0};RTE.Canvas.$6n=function(b){ULSdmo:;var a=b.className;return!RTE.SU.isNullOrEmptyString(a)&&a.indexOf("ms-rtestate-field")>=0};RTE.Canvas.$t=function(b){ULSdmo:;var a=b.className;return!RTE.SU.isNullOrEmptyString(a)&&a.indexOf("ms-rtestate-read")>=0};RTE.Canvas.$CZ=function(b){ULSdmo:;var a=b.className;return!RTE.SU.isNullOrEmptyString(a)&&a.indexOf("ms-rtestate-")>=0};RTE.Canvas.load=function(){ULSdmo:;if(!document.body){window.setTimeout(RTE.Canvas.load,10);return}if(RTE.Canvas.$5K)return;else RTE.Canvas.$5K=true;RTE.Canvas.$5A=true;if(document.body){RTE.RteUtility.$X("mouseup",RTE.Canvas.onMouseUp);RTE.RteUtility.$X("mousedown",RTE.Canvas.onMouseDown);RTE.RteUtility.$X("keypress",RTE.Cursor.onKeyPress);RTE.RteUtility.$X("keydown",RTE.Cursor.onKeyDown);RTE.RteUtility.$X("keyup",RTE.Cursor.onKeyUp);RTE.RteUtility.$X("paste",RTE.Cursor.$Cp);RTE.RteUtility.$X("cut",RTE.Cursor.$Ci);RTE.RteUtility.$X("copy",RTE.Cursor.$Ch);RTE.RteUtility.$X("beforepaste",RTE.Cursor.$Ce);RTE.RteUtility.$X("drop",RTE.Cursor.$9h);RTE.RteUtility.$X("deactivate",RTE.Canvas.onDeactivate);if(navigator&&navigator.msPointerEnabled){document.addEventListener("MSPointerDown",RTE.Canvas.onMSPointerDown,false);document.addEventListener("MSPointerUp",RTE.Canvas.onMSPointerUp,false);document.addEventListener("selectionchange",RTE.Canvas.onSelectionChange,false)}else{RTE.RteUtility.$X("touchstart",RTE.Canvas.onTouchStart);RTE.RteUtility.$X("touchend",RTE.Canvas.onTouchEnd)}$addHandler(document.body,"dragstart",RTE.Cursor.$9g);$addHandler(document.body,"draggesture",RTE.Cursor.$9g);$addHandler(document.body,"dragend",RTE.Cursor.$Ck);RTE.RteUtility.$X("dragover",RTE.Cursor.$Cl);document.body.setAttribute("spellcheck",false);if(RTE.RteUtility.isInternetExplorer()&&Sys.Browser.version>9)$addHandler(window.self,"beforeunload",RTE.Canvas.onBeforeUnload);else $addHandler(window.self.self,"beforeunload",RTE.Canvas.onBeforeUnload);if(RTE.RteUtility.isInternetExplorer())$addHandler(document.body,"deactivate",RTE.Canvas.onElementFocusChanged);else if(document.addEventListener){document.addEventListener("blur",RTE.Canvas.onElementFocusChanged,true);document.addEventListener("drop",RTE.Cursor.$9h,true)}RTE.RteUtility.isFirefox()&&RTE.RteUtility.$X("DOMNodeInserted",RTE.Canvas.$Cj)}try{window.document.execCommand("EnableInlineTableEditing",false,false)}catch(a){}window.setTimeout(RTE.RteUtility.$6C,18e5);RTE.CanvasEvents.registerListener("EditableRegionBlur",RTE.CanvasEvents.onEditableRegionBlur);RTE.CanvasEvents.registerListener("EditableRegionFocus",RTE.CanvasEvents.onEditableRegionFocus);RTE.CanvasEvents.registerListener("ImageFocus",RTE.CanvasEvents.onImageSelected);RTE.CanvasEvents.registerListener("AtomicFocus",RTE.CanvasEvents.onAtomicSelected);RTE.CanvasEvents.registerListener("AtomicBlur",RTE.CanvasEvents.onAtomicDeselected);RTE.DirtyBitManager.start();RTE.Canvas.setInitialFocus();RTE.Canvas.$5A=false};RTE.Canvas.restoreViewHtml=function(b){ULSdmo:;var c=b.id;if(!RTE.SU.isNullOrEmptyString(c)){for(var d=0;d<RTE.Canvas.$4D.length;d++)if(c===RTE.Canvas.$4D[d])return;RTE.Canvas.$4D[RTE.Canvas.$4D.length]=c}var e=RTE.RteUtility.getAttribute(b,"InputFieldId");if(e){var f=$get(e);if(f){var a=new RTE.Snapshot;a.$F_0=b;a.$4v_0=true;a.set_$6e_0(f.value);a.$A5_0(false)}}};RTE.Canvas.storeViewHtml=function(a){ULSdmo:;var b=RTE.RteUtility.getAttribute(a,"InputFieldId");if(b){var c=$get(b);if(c)c.value=a.innerHTML}};RTE.Canvas.$6c=function(b){ULSdmo:;var c=b;if(!Sys.UI.DomElement.containsCssClass(b,"ms-inputBox")){var a=b.parentNode;while(a&&(a.tagName==="DIV"||a.tagName==="SPAN")){if(Sys.UI.DomElement.containsCssClass(a,"ms-rtestate-field")){c=a;break}a=a.parentNode}}return c};RTE.Canvas.$Aj=function(c){ULSdmo:;var b=RTE.Canvas.$6c(c),a=b;do{if(Sys.UI.DomElement.containsCssClass(a,"ms-inputBox"))break;if(Sys.UI.DomElement.containsCssClass(a,"ms-formbody")){Sys.UI.DomElement.addCssClass(b,"ms-inputBox");b.style.display="";break}a=a.parentNode}while(a&&a!==document.body)};RTE.Canvas.$DU=function(b){ULSdmo:;var a=RTE.Canvas.$6c(b);if(!Sys.UI.DomElement.containsCssClass(a,"ms-inputBox"))return;Sys.UI.DomElement.addCssClass(a,"ms-inputBoxActive")};RTE.Canvas.$Db=function(b){ULSdmo:;var a=RTE.Canvas.$6c(b);if(!Sys.UI.DomElement.containsCssClass(a,"ms-inputBox"))return;Sys.UI.DomElement.removeCssClass(a,"ms-inputBoxActive")};RTE.Canvas.fixRegion=function(c,e){ULSdmo:;!RTE.Canvas.$5K&&RTE.Canvas.load();if(arguments.length===1)e=true;if(!RTE.Canvas.$r){RTE.Canvas.$r=[];RTE.Canvas.$2B={}}var d;if(RTE.SU.isNullOrUndefined(RTE.Canvas.$2B[c]))d=RTE.Canvas.$r.length;else d=RTE.Canvas.$2B[c];var a=$get(c);if(a){RTE.Canvas.$Aj(a);if(e)RTE.Canvas.restoreViewHtml(a);else RTE.Canvas.dispatchAddedEventsChildElements(a);for(var b=a.parentNode,f=0;f<3&&b;f++){if(b.tagName==="TD"&&Sys.UI.DomElement.containsCssClass(b,"ms-formbody")){b.RteRedirect=c;break}b=b.parentNode}var g=RTE.Canvas.$Bd(a);if(0!==(g&RTE.RTFieldFlags.$9s))RTE.Canvas.$1D=a;(RTE.SU.isNullOrEmptyString(a.className)||!Sys.UI.DomElement.containsCssClass(a,"ms-rtestate-field"))&&Sys.UI.DomElement.addCssClass(a,"ms-rtestate-field");if(RTE.Canvas.$6p(a))RTE.LayoutsEditor.create(a);else{RTE.Canvas.makeRegionEditable(a);RTE.Canvas.$73(a)}RTE.Canvas.$r[d]=a;RTE.Canvas.$2B[c]=d}};RTE.Canvas.dispatchAddedEventsChildElements=function(a){ULSdmo:;RTE.RteUtility.forEachChildWithTagAndClass(a,null,"ms-rtestate-notify",function(b){ULSdmo:;var a={};a.node=b;RTE.CanvasEvents.dispatchEvent("ElementAdded","restore",a)})};RTE.Canvas.$DE=function(d){ULSdmo:;if(!RTE.Canvas.$r)return;var a=RTE.Canvas.$2B[d];if(RTE.SU.isNullOrUndefined(a))return;var b=RTE.Canvas.$r.length,c=RTE.Canvas.$r[b-1];RTE.Canvas.$r[a]=c;RTE.Canvas.$2B[c.id]=a;Array.removeAt(RTE.Canvas.$r,b-1);delete RTE.Canvas.$2B[d]};RTE.Canvas.revertWikiRegion=function(b){ULSdmo:;RTE.Canvas.$29&&RTE.Canvas.$29.stop();RTE.Canvas.$DE(b);var a=RTE.Cursor.get_range();a&&a.clear();try{document.body.focus()}catch(c){}RTE.Canvas.$1W=false;RTE.Cursor.update()};RTE.Canvas.$73=function(a){ULSdmo:;if(!RTE.RteUtility.containsVisibleNode(a)){var b=document.createElement("P");b.appendChild(a.ownerDocument.createTextNode(RTE.RteUtility.$1t));a.appendChild(b)}};RTE.Canvas.$4s=function(a){ULSdmo:;window.document.execCommand(a,false,null)};RTE.Canvas.$6R=function(a){ULSdmo:;RTE.Cursor.s_range.$4k_0();RTE.Canvas.$4s(a);RTE.Cursor.updateRangeToCurrentSelection();RTE.Cursor.update()};RTE.Canvas.$8K=function(b){ULSdmo:;var a=new RTE.CommandState;if(RTE.Canvas.$4t(b)){a.$D_0=true;try{if(window.document.queryCommandState(b))a.$j_0=true}catch(c){}}return a};RTE.Canvas.$4t=function(b){ULSdmo:;try{RTE.Cursor.ignoreBeforePasteOrDrop=true;var a=window.document.queryCommandEnabled(b);RTE.Cursor.ignoreBeforePasteOrDrop=false;return a}catch(c){RTE.Cursor.ignoreBeforePasteOrDrop=false;return false}};RTE.Canvas.$50=function(a){ULSdmo:;while(a&&RTE.Canvas.$t(a.parentNode))a=a.parentNode;return a};RTE.Canvas.$4K=function(a){ULSdmo:;RTE.Canvas.set_selectedAtomic(a);RTE.CanvasEvents.dispatchNodeEvents("Atomic",RTE.Canvas.get_selectedAtomic())};RTE.Canvas.get_selectedAtomic=function(){ULSdmo:;return RTE.Canvas.$2i};RTE.Canvas.set_selectedAtomic=function(a){ULSdmo:;RTE.Canvas.$2i=RTE.Canvas.$50(a);return a};RTE.Canvas.onMouseDown=function(c){ULSdmo:;var a=c.target;RTE.Canvas.$AN();RTE.Canvas.$32=true;if(!RTE.RteUtility.$1L(a))return;RTE.Canvas.$2e=null;RTE.Canvas.set_selectedAtomic(null);RTE.Canvas.$2E=null;if(RTE.Canvas.isInEditable(a)){var e=RTE.RteUtility.$BU(a);e&&c.ctrlKey&&!c.shiftKey&&window.open(e.href);if(RTE.RteUtility.isSafari()&&a&&a.tagName==="IMG"){RTE.Cursor.get_range().moveToNode(a);RTE.Cursor.select()}var d;if(RTE.RteUtility.isFirefox()&&null!==(d=RTE.RteUtility.$20(a,["TD","TH"]))&&RTE.Canvas.isInEditable(d))RTE.Canvas.$2E=d;var g=RTE.Canvas.getEditableRegion(a);if(a===g){var b=RTE.RteUtility.getRealLastChild(a,true);if(b&&b.nodeType===1&&b.offsetParent===a.offsetParent&&c.offsetY>b.offsetTop-a.offsetTop+b.clientHeight&&(b.tagName==="TABLE"||RTE.Canvas.$t(b))){var f=RTE.RteUtility.$3g(a.ownerDocument);a.appendChild(f);RTE.Cursor.get_range().moveToStartOfNode(f);RTE.Cursor.update();RTE.RteUtility.cancelEvent(c);return}}if(!RTE.Canvas.isEditable(a)){RTE.Canvas.set_selectedAtomic(RTE.Cursor.$Bu(a));if(RTE.Canvas.get_selectedAtomic()){var h=a.tagName;if(!RTE.Canvas.$3C(h)){if(!RTE.Canvas.$46){RTE.Canvas.$3v=null;RTE.RteUtility.$X("mousemove",RTE.Canvas.$75);RTE.Canvas.$46=true}RTE.Canvas.$4o=true;RTE.Canvas.$7O=RTE.Canvas.$2i.style.cssText;RTE.RteUtility.getAttribute(RTE.Canvas.get_selectedAtomic(),"unselectable")!=="on"&&RTE.Canvas.makeUnselectable(RTE.Canvas.get_selectedAtomic());RTE.Cursor.s_range.moveToNode(RTE.Canvas.get_selectedAtomic());RTE.Cursor.select()}}}}else RTE.Canvas.$2e=a;RTE.PasteFlyout.get_isVisible()&&window.setTimeout(RTE.PasteFlyout.collapseOptions,0);!RTE.PasteFlyout.get_isVisible()&&RTE.SnapshotManager.$1N(RTE.Canvas.currentEditableRegion())&&RTE.SnapshotManager.takeSnapshot()};RTE.Canvas.$3C=function(a){ULSdmo:;return a==="TEXTAREA"||a==="INPUT"||a==="IFRAME"||a==="OBJECT"||a==="EMBED"};RTE.Canvas.$9I=function(a){ULSdmo:;return a==="SELECT"||a==="OPTION"||a==="INPUT"};RTE.Canvas.makeUnselectable=function(b){ULSdmo:;b.setAttribute("unselectable","on");for(var d=b.getElementsByTagName("*"),e=RTE.Canvas.getEditableRegion(b),c=0;c<d.length;c++){var a=d[c];!RTE.Canvas.$3C(a.tagName)&&!RTE.RteUtility.isTextNode(a)&&!RTE.RteUtility.isSvgNode(a)&&e===RTE.Canvas.getEditableRegion(a)&&a.setAttribute("unselectable","on")}};RTE.Canvas.$9u=function(){ULSdmo:;if(RTE.Canvas.$3G){RTE.Canvas.$3G.style.cursor=RTE.Canvas.$76;RTE.Canvas.$3G=null}};RTE.Canvas.onMouseMove=function(a){ULSdmo:;RTE.Canvas.$2i&&RTE.Canvas.$9S(a)};RTE.Canvas.$9S=function(d){ULSdmo:;try{var b=RTE.RteUtility.$B4(d.rawEvent);if(b){var c=b.commonAncestorContainer||b.parentElement(),a=RTE.Canvas.getEditableRegion(c);if(a!==RTE.Canvas.$3G&&a){RTE.Canvas.$9u();RTE.Canvas.$76=a.style.cursor;a.style.cursor="move";RTE.Canvas.$3G=a}if(RTE.Canvas.isEditable(c))RTE.Canvas.$3v=b}RTE.Canvas.$3v&&window.setTimeout(function(){ULSdmo:;RTE.Range.$7P(RTE.Canvas.$3v)},0)}catch(e){}};RTE.Canvas.onMSPointerDown=function(b){ULSdmo:;var a=b.pointerType;if(typeof a!=="undefined"&&a===2)RTE.Canvas.onMouseDown(b)};RTE.Canvas.onMSPointerUp=function(b){ULSdmo:;var a=b.pointerType;if(typeof a!=="undefined"&&a===2)RTE.Canvas.onMouseUp(b)};RTE.Canvas.onSelectionChange=function(b){ULSdmo:;try{if(RTE.Canvas.$32||RTE.Cursor.$2P||!RTE.RteUtility.$1L(b.target)||RTE.UiServices.$I.isOnUiOperation())return;var e=RTE.Canvas.currentEditableRegion();if(!e||!b.target||b.target.ownerDocument&&e.ownerDocument!==b.target.ownerDocument||b.target!==e.ownerDocument)return}catch(h){return}var a=RTE.QuickRange.$39();if(a&&a.get_$3D_0()){var c=a.get_$7F_0(),d=a.get_$7E_0();if(RTE.Cursor.s_range.isValid()){var f=c===RTE.Cursor.s_range.$1_0||c.previousSibling===RTE.Cursor.s_range.$1_0||c.nextSibling===RTE.Cursor.s_range.$1_0,g=d===RTE.Cursor.s_range.$2_0||d.previousSibling===RTE.Cursor.s_range.$2_0||d.nextSibling===RTE.Cursor.s_range.$2_0;if(RTE.Cursor.s_range.isEmpty()&&c===d&&a.$1u_0===a.$1K_0&&(f||g)||f&&g)return}RTE.Cursor.waitAndUpdateRangeToCurrentSelection(false,300)}};RTE.Canvas.onTouchStart=function(a){ULSdmo:;RTE.Canvas.onMouseDown(a)};RTE.Canvas.onTouchEnd=function(a){ULSdmo:;if(!RTE.RteUtility.$1L(a.target))return;RTE.Cursor.cursorRangeIsNowOutdated();RTE.Canvas.$8G(a);RTE.CanvasEvents.onImageResize(a)};RTE.Canvas.onMouseUp=function(a){ULSdmo:;RTE.Canvas.$32=false;if(RTE.RteUtility.isInternetExplorer()&&RTE.Canvas.$2e&&RTE.Canvas.$2e===a.target&&!RTE.Canvas.$9I(a.target.tagName)){var b=RTE.Cursor.getSelectedImage();if(b&&b!==RTE.Canvas.$2e){var c=RTE.RteUtility.$Br(b),e=a.clientX,f=a.clientY;e>=c.x&&e<=c.x+b.offsetWidth&&f>=c.y&&f<=c.y+b.offsetHeight&&RTE.Canvas.$2e.click()}}if(RTE.RteUtility.isFirefox()&&RTE.Canvas.$2E){var d=RTE.RteUtility.$20(a.target,["TD","TH"]);if(d&&RTE.Canvas.$2E!==d)if(RTE.RteUtility.getNearestParentElementOfType(RTE.Canvas.$2E,"TABLE")===RTE.RteUtility.getNearestParentElementOfType(d,"TABLE")){RTE.Canvas.$2E.insertBefore(RTE.Cursor.s_range.$1_0,RTE.Canvas.$2E.firstChild);d.appendChild(RTE.Cursor.s_range.$2_0);RTE.Cursor.update()}}RTE.Canvas.$Dv(a);RTE.Canvas.$8G(a);RTE.CanvasEvents.onImageResize(a);RTE.Cursor.$1T&&RTE.Cursor.s_range.clear()};RTE.Canvas.$8G=function(c){ULSdmo:;if(RTE.Canvas.$2i&&RTE.Canvas.$4o){var a=RTE.Canvas.$2i,d=RTE.Canvas.getNonEditableRegion(c.target);if(!d){RTE.Canvas.set_selectedAtomic(null);RTE.Canvas.$9S(c);RTE.Cursor.updateRangeToCurrentSelection();var b=RTE.Cursor.get_range();RTE.Canvas.set_selectedAtomic(a);if(b.isValid()){b.insertNode(a);b.moveToNode(a);window.setTimeout(RTE.Cursor.update,0)}}a.style.cssText=RTE.Canvas.$7O;RTE.Canvas.$AN()}};RTE.Canvas.$AN=function(){ULSdmo:;if(RTE.Canvas.$46){RTE.RteUtility.$8C("mousemove",RTE.Canvas.$75);RTE.Canvas.$46=false}RTE.Canvas.$4o=false;RTE.Canvas.$9u()};RTE.Canvas.onElementFocusChanged=function(b){ULSdmo:;if(b.target&&RTE.Cursor.$1T){var a=RTE.Canvas.getEditableRegion(b.target);a&&RTE.CanvasEvents.dispatchChangedOnEditableRegion(a)}};RTE.Canvas.onDeactivate=function(b){ULSdmo:;var a=b.rawEvent.toElement;a&&a.ownerDocument!==window.document&&RTE.Canvas.$AP(a,b)};RTE.Canvas.$Dv=function(a){ULSdmo:;RTE.Canvas.$AP(a.target,a)};RTE.Canvas.$AP=function(a,c){ULSdmo:;if(a&&a.parentNode&&RTE.RteUtility.$1L(a)){RTE.Canvas.get_activeAutocomplete()&&RTE.Canvas.get_activeAutocomplete().stop();var b=RTE.Canvas.getRedirectEditableRegion(a);if(b&&RTE.Canvas.$CE(b)){RTE.Canvas.moveToRedirect(a,b);c.preventDefault();return}RTE.Cursor.$3r=true;if(RTE.Canvas.$9I(a.tagName))RTE.Cursor.$3c();else RTE.Cursor.waitAndUpdateRangeToCurrentSelection(false,300)}};RTE.Canvas.setRedirectOnNode=function(b,a){ULSdmo:;b.RteRedirect=a};RTE.Canvas.moveToRedirectIfItExist=function(b){ULSdmo:;var a=RTE.Canvas.getRedirectEditableRegion(b);if(a)if(RTE.Canvas.moveToRedirect(b,a)){window.event&&RTE.RteUtility.cancelEvent(new Sys.UI.DomEvent(window.event));return true}return false};RTE.Canvas.moveToRedirect=function(c,a){ULSdmo:;var b=RTE.Canvas.getEditableRegion(c);if(!b||a!==b){if(a.innerHTML==="")a.innerText=RTE.RteUtility.$1t;window.setTimeout(RTE.Canvas.$Dw,2e3);RTE.Cursor.get_range().moveToEndOfNode(a);if(RTE.RteUtility.isFirefox()){RTE.CanvasEvents.$6O();RTE.Cursor.select();a.focus()}else{RTE.RteUtility.focusNoFail(a);RTE.Cursor.update()}return true}return false};RTE.Canvas.$Dw=function(){ULSdmo:;if(!RTE.Cursor.$2R){RTE.Cursor.updateWithoutDispatchingEvents();RTE.Cursor.$2P=true;document.body.focus();RTE.Cursor.select();RTE.Cursor.$2P=false}};RTE.Canvas.$Dt=function(a){ULSdmo:;RTE.Canvas.$3q(a)&&RTE.Canvas.showEmptyPanel(a)};RTE.Canvas.showEmptyPanel=function(a){ULSdmo:;RTE.Canvas.$AH(a,"","none")};RTE.Canvas.hideEmptyPanel=function(a){ULSdmo:;RTE.Canvas.$AH(a,"none","")};RTE.Canvas.$Cj=function(l){ULSdmo:;var a=l.target;if(!RTE.RteUtility.isTextNode(a)&&a.tagName!=="BR")return;if(RTE.Cursor.$m)return;var b=a;if(!b)return;var e=false,f=null;while(b){var i=b.className;if(i&&i.indexOf("ms-rtestate-write")!==-1){e=true;f=b;if(!RTE.Canvas.getCachedRestriction(b,"AllowMultiLines",true))return;break}if(RTE.RteUtility.isBlockNode(b))return;b=b.parentNode}if(!e)return;for(var g=f.childNodes,j=g.length,c=0;c<j;c++){var d=g[c];if(d!==a&&(!d.id||d.id.indexOf("ms-rterangecursor")===-1))return}if(RTE.RteUtility.isTextNode(a)){var k=a.nodeValue;if(k.replace(RTE.Canvas.$AU,"")==="")return}var h=document.createElement("P");a.parentNode.insertBefore(h,a);h.appendChild(a);if(a.tagName==="BR"){RTE.Canvas.$4b=a;window.setTimeout(RTE.Canvas.$D9,0)}RTE.Cursor.get_range().$4k_0();RTE.Cursor.cursorRangeIsNowOutdated()};RTE.Canvas.$D9=function(){ULSdmo:;if(!RTE.Canvas.$4b)return;RTE.RteUtility.removeNode(RTE.Canvas.$4b)};RTE.Canvas.$3q=function(b){ULSdmo:;if(b.childNodes.length<10){var a=b.innerHTML;a=RTE.RteUtility.removeEmptySpanAndRteIds(a,false,true);a=a.replace(RTE.RteUtility.$1t,"");a=a.toLowerCase();if(a===""||a==="<br>"||a==="<p></p>"||a==="<p><br></p>"||a==="<p><br/></p>"||a==="<p>&nbsp;</p>")return true}return false};RTE.Canvas.$CE=function(c){ULSdmo:;var a=RTE.Canvas.getProperty(c,"EmptyPanelId");if(!RTE.SU.isNullOrEmptyString(a)){var b=$get(a);if(b)return b.style.display!=="none"}return false};RTE.Canvas.$AH=function(d,h,b){ULSdmo:;var e=RTE.Canvas.getProperty(d,"EmptyPanelId");if(!RTE.SU.isNullOrEmptyString(e)){var g=$get(e);g.style.display=h;var f=RTE.Canvas.getProperty(d,"DisplayPanelId"),a=d;if(!RTE.SU.isNullOrEmptyString(f))a=$get(f);if(a.style.display!==b){a.style.display=b;if(b!=="none"&&!RTE.Cursor.get_range().isValid()){RTE.Cursor.get_range().moveToEndOfNode(a);RTE.Cursor.update()}}var c=a.nextSibling;if(c&&c.className==="ms-rteclear"&&c.style.display!==b)c.style.display=b}};RTE.Canvas.getEditableRegionHtml=function(a,d){ULSdmo:;if(!a)return null;var b=RTE.RteUtility.getAttribute(a,"dir"),c=RTE.RteUtility.$Ba(a,d);return RTE.Canvas.$3q(a)?"":!RTE.SU.isNullOrEmptyString(b)?'<div class="ms-rtedir" dir="'+b+'">'+c+"</div>":c};RTE.Canvas.currentEditableRegion=function(){ULSdmo:;return RTE.CanvasEvents.$1m};RTE.Canvas.getRTEFieldRegion=function(){ULSdmo:;if(!RTE.Canvas.$r)return null;var c=RTE.Canvas.$r.length;if(1===c)return RTE.Canvas.$r[0];else for(var d=RTE.Canvas.currentEditableRegion(),a=0;a<c;a++){var b=RTE.Canvas.$r[a];if(d===b||RTE.RteUtility.$M(d,b,null))return b}return null};RTE.Canvas.get_activeAutocomplete=function(){ULSdmo:;if(RTE.Canvas.$29&&!RTE.Canvas.$29.get_isStarted())RTE.Canvas.$29=null;return RTE.Canvas.$29};RTE.Canvas.get_autocompleteHandlers=function(){ULSdmo:;return RTE.Canvas.$7L||(RTE.Canvas.$7L=new Array(0))};RTE.Canvas.invokeInAutoComplete=function(d){ULSdmo:;var e=RTE.Canvas.get_activeAutocomplete();if(e)return d(e);for(var a=false,f=RTE.Canvas.get_autocompleteHandlers(),b=0;b<f.length;b++){var c=f[b];a=a||d(c);if(c.get_isStarted()){RTE.Canvas.$29=c;break}}return a};RTE.Canvas.registerAutocomplete=function(a){ULSdmo:;Array.add(RTE.Canvas.get_autocompleteHandlers(),a)};RTE.Canvas.isMultiline=function(a){ULSdmo:;return RTE.Canvas.getCachedRestriction(a,"AllowMultiLines",true)};RTE.Canvas.getCachedRestriction=function(a,c,d){ULSdmo:;if(!a)return d;if(RTE.Canvas.$6A!==a){RTE.Canvas.resetCacheRestriction();RTE.Canvas.$6A=a}var b=RTE.Canvas.$4f[c];if(typeof b==="undefined"){b=RTE.Canvas.getRestriction(a,c,d);RTE.Canvas.$4f[c]=b}return b};RTE.Canvas.resetCacheRestriction=function(){ULSdmo:;RTE.Canvas.$4f={}};RTE.Canvas.getRestriction=function(b,a,c){ULSdmo:;return RTE.Canvas.getStringRestriction(b,a,c?"True":"False")==="True"};RTE.Canvas.getStringRestriction=function(a,d,b){ULSdmo:;if(!a)return b;var c=RTE.RteUtility.getAttribute(a,d);if(!c){if(a.className.indexOf("ms-rtestate-field")!==-1)return b;var e=RTE.Canvas.getRegion(a);if(!e)return b;c=RTE.RteUtility.getAttribute(e,d);if(!c)return b}return c};RTE.Canvas.setRestriction=function(b,a,c){ULSdmo:;var d=c?"True":"false";b.setAttribute(a,d)};RTE.Canvas.getProperty=function(a,b){ULSdmo:;return RTE.RteUtility.getAttribute(a,b)};RTE.Canvas.getBooleanProperty=function(a,b){ULSdmo:;var c=RTE.RteUtility.getAttribute(a,b);return c==="True"};RTE.Canvas.makeRegionEditable=function(a){ULSdmo:;a.setAttribute("contentEditable",true);a.setAttribute("role","textbox");a.setAttribute("aria-autocomplete","both");a.setAttribute("aria-haspopup",true);a.setAttribute("aria-multiline",true);Sys.UI.DomElement.addCssClass(a,"ms-rtestate-write");Sys.UI.DomElement.removeCssClass(a,"ms-rtestate-read");Array.add(RTE.Canvas.$2K,a)};RTE.Canvas.makeRegionUnEditable=function(a){ULSdmo:;a.setAttribute("contentEditable",false);a.removeAttribute("role");a.removeAttribute("aria-autocomplete");a.removeAttribute("aria-haspopup");a.removeAttribute("aria-multiline");Sys.UI.DomElement.removeCssClass(a,"ms-rtestate-write");Sys.UI.DomElement.addCssClass(a,"ms-rtestate-read");Array.remove(RTE.Canvas.$2K,a)};RTE.Canvas.getCurrentStyleSheetPrefix=function(){ULSdmo:;var a=RTE.Canvas.currentEditableRegion();if(a){var b=RTE.Canvas.getProperty(a,"PrefixStyleSheet");if(!RTE.SU.isNullOrEmptyString(b))return b}return"ms-rte"};RTE.Canvas.setInitialFocus=function(){ULSdmo:;var a=RTE.SnapshotManager.getMarkers();if(!RTE.Canvas.$1D&&a.length===2&&a[0]&&a[1])RTE.Canvas.$1D=RTE.Canvas.getEditableRegion(a[0]);if(null!==RTE.Canvas.$1D&&RTE.Canvas.$1D.parentNode){var c=RTE.Cursor.get_range();if(a.length===2&&a[0]&&a[1]&&RTE.RteUtility.$M(a[0],RTE.Canvas.$1D,null)&&RTE.RteUtility.$M(a[1],RTE.Canvas.$1D,null)){c.moveToMarkersCollection(a);a[0]!==c.$1_0&&RTE.RteUtility.removeNodeAndKeepChildNodes(a[0]);a[1]!==c.$2_0&&RTE.RteUtility.removeNodeAndKeepChildNodes(a[1])}else{var b;if(RTE.Canvas.$6p(RTE.Canvas.$1D))b=RTE.LayoutsEditor.getLayoutsEditorForRegion(RTE.Canvas.$1D).$8g_0();else b=RTE.Canvas.$1D;var d=RTE.Canvas.getEditableRegion(b);d&&RTE.RteUtility.focusNoFail(d);RTE.Cursor.get_range().moveToStartOfNode(b)}RTE.Canvas.$1W=true;RTE.Cursor.update()}else window.setTimeout(RTE.Canvas.checkCurrentFocus,0)};RTE.Canvas.checkCurrentFocus=function(){ULSdmo:;var a=RTE.Selection.getSelectionRange();if(a){var b=a.parentElement();if(RTE.Canvas.isInEditable(b)&&!RTE.Cursor.get_range().isValid()){RTE.Cursor.updateRangeToCurrentSelection();RTE.Cursor.update()}}};RTE.Canvas.getVisibleHtml=function(c){ULSdmo:;var b=c.cloneNode(false),d,a;RTE.RteUtility.$2j(b,c.innerHTML);a=b.firstChild;while(null!==a){d=a.nextSibling;!RTE.RteUtility.containsVisibleNode(a)&&b.removeChild(a);a=d}var e=b.innerHTML;b=null;return e};RTE.Canvas.$6p=function(b){ULSdmo:;var a=RTE.RteUtility.getAttribute(b,"isWiki");return!RTE.SU.isNullOrUndefined(a)&&a};RTE.Canvas.$Bd=function(d){ULSdmo:;var a="ms-rteflags-",b=d.className.indexOf(a),c=0;if(-1!==b){var e=d.className.substr(b+a.length).split(" ")[0];c=e}return c};RTE.Canvas.onBeforeUnload=function(){ULSdmo:;for(var a=0;a<RTE.Canvas.$2K.length;a++)RTE.Canvas.storeViewHtml(RTE.Canvas.$2K[a])};RTE.Canvas.changeKeyTimeout=function(a){ULSdmo:;RTE.Canvas.$30=a?0:500};RTE.Canvas.isSkipNode=function(a){ULSdmo:;if(a.nodeType===1&&Sys.UI.DomElement.containsCssClass(a,"ms-rtegenerate-skip"))return true;while(a){if(a.nodeType===1&&Sys.UI.DomElement.containsCssClass(a,"ms-rtegenerate-allskip"))return true;a=a.parentNode}return false};RTE.Canvas.sendApplicationStateChangedEvent=function(){ULSdmo:;if(RTE.Canvas.$1Y<=0)RTE.Canvas.$1Y=window.setTimeout(RTE.Canvas.$A8,0)};RTE.Canvas.$A8=function(){ULSdmo:;RTE.Canvas.$1Y=0;RTE.UiServices.$I.sendApplicationStateChangedEvent()};RTE.Canvas.$DR=function(){ULSdmo:;if(RTE.RteUtility.isFirefox()){if(RTE.Canvas.$1Y>0){window.clearTimeout(RTE.Canvas.$1Y);RTE.Canvas.$1Y=0}RTE.Canvas.$A8()}else RTE.Canvas.sendApplicationStateChangedEvent()};RTE.CanvasEvents=function(){};RTE.CanvasEvents.registerListener=function(a,b){ULSdmo:;RTE.CanvasEvents.$5H.addHandler(a,b);if(!RTE.CanvasEvents.$1r[a])RTE.CanvasEvents.$1r[a]=0;RTE.CanvasEvents.$1r[a]=RTE.CanvasEvents.$1r[a]+1;return true};RTE.CanvasEvents.unRegisterListener=function(a,b){ULSdmo:;RTE.CanvasEvents.$5H.removeHandler(a,b);RTE.CanvasEvents.$1r[a]=RTE.CanvasEvents.$1r[a]-1;return true};RTE.CanvasEvents.dispatchEvent=function(a,b,c){ULSdmo:;RTE.Canvas.get_activeAutocomplete()&&RTE.Canvas.get_activeAutocomplete().onTextChanged();RTE.CanvasEvents.dispatchEventNoTextChange(a,b,c)};RTE.CanvasEvents.dispatchEventNoTextChange=function(a,c,d){ULSdmo:;if(RTE.CanvasEvents.$1r[a]>0){var b=RTE.CanvasEvents.$5H.getHandler(a);if(b)try{b(c,d)}catch(e){}}};RTE.CanvasEvents.dispatchChanged=function(){ULSdmo:;if(RTE.CanvasEvents.$1r.EditableRegionChanged>0){var a=RTE.CanvasEvents.$1m;if(a)RTE.SnapshotManager.$2W(RTE.SnapshotManager.$v,a)&&RTE.SnapshotManager.$1N(a)&&RTE.CanvasEvents.dispatchChangedOnEditableRegion(a)}};RTE.CanvasEvents.dispatchAtomicUpdate=function(c,b){ULSdmo:;var a={};a.container=b;RTE.CanvasEvents.dispatchEventNoTextChange(c,null,a)};RTE.CanvasEvents.dispatchBeforeRestoreOnEditableRegion=function(b){ULSdmo:;var a={};a.editableRegion=b;RTE.CanvasEvents.dispatchEventNoTextChange("EditableRegionBeforeRestore",null,a)};RTE.CanvasEvents.dispatchAfterRestoreOnEditableRegion=function(b){ULSdmo:;var a={};a.editableRegion=b;RTE.CanvasEvents.dispatchEventNoTextChange("EditableRegionAfterRestore",null,a)};RTE.CanvasEvents.dispatchSafeHtmlCleanup=function(a){ULSdmo:;RTE.CanvasEvents.dispatchEventNoTextChange("HtmlCleanup",null,a)};RTE.CanvasEvents.dispatchHandleShortcut=function(a){ULSdmo:;RTE.CanvasEvents.dispatchEventNoTextChange("HandleShortcut",null,a)};RTE.CanvasEvents.dispatchChangedOnEditableRegion=function(b){ULSdmo:;var a={};a.editableRegion=b;RTE.CanvasEvents.dispatchEvent("EditableRegionChanged",null,a)};RTE.CanvasEvents.$B8=function(){ULSdmo:;var a={};a.editableRegion=RTE.CanvasEvents.$1m;RTE.CanvasEvents.dispatchEvent("EditableRegionSelection",null,a)};RTE.CanvasEvents.$8E=function(a,c){ULSdmo:;if(a&&(!RTE.CanvasEvents.$1m||!RTE.RteUtility.$M(RTE.CanvasEvents.$1m,a,null))){var b={};b.oldEditableRegion=a;b.newEditableRegion=c;RTE.CanvasEvents.dispatchEvent("EditableRegionBlur",null,b);RTE.CanvasEvents.$8E(RTE.Canvas.getEditableRegion(a.parentNode),c)}};RTE.CanvasEvents.dispatchFocus=function(a){ULSdmo:;if(a===RTE.CanvasEvents.$1m)return;var c=RTE.CanvasEvents.$1m;RTE.CanvasEvents.$1m=a;RTE.CanvasEvents.$8E(c,a);if(a){!RTE.SnapshotManager.$2W(RTE.SnapshotManager.$v,a)&&RTE.SnapshotManager.takeEditableRegionSnapshot(a);var b={};b.oldEditableRegion=c;b.newEditableRegion=a;RTE.CanvasEvents.dispatchEvent("EditableRegionFocus",null,b);!Array.contains(RTE.Canvas.$2K,a)&&Array.add(RTE.Canvas.$2K,a)}};RTE.CanvasEvents.getNodeFromEvent=function(b){ULSdmo:;var a=RTE.CanvasEvents.$35[b];return RTE.SU.isUndefined(a)?null:a};RTE.CanvasEvents.dispatchNodeEvents=function(a,b){ULSdmo:;if(!b)RTE.CanvasEvents.$8F(a,null);else RTE.CanvasEvents.$B7(a,b)};RTE.CanvasEvents.$8F=function(a,d){ULSdmo:;var c=RTE.CanvasEvents.$35[a];if(c){var b={};b["old"+a]=c;b["new"+a]=d;RTE.CanvasEvents.$35[a]=null;RTE.CanvasEvents.dispatchEvent(a+"Blur",null,b)}};RTE.CanvasEvents.$B7=function(a,b){ULSdmo:;var c=RTE.CanvasEvents.$35[a];if(!b||b===c)return;RTE.CanvasEvents.$8F(a,c);RTE.CanvasEvents.$35[a]=b;var d={};d["old"+a]=c;d["new"+a]=b;RTE.CanvasEvents.dispatchEvent(a+"Focus",null,d)};RTE.CanvasEvents.$6O=function(){ULSdmo:;if(RTE.CanvasEvents.$3h)return;if(RTE.PreviewManager.get_instance().get_hasPreview())return;var a=RTE.Cursor.s_range;RTE.Canvas.$1W=a.isValid();var f=RTE.Canvas.currentEditableRegion(),b=a.getEditableRegion();if(!f&&!b)return;RTE.CanvasEvents.$3h=true;try{RTE.CanvasEvents.dispatchFocus(b);RTE.CanvasEvents.$B8();var g=RTE.Cursor.getSelectedTable();RTE.CanvasEvents.dispatchNodeEvents("Table",g);var c=RTE.Cursor.getSelectedAtomic();RTE.CanvasEvents.dispatchNodeEvents("Atomic",c);var d=null,e=null;if(!c){d=RTE.Cursor.getSelectedLink();e=RTE.Cursor.getSelectedImage()}RTE.CanvasEvents.dispatchNodeEvents("Link",d);RTE.CanvasEvents.dispatchNodeEvents("Image",e);RTE.Canvas.get_activeAutocomplete()&&RTE.Canvas.get_activeAutocomplete().onTextChanged();RTE.CanvasEvents.dispatchChanged()}catch(h){RTE.CanvasEvents.$3h=false}finally{RTE.CanvasEvents.$3h=false}};RTE.CanvasEvents.onEditableRegionBlur=function(c,b){ULSdmo:;var a=b.oldEditableRegion;RTE.SnapshotManager.$1N(a)&&RTE.SnapshotManager.takeEditableRegionSnapshot(a);RTE.Canvas.$Db(a);RTE.Canvas.$Dt(a);RTE.Canvas.sendApplicationStateChangedEvent()};RTE.CanvasEvents.onEditableRegionFocus=function(d,c){ULSdmo:;var b=c.oldEditableRegion,a=c.newEditableRegion;(!b||RTE.Canvas.getCachedRestriction(b,"DisableRibbonCommands",false))&&!RTE.Canvas.getCachedRestriction(a,"DisableRibbonCommands",false)&&RTE.UiServices.$I.showUiExperience(0);RTE.SnapshotManager.$1N(a)&&RTE.SnapshotManager.takeEditableRegionSnapshot(a);RTE.Canvas.hideEmptyPanel(a);RTE.Canvas.$DU(a);RTE.Canvas.sendApplicationStateChangedEvent()};RTE.CanvasEvents.onImageSelected=function(){ULSdmo:;RTE.CanvasEvents.waitAndSetImageSize()};RTE.CanvasEvents.resetImageSizes=function(a){ULSdmo:;a.removeAttribute("setHeight");a.removeAttribute("setWidth");a.removeAttribute("hasHeight")};RTE.CanvasEvents.onImageResize=function(m){ULSdmo:;var a=RTE.CanvasEvents.getNodeFromEvent("Image");if(!a)return;var i=RTE.RichTextEditor.isRatioLocked(a),h=RTE.RteUtility.getAttribute(a,"setHeight"),j=RTE.RteUtility.getAttribute(a,"setWidth"),k=RTE.RteUtility.getAttribute(a,"hasHeight");if(!RTE.SU.isNullOrUndefined(h)){var b=Number.parseInvariant(h),e=Number.parseInvariant(j),g=Boolean.parse(k),f=RTE.RichTextEditor.allowImageResize(),c=f?a.height:b,d=f?a.width:e;if(f&&(i||m.shiftKey)){if(d!==e||c!==b){if(Math.abs(c-b)>Math.abs(d-e))d=Math.round(c*e/b);else c=Math.round(d*b/e);if(!isNaN(d))a.style.width=d+"px";if(g&&!isNaN(c))a.style.height=c+"px"}if(!g)a.style.height=""}else{a.style.width=d+"px";a.style.height=f||g?c+"px":""}a.removeAttribute("height");a.removeAttribute("width");var l=f&&(b!==-1&&b!==a.height||e!==a.width);if(l){RTE.SnapshotManager.setCurrentRegionDirty();RTE.Canvas.sendApplicationStateChangedEvent()}}RTE.CanvasEvents.waitAndSetImageSize()};RTE.CanvasEvents.waitAndSetImageSize=function(){ULSdmo:;RTE.CanvasEvents.$5n>0&&window.clearTimeout(RTE.CanvasEvents.$5n);RTE.CanvasEvents.$5n=window.setTimeout(RTE.CanvasEvents.$AD,100)};RTE.CanvasEvents.setImageSize=function(){ULSdmo:;var a=RTE.Cursor.getSelectedImage();if(!a)return;if(a.complete||a.readyState==="complete"){var b=a.height,c=a.width,d=RTE.RteUtility.getAttribute(a,"setHeight"),e=RTE.RteUtility.getAttribute(a,"setWidth"),f=RTE.RteUtility.getAttribute(a,"hasHeight");a.setAttribute("setHeight",b);a.setAttribute("setWidth",c);a.setAttribute("hasHeight",!RTE.SU.isNullOrEmptyString(a.style.height));var g=a.getAttribute("setHeight")!==d||a.getAttribute("setWidth")!==e||a.getAttribute("hasHeight")!==f;g&&RTE.Canvas.sendApplicationStateChangedEvent()}else{RTE.CanvasEvents.waitAndSetImageSize();return}RTE.SnapshotManager.$1N(RTE.Canvas.currentEditableRegion())&&RTE.SnapshotManager.takeSnapshotIfNotInPreview()};RTE.CanvasEvents.onAtomicSelected=function(c,b){ULSdmo:;var a=b.newAtomic;$addHandler(a,"resizestart",RTE.CanvasEvents.$64)};RTE.CanvasEvents.onAtomicDeselected=function(c,b){ULSdmo:;var a=b.oldAtomic;if(a.parentNode&&a.parentNode.parentNode)try{$removeHandler(a,"resizestart",RTE.CanvasEvents.$64)}catch(d){}};RTE.CanvasEvents.onAtomicResize=function(a){ULSdmo:;a.preventDefault();a.rawEvent.returnValue=false;a.rawEvent.cancelBubble=true;a.stopPropagation()};RTE.CanvasRange=function(a){ULSdmo:;this.$$d_$Dm_0=Function.createDelegate(this,this.$Dm_0);this.$1_0=document.createElement("SPAN");this.$2_0=document.createElement("SPAN");this.$1_0.id="ms-rterange"+a+"-start";this.$2_0.id="ms-rterange"+a+"-end"};RTE.CanvasRange.$9t=function(b){ULSdmo:;var a;while(null!==(a=$get(b)))RTE.RteUtility.removeNodeAndKeepChildNodes(a)};RTE.CanvasRange.$AG=function(b){ULSdmo:;if(RTE.RteUtility.isBlockNode(b))return true;if(b.nodeType===1){var a=b.tagName;return a==="SPAN"||a==="STRONG"||a==="B"||a==="I"||a==="U"||a==="EM"||a==="CENTER"||a==="FONT"||a==="S"||a==="STRIKE"||a==="SUB"||a==="SUP"}return false};RTE.CanvasRange.$6G=function(b){ULSdmo:;var a=null;if(b)a=b===b.ownerDocument.body?new Array(0):RTE.CanvasRange.$6G(b.parentNode);if(a)a[a.length]=b;return a};RTE.CanvasRange.$9F=function(a){ULSdmo:;var b=a.offsetTop,f=a.offsetHeight,c=a.offsetParent;a=a.parentNode;while(a!==document.documentElement){if(a===c)b+=a.offsetTop;if(a.scrollHeight!==a.clientHeight){var e=b-a.offsetTop-a.scrollTop;if(a.scrollHeight!==a.clientHeight){if(a.scrollTop>0&&e<0)if(RTE.RteUtility.$9L(a))return-1;if(a.clientHeight>0&&e>Math.max(0,a.clientHeight-f))if(RTE.RteUtility.$9L(a))return 1}}b-=a.scrollTop;c=a.offsetParent;a=a.parentNode}var d=document.documentElement.scrollTop,g=RTE.RteUtility.getViewPortHeight(window.self);return b<d?-1:b>g+d?1:0};RTE.CanvasRange.prototype={$4d_0:null,$4e_0:false,$x_0:null,$3b_0:false,$91_0:function(){ULSdmo:;if(!this.$x_0)this.$x_0=RTE.Range.createRange()},resetCacheRange:function(){ULSdmo:;this.$3b_0=false;this.$4e_0=false;this.$4g_0=false;this.$4c_0=false},duplicate:function(b){ULSdmo:;var a=new RTE.CanvasRange(b);a.moveToMarkersCollection(this.getMarkers());return a},normalize:function(){ULSdmo:;if(!this.isValid())return;var a=new RTE.DOMTreePosition(this.$1_0,0);a.setLocationAtEnd();a.moveCount(false,0);a.insertMarker(this.$1_0);var b=new RTE.DOMTreePosition(this.$2_0,0);b.moveCount(true,0);b.insertMarker(this.$2_0);this.fixMarkers();this.resetCacheRange()},moveToRange:function(e){ULSdmo:;RTE.RteUtility.assertNotNull("range",e);var b=document.createElement("SPAN"),a=document.createElement("SPAN");a.id="ms-rterangenew-start";b.id="ms-rterangenew-end";var i=true,j=true,c=null,d=null;try{var p=e.$5_0.item;if(p){var m=e.$5_0.item(0);RTE.RteUtility.insertBefore(a,m);RTE.RteUtility.insertAfter(b,m)}else{var h=e.$5_0.startContainer;if(!h)h=e.$5_0.parentElement();if(!h||window.document!==h.ownerDocument)return false;var n=e.duplicate(),o=e.duplicate();n.collapse(false);i=n.$95_0(b,true,RTE.Cursor.$3r);o.collapse(true);j=o.$95_0(a,false,RTE.Cursor.$3r)}c=RTE.Canvas.getEditableRegion(a);if(!c){var k=new RTE.DOMTreePosition(a,0);k.normalizeRight();if(k.$0_0!==a){k.insertMarker(a);c=RTE.Canvas.getEditableRegion(a)}if(!c&&a.nextSibling)c=RTE.Canvas.getEditableRegion(a.nextSibling);c&&c.insertBefore(a,c.firstChild)}d=RTE.Canvas.getEditableRegion(b);if(!d){var l=new RTE.DOMTreePosition(b,0);l.normalizeLeft();if(l.$0_0!==b){l.insertMarker(b);d=RTE.Canvas.getEditableRegion(b)}if(!d&&b.previousSibling)d=RTE.Canvas.getEditableRegion(b.previousSibling);d&&d.appendChild(b)}}catch(r){i=false;j=false}var f=b.parentNode,g=a.parentNode;if(i&&j&&c&&d){RTE.RteUtility.$3T(this.$1_0);RTE.RteUtility.$4Q(this.$2_0);RTE.RteUtility.assertNotNull("endMarkerLoc.ParentNode",f);RTE.RteUtility.assertNotNull("startMarkerLoc.ParentNode",g);b.nextSibling===a&&RTE.RteUtility.insertBefore(a,b);f.replaceChild(this.$2_0,b);g.replaceChild(this.$1_0,a);this.$83_0();this.resetCacheRange();this.$5P_0(this.$2_0);this.$5P_0(this.$1_0);this.$8N_0();return true}else{var q=RTE.Canvas.moveToRedirectIfItExist(a);f&&f.removeChild(b);g&&g.removeChild(a);return q}},makeSafe:function(){ULSdmo:;this.fixMarkers();var c=this.parentElement(),a=new RTE.DOMTreePosition(this.$1_0,0);a.setLocationAtEnd();a.moveToNextElement();while(true){var b=a.$0_0;a.setLocationAtEnd();a.moveToNextElement();if(RTE.RteUtility.$M(this.$2_0,b,c)){RTE.HtmlCleanup.$A0(b,true,true,false);break}else RTE.HtmlCleanup.$A0(b,true,true,false)}this.resetCacheRange()},$83_0:function(){ULSdmo:;if(RTE.CanvasRange.$4l)return;var a=this.$1_0.id,b=this.$2_0.id;this.$1_0.id="";this.$2_0.id="";RTE.CanvasRange.$9t(a);RTE.CanvasRange.$9t(b);this.$1_0.id=a;this.$2_0.id=b;RTE.RteUtility.$3T(this.$1_0);RTE.RteUtility.$4Q(this.$2_0)},$1A_0:function(){ULSdmo:;if(!this.$3b_0){this.$91_0();this.$8N_0();var a=this.isEmpty();if(this.get_$5D_0()){if(!a){this.$x_0.$5_0.setStartAfter(this.$1_0);this.$x_0.$5_0.setEndBefore(this.$2_0)}else{this.$x_0.$5_0.setEndAfter(this.$2_0);this.$x_0.$5_0.setStartAfter(this.$2_0);this.$x_0.collapse(true)}this.$3b_0=true}else{this.$x_0.moveToMarkers(this.$1_0,this.$2_0,this.isEmpty());this.$3b_0=true}}return this.$x_0},get_$5D_0:function(){ULSdmo:;this.$91_0();return!!this.$x_0.$5_0.setEndBefore},$8N_0:function(){ULSdmo:;var a=this.$2_0.parentNode;if(a.tagName==="LI"){var e=a.lastChild;if(a.childNodes.length===3){for(var b=null,d=0;d<a.childNodes.length;d++){var c=a.childNodes[d];if(c===this.$1_0||c===this.$2_0)continue;if(!b&&c.nodeType===1&&c.tagName==="BR"){b=c;continue}b=null;break}b&&a.removeChild(b)}}},getMarkers:function(){ULSdmo:;var a=[];a[0]=this.$1_0;a[1]=this.$2_0;return a},get_endMarker:function(){ULSdmo:;return this.$2_0},get_startMarker:function(){ULSdmo:;return this.$1_0},setMarkersCollection:function(a){ULSdmo:;RTE.RteUtility.assertNotNull("markers",a);a.length===2&&this.setMarkers(a[0],a[1])},setMarkers:function(a,b){ULSdmo:;this.$1_0!==a&&RTE.RteUtility.removeNode(this.$1_0);this.$2_0!==b&&RTE.RteUtility.removeNode(this.$2_0);this.$1_0=a;this.$2_0=b;this.$83_0();this.resetCacheRange()},moveToMarkersCollection:function(a){ULSdmo:;RTE.RteUtility.assertNotNull("markers",a);a.length===2&&this.moveToMarkers(a[0],a[1])},moveToMarkers:function(a,b){ULSdmo:;RTE.RteUtility.insertBefore(this.$1_0,a);RTE.RteUtility.insertBefore(this.$2_0,b);this.resetCacheRange()},$1v_0:null,$2L_0:null,isValid:function(){ULSdmo:;var a=this.$1_0.parentNode,b=this.$2_0.parentNode;return!!a&&!!b&&a.nodeType!==11&&b.nodeType!==11&&a!==RTE.CanvasRange.$1B&&b!==RTE.CanvasRange.$1B},$8M_0:function(){ULSdmo:;this.$1v_0=[];this.$2L_0=[];if(!this.isValid())return;var a=this.$1_0;if(a.nextSibling&&a.nextSibling.firstChild&&RTE.Canvas.isEditable(a.nextSibling)){a=a.nextSibling;while(a.firstChild&&!RTE.RteUtility.isTextNode(a.firstChild))a=a.firstChild}while(a&&!RTE.Canvas.$6n(a)){this.$1v_0.push(a);a=a.parentNode}a&&this.$1v_0.push(a);var b=this.$2_0;if(b.previousSibling&&b.previousSibling.lastChild&&RTE.Canvas.isEditable(b.previousSibling)){b=b.previousSibling;while(b.lastChild&&!RTE.RteUtility.isTextNode(b.lastChild))b=b.lastChild}while(b&&!RTE.Canvas.$6n(b)){this.$2L_0.push(b);b=b.parentNode}b&&this.$2L_0.push(b)},parentElement:function(){ULSdmo:;var a=this.getParentChain();return a.length>0?a[0]:null},fixMarkers:function(){ULSdmo:;this.$8M_0();if(!this.$1v_0.length)return;var a=null,c=null;while(this.$1v_0.length>0){a=this.$1v_0.pop();c=this.$2L_0.pop();if(a!==c)break}for(var e=a.parentNode,f=false,d=0;d<e.childNodes.length;d++){var g=e.childNodes[d];if(f&&g===a){var b=document.createElement("SPAN");RTE.RteUtility.insertBefore(b,this.$1_0);RTE.RteUtility.insertBefore(this.$1_0,this.$2_0);RTE.RteUtility.insertBefore(this.$2_0,b);b.parentNode.removeChild(b);return}else if(g===c)f=true}},inRange:function(b){ULSdmo:;var a=this.$1A_0();return a.inRange(b)},inCanvasRange:function(a){ULSdmo:;RTE.RteUtility.assertNotNull("r",a);var b=a.$1A_0();return this.inRange(b)},collapse:function(a){ULSdmo:;if(a)RTE.RteUtility.insertAfter(this.$2_0,this.$1_0);else RTE.RteUtility.insertBefore(this.$1_0,this.$2_0);this.resetCacheRange()},get_text:function(){ULSdmo:;var a=this.$1A_0();return a.get_innerText()},wrapRange:function(e){ULSdmo:;var d=this.parentElement(),a=this.$1_0;while(a&&a.parentNode!==d)a=a.parentNode;if(!a){while(this.$1_0.parentNode!==d)d=d.parentNode;a=this.$1_0}var b=null,c=null;if(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(551)){b=this.$1_0.parentNode;c=this.$2_0.parentNode}var f=new RTE.ExtractChildNodesProcessor(d,this.$1_0,this.$2_0,e,false);f.process();RTE.RteUtility.insertAfter(e,a);RTE.RteUtility.insertBefore(this.$1_0,e);RTE.RteUtility.insertAfter(this.$2_0,e);if(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(551)){while(b&&b!==a.parentNode&&!RTE.RteUtility.getRealFirstChild(b,true)){var g=b;b=b.parentNode;RTE.RteUtility.removeNode(g)}while(c&&c!==a.parentNode&&!RTE.RteUtility.getRealFirstChild(c,true)){var h=c;c=c.parentNode;RTE.RteUtility.removeNode(h)}}},getEditableRegion:function(){ULSdmo:;var a=this.parentElement();return RTE.Canvas.getEditableRegion(a)},getNonEditableRegion:function(){ULSdmo:;var a=this.parentElement();return RTE.Canvas.getNonEditableRegion(a)},get_isInEditableRegion:function(){ULSdmo:;var a=this.getEditableRegion();return!!a},get_isInNonEditableRegion:function(){ULSdmo:;var a=this.getNonEditableRegion();return!!a},get_isEditableRegion:function(){ULSdmo:;var a=this.parentElement();return RTE.Canvas.$S(a)?!this.$1_0.previousSibling&&this.$1_0.parentNode===a&&!this.$2_0.nextSibling&&this.$2_0.parentNode===a:false},get_isNonEditableRegion:function(){ULSdmo:;var a=this.parentElement();if(RTE.Canvas.$t(a)){var b=RTE.Range.createRange();b.moveToElementText(a);return this.inRange(b)}return false},get_isEditable:function(){ULSdmo:;var a=this.parentElement();if(a&&a.previousSibling===this.$1_0&&a.nextSibling===this.$2_0)a=a.parentNode;return RTE.Canvas.isEditable(a)},expandInNonEditableRegion:function(){ULSdmo:;if(this.get_isInEditableRegion()&&!RTE.Canvas.isEditable(this.parentElement())){var a=this.getNonEditableRegion();this.moveToNode(a);return a}return null},getParentBlockNode:function(){ULSdmo:;var a=this.parentElement();while(a&&!RTE.RteUtility.isBlockNode(a))a=a.parentNode;return a},expandToBlock:function(){ULSdmo:;var a=this.getParentBlockNode();a&&this.moveToNode(a)},$BA_0:function(){ULSdmo:;var b=new RTE.DOMTreePosition(this.$1_0,0),d=null,c=this.$1_0;while(b.moveToPreviousElement()&&b.atStart()&&!RTE.Canvas.$S(b.$0_0)&&c.parentNode===b.$0_0){if(!RTE.RteUtility.isNodeOfType(b.$0_0,RTE.CanvasRange.$7M))d=b.$0_0;c=b.$0_0}d&&RTE.RteUtility.insertBefore(this.$1_0,d);var a=new RTE.DOMTreePosition(this.$2_0,0);a.setLocationAtEnd();var e=null;c=this.$2_0;while(a.moveToNextElement()&&a.atEnd()&&!RTE.Canvas.$S(a.$0_0)&&c.parentNode===a.$0_0){if(!RTE.RteUtility.isNodeOfType(a.$0_0,RTE.CanvasRange.$7M))e=a.$0_0;c=a.$0_0}e&&RTE.RteUtility.insertAfter(this.$2_0,e);this.resetCacheRange()},moveToNode:function(a){ULSdmo:;if(RTE.RteUtility.isNodeOfType(a,RTE.CanvasRange.$5c))this.moveToChildren(a);else{RTE.RteUtility.insertBefore(this.$1_0,a);RTE.RteUtility.insertAfter(this.$2_0,a)}this.resetCacheRange();return true},moveToChildren:function(a){ULSdmo:;RTE.RteUtility.assertNotNull("node",a);if(a.tagName==="TR"||a.tagName==="TBODY"||a.tagName==="TABLE"){var b=a;while(b&&b.tagName!=="TD"&&b.tagName!=="TH")b=RTE.RteUtility.getRealFirstChild(b,true);var c=a;while(c&&c.tagName!=="TD"&&c.tagName!=="TH")c=RTE.RteUtility.getRealLastChild(c,true);if(b&&c){if(RTE.RteUtility.$1t!==b.innerHTML)b.insertBefore(this.$1_0,RTE.RteUtility.getRealFirstChild(b,true));else b.appendChild(this.$1_0);c.appendChild(this.$2_0)}}else{var d=RTE.Canvas.getEditableRegion(a);if(d===a&&RTE.Canvas.$3q(d)&&RTE.Canvas.isMultiline(d)){var e=d.ownerDocument.createElement("P");a.appendChild(e);return this.moveToStartOfNode(e)}a.insertBefore(this.$1_0,RTE.RteUtility.getRealFirstChild(a,false));a.appendChild(this.$2_0)}this.resetCacheRange();return true},moveToStartOfNode:function(a){ULSdmo:;this.$3k_0();RTE.RteUtility.assertNotNull("node",a);try{if(RTE.Canvas.$t(a)){var e=this.moveToNode(a);RTE.Canvas.$4K(a);return e}var c=RTE.RteUtility.getRealFirstChild(a,true);if(c&&RTE.CanvasRange.$AG(c))return this.moveToStartOfNode(c);var b=RTE.Canvas.getEditableRegion(a);if(b===a&&!b.firstChild&&RTE.Canvas.isMultiline(b)){var d=RTE.RteUtility.$3g(b.ownerDocument);b.appendChild(d);return this.moveToStartOfNode(d)}a.insertBefore(this.$2_0,a.firstChild);RTE.RteUtility.insertBefore(this.$1_0,this.$2_0);this.resetCacheRange()}catch(f){}return true},$CY_0:function(b){ULSdmo:;var c=null;if(b.firstChild){var a=new RTE.DOMTreePosition(b.firstChild,0);while(a.$0_0!==b){if(RTE.Canvas.$t(a.$0_0))c=a.$0_0;else if(RTE.RteUtility.isTextNode(a.$0_0)&&!RTE.SU.isNullOrEmptyString(a.$0_0.nodeValue)||a.$0_0.tagName==="A"&&a.$0_0.innerHTML!==""||a.$0_0.tagName==="IMG"){c=a.$0_0;break}if(!a.moveToNextElement())break}}if(c)RTE.RteUtility.insertBefore(this.$2_0,c);else if(!b.firstChild)b.appendChild(this.$2_0);else RTE.RteUtility.insertBefore(this.$2_0,b.firstChild);RTE.RteUtility.insertBefore(this.$1_0,this.$2_0);this.resetCacheRange()},moveToEndOfNode:function(a){ULSdmo:;this.$3k_0();RTE.RteUtility.assertNotNull("node",a);if(RTE.Canvas.$t(a)){var e=this.moveToNode(a);RTE.Canvas.$4K(a);return e}var b=RTE.RteUtility.getRealLastChild(a,true);if(b&&RTE.CanvasRange.$AG(b))return this.moveToEndOfNode(b);if(a.tagName==="P")if(a.innerHTML==="&nbsp;"){a.insertBefore(this.$2_0,a.firstChild);a.insertBefore(this.$1_0,this.$2_0)}else if(b&&b.tagName==="BR"){a.insertBefore(this.$2_0,b);a.insertBefore(this.$1_0,this.$2_0)}else{a.appendChild(this.$1_0);a.appendChild(this.$2_0)}else{var c=RTE.Canvas.getEditableRegion(a);if(c===a&&!c.firstChild&&RTE.Canvas.isMultiline(c)){var d=RTE.RteUtility.$3g(c.ownerDocument);c.appendChild(d);return this.moveToStartOfNode(d)}a.appendChild(this.$1_0);a.appendChild(this.$2_0)}this.resetCacheRange();return true},moveToMarkersPlaceholders:function(a,d){ULSdmo:;var e=false;if(a&&a.ownerDocument){var b=a.ownerDocument.getElementById(d+"-start"),c=a.ownerDocument.getElementById(d+"-end");if(b&&c){RTE.RteUtility.insertAfter(this.$1_0,b);RTE.RteUtility.insertAfter(this.$2_0,c);this.$5P_0(this.$2_0);this.$5P_0(this.$1_0);this.resetCacheRange();e=true}this.$9w_0(b);this.$9w_0(c);this.$Dy_0()}return e?true:this.moveToEndOfNode(a)},$9w_0:function(b){ULSdmo:;if(b){var a=b.parentNode;RTE.RteUtility.removeNode(b);RTE.SU.isNullOrEmptyString(a.tagName)&&!a.childNodes.length&&RTE.RteUtility.removeNode(a)}},$5P_0:function(a){ULSdmo:;while(a&&a.parentNode){var b=a.parentNode,c=null;do{c=b.tagName;b=b.parentNode}while(b&&RTE.SU.isNullOrEmptyString(c));switch(c){case"TABLE":case"TBODY":case"THEAD":case"TR":this.$9U_0(a,["TD","TH"],"TABLE");break;case"OL":case"UL":this.$9U_0(a,["LI"],c);break;default:return}}},$Dy_0:function(){ULSdmo:;if(this.$1_0.parentNode!==this.$2_0.parentNode){var b=this.$2_0.parentNode;if(b.tagName==="TD"||b.tagName==="TH")if(b.firstChild===this.$2_0){var a=RTE.RteUtility.$9o(b);if(!a){var c=RTE.RteUtility.$9o(b.parentNode);if(c)a=c.children[c.children.length-1]}a&&a.nodeType===1&&(a.tagName==="TD"||a.tagName==="TH")&&a.insertBefore(this.$2_0,null)}}},$9U_0:function(b,d,e){ULSdmo:;var c=RTE.RteUtility.getNearestParentElementOfType(b,e),a=new RTE.DOMTreePosition(b,0);while(a.moveToNextElement()){if(RTE.RteUtility.isNodeOfType(a.$0_0,d)){a.$0_0.insertBefore(b,a.$0_0.firstChild);return}if(a.$0_0===c&&a.atEnd()){RTE.RteUtility.insertAfter(b,c);return}}},moveBeforeNode:function(a){ULSdmo:;this.$3k_0();var c=RTE.RteUtility.getRealPreviousSibling(a,true);if(c&&RTE.RteUtility.isBlockNode(c))return this.moveToEndOfNode(c);if(RTE.RteUtility.isNodeOfType(a,RTE.CanvasRange.$5c))return this.moveBeforeNode(a.parentNode);var b=RTE.Canvas.getEditableRegion(a);if(b&&b.firstChild===a&&RTE.Canvas.isMultiline(b)){var d=RTE.RteUtility.$3g(b.ownerDocument);RTE.RteUtility.insertBefore(d,a);return this.moveToStartOfNode(d)}RTE.RteUtility.insertBefore(this.$2_0,a);RTE.RteUtility.insertBefore(this.$1_0,this.$2_0);this.resetCacheRange();return true},moveAfterNode:function(a){ULSdmo:;this.$3k_0();var c=RTE.RteUtility.getRealNextSibling(a,true);if(c&&RTE.RteUtility.isBlockNode(c))return this.moveToStartOfNode(c);if(RTE.RteUtility.isNodeOfType(a,RTE.CanvasRange.$5c))return this.moveAfterNode(a.parentNode);var b=RTE.Canvas.getEditableRegion(a);if(b&&b.lastChild===a&&RTE.Canvas.isMultiline(b)){var d=RTE.RteUtility.$3g(b.ownerDocument);RTE.RteUtility.insertAfter(d,a);return this.moveToStartOfNode(d)}RTE.RteUtility.insertAfter(this.$2_0,a);RTE.RteUtility.insertBefore(this.$1_0,this.$2_0);this.resetCacheRange();return true},$3k_0:function(){ULSdmo:;this.$1_0.parentNode&&this.$1_0.parentNode.removeChild(this.$1_0);this.$2_0.parentNode&&this.$2_0.parentNode.removeChild(this.$2_0)},dispose:function(){ULSdmo:;RTE.RteUtility.removeNode(this.$1_0);RTE.RteUtility.removeNode(this.$2_0)},clear:function(){ULSdmo:;return this.$4k_0()},$4k_0:function(){ULSdmo:;if(!RTE.Canvas.currentEditableRegion()||!RTE.Canvas.getIgnoreClear()){RTE.RteUtility.$3T(this.$1_0);RTE.RteUtility.$4Q(this.$2_0);if(RTE.RteUtility.isFirefox()){if(RTE.SU.isNullOrUndefined(RTE.CanvasRange.$1B)){RTE.CanvasRange.$1B=document.createElement("DIV");RTE.CanvasRange.$1B.style.display="none";document.body.appendChild(RTE.CanvasRange.$1B)}RTE.CanvasRange.$1B.appendChild(this.$1_0);RTE.CanvasRange.$1B.appendChild(this.$2_0)}else this.$3k_0();this.resetCacheRange()}return true},selectAll:function(){ULSdmo:;return this.$BB_0()},$BB_0:function(){ULSdmo:;var a=this.getEditableRegion();return a?this.moveToChildren(a):false},isVisible:function(){ULSdmo:;return!this.isEmpty()},insertNode:function(a){ULSdmo:;RTE.RteUtility.$94(a,this.$2_0);this.resetCacheRange()},insertBefore:function(a){ULSdmo:;RTE.RteUtility.$94(a,this.$1_0);this.resetCacheRange()},insertAfter:function(a){ULSdmo:;RTE.RteUtility.$56(a,this.$2_0);this.resetCacheRange()},insertText:function(a){ULSdmo:;RTE.DomHelper.insertAdjacentText(this.$2_0,"beforeBegin",a);this.resetCacheRange()},insertTextBefore:function(a){ULSdmo:;RTE.DomHelper.insertAdjacentText(this.$1_0,"beforeBegin",a);this.resetCacheRange()},isEmpty:function(){ULSdmo:;var a=this.$1_0.nextSibling;while(a&&a!==this.$2_0&&(a.nodeValue===""||a.tagName==="SPAN"&&!a.childNodes.length))a=a.nextSibling;return a===this.$2_0},deleteContent:function(){ULSdmo:;if(this.get_isEditable()&&!this.isEmpty()&&this.canDeleteContent()){var i=this.get_isEditableRegion(),e=this.getEditableRegion();RTE.AtomicManager.$7a();var f=false;if(i){RTE.AtomicManager.$4m(e);f=true;e.innerHTML="";this.moveToChildren(e)}else{var h=RTE.CanvasRange.$6G(this.$1_0),g=RTE.CanvasRange.$6G(this.$2_0),c=h.length-1;RTE.RteUtility.assertNotNull("DeleteContent: startMarker parent chain is null",h);RTE.RteUtility.assertNotNull("DeleteContent: endMarker parent chain is null",g);var a=this.$1_0.nextSibling,d=this.$1_0.parentNode;while(a!==this.$2_0){while(!a||c+1<g.length&&a===g[c]){if(a){c++;d=a;a=a.firstChild}else{c--;a=d.nextSibling;d=d.parentNode}if(c<0)return}d=a.parentNode;if(a!==this.$2_0){var b=a;a=a.nextSibling;RTE.AtomicManager.$4m(b);f=true;if(b.nodeType===1&&!Sys.UI.DomElement.containsCssClass(b,"ms-rtestate-read"))if(typeof b.innerHTML!=="undefined")try{b.innerHTML=""}catch(j){}b.parentNode.removeChild(b)}}RTE.RteUtility.assertNotNull("DeleteContent: Last element is null",a)}f&&RTE.AtomicManager.$4C()}},canDeleteContent:function(){ULSdmo:;if(!this.isValid())return false;this.fixMarkers();var c=this.parentElement(),a=new RTE.DOMTreePosition(this.$1_0,0);a.setLocationAtEnd();while(a.$0_0!==this.$2_0){var b=a.$0_0.tagName;if(b==="TABLE"){if(RTE.RteUtility.$M(this.$2_0,a.$0_0,c))return false;a.setLocationAtEnd()}else if(b==="TD"||b==="TH"||b==="TR")return false;if(!a.moveToNextElement())return true}return true},getInnerNodes:function(a){ULSdmo:;return this.$8i_0(false,a)},$2k_0:null,$4g_0:false,getSingleElement:function(){ULSdmo:;if(this.$4g_0)return this.$2k_0;this.$4g_0=true;var c=this.parentElement(),a=new RTE.DOMTreePosition(this.$1_0,0);a.setLocationAtEnd();a.moveToNextElement();while(a.atEnd()&&!a.atStart())if(!a.moveToNextElement()){this.$2k_0=null;return null}this.$9V_0(a);var b=a.$0_0;if(RTE.RteUtility.$M(this.$2_0,b,c)){this.$2k_0=b;return b}a.setLocationAtEnd();a.moveToNextElement();this.$9V_0(a);while(a.atStart()){if(a.$0_0===this.$2_0){this.$2k_0=b;return b}if(!a.moveToNextElement()){this.$2k_0=null;return null}}this.$2k_0=null;return null},$9V_0:function(b){ULSdmo:;var a=b.$0_0;if(RTE.RteUtility.isTextNode(a)&&a.nodeValue===RTE.RteUtility.$1t){b.moveToNextElement();a=b.$0_0}},getReducedInnerNodes:function(a){ULSdmo:;return this.$8i_0(true,a)},$CS_0:function(f,g,d,e){ULSdmo:;g&&this.$BA_0();var c=this.getEditableRegion();if(this.$1_0.parentNode===this.$2_0.parentNode&&!RTE.RteUtility.getRealPreviousSibling(this.$1_0,false)&&!RTE.RteUtility.getRealNextSibling(this.$2_0,false)&&!RTE.Canvas.$S(this.$1_0.parentNode))if(!d(this.$1_0.parentNode,e))return;var b=new RTE.DOMTreePosition(this.$1_0,0);b.setLocationAtEnd();b.moveToNextElement();b.$55_0=false;while(b.$0_0!==this.$2_0){var a=b.$0_0;if(f)if(a.nextSibling&&RTE.RteUtility.isTextNode(a)&&RTE.RteUtility.isTextNode(a.nextSibling)){b.moveToNextElement();RTE.RteUtility.$CW(a,a.nextSibling,false);continue}if(b.atStart()&&(RTE.RteUtility.isTextNode(a)||a.nodeType===1&&!RTE.RteUtility.$M(this.$1_0,a,c)&&!RTE.RteUtility.$M(this.$2_0,a,c)&&!RTE.RteUtility.$i(a)))if(!d(b.$0_0,e))return;b.moveToNextElement()}},$Dm_0:function(a,b){ULSdmo:;Array.add(b.nodes,a);return true},$8i_0:function(b,c){ULSdmo:;if(!this.isValid())return[];var a={};a.nodes=[];this.$CS_0(b,c,this.$$d_$Dm_0,a);return a.nodes},onlyContainTextNodes:function(){ULSdmo:;var a=new RTE.DOMTreePosition(this.$1_0,0);a.setLocationAtEnd();while(a.$0_0!==this.$2_0){if(!RTE.RteUtility.isTextNode(a.$0_0)&&!RTE.RteUtility.$i(a.$0_0))return false;a.moveToNextElement()}return true},getParentChain:function(){ULSdmo:;if(!this.$4e_0){this.$B3_0();this.$4e_0=true}return this.$4d_0},$B3_0:function(){ULSdmo:;this.$4d_0=[];var e=[],a=0;this.$8M_0();var d=false;while(this.$1v_0.length>0&&this.$2L_0.length>0){var b=this.$1v_0.pop(),f=this.$2L_0.pop();if(b===f){if(RTE.Canvas.$S(b))d=true;if(d){e[a]=b;a++}if(RTE.Canvas.$t(b))d=false}else break}a--;for(var c=0;c<=a;c++){var g=e[a-c];this.$4d_0[c]=g}},replaceWithChildren:function(a){ULSdmo:;this.deleteContent();var b=RTE.RteUtility.$3n(a);if(!!(b^RTE.RteUtility.isBlockNode(a))){var c=document.createElement(b?"DIV":"SPAN");RTE.RteUtility.moveChildNodes(a,c);RTE.RteUtility.removeNode(a);a=c}this.insertNode(a);RTE.Canvas.dispatchAddedEventsChildElements(a);RTE.RteUtility.removeNodeAndKeepChildNodes(a)},replaceHtml:function(b){ULSdmo:;var a=document.createElement("SPAN");RTE.RteUtility.$2j(a,b);this.replaceWithChildren(a)},convertToText:function(){ULSdmo:;var a=this.get_text();this.deleteContent();this.insertText(a)},convertToStrip:function(){ULSdmo:;var a=RTE.RemoveStyleOnSelectionProcessor.$1S;a.setSettings(this,true);a.process()},getFirstTextNode:function(){ULSdmo:;var a=new RTE.DOMTreePosition(this.$1_0,0);a.setLocationAtEnd();var b=null;while(a.moveToNextElement()&&a.$0_0!==this.$2_0)if(RTE.Canvas.$t(a.$0_0))a.setLocationAtEnd();else if(RTE.RteUtility.isTextNode(a.$0_0)){if(!RTE.RteUtility.isEmptyTextNode(a.$0_0,true))return a.$0_0;b=a.$0_0}return b},$6M_0:null,$4c_0:false,getCurrentStateNode:function(){ULSdmo:;if(this.$4c_0)return this.$6M_0;this.$4c_0=true;var a=this.getFirstTextNode();if(!a)a=this.$1_0;this.$6M_0=a;return a},$DP_0:function(){ULSdmo:;if(!this.$1_0||!this.$1_0.parentNode||this.$1_0.parentNode===RTE.CanvasRange.$1B||!this.$2_0||!this.$2_0.parentNode||this.$2_0.parentNode===RTE.CanvasRange.$1B)return;var b=RTE.Canvas.getEditableRegion(this.$1_0);if(!b||!RTE.Canvas.getCachedRestriction(b,"AllowMultiLines",true))return;var c=this.$x_0||RTE.Range.createRange();if(c.$5_0.select)return;var a=RTE.CanvasRange.$9F(this.$1_0),d=RTE.CanvasRange.$9F(this.$2_0);if(a&&a===d)if(a===-1)this.$1_0.scrollIntoView(true);else this.$2_0.scrollIntoView(false)}};RTE.QuickRange=function(a,b,c,d,e){ULSdmo:;this.$g_0=a;this.$1u_0=b;this.$R_0=c;this.$1K_0=d;this.$4q_0=e};RTE.QuickRange.$39=function(){ULSdmo:;var b,d=-1,c,e=-1,a=RTE.Selection.getSelectionRange();if(a&&a.$5_0&&a.$5_0.startContainer){b=a.$5_0.startContainer;d=a.$5_0.startOffset;c=a.$5_0.endContainer;e=a.$5_0.endOffset}else{var g=RTE.Cursor.get_range();b=g.$1_0;c=g.$2_0}if(!b||!c)return null;var f=RTE.Canvas.getEditableRegion(b);return!f?null:new RTE.QuickRange(b,d,c,e,f)};RTE.QuickRange.$9M=function(a){ULSdmo:;return a===RTE.Cursor.s_range.$1_0||a===RTE.Cursor.s_range.$2_0||RTE.RteUtility.isEmptyTextNode(a,true)};RTE.QuickRange.$A4=function(a,b){ULSdmo:;return a.nodeType!==1||b<0||!a.childNodes.length?a:a.childNodes.length<=b?a.lastChild:a.childNodes[b]};RTE.QuickRange.prototype={$g_0:null,$1u_0:0,$R_0:null,$1K_0:0,$4q_0:null,get_$3D_0:function(){ULSdmo:;return RTE.Canvas.isEditable(this.$g_0)&&RTE.Canvas.isEditable(this.$R_0)},get_$3q_0:function(){ULSdmo:;var a=this.get_$7F_0(),b=this.get_$7E_0();return a===b||a===b.previousSibling},get_$7F_0:function(){ULSdmo:;return RTE.QuickRange.$A4(this.$g_0,this.$1u_0)},get_$AK_0:function(){ULSdmo:;if(this.$g_0.nodeType===1&&this.$g_0===this.$R_0&&this.$1u_0>=0&&this.$1u_0===this.$1K_0-1)return this.get_$7F_0();if(RTE.RteUtility.$i(this.$g_0)&&RTE.RteUtility.$i(this.$R_0)&&this.$g_0.parentNode===this.$R_0.parentNode){var a=this.$g_0.nextSibling;if(a&&a===this.$R_0.previousSibling)return a}return null},get_$7E_0:function(){ULSdmo:;return RTE.QuickRange.$A4(this.$R_0,this.$1K_0)},get_$CM_0:function(){ULSdmo:;if(this.$1u_0<=0)return true;if(this.$g_0.nodeType===1){for(var a=this.$1u_0-1;a>=0;a--){var b=this.$g_0.childNodes[a];if(!RTE.QuickRange.$9M(b))return false}return true}if(this.$g_0.nodeType===3)if(this.$1u_0===1&&this.$g_0.nodeValue.length<=1&&RTE.RteUtility.isEmptyTextNode(this.$g_0,true))return true;return false},get_$9H_0:function(){ULSdmo:;if(this.$1K_0===-1)return true;if(this.$R_0.nodeType===1){var c=this.$R_0.childNodes.length;if(this.$1K_0===c)return true;for(var d=RTE.RteUtility.isBlockNode(this.$R_0),e=RTE.RteUtility.getRealLastChild(this.$R_0,false),b=this.$1K_0;b<c;b++){var a=this.$R_0.childNodes[b];if(d&&e===a&&a.nodeType===1&&a.tagName==="BR")return true;if(!RTE.QuickRange.$9M(a))return false}return true}if(this.$R_0.nodeType===3){if(this.$1K_0>=this.$R_0.nodeValue.length)return true;if(this.$1K_0+1===this.$R_0.nodeValue.length&&RTE.RteUtility.isEmptyString(this.$R_0.nodeValue.substr(this.$R_0.nodeValue.length-1),true))return true}return false}};RTE.Cursor=function(){};RTE.Cursor.cursorRangeIsNowOutdated=function(){ULSdmo:;RTE.Cursor.$1T=true};RTE.Cursor.get_isRangeOutdatedFromCurrentSelection=function(){ULSdmo:;return RTE.Cursor.$1T};RTE.Cursor.get_range=function(){ULSdmo:;RTE.Cursor.$1T&&!RTE.Cursor.$2R&&RTE.Cursor.$7Z(RTE.Cursor.$3U);return RTE.Cursor.s_range};RTE.Cursor.onKeyPress=function(a){ULSdmo:;if(!RTE.RteUtility.$1L(a.target))return;if(RTE.Cursor.$5b){RTE.RteUtility.cancelEvent(a);return}RTE.Canvas.invokeInAutoComplete(function(b){ULSdmo:;return b.onKeyPress(a)});var h=true,i=RTE.Canvas.currentEditableRegion(),j=RTE.Canvas.getCachedRestriction(i,"AllowMultiLines",true);if(!a.altKey&&!a.ctrlKey&&a.charCode===13)if(RTE.Canvas.moveToRedirectIfItExist(a.target)||!j)RTE.RteUtility.cancelEvent(a);else{Flighting.VariantConfiguration.IsExpFeatureClientEnabled(543)&&RTE.Cursor.$BD(i);var e=RTE.QuickRange.$39();h=false;if(e&&e.get_$3D_0()){var b=RTE.RteUtility.$4y(e.$g_0),c=b?b.tagName.toUpperCase():null;if(b&&!RTE.SU.isNullOrEmptyString(c)&&(c==="H1"||c==="H2"||c==="H3"||c==="H4"||c==="H5"||c==="H6")&&!RTE.RteUtility.$CH(b,true)&&RTE.Canvas.isEditable(b)){var k=b.parentNode;window.setTimeout(function(){ULSdmo:;var d=RTE.Cursor.get_range(),b=RTE.RteUtility.$4y(d.parentElement());if(b){if(b.parentNode===k){var f=b.innerText||b.textContent;if(!RTE.RteUtility.isEmptyString(f,true))return}else if(b===k){var c=d.$1_0;while(c.previousSibling&&c.previousSibling.tagName.toUpperCase()==="BR")c.parentNode.removeChild(c.previousSibling)}else return;RTE.FontCommands.createStyledElement("P","");if(RTE.RteUtility.isFirefox()){var a=RTE.RteUtility.$4y(d.parentElement());if(a&&a.tagName==="P"&&a.childNodes.length<=2){var e=a.lastChild;if(!e||e.nodeType!==1||e.tagName!=="BR"){var g=a.ownerDocument.createElement("BR");a.appendChild(g)}}}}},0)}else if(a.shiftKey&&RTE.Canvas.isEditable(b)){var f;try{f=Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0}catch(l){f=false}if(f){var d=RTE.Cursor.get_range().$2_0.nextSibling,g;if(d&&d.parentNode)g=d.parentNode.insertBefore(b.ownerDocument.createElement("BR"),d);else g=b.appendChild(b.ownerDocument.createElement("BR"));RTE.Cursor.get_range().moveAfterNode(g);RTE.Cursor.update();a.stopPropagation();a.preventDefault()}}}}if(j)RTE.Cursor.waitAndUpdateRangeToCurrentSelection(h,RTE.Canvas.$30);else RTE.Cursor.waitAndUpdateRangeToCurrentSelection(true,200)};RTE.Cursor.$BD=function(a){ULSdmo:;if(!a||!RTE.RteUtility.isInternetExplorer())return;window.setTimeout(function(){ULSdmo:;RTE.RteUtility.forEachChildWithTagAndClass(a,"SPAN","ms-rtestate-read",RTE.Cursor.$BE)},0)};RTE.Cursor.$BE=function(c){ULSdmo:;if(RTE.RteUtility.$3n(c)){var b=RTE.RteUtility.$4y(c),a=b?b.tagName.toUpperCase():null;b&&!RTE.SU.isNullOrEmptyString(a)&&RTE.Canvas.isEditable(b)&&(a==="P"||a==="H1"||a==="H2"||a==="H3"||a==="H4"||a==="H5"||a==="H6")&&RTE.RteUtility.removeNodeAndKeepChildNodes(b)}};RTE.Cursor.onKeyUp=function(a){ULSdmo:;RTE.Canvas.$32=false;var b=RTE.RteUtility.$1L(a.target);if(!b)return;if(RTE.Cursor.$2R)a.keyCode===13&&RTE.CanvasEvents.dispatchChanged();else(a.keyCode===16||a.keyCode===17)&&RTE.Cursor.waitAndUpdateRangeToCurrentSelection(false,RTE.Canvas.$30);RTE.Cursor.$5o&&a.keyCode===17&&RTE.PasteFlyout.expandOptions();RTE.Cursor.$5o=false;RTE.Canvas.invokeInAutoComplete(function(b){ULSdmo:;return b.onKeyUp(a)})};RTE.Cursor.$Dr=function(a){ULSdmo:;if(RTE.RteUtility.$CC(a.rawEvent))return;if(a.keyCode===38||a.keyCode===40||a.keyCode===39||a.keyCode===37){if(a.shiftKey||a.ctrlKey||a.altKey)return;var h=RTE.Canvas.get_selectedAtomic()||RTE.CanvasEvents.getNodeFromEvent("Image");if(!h&&RTE.Selection.isControlRangeSelection()&&RTE.RteUtility.isInternetExplorer()){if(RTE.Cursor.s_range.get_$5D_0()){var t=RTE.QuickRange.$39();if(t&&t.get_$3D_0())h=t.get_$AK_0()}if(!h)h=RTE.Cursor.$BX(RTE.Cursor.s_range.$1_0.nextSibling)}if(h){if(a.keyCode===40||a.keyCode===39)RTE.Cursor.get_range().moveAfterNode(h);else RTE.Cursor.get_range().moveBeforeNode(h);RTE.RteUtility.cancelEvent(a);RTE.Canvas.$4K(null);RTE.Cursor.update();return}if(a.keyCode===38||a.keyCode===40){var n=RTE.QuickRange.$39();if(!n||!n.get_$3D_0())return;var o=n.get_$7E_0(),p=n.get_$9H_0(),f=RTE.RteUtility.$20(o,["TD","TH"]);if(f&&RTE.Canvas.isEditable(f)){var j=f.parentNode,d=a.keyCode===40;if(RTE.RteUtility.isSafari()){var G=d?RTE.RteUtility.getRealLastChild(j,true):RTE.RteUtility.getRealFirstChild(j,true);if(G!==f)return}var F=d?RTE.RteUtility.getRealLastChild(j.parentNode,true):RTE.RteUtility.getRealFirstChild(j.parentNode,true);if(F!==j)return;var b=o,z=true;p=p||!d;while(b!==f){if(!p&&b!==f&&(RTE.RteUtility.isBlockNode(b)||b.nodeType===1&&b.tagName==="BR")){z=false;break}p=false;var q=d?b.nextSibling:b.previousSibling;while(!q){b=b.parentNode;if(b===f){q=b;break}q=d?b.nextSibling:b.previousSibling}b=q}if(z){!RTE.Cursor.s_range.isValid()&&!RTE.Cursor.$1T&&RTE.Cursor.cursorRangeIsNowOutdated();var u=RTE.Cursor.get_range();if(!u.isValid())return;var c=o.ownerDocument.createElement("SPAN");c.appendChild(o.ownerDocument.createTextNode(RTE.RteUtility.$1X));u.$2_0.parentNode.insertBefore(c,u.$2_0.nextSibling);var A=c.offsetTop+c.clientHeight,g=f;while(true){var w=d?RTE.RteUtility.getRealLastChild(g,false):RTE.RteUtility.getRealFirstChild(g,false);if(!w||!RTE.RteUtility.isBlockNode(w))break;g=w}if(d&&g.lastChild!==c)g.appendChild(c);else!d&&g.firstChild!==c&&g.insertBefore(c,g.firstChild);A-=c.offsetTop+c.clientHeight;c.parentNode.removeChild(c);if(A)return;var v=RTE.RteUtility.getNearestParentElementOfType(j,"TABLE");if(RTE.Canvas.isEditable(v))if(d)RTE.Cursor.get_range().moveAfterNode(v);else RTE.Cursor.get_range().moveBeforeNode(v);RTE.RteUtility.cancelEvent(a);RTE.Cursor.update();return}}}}if(a.keyCode===8||a.keyCode===127){var e=RTE.QuickRange.$39();if(!e||!e.get_$3D_0())return;var r=e.get_$AK_0(),B=r;if(!r)if(e.get_$CM_0()&&e.get_$9H_0()){r=e.$g_0;B=e.$R_0}else return;var C=RTE.RteUtility.$8f(r,e.$4q_0,true),D=RTE.RteUtility.$8f(B,e.$4q_0,false);if(!C||!D)return;var l=null,m=null,x,y;RTE.Cursor.$DM(C,D,x={val:l},y={val:m}),l=x.val,m=y.val;if(l&&m){if(a.keyCode===8)RTE.Cursor.get_range().moveBeforeNode(l);else RTE.Cursor.get_range().moveAfterNode(m);RTE.Cursor.select();var H=m.nextSibling,s=l,k=null,E=false;while(s!==H){var i=s;s=s.nextSibling;if(RTE.Canvas.setTableWidths&&i.tagName==="TR"){if(!k){k=RTE.RteUtility.getNearestParentElementOfType(i,"TABLE");E=RTE.RteUtility.getRealFirstChild(i.parentNode,true)===i&&RTE.TableCommands.hasHeaderRow(k)}RTE.TableCommands.$97(i,k,false)}else i.parentNode.removeChild(i)}k&&RTE.TableCommands.$9C(E,k);RTE.Cursor.update();RTE.RteUtility.cancelEvent(a);return}}};RTE.Cursor.$BX=function(a){ULSdmo:;if(a&&a.nodeType===1){var b=a.tagName;if(b==="TBODY"||b==="THEAD"||b==="TH"||b==="TR"||b==="TD")return RTE.RteUtility.getNearestParentElementOfType(a,"TABLE")||a}return a};RTE.Cursor.$DM=function(e,f,d,g){ULSdmo:;d.val=null;g.val=null;for(var h=Math.min(e.length,f.length),c=1;c<h;c++){var a=e[c],b=f[c];if(a&&b&&a.parentNode===b.parentNode)if(!d.val&&RTE.Cursor.$8t(a)&&RTE.Cursor.$8t(b)||d.val&&a===b&&RTE.Cursor.$Bx(a)){d.val=a;g.val=b}}};RTE.Cursor.$Bx=function(b){ULSdmo:;if(b.nodeType===1){var a=b.tagName;return a==="HR"||a==="IMG"}return false};RTE.Cursor.$8t=function(b){ULSdmo:;if(b.nodeType===1){var a=b.tagName;return a==="TABLE"||a==="TR"||a==="P"||a==="H1"||a==="H2"||a==="H3"||a==="H4"||a==="H5"||a==="H6"||a==="DIV"||a==="OL"||a==="UL"||a==="HR"||a==="IMG"}return false};RTE.Cursor.onKeyDown=function(a){ULSdmo:;RTE.Cursor.$5b=false;RTE.Canvas.$32=true;var b=a.target,g=RTE.RteUtility.$1L(b);if(!g||!RTE.Canvas.isInEditable(b)){if(a.keyCode===8&&!RTE.Canvas.$3C(b.tagName)&&!RTE.RteUtility.$CB(b))RTE.RteUtility.cancelEvent(a);else a.keyCode===9&&g&&RTE.Cursor.waitAndUpdateRangeToCurrentSelection(false,RTE.Canvas.$30);return}if(a.keyCode!==8&&a.keyCode!==127)RTE.Cursor.$3R=true;RTE.Canvas.invokeInAutoComplete(function(b){ULSdmo:;if(b.onKeyDown(a)){RTE.RteUtility.cancelEvent(a);RTE.Cursor.$5b=true;return true}return false});RTE.MovementKeys.initializeDictionary();RTE.SelectionClearingKeys.initializeDictionary();var c=RTE.MovementKeys.isMovementKey(a);if(c){if((a.keyCode===38||a.keyCode===40)&&RTE.Canvas.getIgnoreUpDownArrows()){RTE.RteUtility.cancelEvent(a);return}if(9===a.keyCode)RTE.Cursor.onKeyDownTabKey(a);else{if(RTE.RteUtility.isSafari()&&(a.keyCode===37||a.keyCode===39))RTE.Cursor.removeZeroWidthSpace();else if(a.keyCode===8||a.keyCode===127){if(RTE.Cursor.$3R){RTE.SnapshotManager.takeSnapshot();RTE.Cursor.$3R=false}RTE.Cursor.$3c();if(!RTE.Canvas.$3C(a.target.tagName))if(RTE.Canvas.get_selectedAtomic()){RTE.SnapshotManager.$1N(RTE.Canvas.currentEditableRegion())&&RTE.SnapshotManager.takeSnapshot();if(a.keyCode===8)RTE.Cursor.get_range().moveBeforeNode(RTE.Canvas.get_selectedAtomic());else RTE.Cursor.get_range().moveAfterNode(RTE.Canvas.get_selectedAtomic());RTE.RteUtility.removeNode(RTE.Canvas.get_selectedAtomic());RTE.Cursor.update();RTE.RteUtility.cancelEvent(a)}else if(RTE.RteUtility.isInternetExplorer()){var f=RTE.QuickRange.$39();if(f&&f.get_$3D_0()&&!f.get_$3q_0()){var i=RTE.Cursor.get_range();if(i.isValid()){var j=i.parentElement();if(j){RTE.AtomicManager.$7a();RTE.AtomicManager.$4m(j);window.setTimeout(RTE.AtomicManager.$4C,0)}}}}}RTE.Cursor.s_range.isValid()&&RTE.Cursor.s_range.isEmpty()&&RTE.Cursor.s_range.$4k_0()}}var h=RTE.SelectionClearingKeys.isSelectionClearKey(a),e=h;if(RTE.Cursor.$3R&&h&&RTE.Selection.get_hasSelection()){RTE.SnapshotManager.takeSnapshot();RTE.Cursor.$3R=false}RTE.Cursor.$Dr(a);var d=new RTE.ShortcutEventArgs;d.event=a;d.handled=false;RTE.CanvasEvents.dispatchHandleShortcut(d);if(d.handled){e=false;RTE.RteUtility.cancelEvent(a);RTE.Canvas.$DR()}RTE.Cursor.$5o=a.keyCode===17;RTE.PasteFlyout.collapseOptions();(e&&a.keyCode!==9||a.keyCode===27)&&RTE.PasteFlyout.hide();if(e){RTE.SnapshotManager.setRegionDirty(RTE.Canvas.currentEditableRegion());RTE.DirtyBitManager.$8D()}else c&&!RTE.PasteFlyout.get_isVisible()&&RTE.SnapshotManager.$1N(RTE.Canvas.currentEditableRegion())&&RTE.SnapshotManager.takeSnapshot();if(!(a.keyCode===16&&RTE.Cursor.$2R))RTE.Cursor.$2R=false;if(a.keyCode===229){RTE.Cursor.$2R=true;RTE.Cursor.$3c()}else if(a.keyCode===16||a.keyCode===17||c&&(a.ctrlKey||a.shiftKey)&&a.keyCode!==9||a.ctrlKey)RTE.Cursor.$3c();else RTE.Cursor.waitAndUpdateRangeToCurrentSelection(!c,RTE.Canvas.$30)};RTE.Cursor.onKeyDownTabKey=function(d){ULSdmo:;RTE.RteUtility.assertNotNull("evt",d);var b=false,e=!d.shiftKey,c=null,a=RTE.Cursor.$o(["TD","TH","LI"]);if(a&&RTE.Canvas.isInEditable(a)){if(a.tagName==="TD"||a.tagName==="TH")c=new RTE.TableKeyTabProcessor(e);else if(a.tagName==="LI"){if(e)RTE.RichTextEditor.increaseIndent();else RTE.RichTextEditor.decreaseIndent();b=true}a=a.parentNode}if(c)b=c.process();b&&RTE.RteUtility.cancelEvent(d);return b};RTE.Cursor.cut=function(){ULSdmo:;RTE.Cursor.select();try{RTE.Canvas.$4s("cut");RTE.Cursor.waitAndUpdateRangeToCurrentSelection(true,0)}catch(a){RTE.UiServices.$I.showError(1)}};RTE.Cursor.copy=function(){ULSdmo:;RTE.Cursor.select();try{RTE.Canvas.$4s("copy")}catch(a){RTE.UiServices.$I.showError(1)}};RTE.Cursor.get_pasteInProgress=function(){ULSdmo:;return RTE.Cursor.$m};RTE.Cursor.paste=function(a){ULSdmo:;RTE.Cursor.$3L=a;try{var b=RTE.Selection.getSelectionRange(),c=b.parentElement();if(!RTE.Canvas.isEditable(c))RTE.Canvas.$4s("paste");else RTE.Cursor.$8z()}catch(d){RTE.UiServices.$I.showError(1);RTE.Cursor.$1C();return}};RTE.Cursor.$9g=function(a){ULSdmo:;RTE.Cursor.$4p=RTE.Canvas.getEditableRegion(a.target);if(RTE.Cursor.$4p){RTE.Cursor.updateRangeToCurrentSelection();RTE.Cursor.$3P=true;RTE.SnapshotManager.takeEditableRegionSnapshot(RTE.Cursor.$4p);var b=RTE.RteUtility.getNearestParentElementOfType(a.target,"A");if(b){a.rawEvent.dataTransfer.dropEffect="None";a.rawEvent.dataTransfer.effectAllowed="None"}}};RTE.Cursor.$Ck=function(b){ULSdmo:;RTE.Cursor.$3P=false;var a=RTE.Canvas.getEditableRegion(b.target);if(!a)return;if(!RTE.RteUtility.isInternetExplorer()){RTE.SnapshotManager.setRegionDirty(a);RTE.SnapshotManager.takePartialSnapshot(a)}RTE.Canvas.onMouseUp(b)};RTE.Cursor.$9h=function(a){ULSdmo:;var b=RTE.Canvas.getEditableRegion(a.target);if(!b)return;RTE.Cursor.cursorRangeIsNowOutdated();if(RTE.Cursor.$3P){!RTE.RteUtility.isInternetExplorer()&&RTE.Cursor.$65();window.setTimeout(RTE.Cursor.$9d,0)}else if(RTE.RteUtility.isInternetExplorer())RTE.RteUtility.cancelEvent(a);else RTE.Cursor.$9j(a,true)};RTE.Cursor.$Cp=function(a){ULSdmo:;if(!RTE.Canvas.isEditable(a.target))return;RTE.Cursor.$4Z=false;try{if(RTE.RteUtility.$7D()){RTE.Cursor.$8z();RTE.RteUtility.cancelEvent(a)}else RTE.Cursor.$9j(a,false)}catch(b){RTE.Cursor.$m=false;RTE.Cursor.$18=0;RTE.RteUtility.cancelEvent(a);RTE.Cursor.$1C()}};RTE.Cursor.$Ch=function(a){ULSdmo:;if(!RTE.RteUtility.$1L(a.target))return;RTE.Cursor.updateRangeToCurrentSelection()};RTE.Cursor.$Ci=function(c){ULSdmo:;if(!RTE.RteUtility.$1L(c.target))return;RTE.Cursor.updateRangeToCurrentSelection();var b=RTE.Cursor.get_range();if(!b.isEmpty()){var a=RTE.Canvas.currentEditableRegion();RTE.SnapshotManager.$1N(a)&&RTE.SnapshotManager.takeSnapshot();if(RTE.RteUtility.isInternetExplorer()){RTE.AtomicManager.$7a();RTE.AtomicManager.$4m(a);RTE.Cursor.select()}window.setTimeout(function(){ULSdmo:;RTE.Cursor.updateRangeToCurrentSelection();RTE.RteUtility.isInternetExplorer()&&RTE.AtomicManager.$4C();RTE.SnapshotManager.takeSnapshot()},0)}};RTE.Cursor.$9j=function(b,a){ULSdmo:;try{if(!a&&RTE.Cursor.$m){RTE.RteUtility.cancelEvent(b);return}RTE.Cursor.$7X();RTE.Cursor.$9f(b,a);RTE.Cursor.$m=true;RTE.Cursor.$65();if(a)window.setTimeout(RTE.Cursor.$9d,0);else window.setTimeout(RTE.Cursor.$Cq,0)}catch(c){RTE.Cursor.$1C();throw c;}};RTE.Cursor.$Cq=function(){ULSdmo:;RTE.RteUtility.insertAfter(RTE.Cursor.$B,RTE.Cursor.$C.$1_0);RTE.Cursor.$C.resetCacheRange();RTE.Cursor.s_range.moveAfterNode(RTE.Cursor.$B);RTE.ScrollPosition.applyScrolls(RTE.Cursor.$5U);RTE.Cursor.$5U=null;RTE.RteUtility.forEachChildWithTagAndClass(RTE.Cursor.$B,"div","ms-rte-pasteremove",function(a){ULSdmo:;if(a!==RTE.Cursor.$B){RTE.Cursor.$7C(a.lastChild);do{var b=a.parentNode;b=b.firstChild===b.lastChild?b:null;RTE.RteUtility.removeNodeAndKeepChildNodes(a);a=b}while(a&&a!==RTE.Cursor.$B&&RTE.RteUtility.$CK(a))}});RTE.Cursor.$7C(RTE.Cursor.$B.firstChild);RTE.Cursor.$7C(RTE.Cursor.$B.lastChild);RTE.Cursor.$8P(RTE.Cursor.$B);var a=RTE.Cursor.$3L;RTE.Cursor.$3L=null;RTE.Cursor.s_range.moveAfterNode(RTE.Cursor.$B);RTE.RtePasteManager.$78(RTE.Cursor.$B,false,a,function(){ULSdmo:;RTE.RteUtility.insertBefore(RTE.Cursor.s_range.$1_0,RTE.Cursor.$B);if(!RTE.RteUtility.$3n(RTE.Cursor.$B)){var a=document.createElement("SPAN");RTE.RteUtility.moveChildNodes(RTE.Cursor.$B,a);RTE.RteUtility.removeNode(RTE.Cursor.$B);RTE.RteUtility.$56(a,RTE.Cursor.s_range.$1_0);RTE.Cursor.$B=a}else{RTE.Cursor.$B.parentNode.removeChild(RTE.Cursor.$B);RTE.RteUtility.$56(RTE.Cursor.$B,RTE.Cursor.s_range.$1_0)}RTE.RteUtility.insertBefore(RTE.Cursor.$C.$1_0,RTE.Cursor.$B);RTE.RteUtility.insertAfter(RTE.Cursor.$C.$2_0,RTE.Cursor.$B);RTE.Cursor.$C.resetCacheRange();RTE.Canvas.dispatchAddedEventsChildElements(RTE.Cursor.$B);RTE.RteUtility.removeNodeAndKeepChildNodes(RTE.Cursor.$B);RTE.Cursor.$B=null;RTE.Cursor.$9e()})};RTE.Cursor.$8P=function(a){ULSdmo:;RTE.RteUtility.forEachChildWithTagAndClass(a,"LI",null,function(b){ULSdmo:;if(b.parentNode===a){var c=b.parentNode.tagName;if(c!=="OL"&&c!=="UL"){var d=a.ownerDocument.createElement("UL"),e=b.parentNode;RTE.RteUtility.moveChildNodes(e,d);e.appendChild(d)}}else b.parentNode.tagName==="SPAN"&&(b.parentNode.parentNode.tagName==="OL"||b.parentNode.parentNode.tagName==="UL")&&RTE.RteUtility.removeNodeAndKeepChildNodes(b.parentNode)})};RTE.Cursor.$7C=function(a){ULSdmo:;if(a&&a.nodeType===3){var b=a.nodeValue;(b===RTE.RteUtility.$1X||b===String.fromCharCode(8203))&&RTE.RteUtility.removeNode(a)}};RTE.Cursor.$Dj=function(a){ULSdmo:;RTE.UiServices.$I.showWaitDialog(a)};RTE.Cursor.$C6=function(){ULSdmo:;RTE.UiServices.$I.hideWaitDialog()};RTE.Cursor.$7X=function(){ULSdmo:;RTE.Cursor.$Dj(1);RTE.Cursor.$4Z=false};RTE.Cursor.$1C=function(){ULSdmo:;!RTE.Cursor.$18&&RTE.Cursor.$C6()};RTE.Cursor.prepareSafeIFrame=function(a){ULSdmo:;if(!RTE.Cursor.$J){RTE.Cursor.$J=document.createElement("IFRAME");RTE.Cursor.$J.style.display="none";RTE.Cursor.$J.style.width="1px";RTE.Cursor.$J.style.height="1px";RTE.Cursor.$J.style.position="absolute";RTE.Cursor.$J.style.zIndex=-100;document.body.appendChild(RTE.Cursor.$J)}RTE.Cursor.$5a(a)};RTE.Cursor.get_safeIframe=function(){ULSdmo:;return RTE.Cursor.$J};RTE.Cursor.$5a=function(i){ULSdmo:;RTE.Cursor.$J.contentWindow.document.designMode="On";RTE.Cursor.$J.contentWindow.document.open("text/html","replace");RTE.Cursor.$J.contentWindow.document.write('<DIV id="pasteDiv">'+String.fromCharCode(8203)+"</DIV>");RTE.Cursor.$J.contentWindow.document.close("");if(i){var c=RTE.Cursor.$J.contentDocument||RTE.Cursor.$J.contentWindow.document,d=c?c.getElementsByTagName("head"):null;if(d&&d.length>0)for(var g=d[0],f=document.styleSheets,h=f.length,e=0;e<h;e++){var a=f[e];if(a&&!RTE.SU.isNullOrEmptyString(a.href)){var b=c.createElement("LINK");b.type=a.type;b.rel="stylesheet";b.href=a.href;g.appendChild(b)}}}};RTE.Cursor.$8z=function(){ULSdmo:;if(!RTE.RteUtility.isInternetExplorer()&&RTE.Cursor.$2f&&!RTE.Cursor.$3M)throw Error.invalidOperation("Can't access clipboard");if(RTE.Cursor.$m){RTE.Cursor.$18++;return}var a=RTE.Cursor.get_range();if(a.isValid()){var b=true,c=window.self.clipboardData;if(!RTE.SU.isNullOrUndefined(c)){var d=c.getData("Text");if(!RTE.SU.isNullOrUndefined(d))if(d.length<3e3)b=false}b&&RTE.Cursor.$7X();RTE.Cursor.$18++;RTE.Cursor.$m=true;if(RTE.RteUtility.isInternetExplorer()||RTE.Cursor.$2f&&RTE.Cursor.$3M){a.deleteContent();window.setTimeout(RTE.Cursor.$79,10)}else RTE.Cursor.$79()}};RTE.Cursor.$79=function(){ULSdmo:;try{if(RTE.Cursor.$4Z)return;RTE.Cursor.$18--;RTE.Cursor.$m=true;RTE.Cursor.prepareSafeIFrame(true);RTE.Cursor.$J.style.display="";var a=RTE.Cursor.$J.contentWindow.document,d=a.body,e=RTE.DomHelper.createRange(a),b=new RTE.Range(e);b.moveToElementText(d);b.select();a.execCommand("paste",false,null);RTE.Cursor.updateRangeToCurrentSelectionWithOptions(true);var c=RTE.Cursor.get_range(),f=c.$1A_0();c.deleteContent();f.select();RTE.Cursor.$J.style.display="none";RTE.Cursor.$3M=true;RTE.Cursor.$2f=true;RTE.Cursor.$Cu()}catch(g){RTE.Cursor.$2f&&RTE.Cursor.$3M&&RTE.Cursor.$1C();RTE.Cursor.$J.style.display="none";RTE.Cursor.$5a(true);if(!RTE.Cursor.$2f){RTE.Cursor.$2f=true;RTE.Cursor.$3M=false}RTE.Cursor.$m=false;RTE.Cursor.$18=0;throw g;}};RTE.Cursor.$Cu=function(){ULSdmo:;try{var b=RTE.Cursor.$J.contentWindow.document.body,c=b.childNodes,a;if(c.length===1&&c[0].id==="pasteDiv")a=c[0];else{a=b.ownerDocument.createElement("DIV");RTE.RteUtility.moveChildNodes(b,a);b.appendChild(a)}var d=RTE.Cursor.$3L;RTE.Cursor.$3L=null;RTE.Cursor.$8P(a);RTE.RtePasteManager.$78(a,false,d,function(){ULSdmo:;try{RTE.RteUtility.removeNodeAndKeepChildNodes(a);RTE.Cursor.$Cv();RTE.Cursor.$6S();RTE.Cursor.prepareSafeIFrame(true);window.setTimeout(function(){ULSdmo:;RTE.Cursor.$9e();if(RTE.Cursor.$18>0){RTE.PasteFlyout.hide();RTE.Cursor.$9n();RTE.Cursor.$79()}},0)}catch(b){RTE.Cursor.$5a(false);RTE.Cursor.$m=false;RTE.Cursor.$18=0;RTE.Cursor.$1C();throw b;}})}catch(e){RTE.Cursor.$5a(false);RTE.Cursor.$m=false;RTE.Cursor.$18=0;RTE.Cursor.$1C();throw e;}};RTE.Cursor.$Cv=function(){ULSdmo:;var b=RTE.Cursor.$J.contentWindow.document.body,a=RTE.Cursor.get_range();a.replaceHtml(RTE.RteUtility.removeEmptySpanAndRteIds(b.innerHTML,false,false));RTE.RteUtility.insertAfter(RTE.Cursor.$C.$1_0,a.$1_0);RTE.RteUtility.insertBefore(RTE.Cursor.$C.$2_0,a.$2_0);RTE.Cursor.$C.resetCacheRange();a.collapse(false);RTE.Cursor.select()};RTE.Cursor.$Ce=function(a){ULSdmo:;RTE.RteUtility.$7D()&&RTE.Cursor.$9f(a,false)};RTE.Cursor.$9f=function(a,d){ULSdmo:;if(!RTE.Canvas.isEditable(a.target)||RTE.Cursor.ignoreBeforePasteOrDrop){a.rawEvent.returnValue=true;return}if(RTE.Cursor.$m){RTE.RteUtility.cancelEvent(a);a.rawEvent.returnValue=false}var b=a.rawEvent.rangeParent,c=a.rawEvent.rangeOffset;if(b&&c){var e=new RTE.DOMTreePosition(b,c);e.insertMarker(RTE.Cursor.get_range().$1_0);RTE.Cursor.get_range().collapse(true)}else RTE.Cursor.updateRangeToCurrentSelectionWithOptions(true);if(RTE.Cursor.get_range().isValid()){(d||!RTE.PasteFlyout.get_isVisible())&&RTE.SnapshotManager.takeSnapshot();RTE.Cursor.$6S();RTE.Cursor.$C.resetCacheRange();RTE.Cursor.$6B();if(d||RTE.RteUtility.$7D())RTE.Cursor.$9n();else RTE.Cursor.$Cs();a.rawEvent.returnValue=true}else{RTE.RteUtility.cancelEvent(a);a.rawEvent.returnValue=false}};RTE.Cursor.$Cs=function(){ULSdmo:;var a=RTE.Cursor.get_range();a.deleteContent();var b=a.getEditableRegion();RTE.Cursor.$5U=RTE.ScrollPosition.buildForElement(b);RTE.Cursor.$B=document.createElement("DIV");RTE.Cursor.$B.setAttribute("contentEditable","true");RTE.Cursor.$B.className="ms-rte-pasteremove";RTE.Cursor.$B.style.width="1px";RTE.Cursor.$B.style.height="1px";RTE.Cursor.$B.style.overflow="hidden";RTE.RteUtility.insertAfter(RTE.Cursor.$C.$2_0,a.$2_0);RTE.RteUtility.insertAfter(RTE.Cursor.$C.$1_0,a.$2_0);if(RTE.RteUtility.isFirefox())b.appendChild(RTE.Cursor.$B);else RTE.RteUtility.insertAfter(RTE.Cursor.$B,b);var c=RTE.Range.createRange();c.moveToElementText(RTE.Cursor.$B);RTE.Range.$7P(c.$5_0)};RTE.Cursor.$9n=function(){ULSdmo:;var a=RTE.Cursor.get_range();a.insertBefore(RTE.Cursor.$C.$1_0);document.body.appendChild(RTE.Cursor.$C.$2_0)};RTE.Cursor.$Cn=function(d){ULSdmo:;var a=d.target;if(!d.target)return;if(RTE.Cursor.$3P){var b=a.id;if(b&&b.indexOf("ms-rterangecursor")!==-1){var c=RTE.Cursor.get_range();a!==c.$1_0&&a!==c.$2_0&&RTE.RteUtility.removeNodeAndKeepChildNodes(a)}}};RTE.Cursor.$65=function(){ULSdmo:;if(!RTE.Cursor.$3o){RTE.Cursor.$3o=true;RTE.RteUtility.$X("DOMNodeInserted",RTE.Cursor.$6k)}};RTE.Cursor.$8B=function(){ULSdmo:;if(RTE.Cursor.$3o){RTE.RteUtility.$8C("DOMNodeInserted",RTE.Cursor.$6k);RTE.Cursor.$3o=false}};RTE.Cursor.$Cl=function(a){ULSdmo:;if(!RTE.Canvas.isInEditable(a.target))return;if(!RTE.Cursor.$3P)if(RTE.RteUtility.isInternetExplorer()){RTE.RteUtility.cancelEvent(a);a.rawEvent.dataTransfer.dropEffect="None"}else{RTE.Cursor.$65();window.setTimeout(RTE.Cursor.$Av,200);RTE.Cursor.$4n++}};RTE.Cursor.$Av=function(){ULSdmo:;RTE.Cursor.$4n--;RTE.Cursor.$4n<=0&&RTE.Cursor.$74(true)};RTE.Cursor.$9e=function(){ULSdmo:;try{RTE.Cursor.$74(false);RTE.Cursor.$m=false;RTE.Cursor.$1C()}catch(a){RTE.Cursor.$1C();RTE.Cursor.$m=false;RTE.Cursor.$18=0;RTE.Cursor.$8B()}};RTE.Cursor.$74=function(b){ULSdmo:;RTE.Cursor.$8B();var a=RTE.Cursor.get_range();if(b){a.insertBefore(RTE.Cursor.$C.$1_0);a.insertAfter(RTE.Cursor.$C.$2_0);RTE.Cursor.updateRangeToCurrentSelectionWithOptions(true)}else a.moveBeforeNode(RTE.Cursor.$C.$2_0);if(!a.isValid())return;!RTE.Cursor.$C.$1_0.parentNode&&RTE.RteUtility.insertBefore(RTE.Cursor.$C.$1_0,a.$1_0);RTE.Cursor.$6S();RTE.Cursor.$Cd(b)};RTE.Cursor.$9d=function(){ULSdmo:;RTE.Cursor.$74(true);RTE.Cursor.$1C()};RTE.Cursor.$Cd=function(b){ULSdmo:;var a=RTE.Canvas.getCachedRestriction(RTE.Canvas.currentEditableRegion(),"RestrictPasteToText",false);if(a){RTE.Cursor.$C.convertToText();RTE.Cursor.$C.clear()}RTE.Cursor.$BF();RTE.AtomicManager.$4C();RTE.SnapshotManager.setCurrentRegionDirtyIf(!b&&!RTE.Cursor.$C.isEmpty());RTE.SnapshotManager.takeSnapshot();RTE.Cursor.update()};RTE.Cursor.$6S=function(){ULSdmo:;var a=RTE.Cursor.$C;RTE.RteUtility.$3T(a.$1_0);RTE.RteUtility.$4Q(a.$2_0);var b=RTE.Cursor.get_range();RTE.RteUtility.$3T(b.$1_0);RTE.RteUtility.$4Q(b.$2_0)};RTE.Cursor.$BF=function(){ULSdmo:;var a=RTE.Cursor.$C.parentElement();RTE.Cursor.fixListItemOfNode(a)};RTE.Cursor.fixListItemOfNode=function(a){ULSdmo:;if(!RTE.RteUtility.isNodeOfType(a,RTE.HtmlTagName.extendedListElements)){for(var d=false,b=[],e=a.childNodes.length-1;e>=0;e--){var c=a.childNodes[e];if(c.tagName==="LI"){d=true;b.push(c)}else if(RTE.RteUtility.isNodeOfType(c,RTE.HtmlTagName.extendedListElements))b.push(c);else if(b.length>0&&d){var g=RTE.Cursor.$86(b);RTE.RteUtility.insertAfter(g,c)}}if(b.length>0&&d){var f=RTE.Cursor.$86(b);if(a.firstChild)RTE.RteUtility.insertBefore(f,a.firstChild);else a.appendChild(f)}}};RTE.Cursor.$86=function(d){ULSdmo:;var b=document.createElement("UL");while(d.length>0){var a=d.pop();if(a.tagName==="LI"||RTE.RteUtility.isNodeOfType(a,RTE.HtmlTagName.extendedListElements))b.appendChild(a);else{var c=document.createElement("LI");b.appendChild(c);c.appendChild(a)}}return b};RTE.Cursor.get_pasteRange=function(){ULSdmo:;return RTE.Cursor.$C};RTE.Cursor.update=function(){ULSdmo:;RTE.Cursor.s_range.resetCacheRange();if(!RTE.PreviewManager.get_instance().get_hasPreview()){RTE.Cursor.updateWithoutDispatchingEvents();RTE.CanvasEvents.$6O();RTE.Cursor.select()}};RTE.Cursor.updateWithoutDispatchingEvents=function(){ULSdmo:;RTE.Cursor.$1T&&RTE.Cursor.updateRangeToCurrentSelectionWithOptions(RTE.Cursor.$3U)};RTE.Cursor.waitAndUpdateRangeToCurrentSelection=function(a,b){ULSdmo:;if(RTE.Cursor.$2P)return;if(!a)RTE.Cursor.$3U=false;RTE.Cursor.$3c();RTE.Cursor.$3V=window.setTimeout(RTE.Cursor.$AO,b)};RTE.Cursor.$6B=function(){ULSdmo:;if(RTE.Cursor.$3V>0){window.clearTimeout(RTE.Cursor.$3V);RTE.Cursor.$3V=0}if(RTE.Canvas.$1Y>0){window.clearTimeout(RTE.Canvas.$1Y);RTE.Canvas.$1Y=0}};RTE.Cursor.$3c=function(){ULSdmo:;RTE.Cursor.$6B();RTE.Cursor.cursorRangeIsNowOutdated()};RTE.Cursor.$Du=function(){ULSdmo:;RTE.Cursor.$3V=0;RTE.Cursor.$7Z(RTE.Cursor.$3U)};RTE.Cursor.updateRangeToCurrentSelectionAndDispatch=function(){ULSdmo:;RTE.Cursor.$7Z(false)};RTE.Cursor.$7Z=function(a){ULSdmo:;RTE.Cursor.updateRangeToCurrentSelectionWithOptions(a);RTE.Cursor.$3U=true;RTE.Cursor.$3r=false;RTE.CanvasEvents.$6O()};RTE.Cursor.updateRangeToCurrentSelection=function(){ULSdmo:;RTE.Cursor.updateRangeToCurrentSelectionWithOptions(false)};RTE.Cursor.updateRangeToCurrentSelectionWithOptions=function(c){ULSdmo:;RTE.Cursor.$5G=false;RTE.Cursor.$5F=false;RTE.Cursor.$6B();if(RTE.PreviewManager.get_instance().get_hasPreview())return;RTE.Cursor.$1T=false;var d=RTE.Selection.getSelectionRange(),a=true;if(RTE.Canvas.get_selectedAtomic()&&RTE.Canvas.get_selectedAtomic().parentNode&&RTE.Canvas.get_selectedAtomic().parentNode.parentNode)a=RTE.Cursor.s_range.moveToNode(RTE.Canvas.get_selectedAtomic());else if(!d)a=false;else a=RTE.Cursor.s_range.moveToRange(d);if(!a&&!c)RTE.Cursor.s_range.clear();else if(a){var b=RTE.Cursor.s_range.expandInNonEditableRegion();if(b&&b!==RTE.Canvas.get_selectedAtomic()){RTE.Canvas.$4K(b);RTE.Cursor.s_range.moveToNode(b)}if(!RTE.RteUtility.isInternetExplorer()&&!RTE.Canvas.get_selectedAtomic()){var e=RTE.Cursor.s_range.$1A_0();e.select()}}!c&&RTE.Canvas.sendApplicationStateChangedEvent()};RTE.Cursor.isTableSelected=function(){ULSdmo:;if(!RTE.Cursor.$5G&&RTE.Cursor.s_range.isValid()){var a=RTE.Cursor.s_range.$1A_0().get_innerHTML().toLowerCase(),b=new RegExp("<\\/?t[r|h|d|able]");RTE.Cursor.$5F=a.search(b)!==-1;RTE.Cursor.$5G=true}return RTE.Cursor.$5F};RTE.Cursor.removeZeroWidthSpace=function(){ULSdmo:;var a=RTE.Cursor.$4V;if(a){var b=RTE.Selection.getSelectionRange(),d=null,e=-1,f=null,g=-1;if(b){d=b.$5_0.startContainer;e=b.$5_0.startOffset;f=b.$5_0.endContainer;g=b.$5_0.endOffset}var i=a.nodeValue,j=i.replace(String.fromCharCode(8203),"");if(j===""){var c=a.parentNode;if(c){for(var h=0;h<c.childNodes.length;h++)if(c.childNodes[h]===a){if(d===a){d=c;e=h}if(f===a){f=c;g=h}break}c.removeChild(a)}}else{var k=i.indexOf(String.fromCharCode(8203));if(d===a&&e>k)e--;if(f===a&&g>k)g--;a.nodeValue=j}if(b){b.$5_0.setStart(d,e);b.$5_0.setEnd(f,g);b.select()}RTE.Cursor.$4V=null}};RTE.Cursor.select=function(){ULSdmo:;try{RTE.Cursor.$9B()}catch(a){window.setTimeout(RTE.Cursor.$9B,0)}};RTE.Cursor.$9B=function(){ULSdmo:;if(RTE.PreviewManager.get_instance().get_hasPreview())return;RTE.Cursor.$2P=true;var a=RTE.Cursor.get_range();if(a.isValid()){RTE.Canvas.$4K(RTE.Cursor.$BC());if(!RTE.Canvas.get_selectedAtomic())if(RTE.RteUtility.isInternetExplorer())if(!a.isEmpty()){var e=a.$1A_0(),f=RTE.Cursor.getSelectedImage();if(f)try{var g=document.body.createControlRange();g.add(f);g.select()}catch(n){e.select()}else e.select()}else if(a.get_$5D_0()){var i=a.$1A_0();i.select()}else{var b=null,c=null;try{b=document.createElement("SPAN");b.innerHTML=String.fromCharCode(8203);a.insertBefore(b);c=document.createElement("SPAN");c.innerHTML=String.fromCharCode(8203);a.insertAfter(c);var j=a.$1A_0();j.select()}finally{b&&b.parentNode&&b.parentNode.removeChild(b);c&&c.parentNode&&c.parentNode.removeChild(c)}}else{if(RTE.RteUtility.isSafari()){RTE.Cursor.removeZeroWidthSpace();if(a.isEmpty()){RTE.Cursor.$4V=a.$1_0.ownerDocument.createTextNode(RTE.RteUtility.$1t);a.insertBefore(RTE.Cursor.$4V)}}var k=a.parentElement(),h=RTE.Canvas.getEditableRegion(k);h&&!RTE.RteUtility.isSafari()&&h.focus();var d=a.$1A_0();(d.$5_0.startContainer!==d.$5_0.endContainer||!RTE.Canvas.$t(d.$5_0.startContainer))&&d.select()}else{var l=a.$1A_0();l.select();var m=RTE.Selection.getSelection();m.clear()}!RTE.PreviewManager.get_instance().get_hasPreview()&&a.$DP_0()}RTE.Cursor.$1T=false;RTE.Cursor.$2P=false};RTE.Cursor.getCurrentElement=function(){ULSdmo:;var a=RTE.Cursor.get_range();return!a?null:!a.isValid()?null:!a.get_isEditable()?null:a.parentElement()};RTE.Cursor.$CD=function(b){ULSdmo:;var a=RTE.Cursor.getCurrentElement();if(a)if(a.tagName===b)return true;return false};RTE.Cursor.$Bh=function(){ULSdmo:;var a=RTE.Cursor.getCurrentElement();return RTE.RteUtility.$4z(a,false)};RTE.Cursor.getNearestContainingElementOfType=function(a){ULSdmo:;var b=RTE.Cursor.getCurrentElement();return RTE.RteUtility.getNearestParentElementOfType(b,a)};RTE.Cursor.$o=function(b){ULSdmo:;var a=RTE.Cursor.getCurrentElement();return RTE.RteUtility.$20(a,b)};RTE.Cursor.$8p=function(c){ULSdmo:;var a=RTE.Cursor.get_range().getSingleElement();while(a&&RTE.Canvas.isEditable(a)){if(a.tagName===c)return a;var b=RTE.RteUtility.getRealFirstChild(a,true);if(b&&b===RTE.RteUtility.getRealLastChild(a,true)&&b.nodeType===1)a=b;else return null}return null};RTE.Cursor.getSelectedTable=function(){ULSdmo:;return RTE.Cursor.$8o("TABLE")};RTE.Cursor.$8o=function(f){ULSdmo:;var b=RTE.Cursor.get_range();if(!b.isValid())return null;for(var c=b.getParentChain(),a=0;a<c.length;a++){var d=c[a],e=d.tagName;if(e&&e===f)return d}return RTE.Cursor.$8p(f)};RTE.Cursor.getSelectedImage=function(){ULSdmo:;return RTE.Cursor.$8p("IMG")};RTE.Cursor.getSelectedLink=function(){ULSdmo:;return RTE.Cursor.$8o("A")};RTE.Cursor.getSelectedAtomic=function(){ULSdmo:;return RTE.Canvas.get_selectedAtomic()};RTE.Cursor.$Bu=function(b){ULSdmo:;var a=RTE.Canvas.getDirectAtomicParent(b);return RTE.Canvas.isInEditable(a)?RTE.Canvas.$50(a):null};RTE.Cursor.$BC=function(){ULSdmo:;var a=RTE.Cursor.get_range();if(!a.isValid())return null;a.fixMarkers();var d=a.parentElement(),c=RTE.Canvas.getDirectAtomicParent(d);if(c)return RTE.Canvas.$50(c);var b=RTE.Cursor.get_range().getSingleElement();return b&&RTE.Canvas.$t(b)?RTE.Canvas.$50(b):null};RTE.DirtyBitManager=function(){};RTE.DirtyBitManager.start=function(){ULSdmo:;var a=$get("ms-rtedirtybit");if(a&&a.value==="1")RTE.DirtyBitManager.$4G=true;RTE.DirtyBitManager.$3O=true};RTE.DirtyBitManager.stop=function(){ULSdmo:;RTE.DirtyBitManager.$3O=false};RTE.DirtyBitManager.isDirty=function(){ULSdmo:;if(RTE.DirtyBitManager.$3O)if(RTE.DirtyBitManager.$4G)return typeof rteRegionIsDirty==="boolean"&&rteRegionIsDirty?true:RTE.SnapshotManager.get_undoEnabled();return false};RTE.DirtyBitManager.cleanRTE=function(){ULSdmo:;if(!RTE.DirtyBitManager.$3O)return;RTE.DirtyBitManager.$4G=false};RTE.DirtyBitManager.$8D=function(){ULSdmo:;if(!RTE.DirtyBitManager.$3O)return;RTE.DirtyBitManager.$4G=true};RTE.DOMTreePosition=function(b,a){ULSdmo:;this.$0_0=b;this.$7_0=a};RTE.DOMTreePosition.prototype={$0_0:null,$7_0:0,$2v_0:null,$55_0:true,getCurrentNode:function(){ULSdmo:;return this.$0_0},setCurrentNode:function(a){ULSdmo:;this.$0_0=a},atStart:function(){ULSdmo:;return!this.$7_0},atEnd:function(){ULSdmo:;return RTE.RteUtility.isTextNode(this.$0_0)?this.$7_0===this.$0_0.nodeValue.length:this.$7_0===this.$0_0.childNodes.length},$Ao_0:function(a){ULSdmo:;return RTE.RteUtility.isTextNode(this.$0_0)?this.$7_0===this.$0_0.nodeValue.length:this.$7_0===a.length},move:function(a){ULSdmo:;return this.moveCount(a,1)},moveCount:function(c,b){ULSdmo:;var a;if(c)a=this.$9R_0(b);else a=this.$9T_0(b);return!a?false:this.$0_0.parentNode&&RTE.RteUtility.$9D(this.$0_0)?this.move(c):true},moveRight:function(){ULSdmo:;return this.moveCount(false,1)},moveLeft:function(){ULSdmo:;return this.moveCount(true,1)},$9T_0:function(a){ULSdmo:;var b=false;while(a>=0){if(this.$0_0&&RTE.RteUtility.isTextNode(this.$0_0)){b=false;var c=this.$0_0.nodeValue.length-this.$7_0;if(c>0)if(c<=a){this.$7_0+=c;a-=c}else{this.$7_0+=a;a=-1}else if(!this.moveToNextElement())return false}else{if(RTE.RteUtility.isNodeOfType(this.$0_0,RTE.HtmlTagName.blockElements)){if(!b){a--;b=true}if(a<0)return this.moveToPreviousElement()}else if(RTE.RteUtility.$3B(this.$0_0)||this.$0_0.className&&this.$0_0.className.indexOf("ms-rtestate-read")!==-1){b=false;a--;if(a<0)return this.moveToPreviousElement()}else b=false;if(!this.moveToNextElement())return false}if(this.$2v_0&&!this.$0_0.childNodes.length)this.$2v_0=null}return true},$9R_0:function(a){ULSdmo:;var b=false;while(a>=0){if(this.$0_0&&RTE.RteUtility.isTextNode(this.$0_0)&&this.$7_0>0){b=false;if(this.$7_0<=a){a-=this.$7_0;this.$7_0=0}else{this.$7_0-=a;a=-1}}else{if(RTE.RteUtility.isNodeOfType(this.$0_0,RTE.HtmlTagName.blockElements)){if(!b){a--;b=true}if(a<0)return this.moveToNextElement()}else if(RTE.RteUtility.$3B(this.$0_0)||this.$0_0.className&&this.$0_0.className.indexOf("ms-rtestate-read")!==-1){b=false;a--;if(a<0)return this.moveToNextElement()}else b=false;if(!this.moveToPreviousElement())return false}if(this.$2v_0&&!this.$0_0.childNodes.length)this.$2v_0=null}return true},normalize:function(){ULSdmo:;this.normalizeWithClassNameSearch(null)},normalizeWithClassNameSearch:function(a){ULSdmo:;if(!RTE.SU.isNullOrUndefined(this.$0_0)&&!RTE.RteUtility.isTextNode(this.$0_0)){var c=false;if(!RTE.SU.isNullOrUndefined(a)&&!RTE.SU.isNullOrUndefined(this.$0_0.className))c=this.$0_0.className.search(a)!==-1;if(!c){var b=this.$0_0.childNodes,d=b.length;if(d>0){if(d===this.$7_0&&this.$7_0>0){this.$0_0=b[this.$7_0-1];this.setLocationAtEnd();this.normalizeWithClassNameSearch(a)}else{this.$0_0=b[this.$7_0];this.setLocationAtStart();this.normalizeWithClassNameSearch(a)}this.$2v_0=null}}}},normalizeLeft:function(){ULSdmo:;var a=this.$0_0;while(a){if(a.style&&a.style.display==="none"){this.$0_0=a;this.setLocationAtStart()}a=a.parentNode}this.$9R_0(0)},normalizeRight:function(){ULSdmo:;var a=this.$0_0;while(a){if(a.style&&a.style.display==="none"){this.$0_0=a;this.setLocationAtEnd()}a=a.parentNode}this.$9T_0(0)},moveToPreviousElement:function(){ULSdmo:;var d=this.$0_0;if(!d)return false;if(this.atStart()){var c=d.parentNode;if(!c)c=this.$0_0.parentElement;if(!c)return false;var a=d.previousSibling;if(RTE.RteUtility.isInternetExplorer()){var g=c.uniqueID;if(!a||a.parentNode&&a.parentNode.uniqueID!==g){var e=c.childNodes;if(e[0]!==this.$0_0)for(var h=e.length,b=h-1;b>=0;b--){var i=e[b];if(i===d){b--;if(b>=0)a=e[b];else a=null;while(a&&a.parentNode&&a.parentNode.uniqueID===g){b--;if(b>=0)a=e[b];else a=null}break}}else a=null}}if(a){this.$0_0=a;this.setLocationAtEnd()}else{this.$0_0=c;this.setLocationAtStart()}}else{var f=d.childNodes;if(f&&f.length>0){this.$0_0=f[f.length-1];this.setLocationAtEnd()}else{this.setLocationAtStart();return this.moveToPreviousElement()}}return this.$55_0&&RTE.RteUtility.isTextNode(this.$0_0)&&!this.$0_0.nodeValue.length?this.moveToPreviousElement():!!this.$0_0},moveToNextElement:function(){ULSdmo:;var e=this.$0_0;if(!e)return false;var f=e.childNodes;if(this.$Ao_0(f)){var c=e.parentNode;if(!c)c=this.$0_0.parentElement;if(!c)return false;var a=e.nextSibling;if(RTE.RteUtility.isInternetExplorer()){var i=!!a,h=c.uniqueID;if(!a||a.parentNode&&a.parentNode.uniqueID!==h){a=null;var d=c.childNodes,g=d.length;if(d[g-1]!==this.$0_0)for(var b=0;b<g;b++){var j=d[b];if(j===this.$0_0){b++;if(g>b)a=d[b];else a=null;while(a&&a.parentNode&&a.parentNode.uniqueID!==h){b++;if(g>b)a=d[b];else a=null}break}}else a=null;if(!!(i^!!a))RTE.RteUtility.$5k=false}}if(a){this.$0_0=a;this.setLocationAtStart()}else{this.$0_0=c;this.setLocationAtEnd()}}else if(f&&f[0]){this.$0_0=f[0];this.setLocationAtStart()}else{this.setLocationAtEnd();return this.moveToNextElement()}return this.$55_0&&RTE.RteUtility.isTextNode(this.$0_0)&&!this.$0_0.nodeValue.length?this.moveToNextElement():!!this.$0_0},setLocationAtEnd:function(){ULSdmo:;this.$7_0=RTE.RteUtility.isTextNode(this.$0_0)?this.$0_0.nodeValue.length:this.$0_0.childNodes.length},setLocationAtStart:function(){ULSdmo:;this.$7_0=0},setLocation:function(a){ULSdmo:;if(a)this.setLocationAtStart();else this.setLocationAtEnd()},setOffset:function(a){ULSdmo:;this.$7_0=a},getOffset:function(){ULSdmo:;return this.$7_0},insertMarker:function(a){ULSdmo:;if(a===this.$0_0)return;this.removeNode(a);var b=this.$0_0.nodeType===1?this.$0_0:this.$0_0.parentNode;if(RTE.Canvas.$3C(b.tagName))return;if(!RTE.RteUtility.isTextNode(this.$0_0))if(RTE.RteUtility.$3B(this.$0_0))this.$0_0.parentNode.insertBefore(a,this.$0_0);else if(this.$7_0===this.$0_0.childNodes.length)try{this.$0_0.appendChild(a);this.$7_0=this.$0_0.childNodes.length}catch(e){this.$0_0.parentNode.insertBefore(a,this.$0_0)}else if(!this.$7_0)RTE.RteUtility.insertBefore(a,this.$0_0.childNodes[this.$7_0]);else{RTE.RteUtility.insertBefore(a,this.$0_0.childNodes[this.$7_0]);this.$0_0=a;this.$7_0=0;this.moveToNextElement()}else if(this.$0_0.nodeValue.length===this.$7_0)RTE.RteUtility.insertAfter(a,this.$0_0);else if(this.$7_0){var c=this.$0_0.nodeValue.substr(this.$7_0);this.$0_0.nodeValue=this.$0_0.nodeValue.substr(0,this.$7_0);RTE.RteUtility.insertAfter(a,this.$0_0);var d=window.document.createTextNode(c);RTE.RteUtility.insertAfter(d,a)}else RTE.RteUtility.insertBefore(a,this.$0_0)},removeNode:function(a){ULSdmo:;if(this.$0_0===a){this.moveToPreviousElement();RTE.RteUtility.removeNode(a)}else if(!RTE.RteUtility.isTextNode(this.$0_0))if(this.$7_0===this.$0_0.childNodes.length){RTE.RteUtility.removeNode(a);this.$7_0=this.$0_0.childNodes.length}else if(this.$7_0){var c=this.$0_0.childNodes[this.$7_0],e=this.$0_0.childNodes.length;RTE.RteUtility.removeNode(a);var d=this.$0_0.childNodes.length;if(c!==a&&e!==d)for(var b=0;b<d;b++)if(this.$0_0.childNodes[b]===c)this.$7_0=b}else RTE.RteUtility.removeNode(a);else RTE.RteUtility.removeNode(a)},clone:function(){ULSdmo:;return new RTE.DOMTreePosition(this.$0_0,this.$7_0)}};RTE.ExtractChildNodesProcessor=function(e,b,d,c,a){ULSdmo:;this.$3I_0=e;this.$40_0=b;this.$1P_0=d;this.$2d_0=c;this.$6y_0=a};RTE.ExtractChildNodesProcessor.prototype={$3x_0:false,$5L_0:false,$3w_0:false,$3I_0:null,$40_0:null,$1P_0:null,$2d_0:null,$2a_0:null,$6y_0:false,$3z_0:null,process:function(){ULSdmo:;this.$3x_0=false;this.$5L_0=false;this.$3w_0=false;this.$2a_0=[];while(this.$1P_0&&this.$1P_0.parentNode.firstChild===this.$1P_0&&this.$1P_0.parentNode!==this.$3I_0)this.$1P_0=this.$1P_0.parentNode;this.$3z_0=[];var a=this.$40_0;while(a!==this.$3I_0){this.$3z_0.push(a);a=a.parentNode}this.$7y_0(this.$3I_0);for(var b=0;b<this.$2a_0.length;b++){var c=this.$2a_0[b];if(c)this.$2d_0.appendChild(c);else this.$2d_0=this.$2d_0.parentNode}},$7y_0:function(d){ULSdmo:;if(this.$3x_0){if(!this.$3w_0){var e=[],a=d.parentNode;while(a!==this.$3I_0){e.push(a);a=a.parentNode}while(e.length>0){a=e.pop();var b;if(a.tagName==="A")b=a.ownerDocument.createElement("SPAN");else b=a.cloneNode(false);this.$2d_0.appendChild(b);this.$2d_0=b}this.$3w_0=true}Array.add(this.$2a_0,d)}else{for(var g=this.$3z_0.length>0?this.$3z_0.pop():null,f=0;f<d.childNodes.length;f++){var c=d.childNodes[f];if(c===this.$40_0){this.$3x_0=true;this.$6y_0&&Array.add(this.$2a_0,this.$40_0)}else if(this.$1P_0&&c===this.$1P_0){this.$5L_0=true;return}else if(this.$3x_0||!g||g===c){this.$7y_0(c);if(this.$5L_0)return}}this.$3w_0&&Array.add(this.$2a_0,null)}}};RTE.FontCssClassPrefix=function(){};RTE.FontCommands=function(){};RTE.FontCommands.$Aq=function(){ULSdmo:;RTE.FontCommands.$2u(0,["STRONG","B"],null,"fontWeight","bold","normal")};RTE.FontCommands.$Cy=function(){ULSdmo:;return RTE.FontCommands.$3N(0,["STRONG","B"],null,"fontWeight","bold","normal")};RTE.FontCommands.$CR=function(){ULSdmo:;RTE.FontCommands.$2u(0,["EM","I"],null,"fontStyle","italic","normal")};RTE.FontCommands.$Cz=function(){ULSdmo:;return RTE.FontCommands.$3N(0,["EM","I"],null,"fontStyle","italic","normal")};RTE.FontCommands.$Dn=function(){ULSdmo:;RTE.FontCommands.$2u(2,null,null,"textDecoration","line-through","none");RTE.Canvas.sendApplicationStateChangedEvent()};RTE.FontCommands.$D0=function(){ULSdmo:;return RTE.FontCommands.$3N(2,null,null,"textDecoration","line-through","none")};RTE.FontCommands.$Dp=function(){ULSdmo:;RTE.FontCommands.$f(0,["SUP"],null,null);RTE.FontCommands.$2u(0,["SUB"],null,null,null,null);RTE.Canvas.sendApplicationStateChangedEvent()};RTE.FontCommands.$D1=function(){ULSdmo:;return RTE.FontCommands.$3N(0,["SUB"],null,null,null,null)};RTE.FontCommands.$Dq=function(){ULSdmo:;RTE.FontCommands.$f(0,["SUB"],null,null);RTE.FontCommands.$2u(0,["SUP"],null,null,null,null);RTE.Canvas.sendApplicationStateChangedEvent()};RTE.FontCommands.$D2=function(){ULSdmo:;return RTE.FontCommands.$3N(0,["SUP"],null,null,null,null)};RTE.FontCommands.$Ds=function(){ULSdmo:;RTE.FontCommands.$2u(2,null,null,"textDecoration","underline","none");RTE.Canvas.sendApplicationStateChangedEvent()};RTE.FontCommands.$D3=function(){ULSdmo:;return RTE.FontCommands.$3N(2,null,null,"textDecoration","underline","none")};RTE.FontCommands.$Dc=function(a){ULSdmo:;RTE.FontCommands.$7o(3,null,null,"xml:lang",a,null);RTE.FontCommands.$7o(3,null,null,"lang",a,null)};RTE.FontCommands.getLanguage=function(){ULSdmo:;var c=RTE.Cursor.get_range();if(!c.isValid())return"";var b="",g=c.getCurrentStateNode(),a=g;while(a&&!RTE.Canvas.$S(a)){if(a.getAttribute){var d=a.getAttribute("lang");if(d){b=d;break}}a=a.parentNode}if(RTE.FontCommands.$6x){RTE.FontCommands.$6x=false;return b}if(b){var e=RTE.Canvas.getCurrentStyleSheetPrefix(),f=RTE.StyleRuleUtility.getStyleRules(e+RTE.RichTextEditor.languageClass+"-"+b,e,false);if(f.length>0)return RTE.StyleRuleUtility.getRuleDisplayName(f[0],null,null)}return b};RTE.FontCommands.get_$51=function(){ULSdmo:;var a=RTE.Canvas.getCurrentStyleSheetPrefix();return[a+"Style-"]};RTE.FontCommands.$DX=function(b,c){ULSdmo:;var a=2;if(c)a=1;RTE.FontCommands.$2t(a,null,["ForeColor","ThemeForeColor"],"color",b,"",null,RTE.FontCommands.get_$51(),1)};RTE.FontCommands.$DW=function(b,c){ULSdmo:;var a=2;if(c)a=1;RTE.FontCommands.$2t(a,null,["BackColor","ThemeBackColor"],"backgroundColor",b,"",null,RTE.FontCommands.get_$51(),1)};RTE.FontCommands.setStyle=function(b,c){ULSdmo:;if(!RTE.SU.isNullOrEmptyString(b)){var a=RTE.Canvas.getCurrentStyleSheetPrefix();if(c||RTE.SU.isUndefined(c)){var d=a+"Style-"+b;RTE.FontCommands.$2t(1,null,[a+"Style-",a+"BackColor-",a+"ForeColor-",a+"ThemeBackColor-",a+"ThemeForeColor-"],null,d,"",["color","backgroundColor"],null,1)}else RTE.FontCommands.$f(1,null,[a+"Style-"],null)}};RTE.FontCommands.getStyledElement=function(){ULSdmo:;var b=RTE.Cursor.get_range(),c=RTE.Canvas.currentEditableRegion(),a=b.parentElement();if(!a||a.nodeType!==1)return null;var d=a.tagName.toUpperCase();while(a&&a.nodeType===1&&RTE.RteUtility.getCssClassName(a).indexOf("Element")===-1&&!RTE.HtmlTagName.$66[d]&&a.parentNode!==c)a=a.parentNode;return a&&a.nodeType===1?a:null};RTE.FontCommands.getTextStyle=function(){ULSdmo:;return RTE.FontCommands.$Bk("Style")};RTE.FontCommands.$Bk=function(c){ULSdmo:;var b=RTE.Cursor.get_range(),a=b.parentElement();while(a&&!a.className&&a.className.indexOf(c)===-1&&a.tagName.toUpperCase()==="SPAN")a=a.parentNode;return a};RTE.FontCommands.createStyledElement=function(h,j){ULSdmo:;var d=RTE.Cursor.get_range(),i=d.getEditableRegion(),f="";if(!RTE.Canvas.getCachedRestriction(i,"UseInlineStyle",false))f=j;var k=d.$1_0,c=d.$2_0,e=RTE.RteUtility.getRealPreviousSibling(c,false);e&&e.nodeType===1&&e.tagName==="BR"&&e.parentNode.insertBefore(c,e);var a=new RTE.DOMTreePosition(k,0);a.moveToNextElement();if(a.$0_0!==c)while(a.$0_0!==c){var b=a.$0_0;if(!RTE.RteUtility.isBlockNode(b)&&!RTE.RteUtility.isStringInArray(b.parentNode.tagName.toUpperCase(),RTE.FontCommands.$9b)&&RTE.Canvas.isEditable(b)&&!RTE.RteUtility.isSvgNode(b)&&!RTE.RteUtility.$3F(b)&&!RTE.RteUtility.isEmptyTextNodeDeep(b,false)){var l=RTE.RteUtility.$8k(b,c,true),g=RTE.FontCommands.$7t(l,h,f);if(RTE.RteUtility.$M(c,g,i)||g.tagName==="HR")break;a.setCurrentNode(g);a.setLocationAtEnd()}a.moveToNextElement()}else{var m=RTE.RteUtility.$4z(d.$1_0,true);RTE.FontCommands.$7t(m,h,f)}d.resetCacheRange();RTE.Cursor.update()};RTE.FontCommands.$7t=function(a,h,e){ULSdmo:;var c=document.createElement(h);if(!RTE.SU.isNullOrEmptyString(e))c.className=e;var d=a.tagName.toUpperCase();RTE.SnapshotManager.setCurrentRegionDirtyIf(h!==a.tagName||!RTE.SU.isNullOrEmptyString(e)&&(RTE.SU.isNullOrEmptyString(a.className)||a.className.indexOf(e)===-1));if(d==="TR"||d==="THEAD"||d==="TBODY"||d==="TFOOT")a=RTE.RteUtility.getNearestParentElementOfType(a,"TABLE");var f=RTE.Cursor.get_range();if(h.toUpperCase()==="HR"){f.deleteContent();f.insertNode(c);f.moveAfterNode(c)}else{var b=null;if(d==="H1"||d==="H2"||d==="H3"||d==="H4"||d==="H5"||d==="H6"||d==="P"){b=document.createElement("DIV");a.parentNode.insertBefore(b,a);b.appendChild(a)}var g=new RTE.CanvasRange("block");g.moveToChildren(a);var i=RTE.RemoveStyleOnSelectionProcessor.$1S;i.setSettings(g,false);i.process();g.dispose();if(b)if(b.firstChild&&b.firstChild===b.lastChild&&RTE.RteUtility.isBlockNode(b.firstChild)&&RTE.SU.isNullOrEmptyString(b.className)&&RTE.SU.isNullOrEmptyString(b.style.cssText)){a=b.childNodes[0];RTE.RteUtility.$3T(b);b.parentNode.removeChild(b)}else a=b;if(RTE.Canvas.$S(a)){RTE.RteUtility.moveChildNodes(a,c);a.appendChild(c)}else if(a.tagName==="LI"||a.tagName==="TD"||a.tagName==="TH"){RTE.RteUtility.moveChildNodes(a,c);a.appendChild(c)}else if(a.tagName==="UL"||a.tagName==="OL"||a.tagName==="MENU"||a.tagName==="DIR"||a.tagName==="TABLE"){a.parentNode.insertBefore(c,a);c.appendChild(a)}else{a.parentNode.insertBefore(c,a);RTE.RteUtility.moveChildNodes(a,c);RTE.RteUtility.removeNode(a)}}return c};RTE.FontCommands.$7T=function(b,c){ULSdmo:;var a=2;if(c)a=1;RTE.FontCommands.$2t(a,null,["FontSize"],"fontSize",b,"",null,RTE.FontCommands.get_$51(),1)};RTE.FontCommands.$DZ=function(b,c){ULSdmo:;var a=2;if(c)a=1;RTE.FontCommands.$2t(a,null,["FontFace","ThemeFontFace"],"fontFamily",b,"",null,RTE.FontCommands.get_$51(),1)};RTE.FontCommands.$f=function(c,d,e,f){ULSdmo:;var a=RTE.Cursor.get_range();if(!a.get_isInEditableRegion())return;var b=RTE.ApplyOnSelectionProcessor.$1S;b.setSettings(a,c,d,e,f,null,null);b.remove();RTE.Cursor.update()};RTE.FontCommands.$2u=function(c,d,e,f,g,h){ULSdmo:;var a=RTE.Cursor.get_range();if(!a.get_isInEditableRegion())return;var b=RTE.ApplyOnSelectionProcessor.$1S;b.setSettings(a,c,d,e,f,g,h);b.process();RTE.Cursor.update()};RTE.FontCommands.$7o=function(a,b,c,d,e,f){ULSdmo:;RTE.FontCommands.$2t(a,b,c,d,e,f,null,null,0)};RTE.FontCommands.$2t=function(c,d,e,f,g,h,i,j,k){ULSdmo:;var a=RTE.Cursor.get_range();if(!a.get_isInEditableRegion())return;var b=RTE.ApplyOnSelectionProcessor.$1S;b.setSettings(a,c,d,e,f,g,h,i,k,j);b.apply();RTE.Cursor.update()};RTE.FontCommands.$3N=function(d,e,f,g,h,i){ULSdmo:;var c=new RTE.CommandState,a=RTE.Cursor.get_range();if(!a.isValid()||!a.get_isInEditableRegion())return c;var b=RTE.ApplyOnSelectionProcessor.$1S;b.setSettings(a,d,e,f,g,h,i);return b.queryApply()};RTE.FontCommands.$A3=function(){ULSdmo:;var a=RTE.Cursor.get_range();if(!a.get_isInEditableRegion())return;if(!a.isVisible())return;var b=RTE.RemoveStyleOnSelectionProcessor.$1S;b.setSettings(a,true);b.process();RTE.Cursor.get_range().resetCacheRange();RTE.Cursor.update();RTE.Canvas.sendApplicationStateChangedEvent()};RTE.FontCommands.$A6=function(d,b){ULSdmo:;var k=RTE.Cursor.get_range();if(!k.isValid())return"";var l=k.getCurrentStateNode(),e=null,c=null,a=l;while(a){if(a.style&&!RTE.SU.isNullOrEmptyString(a.style[b]))break;else if(a.className&&RTE.RteUtility.$2S(d,RTE.RteUtility.getCssClassName(a)))for(var n=a.className.split(" "),u=n.length,f=0;f<u;f++)for(var g=n[f],v=d.length,h=0;h<v;h++){var o=g.indexOf(d[h]);if(o!==-1){e=g;c=g.substr(0,o);a=null;break}}if(a)a=a.parentNode}if(e){var p=RTE.StyleRuleUtility.getStyleRules(e,c,true);if(p.length>0)return RTE.StyleRuleUtility.getRuleDisplayName(p[0],null,b)}if(RTE.SU.isNullOrEmptyString(b))return"";var s=RTE.RteUtility.getCurrentStyle(l),m=RTE.StyleRuleUtility.$6J(s,b);c=RTE.Canvas.getCurrentStyleSheetPrefix();for(var t=d.length,i=0;i<t;i++)for(var q=RTE.StyleRuleUtility.getStyleRules(c+d[i],c,true),w=q.length,j=0;j<w;j++){var r=q[j],x=RTE.StyleRuleUtility.$6J(r.rule.style,b);if(x.toUpperCase()===m.toUpperCase())return RTE.StyleRuleUtility.getRuleDisplayName(r,null,b)}return m};RTE.FontCommands.getFontSize=function(){ULSdmo:;var a=RTE.FontCommands.$A6(["FontSize"],"fontSize");if(RTE.FontCommands.$6v!==a){RTE.FontCommands.$6v=a;var b=RTE.RteUtility.parseUnitValue(a);if(b&&!RTE.SU.isNullOrEmptyString(b.unit))RTE.FontCommands.$6w=b.unit}return a};RTE.FontCommands.getFontFamily=function(){ULSdmo:;return RTE.FontCommands.$A6(["ThemeFontFace","FontFace"],"fontFamily")};RTE.HtmlCleanup=function(){};RTE.HtmlCleanup.$DF=function(a){ULSdmo:;RTE.HtmlCleanup.$A1(a,true,false,true,false)};RTE.HtmlCleanup.$A0=function(a,b,c,d){ULSdmo:;RTE.HtmlCleanup.$A1(a,b,c,d,true)};RTE.HtmlCleanup.$A1=function(b,c,d,e,f){ULSdmo:;RTE.RteUtility.removeRteNodeIdAll(b);var a=new RTE.HtmlCleanupArgs;a.containerElement=b;a.deleteNodes=c;a.checkContainer=d;a.scrub=e;a.itemsRemoved=false;RTE.CanvasEvents.dispatchSafeHtmlCleanup(a);f&&RTE.RteUtility.forEachChildWithTagAndClass(b,null,"ms-rtestate-notify",function(b){ULSdmo:;var a={};a.node=b;RTE.CanvasEvents.dispatchEvent("ElementAdded","html",a)});return a.itemsRemoved};RTE.HtmlFormat=function(){};RTE.HtmlFormat.formatHtml=function(b){ULSdmo:;var d=new RTE.HtmlAndSelection;try{b=RTE.RteUtility.$DB(b);var g=new Sys.StringBuilder,a=0,h=null,e=[],p=b.search(RTE.HtmlFormat.$8A),q=b.search(RTE.HtmlFormat.$88),m=-1,n=-1,r=false,i=false,f=-1;do{var c=b.indexOf("<"+(h?"/"+h:""),a),v=p!==-1&&c===p||q!==-1&&c===q;if(c!==a){var w=c!==-1?c:b.length,j=b.substring(a,w);j=!h&&f===-1?RTE.HtmlFormat.$DI(j):j;r=RTE.HtmlFormat.$Ac(g,j);if(c===-1)break;a=c;if(f===-1&&j.trim().length>0||f!==-1&&j.length>0)i=false}if(v){if(p===c)m=g.toString().length;if(q===c)n=g.toString().length;a=b.indexOf("</span>",a);if(a===-1)break;a+=7}else if(b.indexOf("/",a)===a+1){h=null;a++;var s=b.indexOf(">",c),o=b.substring(a+1,s);if(RTE.HtmlFormat.$CN(e,o))while(e.length>0&&e.pop()!==o);if(f>e.length)f=-1;RTE.HtmlFormat.$Aa(g,e.length,o,i);a=s+1;i=RTE.RteUtility.$3p(o)}else{h=null;var k=b.indexOf(">",c),x=b.indexOf("/",k-1)===k-1,t=b.substring(a+1,k).replace(RTE.HtmlFormat.$7A,"");RTE.HtmlFormat.$Ab(g,e.length,t,r||i);if(!x){i=false;var u=b.indexOf(" ",c),l=b.substring(a+1,u!==-1?Math.min(k,u):k);if(!RTE.HtmlFormat.$CG(l)){h=RTE.HtmlFormat.$CL(l)?l:null;e.push(l);i=RTE.RteUtility.$3p(l);if(f===-1)if(l.toUpperCase()==="PRE"||RTE.HtmlFormat.$AT.test(t))f=e.length}}a=k+1}}while(a!==-1&&a<b.length);d.html=g.toString();if(m!==-1&&n!==-1&&(m!==n||m!==d.html.length)){d.selectionStart=m;d.selectionEnd=n}}catch(y){d.html=RTE.RteUtility.removeEmptySpanAndRteIds(b,false,false);d.selectionStart=0;d.selectionEnd=0}return d};RTE.HtmlFormat.$CN=function(c,d){ULSdmo:;for(var b=c,a=b.length-1;a>=0;a--)if(b[a]===d)return true;return false};RTE.HtmlFormat.$CL=function(a){ULSdmo:;if(!RTE.HtmlFormat.$2C){RTE.HtmlFormat.$2C={};RTE.HtmlFormat.$2C.SCRIPT=null;RTE.HtmlFormat.$2C.XML=null;RTE.HtmlFormat.$2C.STYLE=null}return!RTE.SU.isUndefined(RTE.HtmlFormat.$2C[a.toUpperCase()])};RTE.HtmlFormat.getSkipTags=function(){ULSdmo:;var a=new Array(0),b=RTE.HtmlFormat.$2C.getEnumerator();while(b.moveNext()){var c=b.get_current();a[a.length]=c}return a};RTE.HtmlFormat.$CG=function(a){ULSdmo:;if(!RTE.HtmlFormat.$2Q){RTE.HtmlFormat.$2Q={};RTE.HtmlFormat.$2Q.BR=null;RTE.HtmlFormat.$2Q.IMG=null;RTE.HtmlFormat.$2Q.HR=null}return!RTE.SU.isUndefined(RTE.HtmlFormat.$2Q[a.toUpperCase()])};RTE.HtmlFormat.$Ac=function(b,a){ULSdmo:;if(!RTE.SU.isNullOrEmptyString(a)){b.append(a);return a.endsWith(" ")}return false};RTE.HtmlFormat.$Ab=function(a,d,b,e){ULSdmo:;var c=b.split(" ")[0];if(e||RTE.RteUtility.$3p(c)&&!a.isEmpty()){a.append("\n");RTE.HtmlFormat.$8U(a,d)}a.append("<"+b+">")};RTE.HtmlFormat.$Aa=function(a,c,b,d){ULSdmo:;if(d&&RTE.RteUtility.$3p(b)){a.append("\n");RTE.HtmlFormat.$8U(a,c)}a.append("</"+b.trim()+">")};RTE.HtmlFormat.$8U=function(b,c){ULSdmo:;for(var a=0;a<c;a++)b.append("   ")};RTE.HtmlFormat.$DI=function(f){ULSdmo:;for(var c=f.split(RTE.HtmlFormat.$7A),b=0;b<c.length;b++){var a=c[b],d=!b,e=b===c.length-1;if(!d&&!e)a=a.trim();else if(d&&!e)a=a.trimEnd();else if(!d)a=a.trimStart();if(a.length>0&&!e)a=a+" ";c[b]=a}var g=f.startsWith("\n")?" ":"",h=c.join("");return g+h};RTE.HtmlAndSelection=function(){};RTE.HtmlAndSelection.prototype={html:null,selectionStart:0,selectionEnd:0};RTE.MovementKeys=function(){};RTE.MovementKeys.initializeDictionary=function(){ULSdmo:;if(!RTE.SU.isNullOrUndefined(RTE.MovementKeys.$l))return;RTE.MovementKeys.$l={};RTE.MovementKeys.$l[String.fromCharCode(9)]=null;RTE.MovementKeys.$l[String.fromCharCode(37)]=null;RTE.MovementKeys.$l[String.fromCharCode(39)]=null;RTE.MovementKeys.$l[String.fromCharCode(38)]=null;RTE.MovementKeys.$l[String.fromCharCode(40)]=null;RTE.MovementKeys.$l[String.fromCharCode(36)]=null;RTE.MovementKeys.$l[String.fromCharCode(35)]=null;RTE.MovementKeys.$l[String.fromCharCode(34)]=null;RTE.MovementKeys.$l[String.fromCharCode(33)]=null;RTE.MovementKeys.$l[String.fromCharCode(127)]=null;RTE.MovementKeys.$l[String.fromCharCode(8)]=null};RTE.MovementKeys.isMovementKey=function(a){ULSdmo:;return!RTE.SU.isUndefined(RTE.MovementKeys.$l[String.fromCharCode(a.keyCode)])};RTE.SelectionClearingKeys=function(){};RTE.SelectionClearingKeys.initializeDictionary=function(){ULSdmo:;if(!RTE.SU.isNullOrUndefined(RTE.SelectionClearingKeys.$e))return;RTE.SelectionClearingKeys.$e={};RTE.SelectionClearingKeys.$e[String.fromCharCode(37)]=null;RTE.SelectionClearingKeys.$e[String.fromCharCode(39)]=null;RTE.SelectionClearingKeys.$e[String.fromCharCode(38)]=null;RTE.SelectionClearingKeys.$e[String.fromCharCode(40)]=null;RTE.SelectionClearingKeys.$e[String.fromCharCode(36)]=null;RTE.SelectionClearingKeys.$e[String.fromCharCode(35)]=null;RTE.SelectionClearingKeys.$e[String.fromCharCode(34)]=null;RTE.SelectionClearingKeys.$e[String.fromCharCode(33)]=null;RTE.SelectionClearingKeys.$e[String.fromCharCode(27)]=null;RTE.SelectionClearingKeys.$e[String.fromCharCode(16)]=null;RTE.SelectionClearingKeys.$e[String.fromCharCode(17)]=null;RTE.SelectionClearingKeys.$e[String.fromCharCode(18)]=null};RTE.SelectionClearingKeys.isSelectionClearKey=function(a){ULSdmo:;return!a.ctrlKey&&!a.altKey&&RTE.SU.isUndefined(RTE.SelectionClearingKeys.$e[String.fromCharCode(a.keyCode)])};RTE.LayoutsEditor=function(a){ULSdmo:;this.$2b_0=a;this.$3K_0=a.id;this.$V_0=a.ownerDocument;this.$Y_0=[]};RTE.LayoutsEditor.create=function(b){ULSdmo:;if(null===RTE.LayoutsEditor.$2A)RTE.LayoutsEditor.$2A={};var a=null;if(null!==b){a=new RTE.LayoutsEditor(b);a.$C7_0();RTE.LayoutsEditor.$2A[b.id]=a}return a};RTE.LayoutsEditor.getLayoutsEditorForRegion=function(a){ULSdmo:;return RTE.SU.isNullOrUndefined(a)||RTE.SU.isNullOrUndefined(RTE.LayoutsEditor.$2A)?null:RTE.LayoutsEditor.$2A[a.id]};RTE.LayoutsEditor.relayoutRegion=function(a,c,e,d,f){ULSdmo:;if(!RTE.SU.isNullOrUndefined(a))if(RTE.LayoutsEditor.$2A){var b=RTE.LayoutsEditor.$2A[a.id];if(!RTE.SU.isNullOrUndefined(b))b.$D6_0(c,e,d,f);else RTE.UiServices.$I.showError(2)}else RTE.UiServices.$I.showError(2)};RTE.LayoutsEditor.prototype={$3K_0:null,$2b_0:null,$V_0:null,$u_0:null,$O_0:null,$k_0:false,$p_0:false,$9_0:0,$11_0:null,$10_0:null,$Y_0:null,$C7_0:function(){ULSdmo:;this.$u_0=$get(this.$3K_0+"_layoutsData");this.$O_0=$get(this.$3K_0+"_layoutsTable");if(null===this.$u_0||null===this.$O_0||this.$O_0.tagName!=="TABLE"){this.$u_0&&RTE.RteUtility.removeNode(this.$u_0);this.$O_0&&this.$8O_0(this.$O_0);this.$k_0=false;this.$p_0=false;this.$9_0=1;var a=RTE.LayoutsZone.$44(this.$V_0);RTE.RteUtility.moveChildNodes(this.$2b_0,a.$N_0);a.$AA_0();this.$Y_0[0]=a;this.$69_0();this.$u_0=this.$V_0.createElement("SPAN");this.$u_0.id=this.$3K_0+"_layoutsData";this.$u_0.style.display="none";RTE.RteUtility.setInnerText(this.$u_0,"false,false,1");this.$2b_0.appendChild(this.$O_0);this.$2b_0.appendChild(this.$u_0);!RTE.SU.isNullOrEmptyString(this.$2b_0.style.minHeight)&&a.set_$CX_0(this.$2b_0.style.minHeight)}else this.validateLayouts()},$69_0:function(){ULSdmo:;this.$O_0=this.$V_0.createElement("TABLE");this.$O_0.style.width="100%";this.$O_0.id=this.$3K_0+"_layoutsTable";var b=this.$V_0.createElement("TBODY");this.$O_0.appendChild(b);var a;if(this.$k_0){a=this.$V_0.createElement("TR");b.appendChild(a);this.$11_0.$12_0.colSpan=this.$9_0;a.style.verticalAlign="top";a.appendChild(this.$11_0.$12_0)}a=this.$V_0.createElement("TR");a.style.verticalAlign="top";b.appendChild(a);for(var c=0;c<this.$9_0;c++)a.appendChild(this.$Y_0[c].$12_0);if(this.$p_0){a=this.$V_0.createElement("TR");b.appendChild(a);this.$10_0.$12_0.colSpan=this.$9_0;a.style.verticalAlign="top";a.appendChild(this.$10_0.$12_0)}},validateLayouts:function(){ULSdmo:;var b=this.$u_0.innerHTML,a=b.split(",");this.$k_0="true"===a[0].trim().toLowerCase();this.$p_0="true"===a[1].trim().toLowerCase();this.$9_0=parseInt(a[2].trim());if(isNaN(this.$9_0)||this.$9_0<1)this.$9_0=1;if(this.$9_0>3)this.$9_0=3;this.$Dz_0()},$8O_0:function(a){ULSdmo:;var d=a.childNodes;if(d.length){var c=d[0];while(c)c=this.$8O_0(c)}var b=a;if(a.id&&(a.id.indexOf("layoutsTable")>=0||a.id.indexOf("layoutsData")>=0)||a.className&&(a.className.indexOf("ms-rtestate-write")>=0||a.className.indexOf("ms-rte-layoutszone-inner-editable")>=0||a.className.indexOf("ms-rte-layoutszone-inner")>=0||a.className.indexOf("ms-rte-layoutszone-outer")>=0)){b=a.lastChild;RTE.RteUtility.removeNodeAndKeepChildNodes(a)}b=b.nextSibling;return b},$Dz_0:function(){ULSdmo:;var a,b=0;if(this.$k_0){a=this.$O_0.rows[b++];this.$11_0=RTE.LayoutsZone.$5T(a.cells[0]);if(!this.$11_0)this.$k_0=false}a=this.$O_0.rows[b];if(a.cells.length===this.$9_0){this.$Y_0=[];for(var c=0,e=0;e<a.cells.length;e++){this.$Y_0[c]=RTE.LayoutsZone.$5T(a.cells[e]);if(!this.$Y_0[c]){c--;this.$9_0--}c++}}else{if(a.cells.length<this.$9_0)this.$9_0=a.cells.length;else if(a.cells.length>=3)this.$9_0=3;else this.$9_0=a.cells.length;for(var f=0,d=0;d<this.$9_0;d++){this.$Y_0[d]=RTE.LayoutsZone.$5T(a.cells[d]);if(!this.$Y_0[f]){f--;this.$9_0--}f++}}if(this.$9_0<1){this.$9_0=1;this.$Y_0[0]=RTE.LayoutsZone.$44(this.$O_0.ownerDocument)}b++;if(this.$p_0){a=this.$O_0.rows[b++];this.$10_0=RTE.LayoutsZone.$5T(a.cells[0]);if(!this.$10_0)this.$p_0=false}var g=this.$O_0;this.$69_0();g.parentNode.replaceChild(this.$O_0,g);RTE.RteUtility.setInnerText(this.$u_0,this.$k_0+","+this.$p_0+","+this.$9_0.toString())},get_parentLayoutsContainer:function(){ULSdmo:;return this.$O_0},$D6_0:function(n,w,x,o){ULSdmo:;if(n<0||n>3)throw Error.argumentOutOfRange("newNumColumns");var y=this.$k_0,z=this.$p_0,u=this.$9_0,A=this.$11_0,B=this.$10_0,C=this.$Y_0,p=this.$O_0,f=[];if(this.$k_0)f[0]=this.$11_0;for(var j=0;j<this.$9_0;j++)f[1+j]=this.$Y_0[j];if(this.$p_0)f[4]=this.$10_0;this.$k_0=w;this.$p_0=x;this.$9_0=n;if(isNaN(this.$9_0)||this.$9_0<1)this.$9_0=u;var c=[];if(this.$k_0){this.$11_0=RTE.LayoutsZone.$44(this.$V_0);c[0]=this.$11_0}for(var g=0;g<this.$9_0;g++){this.$Y_0[g]=RTE.LayoutsZone.$44(this.$V_0);c[g+1]=this.$Y_0[g]}if(this.$p_0){this.$10_0=RTE.LayoutsZone.$44(this.$V_0);c[4]=this.$10_0}for(var k=0;k<5;k++){var q=f[k],r=c[k];!RTE.SU.isNullOrUndefined(q)&&!RTE.SU.isNullOrUndefined(r)&&q.$47_0(r,true)}for(var b=0;b<5;b++){var h=f[b],v=c[b];if(!RTE.SU.isNullOrUndefined(h)&&RTE.SU.isNullOrUndefined(v)){for(var d=null,l=0,e=null,i=0,l=0;b-l>=0;l++){d=c[b-l];if(!RTE.SU.isNullOrUndefined(d))break}for(i=0;b+i<5;i++){e=c[b+i];if(!RTE.SU.isNullOrUndefined(e))break}if(d&&e)if(l<=i)h.$47_0(d,true);else h.$47_0(e,false);else if(d)h.$47_0(d,true);else e&&h.$47_0(e,false)}}var a=null;if(this.$k_0){a=this.$11_0;this.$11_0.$12_0.colSpan=this.$9_0}if(!this.$k_0&&!this.$p_0&&1===this.$9_0){var s=this.$Y_0[0];s.$AA_0();if(!a)a=s}else{o=o&&2===this.$9_0;for(var m=0;m<this.$9_0;m++){var t=this.$Y_0[m];t.$DV_0(m,this.$9_0,o);if(!a)a=t}}if(this.$p_0){this.$10_0.$12_0.colSpan=this.$9_0;if(!a)a=this.$10_0}this.$69_0();p.parentNode.replaceChild(this.$O_0,p);RTE.RteUtility.setInnerText(this.$u_0,this.$k_0+","+this.$p_0+","+this.$9_0.toString());if(a){RTE.Cursor.get_range().$CY_0(a.$N_0);RTE.Cursor.update()}},$8g_0:function(){ULSdmo:;var a;if(this.$k_0)a=this.$11_0.$N_0;else if(this.$9_0>0)a=this.$Y_0[0].$N_0;else a=this.$10_0.$N_0;return a}};RTE.LayoutsZone=function(b,c,d,a){ULSdmo:;this.$V_0=b;this.$12_0=c;this.$6z_0=d;this.$N_0=a;Sys.UI.DomElement.addCssClass(a,"ms-rtestate-write");RTE.Canvas.makeRegionEditable(a);this.$6z_0.style.width="100%"};RTE.LayoutsZone.$44=function(b){ULSdmo:;var d=b.createElement("TD"),a=b.createElement("DIV"),c=b.createElement("DIV");a.appendChild(c);Sys.UI.DomElement.addCssClass(c,"ms-rte-layoutszone-inner-editable");Sys.UI.DomElement.addCssClass(a,"ms-rte-layoutszone-outer");d.appendChild(a);var e=new RTE.LayoutsZone(b,d,a,c);return e};RTE.LayoutsZone.$5T=function(b){ULSdmo:;if(!b)return null;if(b.tagName!=="TD")return null;var c=b;b=c.firstChild;var a=document.createElement("DIV");Sys.UI.DomElement.addCssClass(a,"ms-rte-layoutszone-outer");var d=document.createElement("DIV");Sys.UI.DomElement.addCssClass(d,"ms-rte-layoutszone-inner-editable");if(!b){c.appendChild(a);a.appendChild(d);return new RTE.LayoutsZone(window.document,c,a,d)}else{b=RTE.LayoutsZone.$9l(c.childNodes,a);c.appendChild(b)}if(!b.firstChild){c.appendChild(a);a.appendChild(d);return new RTE.LayoutsZone(b.ownerDocument,c,a,d)}else a.appendChild(RTE.LayoutsZone.$9l(a.childNodes,d));var e=new RTE.LayoutsZone(b.ownerDocument,c,a,d);return e};RTE.LayoutsZone.$9l=function(c,b){ULSdmo:;var a=c[0];while(a){if(!RTE.LayoutsZone.$CQ(a))if("DIV"===a.tagName&&a.className&&(Sys.UI.DomElement.containsCssClass(a,"ms-rte-layoutszone-inner")||Sys.UI.DomElement.containsCssClass(a,"ms-rte-layoutszone-inner-editable")||Sys.UI.DomElement.containsCssClass(a,"ms-rte-layoutszone-outer"))){RTE.RteUtility.moveChildNodes(a,b);RTE.RteUtility.removeNode(a)}else b.appendChild(a);else RTE.RteUtility.removeNode(a);a=c[0]}return b};RTE.LayoutsZone.$CQ=function(a){ULSdmo:;return RTE.RteUtility.isTextNode(a)&&(RTE.SU.isNullOrUndefined(a.nodeValue)||RTE.SU.isNullOrEmptyString(a.nodeValue.trim()))};RTE.LayoutsZone.prototype={$V_0:null,$12_0:null,$6z_0:null,$N_0:null,$47_0:function(a,c){ULSdmo:;var b=!a.$N_0.childNodes.length;if(c){if(!b){a.$61_0(this.$V_0.createElement("BR"));a.$61_0(this.$V_0.createElement("BR"))}while(this.$N_0.childNodes.length>0)a.$61_0(this.$N_0.childNodes[0])}else{if(!b){a.$N_0.insertBefore(this.$V_0.createElement("BR"),a.$N_0.firstChild);a.$N_0.insertBefore(this.$V_0.createElement("BR"),a.$N_0.firstChild)}while(this.$N_0.childNodes.length>0)a.$N_0.insertBefore(this.$N_0.lastChild,a.$N_0.firstChild)}},set_$CX_0:function(a){ULSdmo:;this.$N_0.style.minHeight=a;return a},$61_0:function(a){ULSdmo:;this.$N_0.appendChild(a)},$AA_0:function(){ULSdmo:;this.$12_0.style.width="100%"},$DV_0:function(b,d,c){ULSdmo:;var a;if(c&&0===b)a=66.6;else if(c&&1===b)a=33.3;else a=99.9/d;this.$12_0.style.width=a.toString()+"%";if(b>0)this.$12_0.className="ms-wiki-columnSpacing"}};RTE.NodeDictionaryCache=function(){ULSdmo:;this.$5l_0={}};RTE.NodeDictionaryCache.prototype={addEntry:function(a,c){ULSdmo:;if(RTE.RteUtility.isValidRteNodeId(a)){var b=RTE.RteUtility.getRteNodeId(a);this.$5l_0[b]=c}},getEntry:function(a){ULSdmo:;if(RTE.RteUtility.isValidRteNodeId(a)){var b=RTE.RteUtility.getRteNodeId(a);return this.$5l_0[b]}return null},clearEntry:function(a){ULSdmo:;if(RTE.RteUtility.isValidRteNodeId(a)){var b=RTE.RteUtility.getRteNodeId(a);delete this.$5l_0[b]}}};RTE.ElementCommands=function(){};RTE.ElementCommands.insertOrUpdateImage=function(c){ULSdmo:;var d=c.href,e=c.altText,a=RTE.CanvasEvents.getNodeFromEvent("Image");if(null!==a){a.src=d;a.alt=e}else{var b=RTE.Cursor.get_range();b.deleteContent();var f=b.parentElement();if(!f)return;a=f.ownerDocument.createElement("IMG");RTE.RteUtility.initImage(a);a.src=d;a.alt=e;b.insertNode(a)}RTE.Cursor.get_range().moveToNode(a);RTE.RteUtility.showUiExperience(2);RTE.Cursor.update();RTE.Canvas.sendApplicationStateChangedEvent()};RTE.ElementCommands.insertOrUpdateLink=function(d){ULSdmo:;var b=RTE.Cursor.get_range(),e=b.parentElement();if(!e)return;var f=d.href,c=d.text||"",a=e.ownerDocument.createElement("A");a.href=f;if(b.isEmpty()){RTE.RteUtility.setInnerText(a,c.trim()!==""?c:f);b.insertBefore(a)}else{if(RTE.Cursor.getSelectedImage())a.title=c;else c.trim()!==""&&b.replaceHtml(c);b.wrapRange(a)}b.moveToEndOfNode(a);d.fixLinkHierarchy&&RTE.RteUtility.fixLinkHierarchy(a);RTE.Cursor.update();RTE.RteUtility.showUiExperience(1)};RTE.ParagraphCommands=function(){};RTE.ParagraphCommands.$CA=function(b,a){ULSdmo:;switch(b){case 2:return a==="center"||a==="-moz-center";case 3:return a==="justify";case 0:return a==="left"||a==="-moz-left";case 1:return a==="right"||a==="-moz-right"}return false};RTE.ParagraphCommands.queryAlign=function(d){ULSdmo:;var a=new RTE.CommandState,b=RTE.Cursor.getCurrentElement();if(b){a.$D_0=true;var c=RTE.RteUtility.getCurrentStyle(RTE.Cursor.get_range().$1_0).textAlign;a.$j_0=RTE.ParagraphCommands.$CA(d,c)}return a};RTE.ParagraphCommands.setDirection=function(a){ULSdmo:;var b=a?"ltr":"rtl";RTE.ParagraphCommands.$7Q("direction",b,"dir",true);var c=a?"left":"right";RTE.ParagraphCommands.$7Q("textAlign",c,"align",false)};RTE.ParagraphCommands.$7Q=function(i,j,k,h){ULSdmo:;var l=RTE.Cursor.get_range();if(!l.get_isEditable())return false;var c=RTE.Cursor.$Bh();if(!RTE.Canvas.isEditable(c))return false;var e=h?k:i;if(l.isEmpty()){c=RTE.RteUtility.$4z(l.$1_0,true);i==="direction"&&RTE.ParagraphCommands.$7Y(c);RTE.ParagraphCommands.$60(c,e,j,h)}else{var b=RTE.Cursor.get_range().$1_0,d=RTE.Cursor.get_range().$2_0,g=RTE.RteUtility.getRealPreviousSibling(d,false);g&&g.nodeType===1&&g.tagName==="BR"&&g.parentNode.insertBefore(d,g);if(!RTE.SU.isNullOrUndefined(b.nextSibling)&&b.nextSibling.tagName==="TABLE"){var m=b.nextSibling.querySelector("TH, TD");m.insertBefore(b,m.firstChild)}var a=new RTE.DOMTreePosition(b,0);if(b.parentNode===RTE.Canvas.getEditableRegion(b)){var n=RTE.RteUtility.getRealNextSibling(b,false);a=new RTE.DOMTreePosition(n,0)}else a=new RTE.DOMTreePosition(b,0);while(a.$0_0){var f=RTE.RteUtility.$4z(a.$0_0,true);RTE.ParagraphCommands.$6D(f,i,k,true);i==="direction"&&RTE.ParagraphCommands.$7Y(f);RTE.ParagraphCommands.$60(f,e,j,h);RTE.ParagraphCommands.$68(f.parentNode,e,j,k,e,h);a.setCurrentNode(f);a.setLocationAtEnd();if(RTE.RteUtility.$M(d,f,c))break;while(a.atEnd()&&!RTE.RteUtility.$M(d,a.$0_0,c)&&a.$0_0!==d)a.moveToNextElement();if(a.$0_0.firstChild===d||a.$0_0===d)break;a.normalize()}}RTE.ParagraphCommands.$68(c,e,j,k,e,h);RTE.Cursor.get_range().resetCacheRange();RTE.Cursor.update();return true};RTE.ParagraphCommands.$7Y=function(b){ULSdmo:;if(b.style&&b.style.cssText){var a=b.style.cssText.toLowerCase();if(a.indexOf("right")!==-1||a.indexOf("left")!==-1||a.indexOf("rtl")!==-1||a.indexOf("ltr")!==-1){a=a.replace("right","ms-oldright");a=a.replace("left","right");a=a.replace("ms-oldright","left");a=a.replace("rtl","ms-oldrtl");a=a.replace("ltr","rtl");a=a.replace("ms-oldrtl","ltr");b.style.cssText=a;RTE.SnapshotManager.setCurrentRegionDirty()}}for(var c=0;c<b.childNodes.length;c++)RTE.ParagraphCommands.$7Y(b.childNodes[c])};RTE.ParagraphCommands.$60=function(b,c,d,f){ULSdmo:;var a=f?b:b.style,e=a[c];a[c]=d;RTE.SnapshotManager.setCurrentRegionDirtyIf(e!==d)};RTE.ParagraphCommands.$AZ=function(c,g,d,h,i){ULSdmo:;for(var b=0;b<c.childNodes.length;b++){var a=c.childNodes[b];if(i){var e=a[h];if(e!==d)return false}else{if(!a.style)a=a.parentNode;var f=a.style[g];if(f!==d)return false}}return true};RTE.ParagraphCommands.$68=function(a,d,e,b,g,f){ULSdmo:;if(!RTE.Canvas.isEditable(a.parentNode))return;var h=RTE.ParagraphCommands.$AZ(a,d,e,b,f);if(!h&&(b!=="direction"||b==="direction"&&a.tagName!=="OL"&&a.tagName!=="UL"))return;for(var c=0;c<a.childNodes.length;c++){var i=a.childNodes[c];RTE.ParagraphCommands.$6D(i,d,b,false)}RTE.ParagraphCommands.$60(a,g,e,f);RTE.ParagraphCommands.$68(a.parentNode,d,e,b,g,f)};RTE.ParagraphCommands.$6D=function(a,d,b,e){ULSdmo:;if(a.nodeType===1){if(e&&a.childNodes.length>0)for(var c=0;c<a.childNodes.length;c++)RTE.ParagraphCommands.$6D(a.childNodes[c],d,b,e);if(!RTE.SU.isNullOrEmptyString(a.style[d]))a.style[d]="";!RTE.SU.isNullOrEmptyString(b)&&a.getAttribute(b)&&a.removeAttribute(b)}};RTE.ParagraphCommands.queryDirection=function(d){ULSdmo:;var a=new RTE.CommandState,c=RTE.Cursor.getCurrentElement();if(!c)return a;a.$D_0=true;var b=RTE.RteUtility.getCurrentStyle(RTE.Cursor.get_range().$1_0);if(d)a.$j_0=b.direction==="ltr";else a.$j_0=b.direction==="rtl";return a};RTE.ParagraphCommands.queryBulletedList=function(){ULSdmo:;return RTE.Canvas.$8K("InsertUnorderedList")};RTE.ParagraphCommands.bulletedList=function(){ULSdmo:;RTE.ParagraphCommands.$8S("UL","InsertUnorderedList")};RTE.ParagraphCommands.queryNumberedList=function(){ULSdmo:;return RTE.Canvas.$8K("InsertOrderedList")};RTE.ParagraphCommands.numberedList=function(){ULSdmo:;RTE.ParagraphCommands.$8S("OL","InsertOrderedList")};RTE.ParagraphCommands.$8S=function(c,d){ULSdmo:;if(!RTE.ParagraphCommands.$By(c)){var a=null;try{if(RTE.RteUtility.isFirefox()){var b=RTE.Canvas.currentEditableRegion();if(b){a=document.createElement("DIV");a.style.height="0px";a.style.width="0px";b.insertBefore(a,b.firstChild)}}RTE.Canvas.$6R(d)}finally{a&&a.parentNode&&a.parentNode.removeChild(a)}RTE.ParagraphCommands.$BG()}RTE.Canvas.sendApplicationStateChangedEvent()};RTE.ParagraphCommands.$BG=function(){ULSdmo:;var a=RTE.RteUtility.$20(RTE.Cursor.s_range.$1_0,["UL","OL"]);if(a&&RTE.Canvas.isEditable(a)){while(a.parentNode.tagName==="UL"||a.parentNode.tagName==="OL")a=a.parentNode;var b=a.parentNode;if(b.firstChild===a&&b.lastChild===a&&RTE.HtmlTagName.allowedElementStyleTags[b.tagName.toUpperCase()]){if(!a.dir)a.dir=b.dir;if(!a.className)a.className=b.className;if(!a.style.cssText)a.style.cssText=b.style.cssText;RTE.RteUtility.removeNodeAndKeepChildNodes(b);RTE.Cursor.update()}}};RTE.ParagraphCommands.$By=function(g){ULSdmo:;if(RTE.Cursor.get_range().isValid()){var e=RTE.RteUtility.getNearestParentElementOfType(RTE.Cursor.s_range.$1_0,"LI"),f=RTE.RteUtility.getNearestParentElementOfType(RTE.Cursor.s_range.$2_0,"LI");if(e&&f&&RTE.Canvas.isInEditable(e)&&RTE.Canvas.isInEditable(f)){var a=e,c=f;while(a.parentNode.tagName===g)a=a.parentNode;while(c.parentNode.tagName===g)c=c.parentNode;if(a.tagName===g&&a===c){while(a.childNodes.length>0){var b=a.childNodes[0];if(b.tagName==="LI"){var h=b.ownerDocument.createElement("P");RTE.RteUtility.moveChildNodes(b,h);b.parentNode.removeChild(b);b=h;var d=RTE.RteUtility.getRealLastChild(b,false);d&&d.nodeType===1&&d.tagName==="BR"&&b.removeChild(d)}!RTE.RteUtility.isEmptyTextNodeDeep(b,true)&&RTE.RteUtility.insertBefore(b,a)}a.parentNode.removeChild(a);RTE.Cursor.update();return true}}}return false};RTE.ParagraphCommands.indent=function(a){ULSdmo:;if(a)RTE.Canvas.$6R("Indent");else RTE.Canvas.$6R("Outdent")};RTE.ParagraphCommands.align=function(b){ULSdmo:;var a=null;if(b===2)a="center";else if(b===3)a="justify";else if(!b)a="left";else if(b===1)a="right";if(RTE.SU.isNullOrEmptyString(a))return;RTE.ParagraphCommands.$7Q("textAlign",a,"align",false);RTE.Canvas.sendApplicationStateChangedEvent()};RTE.PasteFlyout=function(a,b){ULSdmo:;this.$$d_$BJ_0=Function.createDelegate(this,this.$BJ_0);this.$1x_0=a;this.$5v_0=b};RTE.PasteFlyout.$Dg=function(a,b){ULSdmo:;RTE.PasteFlyout.$T&&RTE.PasteFlyout.$T.$8w_0(true);RTE.PasteFlyout.$T=new RTE.PasteFlyout(a,b);RTE.PasteFlyout.$T.$Dh_0()};RTE.PasteFlyout.expandOptions=function(){ULSdmo:;RTE.PasteFlyout.$T&&RTE.PasteFlyout.$T.$8L_0()};RTE.PasteFlyout.collapseOptions=function(){ULSdmo:;RTE.PasteFlyout.$T&&RTE.PasteFlyout.$T.$6F_0(false)};RTE.PasteFlyout.hide=function(){ULSdmo:;RTE.PasteFlyout.$8x(false)};RTE.PasteFlyout.$8x=function(a){ULSdmo:;if(RTE.PasteFlyout.$T){RTE.PasteFlyout.$T.$8w_0(a);RTE.PasteFlyout.$T=null}};RTE.PasteFlyout.get_isVisible=function(){ULSdmo:;return!!RTE.PasteFlyout.$T};RTE.PasteFlyout.$CF=function(a){ULSdmo:;return RTE.PasteFlyout.$T?RTE.PasteFlyout.$T.$Az_0(a):false};RTE.PasteFlyout.$CP=function(a){ULSdmo:;if(a.nodeType===1){var b=a.tagName.toUpperCase();if(b==="TABLE")return true;if(b==="FONT")return false;if(RTE.RteUtility.isBlockNode(a))return false;if(RTE.RteUtility.$3n(a))return false}return!RTE.RteUtility.isEmptyTextNodeDeep(a,true)};RTE.PasteFlyout.prototype={$1x_0:null,$5v_0:null,$b_0:null,$U_0:null,$1d_0:null,$K_0:null,$c_0:null,$3X_0:null,$5s_0:null,$5w_0:null,$Dh_0:function(){ULSdmo:;this.$c_0=RTE.Canvas.$2N(RTE.Canvas.currentEditableRegion());if(!this.$b_0&&this.$c_0){this.$b_0=this.$c_0.ownerDocument.createElement("DIV");this.$b_0.style.position="relative";this.$b_0.style.width="0px";this.$b_0.style.height="0px";var j=RTE.RteUtility.getCurrentStyle(this.$c_0.parentNode),g=!!j&&j.direction==="rtl";if(g)this.$b_0.style.right=this.$c_0.offsetWidth+"px";var n=this;$addHandler(this.$b_0,"mousedown",function(a){ULSdmo:;RTE.RteUtility.cancelEvent(a);return false});this.$c_0.parentNode.insertBefore(this.$b_0,this.$c_0);this.$As_0();this.$At_0();var b=this.$Bg_0(),c=null;if(!RTE.RteUtility.isBlockNode(b)){c=document.createElement("SPAN");c.className="ms-rtegenerate-skip";RTE.RteUtility.insertAfter(c,b);c.appendChild(b);b=c}var k=RTE.RteUtility.getPosition(b),d=RTE.RteUtility.getPosition(this.$c_0),a=k.x-d.x+(!g?10+b.offsetWidth:-10),e=k.y+b.offsetHeight-d.y,m=this.$U_0.clientHeight+this.$K_0.clientHeight,l=Math.max(Math.max(this.$U_0.clientWidth,this.$U_0.scrollWidth),Math.max(this.$K_0.clientWidth,this.$K_0.scrollWidth));c&&RTE.RteUtility.removeNodeAndKeepChildNodes(c);var f=RTE.RteUtility.$Bs(this.$b_0),h=RTE.RteUtility.getViewPortWidth(window.self),i=RTE.RteUtility.getViewPortHeight(window.self);h=Math.min(h,d.x+this.$c_0.offsetWidth-f.x);i=Math.min(i,d.y+this.$c_0.offsetHeight-f.y);a=Math.min(a,f.x+h-30-d.x+(!g?-l:0));a=Math.max(a,f.x+10+(!g?0:l));e=Math.min(e,f.y+i-m-10-d.y);e=Math.max(e,f.y+10-d.y);this.$U_0.style.top=e+"px";this.$K_0.style.top=e+this.$U_0.clientHeight+"px";if(!g){this.$U_0.style.left=a+"px";this.$K_0.style.left=a+"px"}else{this.$U_0.style.right=-a+"px";this.$K_0.style.right=-a+"px"}this.$6F_0(false)}},$8w_0:function(a){ULSdmo:;if(this.$b_0){if(this.$U_0){RTE.RteUtility.removeNode(this.$U_0);this.$U_0=null}if(this.$K_0){RTE.RteUtility.removeNode(this.$K_0);this.$K_0=null}RTE.RteUtility.removeNode(this.$b_0);this.$b_0=null;this.$1d_0=null;if(!a){RTE.SnapshotManager.$1N(this.$c_0)&&RTE.SnapshotManager.takeEditableRegionSnapshot(this.$c_0);RTE.Cursor.$C.clear()}}},$8L_0:function(){ULSdmo:;if(this.$K_0){this.$K_0.style.display="";RTE.Cursor.updateRangeToCurrentSelectionWithOptions(true);this.$3X_0&&this.$3X_0.focus()}},$6F_0:function(a){ULSdmo:;if(this.$K_0){this.$K_0.style.display="none";a&&RTE.Cursor.select()}},$Az_0:function(a){ULSdmo:;if(this.$b_0)while(a){if(a===this.$b_0)return true;a=a.parentNode}return false},$As_0:function(){ULSdmo:;this.$U_0=this.$c_0.ownerDocument.createElement("DIV");this.$U_0.id="rtePasteFlyout";this.$U_0.className="ms-cui-menu ms-noWrap";this.$U_0.style.position="absolute";var a=document.createElement("DIV");a.className="ms-cui-menusection";this.$U_0.appendChild(a);this.$1d_0=document.createElement("A");this.$1d_0.id="rtePasteFlyoutLink";this.$1d_0.className="ms-cui-ctl";this.$1d_0.href="javascript:;";a.appendChild(this.$1d_0);var b=this;$addHandler(this.$1d_0,"click",function(a){ULSdmo:;b.$8L_0();RTE.RteUtility.cancelEvent(a);return false});RTE.UiServices.$I.populatePasteFlyoutUi(this.$1d_0);this.$b_0.appendChild(this.$U_0)},$At_0:function(){ULSdmo:;this.$K_0=document.createElement("DIV");this.$K_0.id="rtePasteFlyoutOptions";this.$K_0.className="ms-cui-menu ms-noWrap";this.$K_0.style.position="absolute";$addHandler(this.$K_0,"keydown",this.$$d_$BJ_0);var f=document.createElement("DIV");f.className="ms-cui-smenu-inner";this.$K_0.appendChild(f);var e=document.createElement("DIV");e.className="ms-cui-menusection";f.appendChild(e);var g=document.createElement("DIV");g.className="ms-cui-menusection-title";RTE.UiServices.$I.populatePasteFlyoutOptionsTitleUi(g);e.appendChild(g);for(var h=RTE.RtePasteManager.get_pasteModes(),c=0;c<h.length;c++){var d=h[c],j=this.$5v_0===d.id,a=document.createElement("A");a.title=d.flyoutTooltip||d.displayName;a.id="rtePasteFlyoutOption"+c;a.className="ms-cui-ctl ms-rtePasteFlyout-option"+(j?" ms-cui-ctl-on":"");a.href="javascript:;";a.setAttribute("PasteModeId",d.id);e.appendChild(a);var i=d.flyoutIcon.cloneNode(true);i.className="ms-cui-img-cont-float";var b=i;while(b&&b.nodeType===1&&b.tagName.toUpperCase()!=="IMG")b=b.firstChild;if(b&&b.nodeType===1&&b.tagName.toUpperCase()==="IMG")b.alt=a.title;a.appendChild(i);var k=this;$addHandler(a,"click",function(a){ULSdmo:;var b=RTE.RteUtility.getNearestParentElementOfType(a.target,"A");if(b){var c=b.getAttribute("PasteModeId");!RTE.SU.isNullOrEmptyString(c)&&k.$7r_0(c)}RTE.RteUtility.cancelEvent(a);return false});if(j||!this.$3X_0)this.$3X_0=a;if(!c)this.$5s_0=a;if(c===h.length-1)this.$5w_0=a}RTE.RteUtility.insertAfter(this.$K_0,this.$U_0)},$BJ_0:function(a){ULSdmo:;if(a.keyCode===39||a.keyCode===37){var h=a.keyCode===39,c=a.target;if(c&&c.nodeType===1&&c.tagName.toUpperCase()==="A"){var b=c;do b=h?RTE.RteUtility.getRealNextSibling(b,false):RTE.RteUtility.getRealPreviousSibling(b,false);while(b&&(b.nodeType!==1||b.tagName.toUpperCase()!=="A"));if(!b)b=h?this.$5s_0:this.$5w_0;if(b){b.focus();RTE.RteUtility.cancelEvent(a)}}return}if(a.keyCode===27){this.$6F_0(true);RTE.RteUtility.cancelEvent(a);return}var f=String.fromCharCode(a.keyCode).toUpperCase();if(a.ctrlKey&&f==="A"){RTE.RteUtility.cancelEvent(a);return}for(var g=RTE.RtePasteManager.get_pasteModes(),e=0;e<g.length;e++){var d=g[e];if(d&&!RTE.SU.isNullOrEmptyString(d.flyoutShortcutKey)&&d.flyoutShortcutKey.toUpperCase()===f){RTE.RteUtility.cancelEvent(a);this.$7r_0(d.id);return}}},$7r_0:function(b){ULSdmo:;this.$1x_0.style.width="1px";this.$1x_0.style.height="1px";this.$1x_0.style.overflow="hidden";document.body.appendChild(this.$1x_0);var a=this;RTE.RtePasteManager.$78(this.$1x_0,true,b,function(){ULSdmo:;RTE.Cursor.s_range.clear();RTE.Cursor.$C.replaceWithChildren(a.$1x_0);RTE.Cursor.s_range.moveBeforeNode(RTE.Cursor.$C.$2_0);RTE.Cursor.update();RTE.AtomicManager.$4C()})},$Bg_0:function(){ULSdmo:;var a=RTE.Cursor.$C.$2_0;do a=a.lastChild||RTE.RteUtility.getRealPreviousSibling(a,false)||RTE.RteUtility.getRealPreviousSibling(a.parentNode,false);while(a&&a!==this.$c_0&&!RTE.PasteFlyout.$CP(a));if(!a||a===this.$c_0||a===RTE.Cursor.$C.$1_0)a=RTE.Cursor.$C.$2_0;return a}};RTE.RtePasteManager=function(){};RTE.RtePasteManager.registerPasteMode=function(a){ULSdmo:;RTE.RtePasteManager.$4r();RTE.RtePasteManager.$2I[a.id]=a};RTE.RtePasteManager.removePasteMode=function(a){ULSdmo:;RTE.RtePasteManager.$4r();delete RTE.RtePasteManager.$2I[a]};RTE.RtePasteManager.get_pasteModes=function(){ULSdmo:;RTE.RtePasteManager.$4r();var c=new Array(0),a=RTE.RtePasteManager.$2I;for(var b in a){var d={key:b,value:a[b]};Array.add(c,d.value)}return c};RTE.RtePasteManager.getPasteMode=function(a){ULSdmo:;RTE.RtePasteManager.$4r();return!RTE.SU.isNullOrEmptyString(a)?RTE.RtePasteManager.$2I[a]:null};RTE.RtePasteManager.cancelCurrentPaste=function(){ULSdmo:;RTE.RtePasteManager.$1l&&RTE.RtePasteManager.$1l.cancel();if(RTE.RtePasteManager.$2x){RTE.RteUtility.removeChildNodes(RTE.RtePasteManager.$2x);RTE.RtePasteManager.$2x=null}RTE.Cursor.$1C()};RTE.RtePasteManager.pasteModeResolver=function(a){ULSdmo:;return RTE.RtePasteManager.$3i?RTE.RtePasteManager.$3i(a):null};RTE.RtePasteManager.get_defaultPasteModeResolver=function(){ULSdmo:;return RTE.RtePasteManager.$3i};RTE.RtePasteManager.set_defaultPasteModeResolver=function(a){ULSdmo:;RTE.RtePasteManager.$3i=a;return a};RTE.RtePasteManager.$78=function(a,j,m,d){ULSdmo:;RTE.PasteFlyout.$8x(true);var c=RTE.Canvas.currentEditableRegion()||RTE.Cursor.s_range.getEditableRegion(),e=RTE.Canvas.getCachedRestriction(c,"RestrictPasteToText",false)||RTE.Canvas.getCachedRestriction(c,"DisableRibbonCommands",false);RTE.RtePasteManager.$1l=!e?RTE.RtePasteManager.$Bl(m,a):null;if(!j)try{RTE.RtePasteManager.removeScriptsAndUnwantedElements(a)}catch(n){RTE.RteUtility.removeChildNodes(a)}if(e){RTE.Canvas.dispatchAddedEventsChildElements(a);d&&d();return}RTE.RtePasteManager.$2x=a;var f=document.createElement("DIV");f.innerHTML=a.innerHTML;var g=!a.firstChild||a.firstChild===a.lastChild&&RTE.RteUtility.isEmptyTextNodeDeep(a.firstChild,false),k=!g&&a.firstChild===a.lastChild&&RTE.RteUtility.isTextNode(a.firstChild),l=RTE.RtePasteManager.$1l?RTE.RtePasteManager.$1l.id:null,b=new RTE.PasteOperationArgs;b.showFlyoutAfterOperation=!g&&RTE.RtePasteManager.get_pasteModes().length>1&&(!k||RTE.RtePasteManager.$C4(a));b.isFlyoutOperation=j;b.container=a;b.editableRegion=c;var h=false,i=function(){ULSdmo:;h=true;RTE.RteUtility.removeRteNodeId(RTE.Cursor.s_range.$1_0);RTE.RteUtility.removeRteNodeId(RTE.Cursor.s_range.$2_0);RTE.RtePasteManager.$Ax(a);d&&d();RTE.RteUtility.forEachChildWithTagAndClass(c,"TABLE","ms-rte-paste-settablesizes",function(a){ULSdmo:;Sys.UI.DomElement.removeCssClass(a,"ms-rte-paste-settablesizes");RTE.Canvas.setTableWidths&&RTE.TableCommands.$AE(a)});RTE.RteUtility.forEachChildWithTagAndClass(c,"IMG","ms-rte-paste-setimagesize",function(a){ULSdmo:;Sys.UI.DomElement.removeCssClass(a,"ms-rte-paste-setimagesize");var b=a;RTE.RteUtility.initImage(a);var c=a.style.height,d=b.getAttribute("height");if(!RTE.SU.isNullOrEmptyString(c)||!RTE.SU.isNullOrEmptyString(d)){var e=b.width+"px",f=b.height;a.removeAttribute("height");a.style.height="";if(Math.abs(f-b.height)<=2){a.removeAttribute("width");a.style.width=e}else{!RTE.SU.isNullOrEmptyString(d)&&a.setAttribute("height",d);if(!RTE.SU.isNullOrEmptyString(c))a.style.height=c}}});RTE.RtePasteManager.$1l=null;RTE.RtePasteManager.$2x=null;RTE.Cursor.$1C();b.showFlyoutAfterOperation&&window.setTimeout(function(){ULSdmo:;RTE.PasteFlyout.$Dg(f,l)},0)};if(!RTE.SU.isNullOrUndefined(RTE.RtePasteManager.$1l))RTE.RtePasteManager.$1l.execute(b,i);else i();!h&&RTE.Cursor.$7X()};RTE.RtePasteManager.$Bl=function(a,d){ULSdmo:;var b=RTE.RtePasteManager.getPasteMode(a);if(!RTE.SU.isNullOrUndefined(b))return b;var c=RTE.Canvas.getStringRestriction(RTE.Canvas.currentEditableRegion(),"DefaultPasteModeResolver",null);a=RTE.RtePasteManager.$C9(c,d);return RTE.RtePasteManager.getPasteMode(a)};RTE.RtePasteManager.$C9=function($p0,$p1){var $v_0=RTE.RtePasteManager.getPasteMode($p0);if(!RTE.SU.isNullOrUndefined($v_0))return $v_0.id;try{var $v_2;try{$v_2=!RTE.SU.isNullOrEmptyString($p0)?eval($p0):null}catch($$e_4){$v_2=null}if(!$v_2||typeof $v_2!=="function")$v_2=RTE.RtePasteManager.pasteModeResolver;var $v_3=$v_2($p1);if(typeof $v_3==="string")if(!RTE.SU.isNullOrUndefined(RTE.RtePasteManager.getPasteMode($v_3)))return $v_3}catch($$e_6){}var $v_1=RTE.RtePasteManager.get_pasteModes();return $v_1.length>0?$v_1[0].id:null};RTE.RtePasteManager.removeScriptsAndUnwantedElements=function(a){ULSdmo:;RTE.RteUtility.forEachChildWithTagAndClass(a,"o:p",null,function(b){ULSdmo:;do{var c=b.parentNode;RTE.RteUtility.removeNodeAndKeepChildNodes(b);b=c}while(!b.firstChild&&b!==a)});RTE.RteUtility.forEachChildWithTagAndClass(a,null,"ms-rtegenerate-allskip",RTE.RteUtility.removeNode);RTE.RteUtility.forEachChildWithTagAndClass(a,null,"ms-rtegenerate-skip",RTE.RteUtility.removeNodeAndKeepChildNodes);RTE.RteUtility.forEachChildWithTagAndClass(a,null,"ms-rtestate-write",function(c){ULSdmo:;var b=c.parentNode;while(b&&b!==a){if(Sys.UI.DomElement.containsCssClass(b,"ms-rtestate-read"))return;if(Sys.UI.DomElement.containsCssClass(b,"ms-rtestate-write"))break;b=b.parentNode}Sys.UI.DomElement.removeCssClass(c,"ms-rtestate-write")});RTE.HtmlCleanup.$DF(a)};RTE.RtePasteManager.$C4=function(c){ULSdmo:;for(var b=RTE.RtePasteManager.get_pasteModes(),a=0;a<b.length;a++)if(b[a].changesTextOnly(c))return true;return false};RTE.RtePasteManager.$4r=function(){ULSdmo:;if(!RTE.RtePasteManager.$2I)RTE.RtePasteManager.$2I={}};RTE.RtePasteManager.$Ax=function(h){ULSdmo:;if(h.querySelectorAll)for(var e=h.querySelectorAll("p, h1, h2, h3, b, i, u, table"),b=0;b<e.length;b++){var f=e[b],c=f.getAttribute("style");if(!RTE.SU.isNullOrUndefined(c)&&c.indexOf("mso-")>-1){for(var d=c.split(";"),g="",a=0;a<d.length;a++)if(d[a].indexOf("mso-")===-1)g+=d[a]+";";f.setAttribute("style",g)}}};RTE.PasteOperationArgs=function(){};RTE.PasteOperationArgs.prototype={container:null,isFlyoutOperation:false,showFlyoutAfterOperation:false,editableRegion:null};RTE.PasteMode=function(){};RTE.PasteMode.$9z=function(a){ULSdmo:;RTE.PasteMode.$5Y(a.lastChild);RTE.PasteMode.$5Y(a.firstChild);var b=a.firstChild;if(b&&b===a.lastChild)if(b.nodeType===1&&b.tagName.toUpperCase()==="P"){RTE.RteUtility.removeNodeAndKeepChildNodes(b);RTE.PasteMode.$5Y(a.lastChild);RTE.PasteMode.$5Y(a.firstChild)}};RTE.PasteMode.$5Y=function(a){ULSdmo:;if(a&&a.nodeType===1)if(a.tagName.toUpperCase()==="P"){var b=a.firstChild,c=!b;if(!c&&b===a.lastChild&&b.nodeType===1){var d=b.tagName.toUpperCase();if(d==="BR"||d==="DIV"&&!b.firstChild)c=true}c&&RTE.RteUtility.removeNode(a)}else a.tagName.toUpperCase()==="BR"&&RTE.RteUtility.removeNode(a)};RTE.PasteMode.prototype={id:null,displayName:null,displayTooltipTitle:null,displayTooltipDescription:null,ribbonImage:null,ribbonImageLeft:null,ribbonImageTop:null,flyoutIcon:null,flyoutShortcutKey:null,flyoutTooltip:null,cancel:function(){},changesTextOnly:function(){ULSdmo:;return false},appendRibbonButtonProperties:function(a){ULSdmo:;a.LabelText=this.displayName;a.ToolTipTitle=this.displayTooltipTitle||this.displayName;a.ToolTipDescription=this.displayTooltipDescription||this.displayName;if(!RTE.SU.isNullOrEmptyString(this.ribbonImage)){a.Image16by16=this.ribbonImage;if(!RTE.SU.isNullOrEmptyString(this.ribbonImageLeft))a.Image16by16Left=this.ribbonImageLeft;if(!RTE.SU.isNullOrEmptyString(this.ribbonImageTop))a.Image16by16Top=this.ribbonImageTop}}};RTE.WordConverterPasteMode=function(){ULSdmo:;this.$$d_afterListConversions=Function.createDelegate(this,this.afterListConversions);this.$$d_$Cr_1=Function.createDelegate(this,this.$Cr_1);RTE.WordConverterPasteMode.initializeBase(this)};RTE.WordConverterPasteMode.prototype={$2F_1:null,$1s_1:null,arguments:null,doneCallback:null,convertWordLists:true,get_numNumberedConverted:function(){ULSdmo:;return!this.$2F_1?0:this.$2F_1.$4X_0},get_numBulletsConverted:function(){ULSdmo:;return!this.$2F_1?0:this.$2F_1.$4W_0},execute:function(a,b){ULSdmo:;this.arguments=a;this.doneCallback=b;this.$1s_1=new RTE.PasteCommon.SimpleOperation(null,this.$$d_$Cr_1,null);this.$1s_1.$7J_1()},$Cr_1:function(a){ULSdmo:;this.$2F_1=null;if(this.convertWordLists){this.$2F_1=new RTE.HtmlImport.WordConverter;this.$2F_1.process(this.arguments.container,a)}a.$4i_1(this.$$d_afterListConversions);return true},cancel:function(){ULSdmo:;this.$1s_1&&this.$1s_1.$Au_1();this.$1s_1=null;this.arguments=null;this.doneCallback=null}};RTE.AsIsPasteMode=function(){ULSdmo:;this.$$d_$7p_2=Function.createDelegate(this,this.$7p_2);RTE.AsIsPasteMode.initializeBase(this);this.id="PasteAsIs";this.flyoutIcon=document.createTextNode("P");this.flyoutShortcutKey="P";this.flyoutTooltip=""};RTE.AsIsPasteMode.replaceTag=function(c,f,e,g,b,d){ULSdmo:;var a=null;RTE.RteUtility.forEachChildWithTagAndClass(c,f,e,function(e){ULSdmo:;if(!a){a=c.ownerDocument.createElement(g);if(!RTE.SU.isNullOrEmptyString(b))a.className=b;if(!RTE.SU.isNullOrEmptyString(d))a.style.cssText=d}var f=a.cloneNode(false);RTE.RteUtility.moveChildNodes(e,f);e.parentNode.replaceChild(f,e)})};RTE.AsIsPasteMode.prototype={afterListConversions:function(a){ULSdmo:;a.$4i_1(this.$$d_$7p_2);return true},$7p_2:function(){ULSdmo:;this.cleanupAndFinish();return false},cleanupAndFinish:function(){ULSdmo:;var a=this.arguments.container;RTE.AsIsPasteMode.replaceTag(a,"B",null,"STRONG",null,null);RTE.AsIsPasteMode.replaceTag(a,"I",null,"EM",null,null);RTE.AsIsPasteMode.replaceTag(a,"U",null,"SPAN",null,"text-decoration: underline;");RTE.PasteMode.$9z(a);var b=this;RTE.RteUtility.forEachChildWithTagAndClass(a,"IMG",null,function(a){ULSdmo:;if(!RTE.Canvas.isSkipNode(a)){var b=a;if(RTE.SU.isNullOrEmptyString(b.src))RTE.RteUtility.removeNode(a);else Sys.UI.DomElement.addCssClass(a,"ms-rte-paste-setimagesize")}});this.$1s_1=null;this.doneCallback&&this.doneCallback()}};RTE.CleanPasteMode=function(){ULSdmo:;this.$$d_$7p_2=Function.createDelegate(this,this.$7p_2);RTE.CleanPasteMode.initializeBase(this);this.id="PasteClean";this.flyoutIcon=document.createTextNode("C");this.flyoutShortcutKey="C";this.flyoutTooltip=""};RTE.CleanPasteMode.prototype={$2y_2:null,convertWordQuotes:true,execute:function(a,b){ULSdmo:;var c=this;RTE.RteUtility.forEachChildWithTagAndClass(a.container,"STYLE",null,function(a){ULSdmo:;a.parentNode.removeChild(a)});RTE.WordConverterPasteMode.prototype.execute.call(this,a,b)},afterListConversions:function(e){ULSdmo:;var a=this.arguments.container;this.$2y_2=a.ownerDocument.createElement("DIV");var b=new RTE.RteHtmlPasteSteward(this.$2y_2);b.$6K_1=this.convertWordQuotes;var f=new RTE.RteHtmlNormalizer(b),c=new RTE.RteHtmlTranslator(f);c.$3a_2=RTE.CleanPasteMode.passThroughClasses;var d=new RTE.HtmlImport.HtmlProcessor(c);d.registerNewTag("SPAN");d.process(a,this.$1s_1);e.$4i_1(this.$$d_$7p_2);return true},$7p_2:function(){ULSdmo:;var a=this.arguments.container;this.$1s_1=null;RTE.RteUtility.removeChildNodes(a);RTE.RteUtility.moveChildNodes(this.$2y_2,a);RTE.PasteMode.$9z(a);this.doneCallback&&this.doneCallback();this.arguments=null;this.$2y_2=null;return false},cancel:function(){ULSdmo:;RTE.WordConverterPasteMode.prototype.cancel.call(this);this.$2y_2=null}};RTE.PlainTextPasteMode=function(){ULSdmo:;RTE.PlainTextPasteMode.initializeBase(this);this.id="PastePlain";this.flyoutIcon=document.createTextNode("T");this.flyoutShortcutKey="T";this.flyoutTooltip=""};RTE.PlainTextPasteMode.prototype={execute:function(e,d){ULSdmo:;var b=e.container,a;try{if(typeof b.innerText==="string")a=b.innerText;else a=b.textContent}catch(f){var c=RTE.Range.createRange();c.moveToElementText(b);a=c.get_innerText()}a=RTE.RteUtility.htmlEncode(a);a=a.replace(RTE.PlainTextPasteMode.$7g,"").replace(RTE.PlainTextPasteMode.$7h,"\n").replace(RTE.PlainTextPasteMode.$7i,"<br/>");a=a.replace(RTE.PlainTextPasteMode.$7j," ");RTE.RteUtility.removeChildNodes(b);b.innerHTML=a;d&&d()}};RTE.PreviewManager=function(){ULSdmo:;this.$54_0=new RTE.ElementPlaceholderReplacer};RTE.PreviewManager.get_instance=function(){ULSdmo:;if(!RTE.PreviewManager.$T)RTE.PreviewManager.$T=new RTE.PreviewManager;return RTE.PreviewManager.$T};RTE.PreviewManager.prototype={$13_0:null,$4u_0:false,$4H_0:null,beginPreview:function(){ULSdmo:;if(this.$13_0)return;var c=RTE.Selection.getSelectionRange();if(c){var b=c.parentElement();b&&RTE.RteUtility.$1L(b)&&RTE.Canvas.isEditable(b)&&RTE.Cursor.cursorRangeIsNowOutdated()}if(!RTE.Cursor.get_range().get_isInEditableRegion())return;var a=RTE.Cursor.get_range().getEditableRegion();if(!a)return;RTE.SnapshotManager.takeSnapshot();this.$54_0.$DJ_0(a,"IFRAME",null,"ms-rteIframePlaceholder");this.$13_0=RTE.Snapshot.$Bc(a);this.$2V_0=null;this.$4u_0=true;this.$4H_0=RTE.ScrollPosition.buildForElement(a)},$2V_0:null,get_lastPreviewData:function(){ULSdmo:;return this.$2V_0},set_lastPreviewData:function(a){ULSdmo:;this.$2V_0=a;return a},endPreview:function(){ULSdmo:;if(!this.$13_0)return;var a=this.$13_0;this.$13_0=null;this.$4H_0=null;a.$7G_0();this.$54_0.$7H_0();RTE.SnapshotManager.$4J(a.$F_0,a.$q_0);this.$2V_0=null},restoreBeginState:function(){ULSdmo:;if(!this.$13_0)return;if(this.$4u_0){this.$4u_0=false;if(RTE.RteUtility.isInternetExplorer()){var a=RTE.Selection.getSelectionRange();if(a){a.collapse(true);a.select()}}RTE.Cursor.s_range.get_$5D_0()&&RTE.Selection.getSelection().clear()}this.$13_0.$7G_0();RTE.SnapshotManager.$4J(this.$13_0.$F_0,this.$13_0.$q_0);this.$2V_0=null},commitCommandOrAfterPreview:function(a){ULSdmo:;if(!a){RTE.PreviewManager.get_instance().commitPreview();return true}RTE.PreviewManager.get_instance().afterPreview();return false},afterPreview:function(){ULSdmo:;RTE.ScrollPosition.applyScrolls(this.$4H_0)},commitPreview:function(){ULSdmo:;this.$54_0.$7H_0();this.$13_0=null;this.$2V_0=null;this.$4H_0=null;RTE.SnapshotManager.takeSnapshot()},get_hasPreview:function(){ULSdmo:;return!!this.$13_0}};RTE.ScrollPosition=function(){};RTE.ScrollPosition.buildForElement=function(a){ULSdmo:;var c=new Array(0);while(a){var e=a.scrollTop,f=a.scrollLeft,d=!!e||!!f;if(!d){var g=a.scrollHeight,h=a.scrollWidth;d=!!g&&!!h&&g!==a.clientHeight||h!==a.clientWidth}if(d){var b=new RTE.ScrollPosition;b.$33_0=a;b.$5f_0=e;b.$5e_0=f;c[c.length]=b}a=a.parentNode}return c};RTE.ScrollPosition.applyScrolls=function(a){ULSdmo:;if(a&&a.length>0)for(var b=0;b<a.length;b++)a[b].$Ad_0()};RTE.ScrollPosition.prototype={$33_0:null,$5f_0:0,$5e_0:0,$Ad_0:function(){ULSdmo:;if(this.$33_0.scrollTop!==this.$5f_0)this.$33_0.scrollTop=this.$5f_0;if(this.$33_0.scrollLeft!==this.$5e_0)this.$33_0.scrollLeft=this.$5e_0}};RTE.ElementPlaceholderReplacer=function(){ULSdmo:;this.$19_0={}};RTE.ElementPlaceholderReplacer.prototype={$6j_0:0,$DJ_0:function(c,d,e,b){ULSdmo:;this.$7H_0();var a=this;RTE.RteUtility.forEachChildWithTagAndClass(c,d,e,function(c){ULSdmo:;var e="hold"+a.$6j_0++,d=c.ownerDocument.createElement("DIV");d.style.width=c.clientWidth+"px";d.style.height=c.clientHeight+"px";d.id=e;if(!RTE.SU.isNullOrEmptyString(b))d.className=b;a.$19_0[e]=c;c.parentNode.replaceChild(d,c)})},$7H_0:function(){ULSdmo:;var b=this.$19_0;for(var c in b){var d={key:c,value:b[c]},a=$get(d.key);a&&a.parentNode&&a.parentNode.replaceChild(d.value,a)}this.$19_0={};this.$6j_0=0}};RTE.Range=function(a){ULSdmo:;this.$5_0=a};RTE.Range.createRange=function(){ULSdmo:;var a=RTE.DomHelper.createRange(window.document);return a?new RTE.Range(a):null};RTE.Range.$7P=function(a){ULSdmo:;if(a.select){a.select();return}var b=null,c=null;if(RTE.RteUtility.isSafari()){if(a.startContainer&&a.startContainer.nodeType===1){b=a.startContainer.style.display;if(!a.startOffset&&a.startContainer.nodeName==="SPAN"&&a.startContainer.innerHTML==="")a.startContainer.style.display="none"}if(a.endContainer&&a.endContainer.nodeType===1){c=a.endContainer.style.display;if(!a.endOffset&&a.endContainer.nodeName==="SPAN"&&a.endContainer.innerHTML==="")a.endContainer.style.display="none"}if(a.startContainer.nodeType===1&&RTE.RteUtility.isBlockNode(a.startContainer)&&a.startContainer===a.endContainer&&a.startOffset===a.endOffset&&a.endOffset===a.endContainer.childNodes.length){var e=a.endContainer.ownerDocument.createElement("BR");a.endContainer.appendChild(e)}}var d=RTE.Selection.getSelection();d.$1Q_0.removeAllRanges();d.$1Q_0.addRange(a);if(RTE.RteUtility.isSafari()){if(a.startContainer&&a.startContainer.nodeType===1){a.startContainer.style.display=b;RTE.RteUtility.$A2(a.startContainer)}if(a.endContainer&&a.endContainer.nodeType===1){a.endContainer.style.display=c;RTE.RteUtility.$A2(a.endContainer)}}};RTE.Range.prototype={$5_0:null,duplicate:function(){ULSdmo:;var a=RTE.DomHelper.duplicateRange(this.$5_0);return new RTE.Range(a)},collapse:function(a){ULSdmo:;this.$5_0.collapse&&this.$5_0.collapse(a)},moveToElementText:function(a){ULSdmo:;if(this.$5_0.moveToElementText){this.$5_0.moveToElementText(a);return}this.$5_0.selectNodeContents&&this.$5_0.selectNodeContents(a)},pasteHtml:function(a){ULSdmo:;RTE.DomHelper.pasteHtmlIntoRange(this.$5_0,a)},get_innerText:function(){ULSdmo:;var a=this.$5_0.text;if(RTE.SU.isNullOrUndefined(a))a=this.$5_0.toString();return a},get_innerHTML:function(){ULSdmo:;if(!RTE.SU.isUndefined(this.$5_0.htmlText))return this.$5_0.htmlText;else{var b=this.$5_0.cloneContents(),a=document.createElement("DIV");a.appendChild(b);return a.innerHTML}},compareEndPoints:function(a,b){ULSdmo:;var c=RTE.Range.$7N[a];return RTE.DomHelper.compareRangeEndPoints(this.$5_0,c,b.$5_0)},$4I_0:function(b,c){ULSdmo:;var a=RTE.Range.$7N[b];RTE.DomHelper.setRangeEndPoint(this.$5_0,a,c.$5_0)},inRange:function(a){ULSdmo:;return RTE.DomHelper.isRangeInRange(this.$5_0,a.$5_0)},isVisible:function(){ULSdmo:;return RTE.DomHelper.isRangeVisible(this.$5_0)},parentElement:function(){ULSdmo:;var b=this.$5_0;if(b.parentElement){var a=b.parentElement(),c=RTE.DomHelper.createRange(window.document);if(a)try{c.moveToElementText(a)}catch(h){}while(a&&!c.inRange(b)){a=a.parentNode;try{c.moveToElementText(a)}catch(i){}}if(a){var e=true;while(e){e=false;for(var g=a.childNodes.length,d=0;d<g;d++)if(!RTE.RteUtility.isTextNode(a.childNodes[d])){c.moveToElementText(a.childNodes[d]);if(c.inRange(b)){a=a.childNodes[d];e=true;break}}}}return a}var f=b.commonAncestorContainer;return f?f:null},$73_0:function(c){ULSdmo:;var a=this.$5_0.startContainer;if(!RTE.SU.isNullOrUndefined(a)&&RTE.RteUtility.isBlockNode(a)&&a.childNodes.length>0){var b=null;if(this.$5_0.startOffset!==a.childNodes.length){b=a.childNodes[this.$5_0.startOffset];this.$5_0.setStart(b,0)}b&&b.childNodes.length>0&&this.$73_0(c)}},$4Y_0:0,$95_0:function(a,g,q){ULSdmo:;this.$73_0(g);var e=this.$5_0,b=e.startContainer,n=g?RTE.Cursor.s_range.$2_0.parentNode:RTE.Cursor.s_range.$1_0.parentNode,h=false;if(!RTE.SU.isNullOrUndefined(b)){h=true;if(RTE.RteUtility.$9D(b))h=false;else if(RTE.Canvas.$3C(b.tagName))return false;else if(RTE.RteUtility.isSvgNode(b)){while(RTE.RteUtility.isSvgNode(b.parentNode))b=b.parentNode;RTE.RteUtility.insertBefore(a,b)}else if(!e.startOffset)if(RTE.RteUtility.isTextNode(b)||RTE.RteUtility.$3B(b))RTE.RteUtility.insertBefore(a,b);else if(!b.firstChild)b.appendChild(a);else b.insertBefore(a,b.firstChild);else if(RTE.RteUtility.isTextNode(b)&&e.startOffset===b.nodeValue.length)RTE.RteUtility.insertAfter(a,b);else if(!g&&RTE.RteUtility.isTextNode(b)){var l=e.startOffset,r=b.nodeValue.substr(0,l),u=b.nodeValue.substr(l),s=b.ownerDocument.createTextNode(r),o=b.parentNode;o.insertBefore(s,b);o.insertBefore(a,b);var k=RTE.DomHelper.createRange(window.document);k.setStart(b,0);k.setEnd(b,l);k.deleteContents();k.detach()}else h=false}if(!h)if(!RTE.SU.isNullOrUndefined(e.insertNode))e.insertNode(a);else{var d=null;try{var p="rangePosition"+this.$4Y_0++;if(this.$4Y_0>1e7)this.$4Y_0=0;this.pasteHtml("<span id='"+p+"'></span>");var m=$get(p);d=m.parentNode;if(RTE.RteUtility.$3B(d))if(d.tagName==="IMG")if(g)RTE.RteUtility.insertAfter(a,d);else RTE.RteUtility.insertBefore(a,d);else RTE.RteUtility.insertBefore(a,d);else m.parentNode.replaceChild(a,m)}catch(t){if(!d){d=this.parentElement();if(!d)return false}RTE.RteUtility.insertBefore(a,d)}}var f=a.parentNode;while(f&&f.id.indexOf("range")!==-1){f.parentNode.insertBefore(a,f);f=f.parentNode}var i=a.nextSibling,j=a.previousSibling,c=a.parentNode;if(c){if(c.tagName==="BR"){if(!g)RTE.RteUtility.insertAfter(a,c);else RTE.RteUtility.insertBefore(a,c);i=a.nextSibling;j=a.previousSibling;c=a.parentNode}if((n!==c||q)&&c.tagName==="A"){if(!i)RTE.RteUtility.insertAfter(a,c);else!j&&RTE.RteUtility.insertBefore(a,c);i=a.nextSibling;j=a.previousSibling;c=a.parentNode}if((n!==c||q)&&Sys.UI.DomElement.containsCssClass(c,"ms-rtestate-read"))if(!i)RTE.RteUtility.insertAfter(a,c);else!j&&RTE.RteUtility.insertBefore(a,c)}return true},moveToMarkers:function(c,d,e){ULSdmo:;var a=RTE.Range.createRange();a.moveToElementText(c);if(e){this.$4I_0(2,a);this.$4I_0(1,a);this.collapse(true)}else{this.$4I_0(3,a);this.$4I_0(0,a);var b=RTE.Range.createRange();b.moveToElementText(d);this.$4I_0(2,b)}},select:function(){ULSdmo:;RTE.Range.$7P(this.$5_0)}};RTE.RemoveStyleOnSelectionProcessor=function(){ULSdmo:;RTE.RemoveStyleOnSelectionProcessor.initializeBase(this)};RTE.RemoveStyleOnSelectionProcessor.prototype={$4j_1:false,setSettings:function(a,b){ULSdmo:;this.$4j_1=b;RTE.SelectionNodesProcessor.prototype.setSelectionSettings.call(this,a)},process:function(){ULSdmo:;this.$f_1()},$AR_1:function(d,e,c){ULSdmo:;var a=null;if(c)a=this.$E_0.$1_0;else a=this.$E_0.$2_0;var b=a.parentNode;while(a&&b){if(b===d)return a;else(c&&!a.previousSibling||!c&&!a.nextSibling)&&RTE.Canvas.isEditable(b)&&!RTE.Canvas.$S(b)&&e.push(b);a=b;b=a.parentNode}return null},$E1_1:function(c){ULSdmo:;var a=this.get_parentElement();if(RTE.Canvas.$S(a))return;var d=this.$AR_1(a,c,true),e=this.$AR_1(a,c,false);if(d&&e&&d===a.firstChild&&e===a.lastChild){c.push(a);var b=a.parentNode;while(b&&b.childNodes.length===1&&!RTE.Canvas.$S(b)){c.push(b);b=b.parentNode}}},$f_1:function(){ULSdmo:;var c=this.get_innerNodes(),f=0;this.$E1_1(c);for(var d=0;d<c.length;d++){var h=false,a=c[d];if(!a)continue;if(RTE.RteUtility.isTextNode(a))continue;if(!RTE.Canvas.isEditable(a)||RTE.Canvas.$S(a))continue;var m=a.className;if(m.indexOf("ms-rteKeepStyles")!==-1)continue;var b=a.tagName;if(b==="STRONG"||b==="B"||b==="U"||b==="EM"||b==="SUP"||b==="SUB"||b==="I"||b==="FONT"){RTE.RteUtility.removeNodeAndKeepChildNodes(a);c[d]=null;f++;continue}else if(b==="H1"||b==="H2"||b==="H3"||b==="H4"||b==="H5"||b==="H6"||b==="P"){if(RTE.RteUtility.$M(this.$E_0.$1_0,a,a)||RTE.RteUtility.$M(this.$E_0.$2_0,a,a)){if(b!=="DIV"){var n=a.ownerDocument.createElement("DIV");a.parentNode.insertBefore(n,a);RTE.RteUtility.moveChildNodes(a,n);RTE.RteUtility.removeNode(a)}}else{if(RTE.RteUtility.getRealNextSibling(a,false)){a.parentNode.insertBefore(a.ownerDocument.createElement("BR"),a.nextSibling);b==="P"&&a.parentNode.insertBefore(a.ownerDocument.createElement("BR"),a.nextSibling)}RTE.RteUtility.removeNodeAndKeepChildNodes(a)}c[d]=null;f++;continue}if(!this.$4j_1&&b==="IMG")continue;if(!this.$4j_1&&(b==="TH"||b==="TD"||b==="TR"||b==="HR"||b==="TABLE"||b==="TBODY"||b==="THEAD")){a.style.backgroundColor="";a.style.color="";a.style.fontFamily="";a.style.fontSize="";a.style.fontStyle="";a.style.fontWeight="";continue}var i="",j="",e=a.style;if(b==="TABLE"||b==="IMG"){i=e.width;j=e.height;e.width="";e.height=""}if(a.style.cssText!==""){a.removeAttribute("style");h=true}if(i!=="")e.width=i;if(j!=="")e.height=j;for(var o=m.split(" "),k="",p=o.length,l=0;l<p;l++){var g=o[l];if(g!=="")if(RTE.RteUtility.get_ignoreClasses()[g]||g.startsWith("ms-rterange"))k+=g+" ";else h=true}if(k===""){a.removeAttribute("className");a.removeAttribute("class")}else a.className=k;if(RTE.RteUtility.$58(a)){RTE.RteUtility.removeNodeAndKeepChildNodes(a);c[d]=null;f++;continue}if(h)f++}RTE.SnapshotManager.setCurrentRegionDirtyIf(f>0)}};RTE.CommandState=function(){};RTE.CommandState.prototype={$D_0:false,get_enabled:function(){ULSdmo:;return this.$D_0},set_enabled:function(a){ULSdmo:;this.$D_0=a;return a},$j_0:false,get_applied:function(){ULSdmo:;return this.$j_0},set_applied:function(a){ULSdmo:;this.$j_0=a;return a},get_commandOn:function(){ULSdmo:;return this.$D_0&&this.$j_0},$8_0:null,get_value:function(){ULSdmo:;return this.$8_0},set_value:function(a){ULSdmo:;this.$8_0=a;return a}};RTE.RichTextEditor=function(){};RTE.RichTextEditor.align=function(a){ULSdmo:;RTE.SnapshotManager.takeSnapshot();RTE.ParagraphCommands.align(a);RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.bold=function(){ULSdmo:;RTE.SnapshotManager.takeSnapshot();RTE.FontCommands.$Aq();RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.removeStyles=function(){ULSdmo:;RTE.SnapshotManager.takeSnapshot();RTE.FontCommands.$A3();RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.bulletedList=function(){ULSdmo:;RTE.SnapshotManager.takeSnapshot();RTE.ParagraphCommands.bulletedList();RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.clearFormatting=function(){ULSdmo:;RTE.SnapshotManager.takeSnapshot();RTE.FontCommands.$A3();RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.copy=function(){ULSdmo:;RTE.SnapshotManager.takeSnapshot();RTE.Cursor.copy();RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.cut=function(){ULSdmo:;RTE.SnapshotManager.takeSnapshot();RTE.Cursor.cut();RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.decreaseIndent=function(){ULSdmo:;RTE.SnapshotManager.takeSnapshot();RTE.ParagraphCommands.indent(false);RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.deleteCell=function(){ULSdmo:;RTE.SnapshotManager.takeSnapshot();RTE.TableCommands.deleteCell();RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.deleteRow=function(){ULSdmo:;RTE.SnapshotManager.takeSnapshot();RTE.TableCommands.deleteRow();RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.deleteTable=function(){ULSdmo:;RTE.SnapshotManager.takeSnapshot();RTE.TableCommands.deleteTable();RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.deleteColumn=function(){ULSdmo:;RTE.SnapshotManager.takeSnapshot();RTE.TableCommands.deleteColumn();RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.increaseIndent=function(){ULSdmo:;RTE.SnapshotManager.takeSnapshot();RTE.ParagraphCommands.indent(true);RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.insertOrUpdateLink=function(a){ULSdmo:;RTE.SnapshotManager.takeSnapshot();RTE.ElementCommands.insertOrUpdateLink(a);RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.insertOrUpdateImage=function(a){ULSdmo:;RTE.SnapshotManager.takeSnapshot();RTE.ElementCommands.insertOrUpdateImage(a);RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.insertTable=function(a){ULSdmo:;RTE.SnapshotManager.takeSnapshot();RTE.TableCommands.insertTable(a);RTE.RteUtility.showUiExperience(3);RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.insertRowAbove=function(){ULSdmo:;RTE.RichTextEditor.insertRow(true)};RTE.RichTextEditor.insertRowBelow=function(){ULSdmo:;RTE.RichTextEditor.insertRow(false)};RTE.RichTextEditor.insertRow=function(a){ULSdmo:;RTE.SnapshotManager.takeSnapshot();RTE.TableCommands.insertRow(a);RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.insertColumnLeft=function(){ULSdmo:;RTE.RichTextEditor.insertColumn(true)};RTE.RichTextEditor.insertColumnRight=function(){ULSdmo:;RTE.RichTextEditor.insertColumn(false)};RTE.RichTextEditor.insertColumn=function(a){ULSdmo:;RTE.SnapshotManager.takeSnapshot();RTE.TableCommands.insertColumn(a);RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.italic=function(){ULSdmo:;RTE.SnapshotManager.takeSnapshot();RTE.FontCommands.$CR();RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.mergeCells=function(){ULSdmo:;RTE.TableCommands.mergeCells()};RTE.RichTextEditor.mergeAbove=function(){ULSdmo:;RTE.TableCommands.mergeWithAbove()};RTE.RichTextEditor.mergeBellow=function(){ULSdmo:;RTE.TableCommands.mergeWithBelow()};RTE.RichTextEditor.mergeLeft=function(){ULSdmo:;RTE.TableCommands.mergeWithLeft()};RTE.RichTextEditor.mergeRight=function(){ULSdmo:;RTE.TableCommands.mergeWithRight()};RTE.RichTextEditor.numberedList=function(){ULSdmo:;RTE.SnapshotManager.takeSnapshot();RTE.ParagraphCommands.numberedList();RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.queryBold=function(){ULSdmo:;return RTE.FontCommands.$Cy()};RTE.RichTextEditor.queryAlign=function(a){ULSdmo:;return RTE.ParagraphCommands.queryAlign(a)};RTE.RichTextEditor.queryBulletedList=function(){ULSdmo:;return RTE.ParagraphCommands.queryBulletedList()};RTE.RichTextEditor.queryDirection=function(a){ULSdmo:;return RTE.ParagraphCommands.queryDirection(a)};RTE.RichTextEditor.queryNumberedList=function(){ULSdmo:;return RTE.ParagraphCommands.queryNumberedList()};RTE.RichTextEditor.queryImageContextualGroup=function(){ULSdmo:;var a=new RTE.CommandState,b=RTE.CanvasEvents.getNodeFromEvent("Image");a.$D_0=RTE.Canvas.$1W&&!!b;return a};RTE.RichTextEditor.queryItalic=function(){ULSdmo:;return RTE.FontCommands.$Cz()};RTE.RichTextEditor.queryLinkContextualGroup=function(){ULSdmo:;var a=new RTE.CommandState,b=RTE.CanvasEvents.getNodeFromEvent("Link");a.$D_0=RTE.Canvas.$1W&&!!b;return a};RTE.RichTextEditor.queryStrikeThrough=function(){ULSdmo:;return RTE.FontCommands.$D0()};RTE.RichTextEditor.querySubscript=function(){ULSdmo:;return RTE.FontCommands.$D1()};RTE.RichTextEditor.querySuperscript=function(){ULSdmo:;return RTE.FontCommands.$D2()};RTE.RichTextEditor.queryTableExperience=function(){ULSdmo:;var a=new RTE.CommandState,b=RTE.CanvasEvents.getNodeFromEvent("Table");a.$D_0=RTE.Canvas.$1W&&!!b;return a};RTE.RichTextEditor.queryUnderline=function(){ULSdmo:;return RTE.FontCommands.$D3()};RTE.RichTextEditor.relayout=function(a,d,c,b){ULSdmo:;RTE.SnapshotManager.takeSnapshot();var e=RTE.Canvas.getRTEFieldRegion();RTE.Cursor.get_range().collapse(true);RTE.LayoutsEditor.relayoutRegion(e,a,d,c,b);RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.selectAll=function(){ULSdmo:;RTE.Cursor.get_range().selectAll();RTE.Cursor.update()};RTE.RichTextEditor.setLanguage=function(a){ULSdmo:;RTE.SnapshotManager.takeSnapshot();RTE.FontCommands.$Dc(a);RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.setBackgroundColorCssClass=function(a){ULSdmo:;RTE.RichTextEditor.setColor(true,a,true)};RTE.RichTextEditor.setColorCssClass=function(a){ULSdmo:;RTE.RichTextEditor.setColor(false,a,true)};RTE.RichTextEditor.setColor=function(c,a,b){ULSdmo:;RTE.SnapshotManager.takeSnapshotIfNotInPreview();if(c)RTE.FontCommands.$DW(a,b);else RTE.FontCommands.$DX(a,b);RTE.SnapshotManager.takeSnapshotIfNotInPreview()};RTE.RichTextEditor.setDirection=function(a){ULSdmo:;RTE.SnapshotManager.takeSnapshot();RTE.ParagraphCommands.setDirection(a);RTE.Canvas.sendApplicationStateChangedEvent();RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.setFontFamilyCssClass=function(a){ULSdmo:;RTE.RichTextEditor.setFontFamily(a,true)};RTE.RichTextEditor.setFontFamilyStyleValue=function(a){ULSdmo:;RTE.RichTextEditor.setFontFamily(a,false)};RTE.RichTextEditor.setFontFamily=function(a,b){ULSdmo:;RTE.SnapshotManager.takeSnapshotIfNotInPreview();RTE.FontCommands.$DZ(a,b);RTE.SnapshotManager.takeSnapshotIfNotInPreview()};RTE.RichTextEditor.setFontSizeCssClass=function(a){ULSdmo:;RTE.RichTextEditor.$7T(a,true)};RTE.RichTextEditor.setFontSizeStyleValue=function(b){ULSdmo:;var a=RTE.RteUtility.parseUnitValue(b);if(!a)return;if(RTE.SU.isNullOrEmptyString(a.unit))a.unit=RTE.FontCommands.$6w;var c=""+a.value+a.unit;RTE.RichTextEditor.$7T(c,false)};RTE.RichTextEditor.$7T=function(a,b){ULSdmo:;RTE.SnapshotManager.takeSnapshotIfNotInPreview();RTE.FontCommands.$7T(a,b);RTE.SnapshotManager.takeSnapshotIfNotInPreview()};RTE.RichTextEditor.setTableWidth=function(a){ULSdmo:;RTE.SnapshotManager.takeSnapshot();RTE.TableCommands.setTableWidth(a);RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.setTableHeight=function(a){ULSdmo:;RTE.SnapshotManager.takeSnapshot();RTE.TableCommands.setTableHeight(a);RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.setTableColumnWidth=function(a){ULSdmo:;RTE.SnapshotManager.takeSnapshot();RTE.TableCommands.setTableColumnWidth(a);RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.setTableRowHeight=function(a){ULSdmo:;RTE.SnapshotManager.takeSnapshot();RTE.TableCommands.setTableRowHeight(a);RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.setTableStyle=function(b,a){ULSdmo:;RTE.SnapshotManager.takeSnapshotIfNotInPreview();if(a||RTE.SU.isUndefined(a)){var c=RTE.Cursor.getSelectedTable();RTE.TableCommands.setTableStyle(c,b,true)}else RTE.RichTextEditor.clearTableStyle();RTE.SnapshotManager.takeSnapshotIfNotInPreview()};RTE.RichTextEditor.setTableSummary=function(a){ULSdmo:;RTE.SnapshotManager.takeSnapshot();var b=RTE.CanvasEvents.getNodeFromEvent("Table");b.setAttribute("summary",a);RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.queryTableSummary=function(){ULSdmo:;var a=new RTE.CommandState,b=RTE.CanvasEvents.getNodeFromEvent("Table");if(!b)return a;a.$D_0=true;var c=RTE.RteUtility.getAttribute(b,"summary");a.$8_0=RTE.SU.isNullOrUndefined(c)?"":c;return a};RTE.RichTextEditor.setTableFirstColumn=function(a){ULSdmo:;RTE.SnapshotManager.takeSnapshot();var b=RTE.CanvasEvents.getNodeFromEvent("Table");RTE.TableCommands.setFirstColumn(b,a);RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.setTableLastColumn=function(a){ULSdmo:;RTE.SnapshotManager.takeSnapshot();var b=RTE.CanvasEvents.getNodeFromEvent("Table");RTE.TableCommands.setLastColumn(b,a);RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.setTableHeaderRow=function(a){ULSdmo:;RTE.SnapshotManager.takeSnapshot();var b=RTE.CanvasEvents.getNodeFromEvent("Table");RTE.TableCommands.setHeaderRow(b,a);RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.setTableFooterRow=function(a){ULSdmo:;RTE.SnapshotManager.takeSnapshot();var b=RTE.CanvasEvents.getNodeFromEvent("Table");RTE.TableCommands.setFooterRow(b,a);RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.clearTableStyle=function(){ULSdmo:;RTE.SnapshotManager.takeSnapshot();RTE.TableCommands.clearTableStyle();RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.setTableGridLines=function(a){ULSdmo:;RTE.SnapshotManager.takeSnapshot();RTE.TableCommands.setTableGridLines(a);RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.setLinkUrl=function(b){ULSdmo:;var a=RTE.CanvasEvents.getNodeFromEvent("Link");if(!a)return;RTE.SnapshotManager.takeSnapshot();RTE.SnapshotManager.setCurrentRegionDirtyIf(a.href!==b);a.href=b;RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.queryLinkUrl=function(){ULSdmo:;var a=new RTE.CommandState,b=RTE.CanvasEvents.getNodeFromEvent("Link");if(!b)return a;a.$D_0=true;var c=RTE.RteUtility.getAttribute(b,"href");a.$8_0=RTE.RteUtility.$5Z(c);return a};RTE.RichTextEditor.setLinkOpenInNewWindow=function(c){ULSdmo:;var a=RTE.CanvasEvents.getNodeFromEvent("Link");if(!a)return;RTE.SnapshotManager.takeSnapshot();var b=RTE.RteUtility.getAttribute(a,"target");if(c){a.setAttribute("target","_blank");RTE.SnapshotManager.setCurrentRegionDirtyIf(!b||b.toLowerCase()!=="_blank")}else{a.removeAttribute("target");RTE.SnapshotManager.setCurrentRegionDirtyIf(!RTE.SU.isNullOrEmptyString(b))}RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.queryLinkOpenInNewWindow=function(){ULSdmo:;var a=new RTE.CommandState,b=RTE.CanvasEvents.getNodeFromEvent("Link");if(!b)return a;a.$D_0=true;var c=RTE.RteUtility.getAttribute(b,"target");if(c&&c.toLowerCase()==="_blank")a.$j_0=true;else a.$j_0=false;return a};RTE.RichTextEditor.setLinkTitle=function(b){ULSdmo:;var a=RTE.CanvasEvents.getNodeFromEvent("Link");if(!a)return;RTE.SnapshotManager.takeSnapshot();RTE.SnapshotManager.setCurrentRegionDirtyIf(a.title!==b);a.title=b;RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.queryLinkTitle=function(){ULSdmo:;var a=new RTE.CommandState,b=RTE.CanvasEvents.getNodeFromEvent("Link");if(!b)return a;a.$D_0=true;a.$8_0=b.title;return a};RTE.RichTextEditor.removeLink=function(){ULSdmo:;var a=RTE.CanvasEvents.getNodeFromEvent("Link");if(!a)return;RTE.SnapshotManager.takeSnapshot();RTE.RichTextEditor.removeAssetIcon();if(RTE.Canvas.isEditable(a)){if(RTE.Canvas.isEditable(a.parentNode))RTE.RteUtility.removeNodeAndKeepChildNodes(a);else{RTE.RteUtility.removeChildNodes(a);a.href="";a.title="";RTE.Cursor.get_range().clear()}RTE.Cursor.update()}RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.removeAssetIcon=function(){ULSdmo:;var a=RTE.CanvasEvents.getNodeFromEvent("Link");if(!a)return;var b=RTE.RichTextEditor.getAssetIcon(a);b&&a.removeChild(b)};RTE.RichTextEditor.getAssetIcon=function(d){ULSdmo:;for(var c=null,a=0;a<d.childNodes.length;a++){var b=d.childNodes[a];if(b.tagName==="IMG"&&Sys.UI.DomElement.containsCssClass(b,"ms-asset-icon"))c=b}return c};RTE.RichTextEditor.queryCut=function(){ULSdmo:;var a=new RTE.CommandState;a.$D_0=RTE.Canvas.$4t("cut");return a};RTE.RichTextEditor.queryCopy=function(){ULSdmo:;var a=new RTE.CommandState;a.$D_0=RTE.Canvas.$4t("copy");return a};RTE.RichTextEditor.queryPaste=function(){ULSdmo:;var a=new RTE.CommandState;a.$D_0=RTE.Canvas.$4t("paste");return a};RTE.RichTextEditor.queryLinkDisplayIcon=function(){ULSdmo:;var a=new RTE.CommandState,b=RTE.CanvasEvents.getNodeFromEvent("Link");if(b){a.$D_0=true;var c=RTE.RichTextEditor.getAssetIcon(b);if(c)a.$j_0=true;else a.$j_0=false}return a};RTE.RichTextEditor.setImageSrc=function(b){ULSdmo:;var a=RTE.CanvasEvents.getNodeFromEvent("Image");if(!a)return;RTE.SnapshotManager.takeSnapshot();RTE.SnapshotManager.setCurrentRegionDirtyIf(a.src!==b);a.src=b;RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.queryImageSrc=function(){ULSdmo:;var a=new RTE.CommandState,b=RTE.CanvasEvents.getNodeFromEvent("Image");if(!b)return a;a.$D_0=true;var c=b.src;a.$8_0=RTE.RteUtility.$5Z(c);return a};RTE.RichTextEditor.setImageAlt=function(b){ULSdmo:;var a=RTE.CanvasEvents.getNodeFromEvent("Image");if(!a)return;RTE.SnapshotManager.takeSnapshot();RTE.SnapshotManager.setCurrentRegionDirtyIf(a.alt!==b);a.alt=b;RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.queryImageAlt=function(){ULSdmo:;var a=new RTE.CommandState,b=RTE.CanvasEvents.getNodeFromEvent("Image");if(!b)return a;a.$D_0=true;a.$8_0=b.alt;return a};RTE.RichTextEditor.setImageHeight=function(d,j){ULSdmo:;var a=RTE.CanvasEvents.getNodeFromEvent("Image");if(!a)return;if(!RTE.RichTextEditor.allowImageResize())return;RTE.SnapshotManager.takeSnapshot();var e=!RTE.RichTextEditor.isRatioLocked(a),b=d+j;RTE.SnapshotManager.setCurrentRegionDirtyIf(a.style.height!==b);if(!e){var f=a.height,g=a.width,h=!RTE.SU.isNullOrEmptyString(a.style.height);a.style.height=b;var i=a.height,c=Math.round(i*g/f);if(!isNaN(c)){a.style.width=c.toString()+"px";if(!h)a.style.height=""}RTE.CanvasEvents.waitAndSetImageSize()}else a.style.height=b;RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.queryImageHeight=function(){ULSdmo:;var b=new RTE.CommandState,c=RTE.CanvasEvents.getNodeFromEvent("Image");if(!c)return b;b.$D_0=true;var a=c.style.height;if(RTE.SU.isNullOrEmptyString(a))a=RTE.RteUtility.getAttribute(c,"height");if(RTE.SU.isNullOrEmptyString(a)||!RTE.RteUtility.$2S(RTE.RichTextEditor.$7b,a))a=c.height.toString()+"px";b.$8_0=a;return b};RTE.RichTextEditor.setImageWidth=function(e,i){ULSdmo:;var a=RTE.CanvasEvents.getNodeFromEvent("Image");if(!a)return;if(!RTE.RichTextEditor.allowImageResize())return;RTE.SnapshotManager.takeSnapshot();var f=!RTE.RichTextEditor.isRatioLocked(a),b=e+i;RTE.SnapshotManager.setCurrentRegionDirtyIf(a.style.height!==b);var c=a.height;if(!f){var g=a.width;a.style.width=b;var h=a.width,d=Math.round(h*c/g);if(!isNaN(d))a.style.height=d.toString()+"px";RTE.CanvasEvents.waitAndSetImageSize()}else{a.style.width=b;a.style.height=c+"px"}RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.allowImageResize=function(){ULSdmo:;return RTE.Canvas.getCachedRestriction(RTE.Canvas.currentEditableRegion(),"AllowImageResize",true)};RTE.RichTextEditor.queryImageWidth=function(){ULSdmo:;var b=new RTE.CommandState,c=RTE.CanvasEvents.getNodeFromEvent("Image");if(!c)return b;b.$D_0=true;var a=c.style.width;if(RTE.SU.isNullOrEmptyString(a))a=RTE.RteUtility.getAttribute(c,"width");if(RTE.SU.isNullOrEmptyString(a)||!RTE.RteUtility.$2S(RTE.RichTextEditor.$7b,a))a=c.width.toString()+"px";b.$8_0=a;return b};RTE.RichTextEditor.setImageLockRatio=function(b){ULSdmo:;var a=RTE.CanvasEvents.getNodeFromEvent("Image");if(!a)return;a.setAttribute("unlockratio",!b)};RTE.RichTextEditor.queryImageLockRatio=function(){ULSdmo:;var a=new RTE.CommandState,b=RTE.CanvasEvents.getNodeFromEvent("Image");if(!b)return a;a.$D_0=true;a.$j_0=RTE.RichTextEditor.isRatioLocked(b);return a};RTE.RichTextEditor.isRatioLocked=function(b){ULSdmo:;var a=RTE.RteUtility.getAttribute(b,"unlockratio");return a==="false"?true:a==="true"?false:!a};RTE.RichTextEditor.setImagePosition=function(a,b){ULSdmo:;RTE.RichTextEditor.$AC(a,RTE.RichTextEditor.positionClass,b)};RTE.RichTextEditor.setImageStyle=function(a,b){ULSdmo:;RTE.RichTextEditor.$AC(a,RTE.RichTextEditor.imageClass,b)};RTE.RichTextEditor.$AC=function(g,c,h){ULSdmo:;if(!RTE.SU.isNullOrEmptyString(g)){var b=RTE.Canvas.getCurrentStyleSheetPrefix(),a=RTE.Cursor.getSelectedImage(),d=RTE.Canvas.getEditableRegion(a);if(h||RTE.SU.isUndefined(h)){var e=b+c+"-"+g;a.style.styleFloat="";a.style.textAlign="";RTE.RteUtility.$1V(a,e,[b+c]);if(RTE.Canvas.getCachedRestriction(d,"UseInlineStyle",false)){var f=RTE.RteUtility.getCurrentStyle(a);a.style.styleFloat=f.styleFloat;a.style.verticalAlign=f.verticalAlign;RTE.RteUtility.$7B(a,[b+c,e])}}else if(!RTE.Canvas.getCachedRestriction(d,"UseInlineStyle",false))RTE.RteUtility.$1V(a,"",[b+RTE.RichTextEditor.imageClass]);else{RTE.RteUtility.$7B(a,[b+c]);a.style.styleFloat="";a.style.verticalAlign=""}}};RTE.RichTextEditor.clearImageStyle=function(){ULSdmo:;RTE.SnapshotManager.takeSnapshot();var a=RTE.CanvasEvents.getNodeFromEvent("Image"),b=RTE.Canvas.getCurrentStyleSheetPrefix();RTE.RteUtility.$1V(a,"",[b+RTE.RichTextEditor.imageClass]);RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.splitVertical=function(){ULSdmo:;RTE.SnapshotManager.takeSnapshot();RTE.TableCommands.splitVertical();RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.splitHorizontal=function(){ULSdmo:;RTE.SnapshotManager.takeSnapshot();RTE.TableCommands.splitHorizontal();RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.paste=function(a){ULSdmo:;RTE.Cursor.paste(a)};RTE.RichTextEditor.strikeThrough=function(){ULSdmo:;RTE.SnapshotManager.takeSnapshot();RTE.FontCommands.$Dn();RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.subscript=function(){ULSdmo:;RTE.SnapshotManager.takeSnapshot();RTE.FontCommands.$Dp();RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.superscript=function(){ULSdmo:;RTE.SnapshotManager.takeSnapshot();RTE.FontCommands.$Dq();RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.redo=function(){ULSdmo:;RTE.SnapshotManager.redo()};RTE.RichTextEditor.underline=function(){ULSdmo:;RTE.SnapshotManager.takeSnapshot();RTE.FontCommands.$Ds();RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.undo=function(){ULSdmo:;RTE.SnapshotManager.undo()};RTE.RichTextEditor.transferContentsToInputField=function(c,a){ULSdmo:;if(arguments.length===1)a=false;var b=$get(c);if(!b)return;RTE.RichTextEditor.transferContentsToInputFieldNode(b,a)};RTE.RichTextEditor.transferContentsToInputFieldNode=function(a,b){ULSdmo:;if(arguments.length===1)b=false;var c=RTE.RteUtility.getAttribute(a,"InputFieldId");if(!c)return;var d={};d.editableRegion=a;RTE.CanvasEvents.dispatchEvent("Transfer",null,d);RTE.TableCommands.setTableGridLines(false);RTE.PreviewManager.get_instance().endPreview();var e=b&&RTE.Canvas.$1W&&RTE.RteUtility.$M(RTE.Cursor.get_range().$1_0,a,null)&&RTE.RteUtility.$M(RTE.Cursor.get_range().$2_0,a,null),f=$get(c);if(f){var i=RTE.Canvas.getEditableRegionHtml(a,e);RTE.RteUtility.setInputValue(f,i)}var g=$get("ms-rtefocuselementid");if(g&&e)g.value=a.id;var h=$get("ms-rtedirtybit");if(h)h.value=RTE.DirtyBitManager.isDirty()?"1":"0"};RTE.UnitValue=function(){};RTE.UnitValue.prototype={value:0,unit:null};RTE.RteUtility=function(){};RTE.RteUtility.$$cctor=function(){ULSdmo:;RTE.RteUtility.$59=Sys.Browser.agent===Sys.Browser.Firefox||Sys.Browser.name.toLowerCase().indexOf("firefox")!==-1;RTE.RteUtility.$5C=Sys.Browser.agent===Sys.Browser.Safari||Sys.Browser.name.toLowerCase().indexOf("safari")!==-1||Sys.Browser.name.toLowerCase().indexOf("webkit")!==-1;RTE.RteUtility.$2T=Sys.Browser.agent===Sys.Browser.InternetExplorer;if(RTE.RteUtility.$2T)RTE.RteUtility.$57=Sys.Browser.version;else if(!RTE.RteUtility.$59&&!RTE.RteUtility.$5C&&Sys.Browser.name&&Sys.Browser.name.toLowerCase().indexOf("netscape")!==-1){var b=new RegExp("Trident/.*rv:([0-9]{1,}[\\.0-9]{0,})","gi"),a=b.exec(navigator.userAgent);if(a&&a.length>=2)try{RTE.RteUtility.$57=parseFloat(a[1]);RTE.RteUtility.$2T=true}catch(c){RTE.RteUtility.$2T=false}}};RTE.RteUtility.get_nonbreakSpace=function(){ULSdmo:;return RTE.RteUtility.$1X};RTE.RteUtility.isFirefox=function(){ULSdmo:;return RTE.RteUtility.$59};RTE.RteUtility.isInternetExplorer=function(){ULSdmo:;return RTE.RteUtility.$2T};RTE.RteUtility.isSafari=function(){ULSdmo:;return RTE.RteUtility.$5C};RTE.RteUtility.$7D=function(){ULSdmo:;return RTE.RteUtility.$2T&&RTE.RteUtility.$57<11};RTE.RteUtility.$CW=function(a,b,g){ULSdmo:;var e=a.nodeValue,f=b.nodeValue,c=b,d=a;if(g){c=a;d=b}c.nodeValue=e+f;RTE.RteUtility.removeNode(d)};RTE.RteUtility.$A2=function(a){ULSdmo:;RTE.SU.isNullOrEmptyString(a.style.cssText)&&a.removeAttribute("style")};RTE.RteUtility.removeQuotes=function(a){ULSdmo:;return a.charAt(0)==='"'&&a.length>1&&a.charAt(a.length-1)==='"'?a.substring(1,a.length-1):a};RTE.RteUtility.removeNodeAndKeepChildNodes=function(a){ULSdmo:;var b=a.parentNode;if(!b)return;while(a.firstChild)b.insertBefore(a.firstChild,a);b.removeChild(a)};RTE.RteUtility.htmlEncode=function(a){ULSdmo:;a=a.replace(new RegExp("&","g"),"&amp;");a=a.replace(new RegExp('"',"g"),"&quot;");a=a.replace(new RegExp("'","g"),"&#39;");a=a.replace(new RegExp("<","g"),"&lt;");a=a.replace(new RegExp(">","g"),"&gt;");a=a.replace(new RegExp(RTE.RteUtility.$1X,"g"),"&#160;");return a};RTE.RteUtility.htmlAttributeEncode=function(a){ULSdmo:;a=a.replace(new RegExp("&","g"),"&amp;");a=a.replace(new RegExp("<","g"),"&lt;");a=a.replace(new RegExp('"',"g"),"&quot;");a=a.replace(new RegExp("'","g"),"&#39;");return a};RTE.RteUtility.urlEncode=function(a){ULSdmo:;return encodeURIComponent(a)};RTE.RteUtility.$9o=function(b){ULSdmo:;var a=b.previousSibling;while(a&&RTE.RteUtility.isTextNode(a))a=a.previousSibling;return a};RTE.RteUtility.focusNoFail=function(a){ULSdmo:;try{a.focus()}catch(b){}};RTE.RteUtility.getServerRelativeUrl=function(a){ULSdmo:;var b=a.indexOf("://");if(b<0)return a;var c=a.indexOf("/",b+3);return c>0?a.substr(c):""};RTE.RteUtility.$Ba=function(b,c){ULSdmo:;var a=null,d=b.innerHTML;if(RTE.RteUtility.$6u===b)if(d===RTE.RteUtility.$6s)a=RTE.RteUtility.removeEmptySpanAndRteIds(RTE.RteUtility.$6t,c,c);if(RTE.SU.isNullOrEmptyString(a)){var e=[],f=null;if(RTE.RteUtility.$Dx())f=new RTE.Ie8TreeValidator(b);RTE.RteUtility.$6W(e,b,f);a=e.join("");RTE.RteUtility.$6t=a;RTE.RteUtility.$6s=d;RTE.RteUtility.$6u=b;a=RTE.RteUtility.removeEmptySpanAndRteIds(a,c,c)}return a};RTE.RteUtility.$4y=function(a){ULSdmo:;while(a&&!RTE.RteUtility.isBlockNode(a))a=a.parentNode;return a};RTE.RteUtility.$8f=function(b,c,d){ULSdmo:;var a=RTE.RteUtility.$98(b,c,d,true);if(a)a[a.length]=b;return a};RTE.RteUtility.$98=function(a,d,e,f){ULSdmo:;var c=null;if(f&&a!==d){a=RTE.RteUtility.$Dl(a,e);if(null===(e?RTE.RteUtility.getRealPreviousSibling(a,false):RTE.RteUtility.getRealNextSibling(a,false)))c=a.parentNode}var b;if(a===d)b=new Array(0);else if(a===document.body)b=null;else{b=RTE.RteUtility.$98(a.parentNode,d,e,!!c);if(b)b[b.length]=c}return b};RTE.RteUtility.$Dl=function(a,d){ULSdmo:;var b=RTE.RteUtility.getRealLastChild(a.parentNode,false),e=!d&&RTE.RteUtility.isBlockNode(a.parentNode)&&!!b&&b.nodeType===1&&b.tagName==="BR";do{var c=d?RTE.RteUtility.getRealPreviousSibling(a,false):RTE.RteUtility.getRealNextSibling(a,false);if(!RTE.RteUtility.$i(c)&&!(e&&c===b))break;a=c}while(a);return a};RTE.RteUtility.$56=function(b,a){ULSdmo:;RTE.RteUtility.$99(b,a.nextSibling,a.parentNode)};RTE.RteUtility.$94=function(b,a){ULSdmo:;RTE.RteUtility.$99(b,a,a.parentNode)};RTE.RteUtility.$99=function(a,c,j){ULSdmo:;if(!j||!a)return;if(!RTE.RteUtility.isBlockNode(a)&&!RTE.RteUtility.$3n(a))if(a.nodeType!==1||!a.getElementsByTagName("DIV").length&&!a.getElementsByTagName("P").length){j.insertBefore(a,c);return}var d=j,b=new Array(0);while(!RTE.RteUtility.isBlockNode(d)&&!RTE.Canvas.$S(d)){Array.add(b,d);d=d.parentNode}RTE.HtmlTagName.allowedElementStyleTags[d.tagName.toUpperCase()]&&Array.add(b,d);if(!b.length){j.insertBefore(a,c);return}for(var e=null,g=0;g<b.length;g++){var h=b[g],i=h.cloneNode(false);e&&i.appendChild(e);while(c){var k=c.nextSibling;!RTE.RteUtility.$58(c)&&i.appendChild(c);c=k}if(i.firstChild)e=i;c=h.nextSibling;if(g<b.length-1)RTE.RteUtility.$6d(h)&&RTE.RteUtility.removeNodeAndKeepChildNodes(h)}var f=b[b.length-1];if(e){RTE.RteUtility.insertAfter(e,f);RTE.RteUtility.$81(e)}RTE.RteUtility.insertAfter(a,f);RTE.RteUtility.$6d(f)&&RTE.RteUtility.removeNodeAndKeepChildNodes(f)};RTE.RteUtility.$81=function(a){ULSdmo:;if(a.nodeType===1&&!RTE.RteUtility.$i(a)){a.firstChild&&a.firstChild===a.lastChild&&RTE.RteUtility.$81(a.firstChild);RTE.RteUtility.$6d(a)&&RTE.RteUtility.removeNodeAndKeepChildNodes(a)}};RTE.RteUtility.$6d=function(b){ULSdmo:;for(var a=0;a<b.childNodes.length;a++)if(!RTE.RteUtility.$3F(b.childNodes[a]))return false;return true};RTE.RteUtility.$3n=function(b){ULSdmo:;if(b.nodeType===1)for(var a=0;a<b.childNodes.length;a++)if(RTE.RteUtility.isBlockNode(b.childNodes[a]))return true;return false};RTE.RteUtility.getComputedStyle=function(c){ULSdmo:;try{var a=c.currentStyle;if(!a){var b=document.defaultView;if(b&&b.getComputedStyle)a=b.getComputedStyle(c,null)}return a}catch(d){return null}};RTE.RteUtility.$9L=function(b){ULSdmo:;var a=RTE.RteUtility.getComputedStyle(b);return a?RTE.RteUtility.$6q(a.overflow)||RTE.RteUtility.$6q(a.overflowX)||RTE.RteUtility.$6q(a.overflowY):false};RTE.RteUtility.$6q=function(a){ULSdmo:;if(!RTE.SU.isNullOrEmptyString(a)){a=a.toLowerCase();return a==="auto"||a==="scroll"}return false};RTE.RteUtility.$5B=function(a,b){ULSdmo:;return!RTE.RteUtility.isEmptyTextNode(a,true)&&(!b||!RTE.RteUtility.$i(a))};RTE.RteUtility.getRealPreviousSibling=function(c,b){ULSdmo:;var a=c;do a=a.previousSibling;while(a&&!RTE.RteUtility.$5B(a,b));return a};RTE.RteUtility.$Dx=function(){ULSdmo:;if(!RTE.RteUtility.isInternetExplorer())return false;var a=true;if(typeof msRichTextEditorEnableIEValidator==="boolean")a=msRichTextEditorEnableIEValidator;return a};RTE.RteUtility.getRealNextSibling=function(c,b){ULSdmo:;var a=c;do a=a.nextSibling;while(a&&!RTE.RteUtility.$5B(a,b));return a};RTE.RteUtility.getRealFirstChild=function(c,b){ULSdmo:;var a=c.firstChild;if(a&&!RTE.RteUtility.$5B(a,b))a=RTE.RteUtility.getRealNextSibling(a,b);return a};RTE.RteUtility.getRealLastChild=function(c,b){ULSdmo:;var a=c.lastChild;if(a&&!RTE.RteUtility.$5B(a,b))a=RTE.RteUtility.getRealPreviousSibling(a,b);return a};RTE.RteUtility.$Be=function(u,a,v){ULSdmo:;var g=null;try{g=a.outerHTML}catch(F){}if(!RTE.SU.isNullOrUndefined(g)&&RTE.RteUtility.$5k){var k=RTE.RteUtility.$52[g];if(!RTE.SU.isNullOrUndefined(k)){for(var x=k.length,l=0;l<x;l++){var y=k[l];u.push(y)}return false}}var h=false,b=[],d=a.className,c=a.tagName;if(c)c=c.toUpperCase();if(RTE.RteUtility.isTextNode(a)){var z=a.nodeValue;b.push(RTE.RteUtility.htmlEncode(z))}else if(RTE.RteUtility.isSvgNode(a)){var A=RTE.RteUtility.$Bw(a);b.push(A)}else if(d&&d.indexOf("ms-rtegenerate-notify")!==-1){var q=new Sys.StringBuilder,m={};m.html=q;m.node=a;RTE.CanvasEvents.dispatchEvent("ElementGenerateTag",null,m);b.push(q.toString())}else if(d&&d.indexOf("ms-rtegenerate-object")!==-1)b.push(a.getAttribute("object"));else if(c==="XML"||c==="SCRIPT"||c==="STYLE"){var B=c.toLowerCase();RTE.RteUtility.generateStartTag(b,a);b.push(a.innerHTML);RTE.RteUtility.generateEndTag(b,B)}else if(c==="OBJECT"||c==="EMBED"){var f=[],C=c.toLowerCase();RTE.RteUtility.generateStartTag(f,a);if(!a.childNodes.length||!RTE.RteUtility.isInternetExplorer())f.push(a.innerHTML);else{RTE.RteUtility.$6W(f,a,v);f.push(a.altHtml)}RTE.RteUtility.generateEndTag(f,C);var r=RTE.RteUtility.$9v(f.join(""),false);b.push(r);var i=document.createElement("SPAN");i.className="ms-rtegenerate-object";i.setAttribute("object",r);i.contentEditable=false;a.parentNode.insertBefore(i,a);i.appendChild(a)}else if(!(c&&c.charAt(0)==="/")){var e=false,j=false;if(d&&d.indexOf("ms-rtegenerate-skip")!==-1)e=true;else if(d&&d.indexOf("ms-rtegenerate-allskip")!==-1){e=true;j=true}else if(RTE.RteUtility.$3B(a)){RTE.RteUtility.$BP(b,a);j=true;e=true}else if(RTE.RteUtility.isCommentTag(a)){RTE.RteUtility.$BK(b,a);j=true;e=true}else if(c.indexOf("<")>-1||RTE.SU.isNullOrEmptyString(c))e=true;if(!e){RTE.RteUtility.generateStartTag(b,a);var s=a.id;if(s&&s.indexOf("ms-rterangecursor")!==-1)h=true}if(!j){if(a.childNodes.length>0){var D=RTE.RteUtility.$6W(b,a,v);h=!!(h|D)}else RTE.RteUtility.$BL(b,a);if((c==="DIV"||c==="P")&&a.innerText===""&&a.offsetHeight&&RTE.SU.isNullOrEmptyString(a.style.minHeight)&&RTE.SU.isNullOrEmptyString(a.style.height)&&!RTE.Canvas.$S(a)){var n=a.innerHTML;(!n||n.indexOf("<BR")===-1&&n.indexOf("<IMG")===-1)&&b.push("&#160;")}}if(!e){var E=c.toLowerCase();RTE.RteUtility.generateEndTag(b,E)}}for(var w=b.length,p=0,o=0;o<w;o++){var t=b[o];u.push(t);p+=t.length}if(!RTE.SU.isNullOrUndefined(g)&&!h&&RTE.RteUtility.$5k){RTE.RteUtility.$52[g]=b;RTE.RteUtility.$53+=p}return h};RTE.RteUtility.$Bw=function(a){ULSdmo:;if(typeof XMLSerializer!=="undefined"){var b=new XMLSerializer;return b.serializeToString(a)}return a.xml||""};RTE.RteUtility.$6W=function(j,e,b){ULSdmo:;for(var f=e.childNodes,g=f.length,c=false,h=e.uniqueID,d=0;d<g;d++){var a=f[d];if(RTE.RteUtility.isInternetExplorer())if(b&&!b.$Df_0(e,a)||!b&&a.parentNode&&a.parentNode.uniqueID!==h)continue;var i=RTE.RteUtility.$Be(j,a,b);c=!!(c|i)}return c};RTE.RteUtility.$Aw=function(){ULSdmo:;if(RTE.RteUtility.$53>1310720&&RTE.RteUtility.$53<0)RTE.RteUtility.$52={};if(RTE.RteUtility.$4N>1310720&&RTE.RteUtility.$4N<0){RTE.RteUtility.$5i={};RTE.RteUtility.$4N=0}window.setTimeout(RTE.RteUtility.$6C,18e5)};RTE.RteUtility.$8s=function(){ULSdmo:;return!RTE.RteUtility.isFirefox()?document.body:window.self.self};RTE.RteUtility.$X=function(b,c){ULSdmo:;var a=RTE.RteUtility.$8s();$addHandler(a,b,c)};RTE.RteUtility.$8C=function(b,c){ULSdmo:;var a=RTE.RteUtility.$8s();$removeHandler(a,b,c)};RTE.RteUtility.$4Q=function(a){ULSdmo:;while(a.childNodes.length>0)RTE.RteUtility.insertBefore(a.childNodes[0],a)};RTE.RteUtility.$3T=function(a){ULSdmo:;while(a.childNodes.length>0)RTE.RteUtility.insertAfter(a.childNodes[a.childNodes.length-1],a)};RTE.RteUtility.getPosition=function(b){ULSdmo:;var a={};a.x=0;a.y=0;RTE.RteUtility.$Bm(b,a);return a};RTE.RteUtility.$Bm=function(a,b){ULSdmo:;while(a&&a!==document.documentElement){b.x+=a.offsetLeft;b.y+=a.offsetTop;a=a.offsetParent}};RTE.RteUtility.$Bs=function(b){ULSdmo:;var a={};a.x=0;a.y=0;RTE.RteUtility.$Bt(b,a);return a};RTE.RteUtility.$Bt=function(a,b){ULSdmo:;while(a&&a!==document.documentElement){b.x+=a.scrollLeft;b.y+=a.scrollTop;a=a.parentNode}b.x+=document.documentElement.scrollLeft;b.y+=document.documentElement.scrollTop};RTE.RteUtility.$Br=function(b){ULSdmo:;var a={};a.x=0;a.y=0;RTE.RteUtility.$8n(b,a);return a};RTE.RteUtility.$8n=function(a,b){ULSdmo:;if(!a)return;b.x+=a.offsetLeft-a.scrollLeft;b.y+=a.offsetTop-a.scrollTop;RTE.RteUtility.$8n(a.offsetParent,b)};RTE.RteUtility.getOffset=function(b){ULSdmo:;var a={};a.x=0;a.y=0;RTE.RteUtility.$8j(b,a,false);return a};RTE.RteUtility.$8j=function(a,b){ULSdmo:;var e=a.cachedOffsetSet;if(e){var f=a.cachedOffsetY,g=a.cachedOffsetX;b.y+=f;b.x+=g;return}a.parentNode&&a.offsetParent&&RTE.RteUtility.$8j(a.offsetParent,b,true);if(!RTE.RteUtility.isTextNode(a)&&a.tagName.toUpperCase()==="TD"&&a.runtimeStyle){if(a.runtimeStyle.borderTopStyle!=="none"){var c=parseInt(a.runtimeStyle.borderTopWidth);if(!isNaN(c))b.y+=c}if(a.runtimeStyle.borderLeftStyle!=="none"){var d=parseInt(a.runtimeStyle.borderLeftWidth);if(!isNaN(d))b.x+=d}}b.y+=a.offsetTop;b.x+=a.offsetLeft};RTE.RteUtility.hasClass=function(c,a){ULSdmo:;var b=RTE.RteUtility.getCssClassName(c);return b.endsWith(a)||b.indexOf(a+" ")!==-1};RTE.RteUtility.getCssClassName=function(a){ULSdmo:;return a&&a.nodeType===1&&!RTE.RteUtility.isSvgNode(a)&&a.className?a.className:""};RTE.RteUtility.$3B=function(a){ULSdmo:;return RTE.RteUtility.$7c[a.tagName]==="true"};RTE.RteUtility.isCommentTag=function(a){ULSdmo:;return a.nodeType===8};RTE.RteUtility.$BM=function(){};RTE.RteUtility.ignoreNodeInOutput=function(a){ULSdmo:;Sys.UI.DomElement.addCssClass(a,"ms-rtegenerate-skip")};RTE.RteUtility.$BK=function(a,b){ULSdmo:;a.push("<!--");a.push(b.nodeValue);a.push("-->")};RTE.RteUtility.$BP=function(a,b){ULSdmo:;RTE.RteUtility.$8T(a,b);a.push("/>")};RTE.RteUtility.generateStartTag=function(a,b){ULSdmo:;RTE.RteUtility.$8T(a,b);a.push(">")};RTE.RteUtility.$8T=function(s,g){ULSdmo:;var i=g.cloneNode(false),d=null;try{d=i.outerHTML}catch(t){d=null}if(RTE.SU.isNullOrUndefined(d))try{RTE.RteUtility.$5h.appendChild(i);d=RTE.RteUtility.$5h.innerHTML;RTE.RteUtility.$5h.removeChild(i)}catch(u){d=null}var e=null;if(d)e=RTE.RteUtility.$5i[d];if(RTE.SU.isNullOrUndefined(e)){var m=RTE.RteUtility.htmlEncode,c=[],j=g.tagName;c.push("<");c.push(j.toLowerCase());var k=g.attributes;if(k){for(var n=j==="IMG",o=false,p=k.length,l=0;l<p;l++){var h=k[l],a=h.name;a=a.toLowerCase();if(!h.specified)if(a==="name"){if(h.value==="")continue}else continue;var b=h.value;if(j==="TABLE"&&a==="class")b=b.replace("ms-rteTableGrid","");else if(a==="href"&&b.indexOf("#")){try{var q=g;b=q.href}catch(v){}b=RTE.RteUtility.$5Z(b)}else if(a==="src"){try{var r=g;b=r.src}catch(w){}b=RTE.RteUtility.$5Z(b)}if(b&&b!==""&&b!=="null"&&b!=="inherit"&&a!=="_events"&&a!=="style"&&a!=="uniqueID"&&a!=="setwidth"&&a!=="setheight"&&a!=="hasheight"&&a!=="complete"&&a!=="readystate"&&(a!=="disabled"||a==="disabled"&&b!=="false")&&(a!=="hidefocus"||a==="hidefocus"&&b!=="false")&&(a!=="tabindex"||a==="tabindex"&&b!=="0")&&(a!=="dir"||a==="dir"&&b!=="none")||a==="allowfullscreen"||a==="data-spresponsive"){if(n&&a==="alt")o=true;c.push(" ");c.push(a);c.push('="');c.push(m(b));c.push('"')}}n&&!o&&c.push(' alt=""')}var f=g.style.cssText;f=f.toLowerCase();if(f!==""){f=RTE.RteUtility.$BH(f);c.push(' style="');c.push(m(f));c.push('"')}e=c.join("");if(d){RTE.RteUtility.$5i[d]=e;RTE.RteUtility.$4N+=e.length}}s.push(e)};RTE.RteUtility.$CO=function(a){ULSdmo:;var b=new RegExp("[^:]*://"+window.location.hostname+"(:|/)","i"),c=new RegExp("[^:]*://","i");return a.search(c)===-1||a.search(b)!==-1};RTE.RteUtility.$BH=function(a){ULSdmo:;if(!RTE.SU.isNullOrEmptyString(a)&&a.indexOf("rgb(")>-1){var d="",c=a.indexOf("rgb("),b=0;while(c!==-1){d+=a.substring(b,c);b=a.indexOf(")",c+1)+1;if(b!==-1)d+=RTE.RteUtility.$B1(a.substring(c,b));c=b!==-1?a.indexOf("rgb(",b):-1}d+=a.substring(b,a.length);return d}return a};RTE.RteUtility.$B1=function(a){ULSdmo:;var c=a.replace("rgb(","").replace(")",""),b=c.split(",");if(b.length===3)a=RTE.RteUtility.$85(b)||a;return a};RTE.RteUtility.convertRGBAColorToSolidHex=function(a,d){ULSdmo:;var b=a.trim().toLowerCase();if(b.startsWith("rgba(")&&b.endsWith(")")){b=a.replace("rgba(","").replace(")","");var c=b.split(",");if(c.length===4)try{var e=parseFloat(c[3]);if(e>=d)a=RTE.RteUtility.$85(c)||a}catch(f){}}return a};RTE.RteUtility.$85=function(a){ULSdmo:;if(a.length>=3)try{var b=RTE.RteUtility.$6I(a[0].trim()),c=RTE.RteUtility.$6I(a[1].trim()),d=RTE.RteUtility.$6I(a[2].trim());return"#"+b+c+d}catch(e){}return null};RTE.RteUtility.$6I=function(c){ULSdmo:;var b=Number.parseInvariant(c),a=b.toString(16);if(a.length===1)a="0"+a;return a};RTE.RteUtility.$5Z=function(e){ULSdmo:;var a=e,d=window.location.protocol,b=d+"//"+window.location.hostname,c=""+window.location.port;if(c==="")c=d==="https:"?"443":"80";if(c==="80"&&d==="http:"||c==="443"&&d==="https:")if(a===b)return"/";else if(!a.indexOf(b+"/"))return a.replace(b+"/","/");b+=":"+c;return a===b?"/":!a.indexOf(b+"/")?a.replace(b+"/","/"):a};RTE.RteUtility.generateEndTag=function(a,b){ULSdmo:;if(b){a.push("</");a.push(b);a.push(">")}};RTE.RteUtility.$BL=function(c,b){ULSdmo:;var a=b.textContent||b.innerText;a&&c.push(a)};RTE.RteUtility.$3q=function(a){ULSdmo:;return a.nodeValue===""||a.tagName==="SPAN"&&!a.childNodes.length};RTE.RteUtility.$i=function(a){ULSdmo:;return a===RTE.Cursor.s_range.$1_0||a===RTE.Cursor.s_range.$2_0||a===RTE.Cursor.$C.$1_0||a===RTE.Cursor.$C.$2_0};RTE.RteUtility.$3F=function(a){ULSdmo:;if(a.nodeType!==1)return false;if(a.tagName.toUpperCase()!=="SPAN")return false;if(RTE.RteUtility.$i(a))return true;var b=[];RTE.RteUtility.generateStartTag(b,a);var d=b.join(""),c=d.match(RTE.RteUtility.$AJ);return!!c&&c.length>0};RTE.RteUtility.$9G=function(a){ULSdmo:;if(a.nodeType!==1)return false;if(a.tagName.toUpperCase()!=="FONT")return false;var b=[];RTE.RteUtility.generateStartTag(b,a);var d=b.join(""),c=d.match(RTE.RteUtility.$8I);return!!c&&c.length>0};RTE.RteUtility.$CK=function(a){ULSdmo:;if(a.nodeType!==1)return false;if(a.tagName.toUpperCase()!=="DIV")return false;var b=[];RTE.RteUtility.generateStartTag(b,a);var d=b.join(""),c=d.match(RTE.RteUtility.$AI);return!!c&&c.length>0};RTE.RteUtility.$58=function(a){ULSdmo:;return RTE.SU.isNullOrEmptyString(a.id)&&RTE.RteUtility.$3F(a)};RTE.RteUtility.$9x=function(a){ULSdmo:;RTE.RteUtility.$9A(a,1,0)};RTE.RteUtility.$9A=function(a,c,d){ULSdmo:;if(c>0&&d>c||RTE.RteUtility.isTextNode(a))return;for(var b=0;b<a.childNodes.length;b++)RTE.RteUtility.$9A(a.childNodes[b],c,d+1);(RTE.RteUtility.$58(a)||RTE.RteUtility.$9G(a))&&RTE.RteUtility.removeNodeAndKeepChildNodes(a)};RTE.RteUtility.$DC=function(a){ULSdmo:;(RTE.RteUtility.$3F(a)||RTE.RteUtility.$9G(a))&&RTE.RteUtility.removeNodeAndKeepChildNodes(a)};RTE.RteUtility.$4z=function(a,b){ULSdmo:;return RTE.RteUtility.$8k(a,null,b)};RTE.RteUtility.$8k=function(m,n,u){ULSdmo:;if(!m)return null;var a=m,d=null;while(a&&RTE.RteUtility.isInlineNode(a)){d=a;a=a.parentNode}if(!a)return null;var i=!n?d:RTE.RteUtility.$8d(n,a,a);if(u&&d){var c=RTE.RteUtility.getRealPreviousSibling(d,false);while(c&&RTE.RteUtility.isInlineNode(c)&&(c.nodeType!==1||c.tagName!=="BR"||!c.previousSibling))c=RTE.RteUtility.getRealPreviousSibling(c,false);var b=RTE.RteUtility.getRealNextSibling(d,false),j=i?RTE.RteUtility.getRealNextSibling(i,false):null,g=b===j;while(b&&RTE.RteUtility.isInlineNode(b)&&(!g||b.nodeType!==1||b.tagName!=="BR"||!b.nextSibling)){b=RTE.RteUtility.getRealNextSibling(b,false);g=g||b===j}if(c||b){var o=RTE.Canvas.getEditableRegion(a);if(RTE.RteUtility.isSafari()){var q=RTE.Selection.getSelection();q.clear()}var p=a!==o&&RTE.HtmlTagName.allowedElementStyleTags[a.tagName.toUpperCase()];if(p){if(c){var k=a.cloneNode(false),r=c.nextSibling;while(a.firstChild!==r)k.appendChild(a.firstChild);a.parentNode.insertBefore(k,a)}if(b){var l=a.cloneNode(false),f=b;while(f){var s=f.nextSibling;l.appendChild(f);f=s}a.parentNode.insertBefore(l,a.nextSibling)}}else{var e=c?c.nextSibling:a.firstChild;if(e!==a.firstChild||b){var h=a.ownerDocument.createElement("DIV");while(e!==b){var t=e.nextSibling;h.appendChild(e);e=t}a.insertBefore(h,b);a=h}}c&&c.nodeType===1&&c.tagName==="BR"&&c.parentNode.removeChild(c);b&&b.nodeType===1&&b.tagName==="BR"&&b.parentNode.removeChild(b)}}if(a.tagName==="TR"&&a.parentNode&&(a.parentNode.tagName==="TBODY"||a.parentNode.tagName==="THEAD"||a.parentNode.tagName==="TFOOT"))a=a.parentNode;if((a.tagName==="TBODY"||a.tagName==="THEAD"||a.tagName==="TFOOT")&&a.parentNode&&a.parentNode.tagName==="TABLE")a=a.parentNode;return a};RTE.RteUtility.fixLinkHierarchy=function(a){ULSdmo:;if(a&&a.parentNode){var c=a.getElementsByTagName("A");while(c.length>0)RTE.RteUtility.removeNodeAndKeepChildNodes(c[0]);if(RTE.RteUtility.isStringInArray(a.parentNode.tagName,RTE.RteUtility.$6l)){for(var b=0;b<a.childNodes.length;b++)RTE.RteUtility.$AV(a,a.childNodes[b]);RTE.RteUtility.removeNodeAndKeepChildNodes(a)}}};RTE.RteUtility.$AV=function(c,a){ULSdmo:;if(!RTE.RteUtility.$i(a))if(a.nodeType===1)if(RTE.RteUtility.isStringInArray(a.tagName,RTE.RteUtility.$6l))for(var b=0;b<a.childNodes.length;b++)RTE.RteUtility.$AV(c,a.childNodes[b]);else{var d=c.cloneNode(false);RTE.RteUtility.moveChildNodes(a,d);a.appendChild(d)}else if(RTE.RteUtility.isTextNode(a)&&!RTE.RteUtility.isEmptyTextNode(a,true)){var e=c.cloneNode(false);a.parentNode.insertBefore(e,a);e.appendChild(a)}};RTE.RteUtility.getNearestParentElementOfType=function(b,a){ULSdmo:;return RTE.RteUtility.$20(b,[a])};RTE.RteUtility.$20=function(b,e){ULSdmo:;var f=e.length;if(!b)return null;for(var c=0;c<f;c++)if(b.tagName===e[c])return b;var a=b.parentNode;while(a){for(var d=0;d<f;d++)if(a.tagName===e[d])return a;a=a.parentNode}return null};RTE.RteUtility.$BZ=function(){ULSdmo:;var b="",c=RTE.Selection.getSelectionRange();if(null===c)return b;var d="|H1|H2|H3|H4|H5|H6|P|PRE|LI|TD|DIV|BLOCKQUOTE|DT|DD|TABLE|HR|IMG|TR|UL|OL|BODY|HTML|",a=c.parentElement();while(a&&(d.indexOf("|"+a.tagName+"|")===-1||a.dir!=="ltr"&&a.dir!=="rtl"))a=a.parentNode;if(a)if(a.dir==="ltr")b="ltr";else if(a.dir==="rtl")b="rtl";return b};RTE.RteUtility.isInlineNode=function(a){ULSdmo:;return RTE.RteUtility.isTextNode(a)?true:RTE.SU.isNullOrEmptyString(a.tagName)?true:a._blockElement?false:RTE.HtmlTagName.$93[a.tagName]?true:false};RTE.RteUtility.isBlockNode=function(a){ULSdmo:;return a.nodeType!==1?false:RTE.RteUtility.$3p(a.tagName)?true:a._blockElement?true:false};RTE.RteUtility.$3p=function(a){ULSdmo:;return RTE.SU.isNullOrEmptyString(a)?false:RTE.HtmlTagName.$66[a.toUpperCase()]};RTE.RteUtility.getCurrentStyle=function(a){ULSdmo:;if(RTE.RteUtility.isTextNode(a))a=a.parentNode;var b=a.currentStyle;if(RTE.SU.isNullOrUndefined(b))if(window.getComputedStyle)b=window.getComputedStyle(a,null);return b};RTE.RteUtility.$M=function(a,b,c){ULSdmo:;return!!RTE.RteUtility.$8d(a,b,c)};RTE.RteUtility.$8d=function(d,b,e){ULSdmo:;if(!d||!b)return null;var a=d,c=null;while(a&&a!==b&&a!==e){c=a;a=a.parentNode}return a===b?c:null};RTE.RteUtility.containsVisibleNode=function(a){ULSdmo:;if(RTE.RteUtility.isTextNode(a))return a.nodeValue.length>0;switch(a.tagName){case"IMG":case"HR":return true}for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];if(RTE.RteUtility.isTextNode(c))return c.nodeValue.length>0;var d=RTE.RteUtility.containsVisibleNode(c);if(d)return true}return false};RTE.RteUtility.moveChildNodes=function(a,b){ULSdmo:;while(a.childNodes.length>0)b.appendChild(a.childNodes[0])};RTE.RteUtility.removeNode=function(a){ULSdmo:;if(a.parentNode){if(a.nodeType===1&&!Sys.UI.DomElement.containsCssClass(a,"ms-rtestate-read")&&typeof a.innerHTML!=="undefined")try{a.innerHTML=""}catch(b){}a.parentNode.removeChild(a)}};RTE.RteUtility.removeChildNodes=function(a){ULSdmo:;while(a.firstChild)a.removeChild(a.firstChild)};RTE.RteUtility.$9D=function(b){ULSdmo:;var a=b.parentNode;return b.nodeType===8||RTE.SU.isNullOrUndefined(a)||b.tagName!=="TD"&&b.tagName!=="TH"&&(a.tagName==="TR"||a.tagName==="TBODY"||a.tagName==="TABLE")||b.tagName!=="LI"&&(a.tagName==="UL"||a.tagName==="OL")};RTE.RteUtility.$B4=function(a){ULSdmo:;if(document.caretRangeFromPoint){var e=a.clientX,f=a.clientY;return document.caretRangeFromPoint(e,f)}var b=document.body.createTextRange?document.body.createTextRange():RTE.DomHelper.createRange(window.document);if(b.moveToPoint)try{var g=a.clientX,h=a.clientY;b.moveToPoint(g,h)}catch(i){return null}else if(a.rangeParent){var c=a.rangeParent,d=a.rangeOffset;b.setStart(c,d);b.setEnd(c,d)}else return null;return b};RTE.RteUtility.$1L=function(a){ULSdmo:;if(RTE.PreviewManager.get_instance().get_hasPreview())return false;while(a&&RTE.RteUtility.isSvgNode(a))a=a.parentNode;if(!a)return true;if(RTE.PasteFlyout.$CF(a))return false;for(var c=RTE.Canvas.get_autocompleteHandlers(),d=c.length,b=0;b<d;++b){var e=c[b];if(e.isSuggestionNode(a))return false}return RTE.UiServices.$I.isFocusValidOnThisNode(a)};RTE.RteUtility.$CC=function(a){ULSdmo:;var b=a.defaultPrevented||a.returnValue===false;if(!b&&a.getPreventDefault)b=a.getPreventDefault();return b};RTE.RteUtility.get_ignoreClasses=function(){ULSdmo:;if(!RTE.RteUtility.$7K){RTE.RteUtility.$4F["ms-rtestate-write"]=true;RTE.RteUtility.$4F["ms-rtestate-read"]=true;RTE.RteUtility.$4F["ms-rtefocus-invalid"]=true;RTE.RteUtility.$7K=true}return RTE.RteUtility.$4F};RTE.RteUtility.setInputValue=function(a,b){ULSdmo:;RTE.RteUtility.assertNotNull("inputNode",a);if(a.tagName==="TEXTAREA")RTE.RteUtility.setInnerText(a,b);else a.value=b};RTE.RteUtility.$9v=function(a,b){ULSdmo:;return b?a.replace(RTE.RteUtility.$8J,""):a.replace(RTE.RteUtility.$89,"")};RTE.RteUtility.removeEmptySpanAndRteIds=function(a,b,c){ULSdmo:;a=RTE.RteUtility.$9v(a,b);if(!c)a=a.replace(RTE.RteUtility.$7I,"");return a};RTE.RteUtility.$DB=function(a){ULSdmo:;return a.replace(RTE.RteUtility.$9q,"").replace(RTE.RteUtility.$7I,"")};RTE.RteUtility.assertNotNull=function(a,b){ULSdmo:;if(!b)throw Error.argumentNull(a);};RTE.RteUtility.createStyleSheet=function(){ULSdmo:;if(document.createStyleSheet)return document.createStyleSheet();else{var a=document.createElement("STYLE");document.body.appendChild(a);return a.styleSheet?a.styleSheet:a.sheet?a.sheet:null}};RTE.RteUtility.getFirstStyleSheet=function(){ULSdmo:;var a=document.styleSheets;return!a.length?RTE.RteUtility.createStyleSheet():a[0]};RTE.RteUtility.addStyleSheetRule=function(a,b,d,c){ULSdmo:;if(!a)return;if(a.addRule)a.addRule(b,d,c);else a.insertRule&&a.insertRule(b+" {"+d+"}",c)};RTE.RteUtility.removeStyleSheetRule=function(a,b){ULSdmo:;if(!a)return;if(a.removeRule)a.removeRule(b);else a.deleteRule&&a.deleteRule(b)};RTE.RteUtility.$BY=function(e,d){ULSdmo:;for(var b=e.className.split(" "),a=0;a<b.length;a++)if(b[a].length>0)for(var c=0;c<d.length;c++)if(b[a].indexOf(d[c])!==-1)return b[a];return null};RTE.RteUtility.$8e=function(g,f){ULSdmo:;for(var a="",c=g.className.split(" "),b=0;b<c.length;b++)if(c[b].length>0){for(var e=false,d=0;d<f.length;d++)if(c[b].indexOf(f[d])!==-1){e=true;break}if(!e){if(a.length>0)a=a+" ";a=a+c[b]}}return a};RTE.RteUtility.$1V=function(b,c,d){ULSdmo:;var a=RTE.RteUtility.$8e(b,d);if(a.length>0)a=a+" ";a=a+c;RTE.SnapshotManager.setCurrentRegionDirtyIf(b.className!==a);b.className=a;return a};RTE.RteUtility.$7B=function(a,c){ULSdmo:;var b=RTE.RteUtility.$8e(a,c);a.className=b};RTE.RteUtility.$BU=function(a){ULSdmo:;while(a&&a.tagName!=="A")a=a.parentNode;return a};RTE.RteUtility.parseUnitValue=function(b){ULSdmo:;if(RTE.SU.isNullOrEmptyString(b)||b==="auto")return null;for(var a=new RTE.UnitValue,c=0,c=0;c<b.length;c++){var d=b.charCodeAt(c);if(d===46||d>=48&&d<=57)continue;else break}a.value=parseFloat(b.substr(0,c));if(isNaN(a.value))return null;if(c<b.length){a.unit=b.substr(c).trim();a.unit=a.unit.toLowerCase()}else a.unit="";return!RTE.RteUtility.isStringInArray(a.unit,RTE.RteUtility.$AQ)?null:a};RTE.RteUtility.$3g=function(b){ULSdmo:;var a=b.createElement("P");if(RTE.RteUtility.isFirefox()){var c=b.createElement("BR");a.appendChild(c)}return a};RTE.RteUtility.$2j=function(a,c){ULSdmo:;if(RTE.RteUtility.isInternetExplorer()&&a.tagName==="TABLE"){var b=document.createElement("DIV");b.innerHTML="<table>"+c+"</table>";while(a.childNodes.length>0)a.removeChild(a.childNodes[0]);RTE.RteUtility.moveChildNodes(b.firstChild,a)}else{a.innerHTML="<div>RTE</div>"+c;a.removeChild(a.firstChild)}};RTE.RteUtility.$CB=function(a){ULSdmo:;var b=RTE.RteUtility.getAttribute(a,"ContentEditable");while(a){if(b==="true")return true;a=a.parentNode}return false};RTE.RteUtility.setInnerHTMLWithEvents=function(a,b){ULSdmo:;RTE.CanvasEvents.dispatchBeforeRestoreOnEditableRegion(a);RTE.RteUtility.$2j(a,b);RTE.CanvasEvents.dispatchAfterRestoreOnEditableRegion(a)};RTE.RteUtility.isElementConnected=function(a){ULSdmo:;while(a){if(a===a.ownerDocument.body)return true;a=a.parentNode}return false};RTE.RteUtility.$DD=function(c){ULSdmo:;for(var a=c.length-1;a>=0;a--){var b=c[a];if(RTE.RteUtility.$CJ(b)||RTE.RteUtility.isSvgNode(b)){Array.remove(c,b);continue}}};RTE.RteUtility.$CJ=function(a){ULSdmo:;while(null!==a){var b=a.className;if(b){if(b.indexOf("ms-rtestate-write")!==-1)return false;if(b.indexOf("ms-rtestate-read")!==-1)return true}a=a.parentNode}return false};RTE.RteUtility.$f=function(a,b){ULSdmo:;if(a)if(a.removeAttribute)a.removeAttribute(b);else a[b]=""};RTE.RteUtility.$BW=function(c,d,e,f){ULSdmo:;var a=c.createElement("SPAN");RTE.RteUtility.insertBefore(a,d);a.className=e;var b=RTE.RteUtility.$BV(a,f);RTE.RteUtility.removeNode(a);return b};RTE.RteUtility.$BV=function(b,c){ULSdmo:;var a=RTE.RteUtility.getCurrentStyle(b);return a[c]};RTE.RteUtility.isStringInArray=function(c,b){ULSdmo:;for(var a=0;a<b.length;a++)if(c===b[a])return true;return false};RTE.RteUtility.$2S=function(b,c){ULSdmo:;for(var a=0;a<b.length;a++)if(c.indexOf(b[a])!==-1)return true;return false};RTE.RteUtility.$8H=function(d){ULSdmo:;for(var b=d.length,c=new Array(b),a=0;a<b;a++)c[a]=d[a];return c};RTE.RteUtility.forEachChildWithTagAndClass=function(c,e,f,i){ULSdmo:;var d=!RTE.SU.isNullOrEmptyString(f),b=!RTE.SU.isNullOrEmptyString(e),a;if((b&&e.indexOf(":")===-1||d)&&c.querySelectorAll){var j=(b?e:"")+(d?"."+f:"");a=c.querySelectorAll(j);b=false;d=false}else if(b){a=c.getElementsByTagName(e);a=RTE.RteUtility.$8H(a);b=false}else{a=c.getElementsByTagName("*");a=RTE.RteUtility.$8H(a)}for(var g=0;g<a.length;g++){var h=a[g];(!d||h.className&&h.className.indexOf(f)!==-1)&&i(h)}};RTE.RteUtility.showUiExperience=function(b){ULSdmo:;var a=RTE.Canvas.currentEditableRegion();if(!a||RTE.Canvas.getCachedRestriction(a,"DisableRibbonCommands",false))return;RTE.RteUtility.$5r=b;window.setTimeout(RTE.RteUtility.$Di,0)};RTE.RteUtility.$Di=function(){ULSdmo:;RTE.UiServices.$I.showUiExperience(RTE.RteUtility.$5r)};RTE.RteUtility.getAttribute=function(a,c){ULSdmo:;if(!a.getAttribute)return null;var b=a.getAttribute(c);return!RTE.SU.isNullOrUndefined(b)?b:a[c]};RTE.RteUtility.isClassAvailable=function(d){ULSdmo:;for(var c=d.split("."),a=window,b=0;b<c.length;b++){a=a[c[b]];if(!a)return false}return true};RTE.RteUtility.classMustExist=function(a){ULSdmo:;!RTE.RteUtility.isClassAvailable(a)};RTE.RteUtility.initImageForce=function(a){ULSdmo:;a.setAttribute("ForceImageSizeInit","true");RTE.RteUtility.initImage(a)};RTE.RteUtility.initImageSizeForce=function(a){ULSdmo:;a.setAttribute("ForceImageSizeInit","true");RTE.RteUtility.$92(a)};RTE.RteUtility.initImage=function(a){ULSdmo:;a.style.margin="5px";RTE.RteUtility.$92(a)};RTE.RteUtility.$92=function(a){ULSdmo:;if(!a.style.width&&!a.style.height)if(a.src&&a.src.length>0)RTE.RteUtility.$7U(a);else $addHandler(a,"load",RTE.RteUtility.$6i)};RTE.RteUtility.$Da=function(a){ULSdmo:;RTE.RteUtility.$7U(a.target);$removeHandler(a.target,"load",RTE.RteUtility.$6i)};RTE.RteUtility.$7U=function(a){ULSdmo:;if(a.complete||a.readyState==="complete"){var c=a.getAttribute("ForceImageSizeInit");if(c==="true"||!a.style.width&&!a.style.height){var b=RTE.Canvas.getEditableRegion(a)||RTE.Canvas.currentEditableRegion();if(b)if(b.clientWidth<a.width){a.removeAttribute("width");a.removeAttribute("height");a.style.height="";a.style.width=Math.max(20,b.clientWidth-20)+"px"}}a.removeAttribute("ForceImageSizeInit")}else a.src&&a.src.length>0&&window.setTimeout(function(){ULSdmo:;RTE.RteUtility.$7U(a)},20)};RTE.RteUtility.$CH=function(c,d){ULSdmo:;for(var b=0;b<c.childNodes.length;b++){var a=c.childNodes[b];if(a!==RTE.Cursor.s_range.$1_0&&a!==RTE.Cursor.s_range.$2_0&&!RTE.RteUtility.isEmptyTextNode(a,d)&&!RTE.RteUtility.$3q(a))return false}return true};RTE.RteUtility.isEmptyTextNodeDeep=function(a,b){ULSdmo:;if(RTE.RteUtility.isEmptyTextNode(a,b))return true;if(a.nodeType===1&&a.firstChild===a.lastChild){var c=a.tagName.toUpperCase();if((c==="FONT"||c==="SPAN")&&(!a.firstChild||RTE.RteUtility.isEmptyTextNodeDeep(a.firstChild,b)))return true}return false};RTE.RteUtility.isEmptyTextNode=function(a,b){ULSdmo:;return!RTE.RteUtility.isTextNode(a)?false:RTE.RteUtility.isEmptyString(a.nodeValue,b)};RTE.RteUtility.isEmptyString=function(a,b){ULSdmo:;if(RTE.SU.isNullOrEmptyString(a))return true;var c=b?RTE.RteUtility.$AL:RTE.RteUtility.$AM;return c.test(a)};RTE.RteUtility.getViewPortWidth=function(b){ULSdmo:;var a;a=b.document.documentElement.clientWidth;if(RTE.SU.isNullOrUndefined(a)||a<=0)a=b.innerWidth;if(RTE.SU.isNullOrUndefined(a)||a<=0)a=b.document.body.clientWidth;return a};RTE.RteUtility.getViewPortHeight=function(b){ULSdmo:;var a;a=b.document.documentElement.clientHeight;if(RTE.SU.isNullOrUndefined(a)||a<=0)a=b.innerHeight;if(RTE.SU.isNullOrUndefined(a)||a<=0)a=b.document.body.clientHeight;return a};RTE.RteUtility.getRteNodeId=function(b){ULSdmo:;if(!RTE.RteUtility.isValidRteNodeId(b))throw Error.invalidOperation("this node cannot have id");var a=b.getAttribute("RteNodeId");if(RTE.SU.isNullOrUndefined(a)){a=""+RTE.RteUtility.$72;RTE.RteUtility.$72++;b.setAttribute("RteNodeId",a)}return a};RTE.RteUtility.isValidRteNodeId=function(a){ULSdmo:;return a.nodeType===1};RTE.RteUtility.removeRteNodeId=function(a){ULSdmo:;RTE.RteUtility.isValidRteNodeId(a)&&a.removeAttribute("RteNodeId")};RTE.RteUtility.removeRteNodeIdAll=function(a){ULSdmo:;if(RTE.RteUtility.isValidRteNodeId(a)){a.removeAttribute("RteNodeId");if(a.querySelectorAll)for(var b=a.querySelectorAll("[RteNodeId]"),d=!b?0:b.length,c=0;c<d;c++)b[c].removeAttribute("RteNodeId")}};RTE.RteUtility.containsCssClass=function(a,b){ULSdmo:;return RTE.RteUtility.isSvgNode(a)||a.nodeType!==1?false:Sys.UI.DomElement.containsCssClass(a,b)};RTE.RteUtility.cancelEvent=function(a){ULSdmo:;if(a){a.preventDefault();a.stopPropagation()}};RTE.RteUtility.insertBefore=function(b,a){ULSdmo:;var c=a.parentNode;c.insertBefore(b,a)};RTE.RteUtility.insertAfter=function(c,a){ULSdmo:;var b=a.parentNode;if(b.lastChild===a)b.appendChild(c);else b.insertBefore(c,a.nextSibling)};RTE.RteUtility.isTextNode=function(a){ULSdmo:;return a.nodeType===3||a.nodeType===4};RTE.RteUtility.isSvgNode=function(a){ULSdmo:;return RTE.RteUtility.isTextNode(a)&&a.parentNode?RTE.RteUtility.isSvgNode(a.parentNode):a.nodeType===1&&!!a.namespaceURI&&a.namespaceURI==="http://www.w3.org/2000/svg"};RTE.RteUtility.isNodeOfType=function(c,b){ULSdmo:;for(var a=0;a<b.length;a++)if(c.tagName===b[a])return true;return false};RTE.RteUtility.setInnerText=function(a,b){ULSdmo:;a.innerHTML="";a.appendChild(a.ownerDocument.createTextNode(b))};RTE.SU=function(){};RTE.SU.isNullOrEmptyString=function(a){ULSdmo:;var b=null;return a===b||typeof a==="undefined"||!a.length};RTE.SU.isNullOrUndefined=function(a){ULSdmo:;var b=null;return a===b||typeof a==="undefined"};RTE.SU.isUndefined=function(a){ULSdmo:;return typeof a==="undefined"};RTE.SU.truncateToInt=function(a){ULSdmo:;return a>0?Math.floor(a):Math.ceil(a)};RTE.Ie8TreeValidator=function(a){ULSdmo:;this.$6Q_0={};this.$6P_0={};this.$7x_0(a,0)};RTE.Ie8TreeValidator.prototype={$7x_0:function(d,e){ULSdmo:;if(d.nodeType===1)for(var h=d.uniqueID,f=d.childNodes,i=f.length,b=0;b<i;b++){var c=f[b];if(c.nodeType===1){var a=c.uniqueID;if(typeof a!=="undefined"){var g=this.$6P_0[a];if(typeof g==="undefined"||g>e){this.$6P_0[a]=e;this.$6Q_0[a]=h}}this.$7x_0(c,e+1)}}},$Df_0:function(d,c){ULSdmo:;if(c.nodeType!==1)return true;var a=c.uniqueID;if(typeof a==="undefined")return true;var b=this.$6Q_0[a];return typeof b==="undefined"||b===d.uniqueID}};RTE.RteHtmlPasteSteward=function(a){ULSdmo:;this.$5y_1=RTE.Canvas.getCurrentStyleSheetPrefix();this.$7l_1=new RegExp("(\u201c|\u201d)","g");this.$7m_1=new RegExp("(\u2018|\u2019)","g");RTE.RteHtmlPasteSteward.initializeBase(this,[a.ownerDocument]);this.$5t_1=a;this.$3Y_1=this.get_defaultFormatting();RTE.RteHtmlPasteSteward.$h[RTE.RteHtmlPasteSteward.$z(2)]="disc";RTE.RteHtmlPasteSteward.$h[RTE.RteHtmlPasteSteward.$z(6)]="decimal";RTE.RteHtmlPasteSteward.$h[RTE.RteHtmlPasteSteward.$z(0)]="";RTE.RteHtmlPasteSteward.$h[RTE.RteHtmlPasteSteward.$z(1)]="none";RTE.RteHtmlPasteSteward.$h[RTE.RteHtmlPasteSteward.$z(3)]="disc";RTE.RteHtmlPasteSteward.$h[RTE.RteHtmlPasteSteward.$z(4)]="circle";RTE.RteHtmlPasteSteward.$h[RTE.RteHtmlPasteSteward.$z(5)]="square";RTE.RteHtmlPasteSteward.$h[RTE.RteHtmlPasteSteward.$z(7)]="decimal";RTE.RteHtmlPasteSteward.$h[RTE.RteHtmlPasteSteward.$z(10)]="upper-alpha";RTE.RteHtmlPasteSteward.$h[RTE.RteHtmlPasteSteward.$z(8)]="lower-alpha";RTE.RteHtmlPasteSteward.$h[RTE.RteHtmlPasteSteward.$z(11)]="upper-roman";RTE.RteHtmlPasteSteward.$h[RTE.RteHtmlPasteSteward.$z(9)]="lower-roman"};RTE.RteHtmlPasteSteward.$z=function(a){ULSdmo:;return a.toString()};RTE.RteHtmlPasteSteward.prototype={$3Y_1:null,$5t_1:null,$7d_1:false,$6K_1:true,$2D_1:function(){ULSdmo:;RTE.PasteCommon.Debug.assertString(!!this.generatedHtmlLocation.parentNode,"There's no parent DOMElement to move to!");var a=this.generatedHtmlLocation.firstChild;if(a&&a===this.generatedHtmlLocation.lastChild)a.nodeType===1&&a.tagName==="P"&&RTE.RteUtility.removeNodeAndKeepChildNodes(a);this.generatedHtmlLocation=this.generatedHtmlLocation.parentNode},reset:function(){ULSdmo:;this.generatedHtmlLocation=this.$5t_1},get_defaultFormatting:function(){ULSdmo:;return new RTE.RteHtmlPasteSteward.FormattingSteward(this.ownerDocument)},onText:function(a){ULSdmo:;if(RTE.SU.isNullOrEmptyString(a))return;if(this.$6K_1){a=a.replace(this.$7l_1,'"');a=a.replace(this.$7m_1,"'")}var b=this.$3Y_1.$Do_0(this.ownerDocument.createTextNode(a));this.generatedHtmlLocation.appendChild(b)},onLineBreak:function(){ULSdmo:;this.generatedHtmlLocation.appendChild(this.ownerDocument.createElement("BR"))},onImage:function(b){ULSdmo:;if(RTE.SU.isNullOrEmptyString(b.src)){this.$7d_1=true;return}var a=this.ownerDocument.createElement("IMG");a.src=b.src;a.alt=b.alt;if(b.width)a.style.width=b.width+"px";Sys.UI.DomElement.addCssClass(a,"ms-rte-paste-setimagesize");this.generatedHtmlLocation.appendChild(a)},onFormattingChange:function(a){ULSdmo:;this.$3Y_1=a},onAnchorStart:function(b){ULSdmo:;var a=this.ownerDocument.createElement("A");a.href=b;this.generatedHtmlLocation.appendChild(a);this.generatedHtmlLocation=a},onAnchorEnd:function(){ULSdmo:;RTE.PasteCommon.Debug.assertString(RTE.PasteCommon.StringUtils.toUpper(this.generatedHtmlLocation.tagName)==="A","Expected Tag:  A\nActual Tag:  "+RTE.PasteCommon.StringUtils.toUpper(this.generatedHtmlLocation.tagName));this.$2D_1()},onParagraphStart:function(){ULSdmo:;var a=this.$3Y_1.$BO_0();this.generatedHtmlLocation.appendChild(a);this.generatedHtmlLocation=a},onParagraphEnd:function(){ULSdmo:;RTE.PasteCommon.Debug.assertString(RTE.PasteCommon.StringUtils.toUpper(this.generatedHtmlLocation.tagName)==="P"||this.generatedHtmlLocation.tagName.length===2&&!RTE.PasteCommon.StringUtils.toUpper(this.generatedHtmlLocation.tagName).indexOf("H"),"Expected Tag:  P or H_\nActual Tag:  "+RTE.PasteCommon.StringUtils.toUpper(this.generatedHtmlLocation.tagName));this.$2D_1()},onListStart:function(a){ULSdmo:;var c=a.get_listStyleType().toString(),b=this.ownerDocument.createElement(a.get_isListNumbered()?"OL":"UL");if(a.get_isListStyleSpecified())b.style.listStyleType=RTE.RteHtmlPasteSteward.$h[c];if(a.get_isListNumbered()&&!a.$1f_0)b.start=a.$2H_0;this.generatedHtmlLocation.appendChild(b);this.generatedHtmlLocation=b},onListEnd:function(){ULSdmo:;RTE.PasteCommon.Debug.assertString(RTE.PasteCommon.StringUtils.toUpper(this.generatedHtmlLocation.tagName)==="UL"||RTE.PasteCommon.StringUtils.toUpper(this.generatedHtmlLocation.tagName)==="OL","Expected Tag:  UL or OL\nActual Tag:  "+RTE.PasteCommon.StringUtils.toUpper(this.generatedHtmlLocation.tagName));this.$2D_1()},onListItemStart:function(a){ULSdmo:;var b=this.ownerDocument.createElement("LI");if(a.get_isListItemStyleSpecified())b.style.listStyleType=RTE.RteHtmlPasteSteward.$h[a.get_listStyleType().toString()];if(a.get_isListNumbered()&&!a.$1f_0)b.value=a.get_currentNumber();this.generatedHtmlLocation.appendChild(b);this.generatedHtmlLocation=b},onListItemEnd:function(){ULSdmo:;RTE.PasteCommon.Debug.assertString(RTE.PasteCommon.StringUtils.toUpper(this.generatedHtmlLocation.tagName)==="LI","Expected Tag:  LI\nActual Tag:  "+RTE.PasteCommon.StringUtils.toUpper(this.generatedHtmlLocation.tagName));this.$2D_1()},onTableStart:function(){ULSdmo:;var a=this.ownerDocument.createElement("TABLE");a.setAttribute("cellspacing","0");a.setAttribute("width","100%");a.className=this.$5y_1+"Table-default";if(RTE.Canvas.setTableWidths)a.className+=" ms-rte-paste-settablesizes";this.generatedHtmlLocation.appendChild(a);var b=this.ownerDocument.createElement("TBODY");a.appendChild(b);this.generatedHtmlLocation=b},onTableEnd:function(){ULSdmo:;RTE.PasteCommon.Debug.assertString(RTE.PasteCommon.StringUtils.toUpper(this.generatedHtmlLocation.tagName)==="TBODY","Expected Tag:  TBODY\nActual Tag:  "+RTE.PasteCommon.StringUtils.toUpper(this.generatedHtmlLocation.tagName));this.$2D_1();this.$2D_1()},onTableRowStart:function(){ULSdmo:;var a=this.ownerDocument.createElement("TR");this.generatedHtmlLocation.appendChild(a);this.generatedHtmlLocation=a},onTableRowEnd:function(){ULSdmo:;RTE.PasteCommon.Debug.assertString(RTE.PasteCommon.StringUtils.toUpper(this.generatedHtmlLocation.tagName)==="TR","Expected Tag:  TR\nActual Tag:  "+RTE.PasteCommon.StringUtils.toUpper(this.generatedHtmlLocation.tagName));this.$2D_1()},onTableCellStart:function(){ULSdmo:;var a=this.ownerDocument.createElement("TD");a.className=this.$5y_1+"Table-default";this.generatedHtmlLocation.appendChild(a);this.generatedHtmlLocation=a},onTableCellEnd:function(){ULSdmo:;RTE.PasteCommon.Debug.assertString(RTE.PasteCommon.StringUtils.toUpper(this.generatedHtmlLocation.tagName)==="TD","Expected Tag:  TD\nActual Tag:  "+RTE.PasteCommon.StringUtils.toUpper(this.generatedHtmlLocation.tagName));!this.generatedHtmlLocation.firstChild&&RTE.TableCommands.initTableCell(this.generatedHtmlLocation);this.$2D_1()},onTablePartStart:function(){ULSdmo:;RTE.PasteCommon.Debug.assertNotReachedString("Table Parts Not Used!")},onTablePartEnd:function(){ULSdmo:;RTE.PasteCommon.Debug.assertNotReachedString("Table Parts Not Used!")},$9i_1:function(a){ULSdmo:;this.generatedHtmlLocation.appendChild(a.cloneNode(true))}};RTE.RteHtmlPasteSteward.FormattingSteward=function(b,a){ULSdmo:;this.$5q_0=b;if(a){this.$G_0=a.$G_0.cloneNode(true);this.$1g_0=a.$1g_0.cloneNode(false);this.$1e_0=a.$1e_0;this.$14_0=a.$14_0}else{this.$G_0=b.createElement("SPAN");this.$1g_0=b.createElement("P");this.$1e_0=0;this.$14_0=16}};RTE.RteHtmlPasteSteward.FormattingSteward.$34=function(c,d,a){ULSdmo:;var b=null;while(a&&a.tagName!==d){b=a;a=a.firstChild}if(c&&!a&&b)b.appendChild(b.ownerDocument.createElement(d));else!c&&a&&RTE.RteUtility.removeNodeAndKeepChildNodes(a)};RTE.RteHtmlPasteSteward.FormattingSteward.prototype={$5q_0:null,$G_0:null,$1g_0:null,$1e_0:0,$14_0:0,setLang:function(a){ULSdmo:;this.$G_0.lang=a;return true},setTextDir:function(a){ULSdmo:;this.$G_0.dir=a;return true},setBold:function(a){ULSdmo:;RTE.RteHtmlPasteSteward.FormattingSteward.$34(a,"STRONG",this.$G_0);return true},setItalics:function(a){ULSdmo:;RTE.RteHtmlPasteSteward.FormattingSteward.$34(a,"EM",this.$G_0);return true},setUnderline:function(b){ULSdmo:;if(RTE.RteUtility.isInternetExplorer())this.$G_0.style.textDecorationUnderline=b;else if(b){var a=this.$G_0.style.textDecoration;if(a.toLowerCase().indexOf("underline")<0)this.$G_0.style.textDecoration=a+" underline"}return true},setStrikethrough:function(b){ULSdmo:;if(RTE.RteUtility.isInternetExplorer())this.$G_0.style.textDecorationLineThrough=b;else if(b){var a=this.$G_0.style.textDecoration;if(a.toLowerCase().indexOf("line-through")<0)this.$G_0.style.textDecoration=a+" line-through"}return true},setSubscript:function(a){ULSdmo:;RTE.RteHtmlPasteSteward.FormattingSteward.$34(a,"SUB",this.$G_0);RTE.RteHtmlPasteSteward.FormattingSteward.$34(!a,"SUP",this.$G_0);return true},setSuperscript:function(a){ULSdmo:;RTE.RteHtmlPasteSteward.FormattingSteward.$34(a,"SUP",this.$G_0);RTE.RteHtmlPasteSteward.FormattingSteward.$34(!a,"SUB",this.$G_0);return true},setFontsize:function(b){ULSdmo:;if(RTE.SU.isNullOrEmptyString(b))return false;var a=RTE.RteUtility.parseUnitValue(b);if(a&&a.unit.toLowerCase()==="px")this.$14_0=a.value;return true},setFontface:function(a){ULSdmo:;return RTE.SU.isNullOrEmptyString(a)?false:true},growFontsize:function(){ULSdmo:;this.$14_0=this.$14_0+4;return true},shrinkFontsize:function(){ULSdmo:;if(this.$14_0-4>4)this.$14_0=this.$14_0-4;else this.$14_0=4;return true},setFontColor:function(a){ULSdmo:;return RTE.SU.isNullOrEmptyString(a)?false:true},setFontHighlight:function(a){ULSdmo:;return RTE.SU.isNullOrUndefined(a)?false:true},setHeading:function(a){ULSdmo:;if(a<1||6<a)return false;this.$1e_0=a;return true},setTextAlign:function(a){ULSdmo:;if(a==="left"||a==="center"||a==="right"||a==="justify"){this.$1g_0.style.textAlign=a;return true}return false},clearFormatting:function(){ULSdmo:;this.$G_0.removeAttribute("style");this.$G_0.firstChild&&this.$G_0.removeChild(this.$G_0.firstChild);this.$1g_0.removeAttribute("style");return true},clone:function(){ULSdmo:;return new RTE.RteHtmlPasteSteward.FormattingSteward(this.$5q_0,this)},$Do_0:function(c){ULSdmo:;var d=!RTE.SU.isNullOrEmptyString(this.$G_0.style.cssText);if(d||this.$G_0.firstChild){var b=this.$G_0.cloneNode(true),a=b;while(a.firstChild)a=a.firstChild;a.appendChild(c);c=d?b:b.firstChild}return c},$BO_0:function(){ULSdmo:;var a;if(!this.$1e_0)a=this.$1g_0.cloneNode(false);else{RTE.PasteCommon.Debug.assert(1<=this.$1e_0&&this.$1e_0<=6);a=this.$1g_0.ownerDocument.createElement("H"+this.$1e_0);a.style.cssText=this.$1g_0.style.cssText}return a}};RTE.RteHtmlTranslator=function(a){ULSdmo:;this.$3a_2=new Array(0);RTE.RteHtmlTranslator.initializeBase(this,[a])};RTE.RteHtmlTranslator.$9E=function(a){ULSdmo:;return a?a.nodeType===1?RTE.RteHtmlTranslator.$7n.test(a.style.marginBottom):false:true};RTE.RteHtmlTranslator.prototype={onDivOpen:function(a){ULSdmo:;return this.$9m_2(a)?3:RTE.HtmlImport.DefaultHtmlTranslator.prototype.onDivOpen.call(this,a)},onSpanOpen:function(a){ULSdmo:;return this.$9m_2(a)?3:2},onPOpen:function(a){ULSdmo:;var d=true,b=RTE.PasteCommon.CustomData.getObject(a,"SpecialProcessing");if(b){if(b==="IgnoreAll")return 3;if(b==="IgnoreOpen")d=false}var e=Sys.UI.DomElement.containsCssClass(a,"MsoTitle"),f=a.getAttribute("align");if(d){if(e){var g=this;this.handleSpecifiedFormatting(function(a){ULSdmo:;return a.setHeading(1)})}var h=this;this.handleSpecifiedFormatting(function(a){ULSdmo:;return a.setTextAlign(f)});this.normalizer.onParagraphStart()}var c=this;this.registerOnCloseCallback(function(){ULSdmo:;var b=RTE.RteUtility.getRealNextSibling(a,false),d=true;if(b&&b.nodeType===1&&b.tagName.toUpperCase()==="P"){var g=b.getAttribute("align"),h=Sys.UI.DomElement.containsCssClass(b,"MsoTitle");if(f===g&&e===h&&RTE.RteHtmlTranslator.$9E(a))if(b.firstChild===b.lastChild&&(!b.firstChild||RTE.RteUtility.isEmptyTextNodeDeep(b.firstChild,true))&&RTE.RteHtmlTranslator.$9E(b)){RTE.PasteCommon.CustomData.$3Q(b,"SpecialProcessing","IgnoreAll");RTE.RteUtility.removeChildNodes(b)}else{d=false;c.normalizer.onLineBreak();RTE.PasteCommon.CustomData.$3Q(b,"SpecialProcessing","IgnoreOpen")}}d&&c.normalizer.onParagraphEnd()});return 1},$9m_2:function(b){ULSdmo:;if(this.$3a_2)for(var a=0;a<this.$3a_2.length;a++)if(Sys.UI.DomElement.containsCssClass(b,this.$3a_2[a])){this.normalizer.$9i_3(b);return true}return false}};RTE.RteHtmlNormalizer=function(a){ULSdmo:;RTE.RteHtmlNormalizer.initializeBase(this,[a])};RTE.RteHtmlNormalizer.prototype={$9i_3:function(a){ULSdmo:;RTE.RteUtility.isBlockNode(a)&&this.ensureOutsideParagraph();this.steward.$9i_1(a)}};RTE.Selection=function(a){ULSdmo:;this.$1Q_0=a};RTE.Selection.getSelection=function(){ULSdmo:;var b=window.document,a=null;if(!a){var c=b.defaultView;if(c){var d=b.defaultView.getSelection;if(d)a=b.defaultView.getSelection()}}if(!a){var e=window.self.getSelection;if(e)a=window.self.getSelection()}if(!a)a=b.selection;return new RTE.Selection(a)};RTE.Selection.isControlRangeSelection=function(){ULSdmo:;var a=window.document.selection;return!!a&&!RTE.SU.isNullOrEmptyString(a.type)&&a.type==="Control"};RTE.Selection.getSelectionRange=function(){ULSdmo:;var a=RTE.Selection.getSelection();return a&&!RTE.SU.isNullOrUndefined(a.$1Q_0)?a.createRange():null};RTE.Selection.get_hasSelection=function(){ULSdmo:;var a=RTE.Selection.getSelection();if(!a)return false;var b=a.createRange();return!b?false:b.isVisible()};RTE.Selection.prototype={$1Q_0:null,createRange:function(){ULSdmo:;var a=RTE.DomHelper.createRangeFromSelection(this.$1Q_0);return!a?null:new RTE.Range(a)},clear:function(){ULSdmo:;if(this.$1Q_0.removeAllRanges)this.$1Q_0.removeAllRanges();else this.$1Q_0.empty&&this.$1Q_0.empty()}};RTE.Snapshot=function(){ULSdmo:;this.$1E_0=-1;this.$19_0=-1};RTE.Snapshot.$8q=function(a){ULSdmo:;return RTE.Snapshot.$6b(a,false,true)};RTE.Snapshot.$6a=function(a){ULSdmo:;return RTE.Snapshot.$6b(a,false,false)};RTE.Snapshot.$Bc=function(b){ULSdmo:;var a=RTE.Snapshot.$6b(b,true,true),c=a.get_$6e_0();return a};RTE.Snapshot.$6b=function(a,c,d){ULSdmo:;if(!a||!a.parentNode)return null;a=RTE.Canvas.$2N(a);var b=new RTE.Snapshot;b.$F_0=a;b.$n_0=a.cloneNode(true);b.$4v_0=c;b.$q_0=d?RTE.SnapshotManager.$6o(a,b,null):false;return b};RTE.Snapshot.prototype={$n_0:null,$F_0:null,$4v_0:false,$q_0:false,$4A_0:false,$22_0:null,$3d_0:false,get_$6e_0:function(){ULSdmo:;if(!this.$22_0&&this.$22_0!==""){this.$80_0();this.$22_0=this.$n_0?this.$n_0.innerHTML:""}return this.$22_0},set_$6e_0:function(a){ULSdmo:;this.$22_0=a||"";return a},get_$9c_0:function(){ULSdmo:;if(this.$19_0===-1&&this.$n_0)if(this.$n_0.querySelectorAll){this.$80_0();this.$19_0=this.$n_0.getElementsByTagName("*").length;this.$19_0-=this.$n_0.querySelectorAll("#ms-rterangecursor-start, #ms-rterangecursor-end, .ms-rtegenerate-skip").length}return this.$19_0},$7G_0:function(){ULSdmo:;this.$A5_0(true)},$A5_0:function(i){ULSdmo:;RTE.CanvasRange.$4l=true;RTE.PasteFlyout.hide();RTE.RteUtility.setInnerHTMLWithEvents(this.$F_0,this.get_$6e_0());this.$F_0.childNodes.length>0&&RTE.Canvas.dispatchAddedEventsChildElements(this.$F_0);var c=null;if(RTE.Canvas.$6p(this.$F_0))c=RTE.LayoutsEditor.create(this.$F_0);!RTE.PreviewManager.get_instance().get_hasPreview()&&RTE.CanvasEvents.dispatchChangedOnEditableRegion(this.$F_0);var a=RTE.Cursor.get_range(),d=a.$1_0.id,e=a.$2_0.id;a.$1_0.id="";a.$2_0.id="";var b=RTE.SnapshotManager.getMarkers();if(b.length===2&&b[0]&&b[1])RTE.Cursor.get_range().setMarkersCollection(b);else if(i)if(c){var f=c.$8g_0();RTE.Cursor.get_range().moveToEndOfNode(f)}else RTE.Cursor.get_range().moveToEndOfNode(this.$F_0);a.$1_0.id=d;a.$2_0.id=e;RTE.CanvasRange.$4l=false;if(!this.$4v_0){var g=RTE.Snapshot.$6a(this.$F_0),h=this.$q_0;this.$6L_0(g);this.$q_0=h}RTE.Canvas.$De()&&RTE.Cursor.update()},$80_0:function(){ULSdmo:;if(!this.$3d_0&&this.$n_0){if(this.$n_0.querySelectorAll){for(var c=this.$n_0.querySelectorAll(".ms-rtegenerate-notify"),a=0;a<c.length;a++)RTE.RteUtility.removeChildNodes(c[a]);for(var d=this.$n_0.querySelectorAll(".ms-rtegenerate-skip"),b=0;b<d.length;b++)RTE.RteUtility.removeNodeAndKeepChildNodes(d[b])}this.$3d_0=true}},$6L_0:function(a){ULSdmo:;this.$n_0=a.$n_0;this.$22_0=a.$22_0;this.$4A_0=a.$4A_0;this.$1E_0=a.$1E_0;this.$3d_0=a.$3d_0;this.$19_0=a.$19_0;this.$q_0=a.$q_0}};RTE.SnapshotManager=function(){};RTE.SnapshotManager.takeSnapshot=function(){ULSdmo:;var b=RTE.Cursor.get_range(),a=b.getEditableRegion();if(!a||!a.parentNode)return;RTE.SnapshotManager.takeEditableRegionSnapshot(a)};RTE.SnapshotManager.takeSnapshotIfNotInPreview=function(){ULSdmo:;!RTE.PreviewManager.get_instance().get_hasPreview()&&RTE.SnapshotManager.takeSnapshot()};RTE.SnapshotManager.takePartialSnapshot=function(b){ULSdmo:;if(!b)return;var a=RTE.Snapshot.$8q(b);a.$4A_0=true;a.$1E_0=RTE.SnapshotManager.$9W++%2+1;a.$q_0&&RTE.CanvasEvents.dispatchChangedOnEditableRegion(a.$F_0);RTE.SnapshotManager.$v.push(a);RTE.SnapshotManager.clearRegionDirty(b)};RTE.SnapshotManager.takeEditableRegionSnapshot=function(a){ULSdmo:;a=RTE.Canvas.$2N(a);if(!a||!a.parentNode||RTE.PreviewManager.get_instance().get_hasPreview())return;var b=RTE.Snapshot.$8q(a),c=RTE.SnapshotManager.$CT(RTE.SnapshotManager.$v);if(c&&c.$4A_0)b.$1E_0=c.$1E_0;var d=b.$q_0;RTE.SnapshotManager.$5d(true,b,true);RTE.SnapshotManager.clearRegionDirty(a);d&&RTE.PasteFlyout.hide()};RTE.SnapshotManager.$D5=function(){ULSdmo:;if(!RTE.SnapshotManager.$5W){RTE.CanvasEvents.registerListener("EditableRegionChanged",RTE.SnapshotManager.$3j);RTE.SnapshotManager.$5W=true}};RTE.SnapshotManager.undo=function(){ULSdmo:;RTE.SnapshotManager.$D5();RTE.SnapshotManager.$4S(true,-1);RTE.Canvas.sendApplicationStateChangedEvent();RTE.SnapshotManager.$7z()};RTE.SnapshotManager.$7z=function(){ULSdmo:;var a=RTE.SnapshotManager.$2l;RTE.SnapshotManager.$2l=RTE.SnapshotManager.$C0(RTE.SnapshotManager.$v);RTE.SnapshotManager.$2l!==a&&RTE.Canvas.sendApplicationStateChangedEvent()};RTE.SnapshotManager.redo=function(){ULSdmo:;RTE.SnapshotManager.$4S(false,-1);RTE.Canvas.sendApplicationStateChangedEvent()};RTE.SnapshotManager.$62=function(a,b,e){ULSdmo:;var c=b?b.$q_0:true,d=a?a.$q_0:true;return e?!c:!d};RTE.SnapshotManager.$4S=function(b,e){ULSdmo:;var c=b?RTE.SnapshotManager.$v:RTE.SnapshotManager.$2g,f=b?RTE.SnapshotManager.$2g:RTE.SnapshotManager.$v;if(!c.$a_0)return;var a=c.pop();if(!a||!a.$F_0||!a.$F_0.parentNode){RTE.SnapshotManager.$4S(b,e);return}if(e!==-1&&a.$1E_0!==e){c.push(a);return}var d=RTE.Snapshot.$6a(a.$F_0);d.$q_0=RTE.SnapshotManager.$6o(a.$F_0,d,b?a:null);!RTE.SnapshotManager.$2W(f,a.$F_0)&&RTE.SnapshotManager.$5d(!b,d,false);if(RTE.SnapshotManager.$62(a,d,b)&&c.$a_0>0){RTE.SnapshotManager.$4J(a.$F_0,a.$q_0);RTE.SnapshotManager.$5d(!b,a,false);RTE.SnapshotManager.$4S(b,a.$1E_0);return}RTE.SnapshotManager.clearRegionDirty(a.$F_0);RTE.SnapshotManager.$5d(true,a,false);RTE.CanvasEvents.unRegisterListener("EditableRegionChanged",RTE.SnapshotManager.$3j);a.$7G_0();RTE.CanvasEvents.registerListener("EditableRegionChanged",RTE.SnapshotManager.$3j);a.$1E_0!==-1&&RTE.SnapshotManager.$4S(b,a.$1E_0)};RTE.SnapshotManager.$C0=function(d){ULSdmo:;for(var b=[],a=d.$a_0-1;a>=0;a--){var c=d.getItemAt(a);if(Array.contains(b,c.$F_0))return true;Array.add(b,c.$F_0)}return false};RTE.SnapshotManager.$Cf=function(){ULSdmo:;RTE.CanvasEvents.unRegisterListener("EditableRegionChanged",RTE.SnapshotManager.$3j);RTE.SnapshotManager.$5W=false;RTE.SnapshotManager.clearRedo()};RTE.SnapshotManager.$5d=function(d,a,f){ULSdmo:;var c=d?RTE.SnapshotManager.$v:RTE.SnapshotManager.$2g,b=RTE.SnapshotManager.$2W(c,a.$F_0);if(!RTE.SnapshotManager.$62(b,a,d)){f&&RTE.CanvasEvents.dispatchChangedOnEditableRegion(a.$F_0);c.push(a);RTE.DirtyBitManager.$8D()}else{var e=RTE.SnapshotManager.$DQ(c,a.$F_0);if(b&&RTE.SnapshotManager.$62(e,b,d))b.$6L_0(a);else if(b&&!e&&a.$1E_0===-1)b.$6L_0(a);else c.push(a)}RTE.SnapshotManager.$7z()};RTE.SnapshotManager.get_undoEnabled=function(){ULSdmo:;if(RTE.SnapshotManager.$2l)return true;RTE.SnapshotManager.$2l=RTE.SnapshotManager.$C1();if(RTE.SnapshotManager.$2l)return true;RTE.SnapshotManager.$D4();return false};RTE.SnapshotManager.get_redoEnabled=function(){ULSdmo:;return RTE.SnapshotManager.$2g.$a_0>0};RTE.SnapshotManager.$C1=function(){ULSdmo:;var a=RTE.Canvas.currentEditableRegion();return a?!!RTE.SnapshotManager.$2W(RTE.SnapshotManager.$v,a)&&RTE.SnapshotManager.$1N(a):false};RTE.SnapshotManager.$D4=function(){ULSdmo:;if(!RTE.SnapshotManager.$5X){RTE.CanvasEvents.registerListener("EditableRegionChanged",RTE.SnapshotManager.$6N);RTE.SnapshotManager.$5X=true}};RTE.SnapshotManager.$Cg=function(){ULSdmo:;var a=RTE.SnapshotManager.get_undoEnabled();if(a){RTE.CanvasEvents.unRegisterListener("EditableRegionChanged",RTE.SnapshotManager.$6N);RTE.SnapshotManager.$5X=false;RTE.Canvas.sendApplicationStateChangedEvent()}};RTE.SnapshotManager.$2W=function(d,b){ULSdmo:;b=RTE.Canvas.$2N(b);for(var a=d.$a_0-1;a>=0;a--){var c=d.getItemAt(a);if(c.$F_0===b)return c}return null};RTE.SnapshotManager.$CT=function(a){ULSdmo:;return a.$a_0>0?a.getItemAt(a.$a_0-1):null};RTE.SnapshotManager.$DQ=function(d,e){ULSdmo:;for(var b=false,a=d.$a_0-1;a>=0;a--){var c=d.getItemAt(a);if(c.$F_0===e)if(!b)b=true;else return c}return null};RTE.SnapshotManager.clearRedo=function(){ULSdmo:;RTE.SnapshotManager.$2g=new RTE.CircularArray(200);RTE.Canvas.sendApplicationStateChangedEvent()};RTE.SnapshotManager.getMarkers=function(){ULSdmo:;var b=$get("ms-rterangecursor-start"),c=$get("ms-rterangecursor-end"),a=[];a[0]=b;a[1]=c;return a};RTE.SnapshotManager.clear=function(){ULSdmo:;RTE.SnapshotManager.$v=new RTE.CircularArray(200);RTE.SnapshotManager.clearRedo()};RTE.SnapshotManager.$1N=function(a){ULSdmo:;return RTE.SnapshotManager.$6o(a,null,null)};RTE.SnapshotManager.$6o=function(a,c,d){ULSdmo:;a=RTE.Canvas.$2N(a);if(!a)return false;if(RTE.SnapshotManager.$3u===a)return true;var b=a.getAttribute("RteDirty")==="true";if(!b){d=d||RTE.SnapshotManager.$2W(RTE.SnapshotManager.$v,a);if(!d)b=true;else{c=c||RTE.Snapshot.$6a(a);if(c)b=d.get_$9c_0()!==c.get_$9c_0()}RTE.SnapshotManager.setRegionDirtyIf(b,a)}if(b)RTE.SnapshotManager.$3u=a;return b};RTE.SnapshotManager.$4J=function(a,b){ULSdmo:;a.setAttribute("RteDirty",b?"true":"false");RTE.SnapshotManager.$3u=b?a:null};RTE.SnapshotManager.setCurrentRegionDirty=function(){ULSdmo:;RTE.SnapshotManager.setRegionDirty(RTE.Canvas.currentEditableRegion())};RTE.SnapshotManager.setCurrentRegionDirtyIf=function(a){ULSdmo:;RTE.SnapshotManager.setRegionDirtyIf(a,RTE.Canvas.currentEditableRegion())};RTE.SnapshotManager.setRegionDirty=function(a){ULSdmo:;a=RTE.Canvas.$2N(a);if(a&&a!==RTE.SnapshotManager.$3u){RTE.SnapshotManager.$4J(a,true);RTE.SnapshotManager.$2g.$a_0>0&&RTE.SnapshotManager.$2W(RTE.SnapshotManager.$v,a)&&!RTE.PreviewManager.get_instance().get_hasPreview()&&RTE.SnapshotManager.clearRedo()}};RTE.SnapshotManager.setRegionDirtyIf=function(a,b){ULSdmo:;a&&RTE.SnapshotManager.setRegionDirty(b)};RTE.SnapshotManager.clearRegionDirty=function(a){ULSdmo:;a=RTE.Canvas.$2N(a);a&&RTE.SnapshotManager.$4J(a,false)};RTE.CssStyleInfo=function(){};RTE.CssStyleInfo.prototype={$7W_0:null,rule:null,selector:null};RTE.StyleRuleUtility=function(){};RTE.StyleRuleUtility.getSelectorText=function(a){ULSdmo:;var b=a.indexOf(";");return b===-1?a:a.substr(0,b)};RTE.StyleRuleUtility.getIsElementStyle=function(a){ULSdmo:;var b=a.indexOf(";");return b===-1?false:a.substring(b+1,a.length)==="true"};RTE.StyleRuleUtility.getClassNameFromSelectorText=function(a){ULSdmo:;var b=a.indexOf(".");if(b>=0)a=a.substr(b+1);return a};RTE.StyleRuleUtility.getTagNameFromSelectorText=function(a){ULSdmo:;var b=a.indexOf(".");return b>=0?a.substring(0,b):""};RTE.StyleRuleUtility.$Bq=function(a,d,e,f,h){ULSdmo:;if(!RTE.SU.isUndefined(a.href)&&!RTE.SU.isNullOrEmptyString(a.href)){var c=RTE.StyleRuleUtility.$Bj(a),g=a.href;if(RTE.StyleRuleUtility.checkOnlyCssFromSameDomain&&!RTE.RteUtility.$CO(c))return false;var b=null;if(h){b=RTE.StyleRuleUtility.$DO(c,g);if(!b)return false}else b=RTE.StyleRuleUtility.$A7(c);return b.indexOf(d)===-1?true:RTE.StyleRuleUtility.$9N(a,d,e,f)}return RTE.StyleRuleUtility.$9N(a,d,e,f)};RTE.StyleRuleUtility.$9N=function(i,l,m,j){ULSdmo:;for(var f=RTE.StyleRuleUtility.$Bo(i),k=f.length,c=0;c<k;c++){var d=f[c],g=d.selectorText;if(!RTE.SU.isNullOrEmptyString(g))for(var h=g.split(","),e=0;e<h.length;e++){var a=RTE.StyleRuleUtility.$Bp(l,h[e].trim());if(a&&!j[a]){var b=new RTE.CssStyleInfo;b.$7W_0=i;b.rule=d;b.selector=a;j[a]=d;m.push(b)}}}return true};RTE.StyleRuleUtility.$Bp=function(e,a){ULSdmo:;if(a&&typeof a!=="undefined"&&a.length&&a.indexOf(e)!==-1){a=a.toLowerCase();var c,b=null;if((c=a.lastIndexOf(" "))>=0)if(++c<a.length)b=a.substr(c);else b="";else b=a;var d=b.indexOf(".");if(d!==-1)b=b.substr(d);if(b.indexOf(e)!==-1)return b}return null};RTE.StyleRuleUtility.get_$84=function(){ULSdmo:;return window.SPThemeUtils&&window.SPThemeUtils.UseClientSideTheming()?true:false};RTE.StyleRuleUtility.$Bo=function(a){ULSdmo:;return a.rules?a.rules:a.cssRules};RTE.StyleRuleUtility.getStyleRules=function(a,c,k){ULSdmo:;if(!a.startsWith("."))a="."+a;a=a.toLowerCase();if(!RTE.StyleRuleUtility.$41)RTE.StyleRuleUtility.$41={};var d=null;d=RTE.StyleRuleUtility.$41[a];if(d)return d;else{if(!RTE.StyleRuleUtility.$42)RTE.StyleRuleUtility.$42={};var e=true,b=RTE.StyleRuleUtility.$42[c];if(!b){b=[];for(var m={},i=RTE.StyleRuleUtility.get_$84()?window.SPThemeUtils.GetThemedStyleSheets():document.styleSheets,n=i.length,g=0;g<n;g++){var o=RTE.StyleRuleUtility.$Bq(i[g],c,b,m,k);if(!o)e=false}if(e)RTE.StyleRuleUtility.$42[c]=b}for(var f=[],l=b.length,h=0;h<l;h++){var j=b[h];j.selector.indexOf(a)!==-1&&f.push(j)}if(e)RTE.StyleRuleUtility.$41[a]=f;return f}};RTE.StyleRuleUtility.getSuffix=function(a,d){ULSdmo:;var b=a.indexOf(d);if(b!==-1){var e=b+d.length,c=a.indexOf(",",b);if(c===-1)c=a.length;var f=c-e;return a.substr(e,f)}else return""};RTE.StyleRuleUtility.getRuleDisplayName=function(c,b,a){ULSdmo:;return RTE.StyleRuleUtility.$6Z(c,b,a,"-ms-name")};RTE.StyleRuleUtility.buildCommandIdForStyle=function(a,b){ULSdmo:;return!b?a.rule.selectorText:a.rule.selectorText+(RTE.StyleRuleUtility.isElementRule(a)?";true":";false")};RTE.StyleRuleUtility.isElementRule=function(c){ULSdmo:;var a=RTE.StyleRuleUtility.getTagNameFromSelectorText(c.rule.selectorText);if(RTE.SU.isNullOrEmptyString(a)||!RTE.HtmlTagName.allowedElementStyleTags[a.toUpperCase()])return false;var b=RTE.StyleRuleUtility.$6Z(c,null,null,"-ms-element");return!RTE.SU.isNullOrEmptyString(b)&&b.trim().toLowerCase()==="true"};RTE.StyleRuleUtility.getRuleColorName=function(c,b,a){ULSdmo:;return RTE.StyleRuleUtility.$6Z(c,b,a,"-ms-color")};RTE.StyleRuleUtility.$6Z=function(b,e,c,d){ULSdmo:;var a=b.rule.style[d];if(RTE.SU.isNullOrUndefined(a))a=RTE.StyleRuleUtility.$DN(b,d);if(!RTE.SU.isNullOrUndefined(a))a=unescape(a);else if(!RTE.SU.isNullOrEmptyString(c))a=RTE.StyleRuleUtility.$6J(b.rule.style,c);if(!RTE.SU.isNullOrUndefined(a))a=RTE.RteUtility.removeQuotes(a);return a};RTE.StyleRuleUtility.$6J=function(a,b){ULSdmo:;return b==="fontSize"?RTE.StyleRuleUtility.$B2(a.fontSize):b==="fontFamily"?RTE.StyleRuleUtility.convertFontFamilyToDisplay(a.fontFamily):a[b]};RTE.StyleRuleUtility.convertFontFamilyToDisplay=function(a){ULSdmo:;var b=a.indexOf(",");if(b>0)a=a.substr(0,b);if(a.startsWith('"'))a=a.substr(1);if(a.endsWith('"'))a=a.substr(0,a.length-1);if(a.length>0)a=a.charAt(0).toString().toUpperCase()+a.substr(1);return a};RTE.StyleRuleUtility.$B2=function(c){ULSdmo:;var a=RTE.RteUtility.parseUnitValue(c);if(!a)return"";if(a.unit==="px"&&Math.round(a.value*10)!==Math.round(a.value)*10){if(RTE.StyleRuleUtility.$5V===-1){var b=document.createElement("SPAN");b.style.height="100pt";b.style.position="absolute";document.body.appendChild(b);RTE.StyleRuleUtility.$5V=b.offsetHeight/100;b.parentNode.removeChild(b)}a.unit="pt";a.value=Math.round(a.value/RTE.StyleRuleUtility.$5V*10)/10}return a.value+a.unit};RTE.StyleRuleUtility.$Bj=function(b){ULSdmo:;if(null===b)return null;var c=b.ownerNode;if(RTE.SU.isNullOrUndefined(c))return b.href;var a=c.getAttribute("data-original-href");if(RTE.SU.isNullOrEmptyString(a))a=b.href;else{var d=document.createElement("a");d.href=a;a=d.href}return a};RTE.StyleRuleUtility.$DN=function(j,l){ULSdmo:;var g=j.$7W_0.href;if(!g)return null;var c=j.selector;if(!c)return null;var e=RTE.StyleRuleUtility.$A7(g);if(!e)return null;var b=e.toLowerCase();c=c.toLowerCase();var a=-1;a=b.indexOf(c,a+1);while(a!==-1){var h=b.indexOf(l,a);if(h!==-1){var d=b.indexOf(":",h);if(d!==-1){var f=b.indexOf(";",d);if(f!==-1){var i=b.indexOf("}",a);if(i!==-1)if(i>=f){var k=e.substr(d+1,f-d-1);return k.trim()}}}}a=b.indexOf(c,a+1)}return null};RTE.StyleRuleUtility.$A7=function(a){ULSdmo:;if(!RTE.StyleRuleUtility.$1Z[a])try{var b=new XMLHttpRequest;b.open("GET",a,false);b.send(null);RTE.StyleRuleUtility.$1Z[a]=b.responseText}catch(c){RTE.StyleRuleUtility.$1Z[a]=""}return RTE.StyleRuleUtility.$1Z[a]};RTE.StyleRuleUtility.$DO=function(a,d){ULSdmo:;var b=RTE.StyleRuleUtility.$1Z[d];if(!b&&RTE.StyleRuleUtility.get_$84()){b=window.SPThemeUtils.GetCurrentStyleSheetText(d);if(b)RTE.StyleRuleUtility.$1Z[d]=b}if(!b){var e=RTE.StyleRuleUtility.$4O[a];if(!e||!e){RTE.StyleRuleUtility.$4O[a]=true;RTE.StyleRuleUtility.$4P++;RTE.StyleRuleUtility.$1Z[a]="";try{var c=new XMLHttpRequest;c.open("GET",a,true);c.onreadystatechange=function(){ULSdmo:;if(c.readyState===4){RTE.StyleRuleUtility.$4O[a]=false;RTE.StyleRuleUtility.$4P--;if(c.status===200)RTE.StyleRuleUtility.$1Z[a]=c.responseText;else RTE.StyleRuleUtility.$1Z[a]="";!RTE.StyleRuleUtility.$4P&&RTE.Canvas.sendApplicationStateChangedEvent()}};c.send(null)}catch(f){RTE.StyleRuleUtility.$4O[a]=false;RTE.StyleRuleUtility.$4P--}}}return b};RTE.TableCommands=function(){};RTE.TableCommands.$1o=function(a,b){ULSdmo:;RTE.TableCommands.applyStyleToElement&&RTE.TableCommands.applyStyleToElement(a,b)};RTE.TableCommands.insertTable=function(f){ULSdmo:;if(!RTE.Cursor.get_range().canDeleteContent())return;RTE.Cursor.get_range().deleteContent();var g=RTE.Canvas.getCurrentStyleSheetPrefix(),h=RTE.Cursor.get_range().$2_0,d=h.ownerDocument,a=d.createElement("TABLE");a.setAttribute("cellspacing","0");a.setAttribute("width","100%");var e=d.createElement("TBODY"),c=d.createElement("TR");e.appendChild(c);var b=d.createElement("TD");b.className=g+"Table-default";RTE.TableCommands.$1o(b,b.className);RTE.TableCommands.initTableCell(b);c.appendChild(b);for(var i=1;i<f.columns;i++)c.appendChild(b.cloneNode(true));for(var j=1;j<f.rows;j++)e.appendChild(c.cloneNode(true));a.appendChild(e);a.className=g+"Table-default";RTE.TableCommands.$1o(a,a.className);if(c&&c.childNodes.length>0)b=c.firstChild;RTE.RteUtility.$56(a,h);if(b){RTE.Cursor.get_range().moveToEndOfNode(b);RTE.Cursor.update()}if(a.parentNode===RTE.Canvas.currentEditableRegion()&&!RTE.RteUtility.getRealNextSibling(a,false)){var k=a.ownerDocument.createElement("P");RTE.RteUtility.insertAfter(k,a)}RTE.Canvas.setTableWidths&&RTE.TableCommands.$AE(a)};RTE.TableCommands.$AE=function(a){ULSdmo:;var b=a;if(a.firstChild&&a.firstChild.nodeType===1&&a.firstChild.tagName==="TBODY")b=a.firstChild;if(b.childNodes.length>0&&b.childNodes[0].childNodes.length>0)for(var d=b.childNodes[0],e=d.childNodes.length,c=0;c<e;c++)if(RTE.SU.isNullOrEmptyString(d.childNodes[c].style.width)){var f=100/e,g=f+"%";d.childNodes[c].style.width=g}};RTE.TableCommands.$96=function(a,b,o){ULSdmo:;for(var c=b.cloneNode(false),e=b.rowIndex,d=0;d<e;d++)for(var n=a.rows[d],k=n.cells,f=0;f<k.length;f++){var g=k[f];if(d+g.rowSpan>=e+1)g.rowSpan=g.rowSpan+1}if(o)RTE.RteUtility.insertBefore(c,b);else RTE.RteUtility.insertAfter(c,b);var l=RTE.TableCommands.hasHeaderRow(a),m=RTE.TableCommands.hasFooterRow(a);RTE.TableCommands.$7V(a,e,false);for(var j=b.cells,h=0;h<j.length;h++){var i=j[h].cloneNode(false);RTE.TableCommands.initTableCell(i);i.rowSpan=1;c.appendChild(i)}RTE.TableCommands.setHeaderRow(a,l);RTE.TableCommands.setFooterRow(a,m);return c};RTE.TableCommands.insertRow=function(e){ULSdmo:;var b=RTE.Cursor.getNearestContainingElementOfType("TR");if(!b)return;var a=RTE.RteUtility.getNearestParentElementOfType(b,"TABLE");if(!a)return;if(!RTE.Canvas.isEditable(a))return;var c=RTE.TableCommands.$96(a,b,e);RTE.TableCommands.$1U(a);var d=RTE.Cursor.get_range(),f=RTE.RteUtility.$BZ();if(f==="rtl")d.moveToNode(c.childNodes[c.childNodes.length-1]);else d.moveToNode(c.childNodes[0]);RTE.Cursor.update()};RTE.TableCommands.insertColumn=function(o){ULSdmo:;var e=RTE.Cursor.$o(RTE.HtmlTagName.tableCellTagNames);if(!e)return;var a=RTE.RteUtility.getNearestParentElementOfType(e,"TABLE");if(!a)return;if(!RTE.Canvas.isEditable(a))return;if(RTE.ParagraphCommands.queryDirection(false).get_commandOn())o=!o;var g=RTE.TableCommands.$d(a,e,false),h=g.targetCellColSpanIndex,q=e.colSpan,r=RTE.TableCommands.hasFirstColumn(a),s=RTE.TableCommands.hasLastColumn(a);RTE.TableCommands.$7R(a,g,h,false);g=RTE.TableCommands.$d(a,e,false);for(var c=[],m=[],n=0;n<a.rows.length*2;n++){var i=g.columns[h].cells[n];if(!RTE.SU.isNullOrUndefined(i))if(!Array.contains(c,i.cell)){Array.add(c,i.cell);Array.add(m,i.colSpanIndex)}}var d=null,b,p=RTE.Cursor.get_range();if(o)for(var j=0;j<c.length;j++){var k=c[j],t=m[j];if(t===h){b=k.cloneNode(false);b.colSpan=1;RTE.TableCommands.initTableCell(b);RTE.RteUtility.insertBefore(b,k);if(!d){d=b;p.moveToNode(d)}}else k.colSpan=k.colSpan+1}else for(var l=0;l<c.length;l++){var f=c[l],u=m[l];if(u+f.colSpan===h+q){b=f.cloneNode(false);b.colSpan=1;RTE.TableCommands.initTableCell(b);RTE.RteUtility.insertAfter(b,f);if(!d){d=b;p.moveToNode(d)}}else f.colSpan=f.colSpan+1}RTE.TableCommands.setFirstColumn(a,r);RTE.TableCommands.setLastColumn(a,s);RTE.TableCommands.$1U(a);RTE.Cursor.get_range().resetCacheRange();RTE.Cursor.update()};RTE.TableCommands.deleteColumn=function(){ULSdmo:;var c=RTE.Cursor.$o(RTE.HtmlTagName.tableCellTagNames);if(!c)return;var m=RTE.RteUtility.getNearestParentElementOfType(c,"TR");if(!m)return;var a=RTE.RteUtility.getNearestParentElementOfType(m,"TABLE");if(!a)return;if(!RTE.Canvas.isEditable(a))return;for(var n=RTE.TableCommands.$d(a,c,false),h=n.targetCellColSpanIndex,t=c.colSpan,d=[],o=[],i=0;i<a.rows.length*2;i++){var e=n.columns[h].cells[i];if(!RTE.SU.isNullOrUndefined(e))if(!Array.contains(d,e.cell)){Array.add(d,e.cell);Array.add(o,e.colSpanIndex)}}for(var f=0;f<d.length;f++){var b=d[f],u=o[f],p=RTE.TableCommands.$6X(h,t,u,b.colSpan);if(p===b.colSpan)b.parentNode.removeChild(b);else b.colSpan=b.colSpan-p}for(var j=a.rows.length-1;j>=0;j--){var k=a.rows[j],v=k.cells;!v.length&&k.parentNode.removeChild(k)}if(!a.rows.length){RTE.Cursor.get_range().moveAfterNode(a);a.parentNode.removeChild(a)}else{RTE.TableCommands.$1U(a);for(var q=0,r=0,l=a.rows[0].cells,g=0;g<l.length;g++){q=g;var s=RTE.TableCommands.$38(l[g]);if(r+s>h)break;r+=s}var w=RTE.Cursor.get_range(),x=l[q];w.moveToStartOfNode(x)}RTE.Cursor.update()};RTE.TableCommands.$38=function(a){ULSdmo:;return a.colSpan};RTE.TableCommands.$7S=function(a,b){ULSdmo:;a.setAttribute("colSpan",b)};RTE.TableCommands.$Bv=function(){ULSdmo:;var e=[],b=RTE.Cursor.getNearestContainingElementOfType("TR");if(!b)return e;for(var g=RTE.Cursor.get_range(),h=g.$1_0,i=g.$2_0,c=b.cells,f=false,d=false,a=0;a<c.length;a++){if(!f)f=RTE.RteUtility.$M(h,c[a],b);f&&!d&&Array.add(e,c[a]);if(!d)d=RTE.RteUtility.$M(i,c[a],b);if(d)break}return e};RTE.TableCommands.splitHorizontal=function(){ULSdmo:;var a=RTE.Cursor.$o(RTE.HtmlTagName.tableCellTagNames);if(!a)return;var i=RTE.RteUtility.getNearestParentElementOfType(a,"TR");if(!i)return;var b=RTE.RteUtility.getNearestParentElementOfType(i,"TABLE");if(!b)return;if(!RTE.Canvas.isEditable(b))return;var c=a.cloneNode(false);RTE.TableCommands.initTableCell(c);var f=RTE.TableCommands.$38(a);if(f>1){RTE.TableCommands.$7S(c,Math.floor(f/2));RTE.TableCommands.$7S(a,f-RTE.TableCommands.$38(c))}else{for(var j=RTE.TableCommands.$d(b,a,false),l=j.targetCellColSpanIndex,d=[],g=0;g<b.rows.length*2;g++){var e=j.columns[l].cells[g];if(!RTE.SU.isNullOrUndefined(e))!Array.contains(d,e.cell)&&e.cell!==a&&Array.add(d,e.cell)}for(var h=0;h<d.length;h++){var k=d[h];k.colSpan=k.colSpan+1}}RTE.RteUtility.insertAfter(c,a);RTE.Cursor.get_range().moveToStartOfNode(c);RTE.TableCommands.$1U(b);RTE.Cursor.update()};RTE.TableCommands.splitVertical=function(){ULSdmo:;var a=RTE.Cursor.$o(RTE.HtmlTagName.tableCellTagNames);if(!a)return;var b=RTE.RteUtility.getNearestParentElementOfType(a,"TR");if(!b)return;var c=RTE.RteUtility.getNearestParentElementOfType(b,"TABLE");if(!c)return;if(!RTE.Canvas.isEditable(c))return;var g=b.cells;if(a.rowSpan>1){for(var q=true,j=0;j<g.length;j++)if(g[j].rowSpan!==a.rowSpan){q=false;break}if(q)for(var k=0;k<g.length;k++)g[k].rowSpan=1}var p=b.rowIndex,d=a.cloneNode(false);RTE.TableCommands.initTableCell(d);var x=RTE.TableCommands.$d(c,a,false),y=x.targetCellColSpanIndex,i=a.rowSpan;if(i>1){for(var l=Math.floor(i/2),e=b,t=0;t<l;t++)if(e)e=e.nextSibling;if(!e)return;for(var r=0,s=e.cells,m=null,n=0;n<s.length;n++){var u=s[n];r+=RTE.TableCommands.$38(u);if(r>y){m=u;break}}d.rowSpan=i-l;a.rowSpan=l;if(!m)e.appendChild(d);else RTE.RteUtility.insertBefore(d,m)}else{var v=b.cloneNode(false);RTE.RteUtility.insertAfter(v,b);v.appendChild(d);for(var f=0;f<p+1&&f<c.rows.length;f++)for(var z=c.rows[f],w=z.cells,o=0;o<w.length;o++){var h=w[o];if(h!==a&&h.rowSpan+f===p+1)h.rowSpan=h.rowSpan+1}}RTE.Cursor.get_range().moveToStartOfNode(d);RTE.TableCommands.$1U(c);RTE.Cursor.update()};RTE.TableCommands.mergeCells=function(){ULSdmo:;var a=RTE.CanvasEvents.getNodeFromEvent("Table");if(!a)return;if(!RTE.Canvas.isEditable(a))return;if(RTE.Cursor.$CD("TR"))RTE.TableCommands.$9P();else RTE.TableCommands.$45(0)};RTE.TableCommands.mergeWithRight=function(){ULSdmo:;RTE.TableCommands.$45(1)};RTE.TableCommands.mergeWithLeft=function(){ULSdmo:;RTE.TableCommands.$45(2)};RTE.TableCommands.mergeWithAbove=function(){ULSdmo:;RTE.TableCommands.$45(3)};RTE.TableCommands.mergeWithBelow=function(){ULSdmo:;RTE.TableCommands.$45(4)};RTE.TableCommands.$45=function(e){ULSdmo:;RTE.TableCommands.$9P();var k=RTE.Cursor.getCurrentElement();if(!k)return;var f=RTE.RteUtility.$20(k,RTE.HtmlTagName.tableCellTagNames);if(!f)return;var a=RTE.RteUtility.getNearestParentElementOfType(f,"TR");if(!a)return;var b=RTE.RteUtility.getNearestParentElementOfType(a,"TABLE");if(!b)return;if(!RTE.Canvas.isEditable(b))return;var d=a.cells,l=RTE.ParagraphCommands.queryDirection(false).get_commandOn();if(l)if(1===e)e=2;else if(2===e)e=1;var c;if(1===e){c=f.cellIndex;if(c+1>=d.length)return;if(d[c+1].rowSpan===d[c].rowSpan)RTE.TableCommands.$5O(b,a,c);else RTE.UiServices.$I.showError(3)}else if(2===e){c=f.cellIndex-1;if(c<0)return;if(d[c+1].rowSpan===d[c].rowSpan)RTE.TableCommands.$5O(b,a,c);else RTE.UiServices.$I.showError(3)}else if(3===e){if(!a.rowIndex)return;var v=a,m=f,w=a.rowIndex,n=RTE.TableCommands.$d(b,f,true),o=n.targetCellColSpanIndex,p=n.columns[o].cells[w-1],q=p.cell;if(m.colSpan===q.colSpan&&p.colSpanIndex===o)RTE.TableCommands.$9Q(b,v,m,q);else RTE.UiServices.$I.showError(3)}else if(4===e){var h=f,r=RTE.TableCommands.$d(b,h,false),s=r.targetCellColSpanIndex,x=a.rowIndex,i=r.columns[s].cells[x+h.rowSpan];if(!i)return;var j=i.cell,t=RTE.RteUtility.getNearestParentElementOfType(j,"TR");if(!t)return;if(j.colSpan===h.colSpan&&i.colSpanIndex===s)RTE.TableCommands.$9Q(b,t,j,h);else RTE.UiServices.$I.showError(3)}else if(0===e){var g=f.cellIndex;if(d[g]&&d[g+1])if(l&&(g===d.length-1||g)){var u=g-1;if(u<0)return;RTE.TableCommands.$5O(b,a,u)}else{if(g+1>=d.length)return;RTE.TableCommands.$5O(b,a,g)}}};RTE.TableCommands.$5O=function(g,e,f){ULSdmo:;RTE.RteUtility.removeNode(RTE.Cursor.get_range().$1_0);RTE.RteUtility.removeNode(RTE.Cursor.get_range().$2_0);var d=e.cells,a=d[f],c=d[f+1],b=a.innerHTML;if(b.length>0)b+=" ";b+=c.innerHTML;RTE.RteUtility.$2j(a,b);a.colSpan+=c.colSpan;e.removeChild(c);RTE.Cursor.get_range().moveToStartOfNode(a);RTE.TableCommands.$1U(g);RTE.Cursor.update()};RTE.TableCommands.$9Q=function(d,e,c,b){ULSdmo:;RTE.RteUtility.removeNode(RTE.Cursor.get_range().$1_0);RTE.RteUtility.removeNode(RTE.Cursor.get_range().$2_0);var a=b.innerHTML;if(a.length>0)a+=" ";a+=c.innerHTML;RTE.RteUtility.$2j(b,a);b.rowSpan+=c.rowSpan;e.removeChild(c);RTE.Cursor.get_range().moveToStartOfNode(b);RTE.TableCommands.$1U(d);RTE.Cursor.update()};RTE.TableCommands.deleteCell=function(){ULSdmo:;var a=RTE.Cursor.$o(RTE.HtmlTagName.tableCellTagNames);if(!a)return;var g=RTE.RteUtility.getNearestParentElementOfType(a,"TR");if(!g)return;var f=RTE.RteUtility.getNearestParentElementOfType(a,"TABLE");if(!f)return;if(!RTE.Canvas.isEditable(f))return;var i=g.cells;if(i.length<=1){RTE.TableCommands.deleteRow();return}var c=a.nextSibling,d=a.previousSibling,e;if(c&&c.rowSpan===a.rowSpan){c.colSpan=c.colSpan+a.colSpan;e=c}else if(d&&d.rowSpan===a.rowSpan){d.colSpan=d.colSpan+a.colSpan;e=d}else{var j=g.rowIndex,h=RTE.TableCommands.$d(f,a,true),b;b=h.columns[h.targetCellColSpanIndex].cells[j-1];if(!RTE.SU.isNullOrUndefined(b)&&b.colSpanIndex===h.targetCellColSpanIndex&&b.cell.colSpan===a.colSpan){b.cell.rowSpan=b.cell.rowSpan+a.rowSpan;e=b.cell}else e=c||d}RTE.Cursor.get_range().moveToStartOfNode(e);a.parentNode.removeChild(a);RTE.TableCommands.$1U(f);RTE.Cursor.update()};RTE.TableCommands.deleteTable=function(){ULSdmo:;var a=RTE.CanvasEvents.getNodeFromEvent("Table");if(!a)return;if(!RTE.Canvas.isEditable(a))return;RTE.Cursor.get_range().moveAfterNode(a);a.parentNode.removeChild(a);RTE.Cursor.update();RTE.Canvas.sendApplicationStateChangedEvent()};RTE.TableCommands.$Bn=function(b){ULSdmo:;var a=b.parentNode;return a.rowIndex};RTE.TableCommands.$6X=function(a,b,c,d){ULSdmo:;return a===c?b<d?b:d:a>c?RTE.TableCommands.$6X(c,d,a,b):c>a+b?0:c+d<=a+b?d:a+b-c};RTE.TableCommands.deleteRow=function(){ULSdmo:;var c=RTE.Cursor.$o(RTE.HtmlTagName.tableCellTagNames);if(!c)return;var a=RTE.RteUtility.getNearestParentElementOfType(c,"TR");if(!a)return;var b=RTE.RteUtility.getNearestParentElementOfType(a,"TABLE");if(!b)return;var d=a.rowIndex,e=!d&&RTE.TableCommands.hasHeaderRow(b);RTE.TableCommands.$97(a,b,true);RTE.TableCommands.$9C(e,b);RTE.Cursor.get_range().resetCacheRange();RTE.Cursor.update()};RTE.TableCommands.$97=function(t,a,p){ULSdmo:;if(!RTE.Canvas.isEditable(a))return;if(a.rows.length===1){p&&RTE.Cursor.get_range().moveAfterNode(a);a.parentNode.removeChild(a)}else{for(var c=t.rowIndex,q=!c&&RTE.Canvas.setTableWidths,m=RTE.TableCommands.$d(a,null,false),e=[],j=0;j<m.totalColSpan;j++)for(var d=c;d<c+1;d++){var f=m.columns[j];if(!RTE.SU.isNullOrUndefined(f)){var g=f.cells[d];if(!RTE.SU.isNullOrUndefined(g)){!Array.contains(e,g.cell)&&Array.add(e,g.cell);if(!RTE.SU.isNullOrEmptyString(g.cell.style.width)&&q&&d+1<f.cells.length){var h=f.cells[d+1];if(!RTE.SU.isNullOrUndefined(h)&&RTE.SU.isNullOrEmptyString(h.cell.style.width))h.cell.style.width=h.cell.offsetWidth+"px"}}}}for(var k=0;k<e.length;k++){var b=e[k],r=RTE.TableCommands.$Bn(b),n=RTE.TableCommands.$6X(c,1,r,b.rowSpan);if(n===b.rowSpan)b.parentNode.removeChild(b);else b.rowSpan=b.rowSpan-n}for(var i=a.rows.length-1;i>=0;i--){var o=a.rows[i],s=a.rows[i].cells;!s.length&&o.parentNode.removeChild(o)}if(p)if(!a.rows.length){RTE.Cursor.get_range().moveAfterNode(a);a.parentNode.removeChild(a)}else{var l=null;if(c>=a.rows.length)l=a.rows[a.rows.length-1];else l=a.rows[c];RTE.Cursor.get_range().moveToNode(l.childNodes[0])}}};RTE.TableCommands.$9C=function(b,a){ULSdmo:;if(b)RTE.TableCommands.setHeaderRow(a,true);else RTE.TableCommands.$1U(a)};RTE.TableCommands.$9P=function(){ULSdmo:;var d=RTE.Cursor.getCurrentElement();if(!d)return;if(d.tagName!=="TR")return;var f=RTE.RteUtility.getNearestParentElementOfType(d,"TABLE");if(!f)return;if(!RTE.Canvas.isEditable(f))return;var a=RTE.TableCommands.$Bv();if(a.length>1){var b=a[0],e=new Sys.StringBuilder;e.append(b.innerHTML);for(var g=RTE.TableCommands.$38(b),c=1;c<a.length;c++){e.append(" ");e.append(a[c].innerHTML);g+=RTE.TableCommands.$38(a[c]);d.removeChild(a[c])}RTE.RteUtility.$2j(b,e.toString());RTE.TableCommands.$7S(b,g);var h=RTE.Cursor.get_range();h.moveToStartOfNode(b);RTE.TableCommands.$1U(f);RTE.Cursor.update()}};RTE.TableCommands.$d=function(j,g,k){ULSdmo:;var a=new RTE.TableGrid;a.columns=[];a.targetCellColSpanIndex=-1;a.totalColSpan=-1;for(var c=0;c<j.rows.length;c++){for(var b=0,i=j.rows[c].cells,h=0;h<i.length;h++){while(a.columns[b]&&a.columns[b].cells[c])b++;if(!a.columns[b]){a.columns[b]=new RTE.TableColumnInfo;a.columns[b].cells=[]}var e=i[h];if(e===g)a.targetCellColSpanIndex=b;a.columns[b].cells[c]=new RTE.TableCellInfo;a.columns[b].cells[c].cell=e;a.columns[b].cells[c].colSpanIndex=b;for(var d=0;d<e.colSpan;d++){if(!a.columns[b+d]){a.columns[b+d]=new RTE.TableColumnInfo;a.columns[b+d].cells=[]}for(var f=0;f<e.rowSpan;f++){a.columns[b+d].cells[c+f]=new RTE.TableCellInfo;a.columns[b+d].cells[c+f].cell=e;a.columns[b+d].cells[c+f].colSpanIndex=b}}b+=e.colSpan;if(k)if(a.targetCellColSpanIndex!==-1&&b>a.targetCellColSpanIndex+g.colSpan&&c!==g.parentNode.rowIndex+g.rowSpan-1)break}if(b>a.totalColSpan)a.totalColSpan=b}return a};RTE.TableCommands.queryTableWidth=function(){ULSdmo:;var c=new RTE.CommandState,b=RTE.CanvasEvents.getNodeFromEvent("Table");if(!b||!RTE.Canvas.isEditable(b))return c;c.$D_0=true;var a=b.style.width;if(RTE.SU.isNullOrEmptyString(a))a=b.width;if(RTE.SU.isNullOrEmptyString(a)||!RTE.RteUtility.$2S(RTE.TableCommands.$4T,a))a=b.offsetWidth.toString()+"px";c.$8_0=a;return c};RTE.TableCommands.queryTableHeight=function(){ULSdmo:;var c=new RTE.CommandState,b=RTE.CanvasEvents.getNodeFromEvent("Table");if(!b||!RTE.Canvas.isEditable(b))return c;c.$D_0=true;var a=b.style.height;if(RTE.SU.isNullOrEmptyString(a))a=b.height;if(RTE.SU.isNullOrEmptyString(a)||!RTE.RteUtility.$2S(RTE.TableCommands.$4T,a))a=b.offsetHeight.toString()+"px";c.$8_0=a;return c};RTE.TableCommands.queryTableRowHeight=function(){ULSdmo:;var a=new RTE.CommandState,b=RTE.Cursor.$o(RTE.HtmlTagName.tableCellTagNames);if(!b||!RTE.Canvas.isEditable(b))return a;var d=RTE.RteUtility.getNearestParentElementOfType(b,"TABLE");if(!d||!RTE.Canvas.isEditable(d))return a;a.$D_0=true;var c=b.style.height;if(RTE.SU.isNullOrEmptyString(c)||!RTE.RteUtility.$2S(RTE.TableCommands.$4T,c))c=b.offsetHeight.toString()+"px";a.$8_0=c;return a};RTE.TableCommands.queryTableColumnWidth=function(){ULSdmo:;var a=new RTE.CommandState,b=RTE.Cursor.$o(RTE.HtmlTagName.tableCellTagNames);if(!b||!RTE.Canvas.isEditable(b))return a;var d=RTE.RteUtility.getNearestParentElementOfType(b,"TABLE");if(!d||!RTE.Canvas.isEditable(d))return a;a.$D_0=true;var c=b.style.width;if(RTE.SU.isNullOrEmptyString(c)||!RTE.RteUtility.$2S(RTE.TableCommands.$4T,c))c=b.offsetWidth.toString()+"px";a.$8_0=c;return a};RTE.TableCommands.setTableWidth=function(b){ULSdmo:;var a=RTE.CanvasEvents.getNodeFromEvent("Table");if(!a)return;if(!RTE.Canvas.isEditable(a))return;RTE.RteUtility.getAttribute(a,"width")&&a.removeAttribute("width");RTE.SnapshotManager.setCurrentRegionDirtyIf(a.style.width!==b);a.style.width=b};RTE.TableCommands.setTableHeight=function(b){ULSdmo:;var a=RTE.CanvasEvents.getNodeFromEvent("Table");if(!a)return;if(!RTE.Canvas.isEditable(a))return;RTE.RteUtility.getAttribute(a,"height")&&a.removeAttribute("height");RTE.SnapshotManager.setCurrentRegionDirtyIf(a.style.height!==b);a.style.height=b};RTE.TableCommands.setTableColumnWidth=function(h){ULSdmo:;var b=RTE.Cursor.$o(RTE.HtmlTagName.tableCellTagNames);if(!b)return;var c=RTE.RteUtility.getNearestParentElementOfType(b,"TABLE");if(!c)return;if(!RTE.Canvas.isEditable(c))return;for(var i=RTE.TableCommands.$d(c,b,false),j=i.targetCellColSpanIndex,l=b.colSpan,d=[],k=[],g=0;g<c.rows.length*2;g++){var e=i.columns[j].cells[g];if(!RTE.SU.isNullOrUndefined(e))if(!Array.contains(d,e.cell)){Array.add(d,e.cell);Array.add(k,e.colSpanIndex)}}for(var f=0;f<d.length;f++){var a=d[f],m=k[f];if(m===j&&a.colSpan===l){a.attributes.getNamedItem("width")&&a.removeAttribute("width");RTE.SnapshotManager.setCurrentRegionDirtyIf(a.style.width!==h);a.style.width=h}}};RTE.TableCommands.setTableRowHeight=function(d){ULSdmo:;var b=RTE.Cursor.$o(RTE.HtmlTagName.tableCellTagNames);if(!b)return;var e=RTE.RteUtility.getNearestParentElementOfType(b,"TR");if(!b)return;var f=RTE.RteUtility.getNearestParentElementOfType(e,"TABLE");if(!f)return;if(!RTE.Canvas.isEditable(f))return;for(var g=e.cells,c=0;c<g.length;c++){var a=g[c];if(a.rowSpan===b.rowSpan){RTE.RteUtility.getAttribute(a,"height")&&a.removeAttribute("height");RTE.SnapshotManager.setCurrentRegionDirtyIf(a.style.height!==d);a.style.height=d}}};RTE.TableCommands.$C3=function(d,f){ULSdmo:;for(var e=true,b=0;b<d.columns.length;b++){var c=d.columns[b].cells;if(c&&f<c.length){var a=c[f];if(a&&a.cell)if(a.cell.tagName==="TH"){if(a.colSpanIndex&&a.colSpanIndex+a.cell.colSpan!==d.totalColSpan)return true}else e=false}}return e};RTE.TableCommands.$C2=function(g,h){ULSdmo:;var d=true;if(h<g.columns.length){var a=g.columns[h].cells;if(a&&a.length>0){var e=null,f=null;if(a[0])e=a[0].cell;if(a[a.length-1])f=a[a.length-1].cell;for(var c=0;c<a.length;c++){var b=a[c];if(b&&b.cell)if(b.cell.tagName==="TH"){if(b.cell!==e&&b.cell!==f)return true}else d=false}}}return d};RTE.TableCommands.$8v=function(a,e,b){ULSdmo:;if(a.rows.length>0){var c=a.rows[b];if(c.className.indexOf("Table"+e)!==-1)return true;else{var d=RTE.TableCommands.$d(a,null,false);return RTE.TableCommands.$C3(d,b)}}return true};RTE.TableCommands.hasHeaderRow=function(a){ULSdmo:;return RTE.TableCommands.$8v(a,"Header",0)};RTE.TableCommands.hasFooterRow=function(a){ULSdmo:;return RTE.TableCommands.$8v(a,"Footer",a.rows.length-1)};RTE.TableCommands.$8u=function(d,e,f){ULSdmo:;if(f<d.columns.length){var a=d.columns[f].cells;if(a){for(var b=0;b<a.length;b++)if(a[b]&&a[b].cell){var c=a[b].cell;if(c.className.indexOf("Table"+e)!==-1)return true;else if(c.className.indexOf("TableHeader"+e)!==-1)return true;else if(c.className.indexOf("TableFooter"+e)!==-1)return true}if(a.length>0)return RTE.TableCommands.$C2(d,f)}}return true};RTE.TableCommands.hasFirstColumn=function(a){ULSdmo:;var b=RTE.TableCommands.$d(a,null,false);return RTE.TableCommands.$8u(b,"First",0)};RTE.TableCommands.hasLastColumn=function(b){ULSdmo:;var a=RTE.TableCommands.$d(b,null,false);return a.totalColSpan>0?RTE.TableCommands.$8u(a,"Last",a.totalColSpan-1):false};RTE.TableCommands.$5g=function(b,c){ULSdmo:;var a=null;if(b.tagName==="TD"&&c)a=document.createElement("TH");else if(b.tagName==="TH"&&!c)a=document.createElement("TD");if(a){RTE.RteUtility.moveChildNodes(b,a);a.style.cssText=b.style.cssText;a.className=b.className;RTE.TableCommands.$1o(a,a.className);a.rowSpan=b.rowSpan;a.colSpan=b.colSpan;b.parentNode.replaceChild(a,b)}};RTE.TableCommands.$7V=function(d,g,h){ULSdmo:;if(d.rows.length>0)for(var e=RTE.TableCommands.$d(d,null,false),b=0;b<e.columns.length;b++){var c=e.columns[b].cells;if(c&&g<c.length){var a=c[g];if(a&&a.cell){var f=a.cell;if(!a.colSpanIndex&&RTE.TableCommands.hasFirstColumn(d))RTE.TableCommands.$5g(f,true);else RTE.TableCommands.$5g(f,h)}}}};RTE.TableCommands.setHeaderRow=function(a,b){ULSdmo:;RTE.TableCommands.$7V(a,0,b);var c=RTE.TableCommands.$3l(a),d=RTE.TableCommands.hasFooterRow(a),e=RTE.TableCommands.hasFirstColumn(a),f=RTE.TableCommands.hasLastColumn(a);RTE.TableCommands.$4L(a,c,b,d,e,f,false);RTE.Cursor.update()};RTE.TableCommands.setFooterRow=function(a,b){ULSdmo:;!b&&RTE.TableCommands.$7V(a,a.rows.length-1,b);var c=RTE.TableCommands.$3l(a),d=RTE.TableCommands.hasHeaderRow(a),e=RTE.TableCommands.hasFirstColumn(a),f=RTE.TableCommands.hasLastColumn(a);RTE.TableCommands.$4L(a,c,d,b,e,f,false);RTE.Cursor.update()};RTE.TableCommands.$7R=function(g,e,f,h){ULSdmo:;if(f<e.columns.length){var b=e.columns[f].cells;if(b)for(var a=0;a<b.length;a++){var c=b[a];if(c&&c.cell){var d=c.cell;if(!a&&RTE.TableCommands.hasHeaderRow(g))RTE.TableCommands.$5g(d,true);else RTE.TableCommands.$5g(d,h)}}}};RTE.TableCommands.setFirstColumn=function(a,b){ULSdmo:;var c=RTE.TableCommands.$d(a,null,false);RTE.TableCommands.$7R(a,c,0,b);var d=RTE.TableCommands.$3l(a),e=RTE.TableCommands.hasHeaderRow(a),f=RTE.TableCommands.hasFooterRow(a),g=RTE.TableCommands.hasLastColumn(a);RTE.TableCommands.$4L(a,d,e,f,b,g,false);RTE.Cursor.update()};RTE.TableCommands.setLastColumn=function(a,b){ULSdmo:;if(!b){var c=RTE.TableCommands.$d(a,null,false);RTE.TableCommands.$7R(a,c,c.totalColSpan-1,b)}var d=RTE.TableCommands.$3l(a),e=RTE.TableCommands.hasHeaderRow(a),f=RTE.TableCommands.hasFooterRow(a),g=RTE.TableCommands.hasFirstColumn(a);RTE.TableCommands.$4L(a,d,e,f,g,b,false);RTE.Cursor.update()};RTE.TableCommands.$3l=function(f){ULSdmo:;var b=f.className,c="Table-",d=b.indexOf(c);if(d!==-1){var a=b.substr(d+c.length),e=a.indexOf(" ");return e!==-1?a.substring(0,e):a}return null};RTE.TableCommands.$1U=function(a){ULSdmo:;var b=RTE.TableCommands.$3l(a);RTE.TableCommands.setTableStyle(a,b,false)};RTE.TableCommands.hasTableStyle=function(a){ULSdmo:;if(a&&a.className){var b=RTE.Canvas.getCurrentStyleSheetPrefix();return a.className.indexOf(b+"Table")!==-1}return false};RTE.TableCommands.getTableStyle=function(b){ULSdmo:;if(b&&b.className)for(var d=RTE.Canvas.getCurrentStyleSheetPrefix(),c=b.className.split(" "),a=0;a<c.length;a++)if(c[a].indexOf(d+"Table")!==-1)return c[a];return null};RTE.TableCommands.setTableStyle=function(a,c,b){ULSdmo:;var d=RTE.TableCommands.hasHeaderRow(a),e=RTE.TableCommands.hasFooterRow(a),f=RTE.TableCommands.hasFirstColumn(a),g=RTE.TableCommands.hasLastColumn(a);RTE.TableCommands.$4L(a,c,d,e,f,g,b)};RTE.TableCommands.$4L=function(a,f,r,s,t,u,v){ULSdmo:;var b=RTE.Canvas.getCurrentStyleSheetPrefix(),p=RTE.TableCommands.$7v(a),g;if(v)g=[b+"Table",b+"BackColor",b+"ThemeBackColor"];else g=[b+"Table"];var j=false;RTE.RteUtility.assertNotNull("Cursor.GetSelectedTable()",a);var m="";if(!RTE.SU.isNullOrEmptyString(f))m=b+"Table-"+f;var q=a.className;RTE.RteUtility.$1V(a,m,g);if(q!==a.className){j=true;a.removeAttribute("border");RTE.TableCommands.$6E(a.style)}RTE.TableCommands.$1o(a,a.className);for(var c=0;c<a.rows.length;c++){var d=a.rows[c],k="",h="";if(!c&&r){h="Header";k="Header"}else if(c===a.rows.length-1&&s){h="Footer";k="Footer"}else if(c%2===1)h="Odd";else h="Even";var n="";if(!RTE.SU.isNullOrEmptyString(f))n=b+"Table"+h+"Row-"+f;j&&RTE.TableCommands.$6E(d.style);RTE.TableCommands.$1o(d,RTE.RteUtility.$1V(d,n,g));for(var e=0;e<d.cells.length;e++){var l=d.cells[e],i="";if(!e&&t)i="First";else if(e===d.cells.length-1&&u)i="Last";else if(e%2===1)i="Odd";else i="Even";var o="";if(!RTE.SU.isNullOrEmptyString(f))o=b+"Table"+k+i+"Col-"+f;j&&RTE.TableCommands.$6E(l.style);RTE.TableCommands.$1o(l,RTE.RteUtility.$1V(l,o,g))}}!RTE.PreviewManager.get_instance().get_hasPreview()&&RTE.TableCommands.$AB(a,p)};RTE.TableCommands.$6E=function(a){ULSdmo:;RTE.RteUtility.$f(a,"border");RTE.RteUtility.$f(a,"background");RTE.RteUtility.$f(a,"color");RTE.RteUtility.$f(a,"direction");RTE.RteUtility.$f(a,"font");RTE.RteUtility.$f(a,"margin");RTE.RteUtility.$f(a,"padding");RTE.RteUtility.$f(a,"textAlign");RTE.RteUtility.$f(a,"textDecoration");RTE.RteUtility.$f(a,"textJustify");RTE.RteUtility.$f(a,"textTransform");RTE.RteUtility.$f(a,"verticalAlign");a.cssText=a.cssText.replace(new RegExp("(border-width|border-color)[^;]*;","gi"),"")};RTE.TableCommands.clearTableStyle=function(){ULSdmo:;var a=RTE.CanvasEvents.getNodeFromEvent("Table"),b=RTE.Canvas.getCurrentStyleSheetPrefix();RTE.TableCommands.$1o(a,RTE.RteUtility.$1V(a,"",[b+"Table"]));for(var c=0;c<a.rows.length;c++){var e=a.rows[c];RTE.TableCommands.$1o(e,RTE.RteUtility.$1V(e,"",[b+"Table"]))}for(var d=0;d<a.cells.length;d++){var f=a.cells[d];RTE.TableCommands.$1o(f,RTE.RteUtility.$1V(f,"",[b+"Table"]))}};RTE.TableCommands.setTableGridLines=function(b){ULSdmo:;var a=RTE.CanvasEvents.getNodeFromEvent("Table");if(null===a)return;RTE.TableCommands.$AB(a,b)};RTE.TableCommands.queryTableGridLines=function(){ULSdmo:;var a=new RTE.CommandState,b=RTE.CanvasEvents.getNodeFromEvent("Table");if(!b)return a;a.$D_0=true;a.$j_0=RTE.TableCommands.$7v(b);return a};RTE.TableCommands.$AB=function(a,b){ULSdmo:;if(b)Sys.UI.DomElement.addCssClass(a,RTE.TableCommands.$5j);else Sys.UI.DomElement.removeCssClass(a,RTE.TableCommands.$5j)};RTE.TableCommands.$7v=function(a){ULSdmo:;return!RTE.SU.isNullOrEmptyString(a.className)&&a.className.indexOf(RTE.TableCommands.$5j)>=0};RTE.TableCommands.canInsertRow=function(){ULSdmo:;var a;if(null===(a=RTE.Cursor.getNearestContainingElementOfType("TR")))return false;var b;return null===(b=RTE.RteUtility.getNearestParentElementOfType(a,"TABLE"))?false:RTE.Canvas.isEditable(b)};RTE.TableCommands.canInsertColumn=function(){ULSdmo:;var a;if(null===(a=RTE.Cursor.$o(RTE.HtmlTagName.tableCellTagNames)))return false;var b;return null===(b=RTE.RteUtility.getNearestParentElementOfType(a,"TABLE"))?false:RTE.Canvas.isEditable(b)};RTE.TableCommands.canMergeCells=function(){ULSdmo:;var a;if(null===(a=RTE.Cursor.getCurrentElement()))return false;var b;if(null===(b=RTE.RteUtility.$20(a,RTE.HtmlTagName.tableCellTagNames)))return false;var c;if(null===(c=RTE.RteUtility.getNearestParentElementOfType(b,"TR")))return false;var d;return null===(d=RTE.RteUtility.getNearestParentElementOfType(c,"TABLE"))?false:RTE.Canvas.isEditable(d)};RTE.TableCommands.canMergeSelected=function(){ULSdmo:;var a;if(null===(a=RTE.Cursor.getCurrentElement())||"TR"!==a.tagName)return false;var b;return null===(b=RTE.RteUtility.getNearestParentElementOfType(a,"TABLE"))?false:RTE.Canvas.isEditable(b)};RTE.TableCommands.canSplit=function(){ULSdmo:;var a;if(null===(a=RTE.Cursor.$o(RTE.HtmlTagName.tableCellTagNames)))return false;var b;if(null===(b=RTE.RteUtility.getNearestParentElementOfType(a,"TR")))return false;var c;return null===(c=RTE.RteUtility.getNearestParentElementOfType(b,"TABLE"))?false:RTE.Canvas.isEditable(c)};RTE.TableCommands.initTableCell=function(a){ULSdmo:;RTE.RteUtility.$2j(a,RTE.RteUtility.$1t)};RTE.TableKeyTabProcessor=function(a){ULSdmo:;this.$2Z_0=a;this.$27_0=RTE.Cursor.$o(RTE.HtmlTagName.tableCellTagNames);this.$43_0=RTE.RteUtility.getNearestParentElementOfType(this.$27_0,"TR");this.$5M_0=RTE.RteUtility.getNearestParentElementOfType(this.$43_0,"TABLE")};RTE.TableKeyTabProcessor.prototype={$27_0:null,$43_0:null,$5M_0:null,$2Z_0:false,process:function(){ULSdmo:;if(!this.$27_0||!this.$43_0||!this.$5M_0)return false;var a=this.$2Z_0?RTE.RteUtility.getRealNextSibling(this.$27_0,false):RTE.RteUtility.getRealPreviousSibling(this.$27_0,false);if(!a){var b=this.$2Z_0?RTE.RteUtility.getRealNextSibling(this.$27_0.parentNode,false):RTE.RteUtility.getRealPreviousSibling(this.$27_0.parentNode,false);if(b)a=this.$2Z_0?b.children[0]:b.children[b.children.length-1]}if(!a){var c=RTE.TableCommands.$96(this.$5M_0,this.$43_0,!this.$2Z_0);a=this.$2Z_0?c.children[0]:c.children[c.children.length-1]}if(a&&a.nodeType===1){var d=RTE.Cursor.get_range();d.moveToEndOfNode(a);RTE.Cursor.update();return true}return false}};RTE.UiServices=function(){};RTE.UiServices.get_current=function(){ULSdmo:;return RTE.UiServices.$I};RTE.UiServices.set_current=function(a){ULSdmo:;RTE.UiServices.$I=a;return a};RTE.UiServices.prototype={initialFocusOnRichText:function(){ULSdmo:;return false},sendApplicationStateChangedEvent:function(){},showError:function(){},showWaitDialog:function(){},hideWaitDialog:function(){},showUiExperience:function(){},populatePasteFlyoutUi:function(b){ULSdmo:;var a=document.createElement("SPAN");a.id="rtePasteFlyoutText";a.appendChild(document.createTextNode("(Ctrl)"));b.appendChild(a)},populatePasteFlyoutOptionsTitleUi:function(a){ULSdmo:;a.appendChild(document.createTextNode("Options:"))},isFocusValidOnThisNode:function(){ULSdmo:;return true},isOnUiOperation:function(){ULSdmo:;return false}};Type.registerNamespace("RTE.PasteCommon");RTE.PasteCommon.Debug=function(){};RTE.PasteCommon.Debug.$1J=function(a,b,c){ULSdmo:;!a&&RTE.PasteCommon.Debug.$4a(b,c)};RTE.PasteCommon.Debug.$6=function(a,b){ULSdmo:;RTE.PasteCommon.Debug.$4a(a,b)};RTE.PasteCommon.Debug.assertTag=function(a,b){ULSdmo:;!a&&RTE.PasteCommon.Debug.$4a("Failed assert",b)};RTE.PasteCommon.Debug.$CU=function(){};RTE.PasteCommon.Debug.$63=function(a){ULSdmo:;RTE.PasteCommon.Debug.$6("Failed assert not reached",a)};RTE.PasteCommon.Debug.$7w=function(a,b,c){ULSdmo:;a&&!b&&RTE.PasteCommon.Debug.$4a("Assert implies failed",c)};RTE.PasteCommon.Debug.$4a=function(){};RTE.PasteCommon.Debug.assertString=function(a,b){ULSdmo:;RTE.PasteCommon.Debug.$1J(a,b,0)};RTE.PasteCommon.Debug.assertNotReachedString=function(a){ULSdmo:;RTE.PasteCommon.Debug.$6(a,0)};RTE.PasteCommon.Debug.assert=function(a){ULSdmo:;RTE.PasteCommon.Debug.assertTag(a,0)};RTE.PasteCommon.Debug.log=function(a,b,c){ULSdmo:;RTE.PasteCommon.Debug.$CU(a,b,c,0)};RTE.PasteCommon.Debug.assertNotReached=function(){ULSdmo:;RTE.PasteCommon.Debug.$63(0)};RTE.PasteCommon.LogLevel=function(){};RTE.PasteCommon.StringUtils=function(){};RTE.PasteCommon.StringUtils.toLower=function(a){ULSdmo:;return a.toLowerCase()};RTE.PasteCommon.StringUtils.toUpper=function(a){ULSdmo:;return a.toUpperCase()};RTE.PasteCommon.CustomData=function(){};RTE.PasteCommon.CustomData.$3Q=function(c,d,e){ULSdmo:;if(RTE.RteUtility.isValidRteNodeId(c)){var b=RTE.RteUtility.getRteNodeId(c);if(!RTE.SU.isNullOrEmptyString(b)){var a=RTE.PasteCommon.CustomData.dict[b];if(RTE.SU.isNullOrUndefined(a)){a={};RTE.PasteCommon.CustomData.dict[b]=a}a[d]=e}}};RTE.PasteCommon.CustomData.getObject=function(c,d){ULSdmo:;if(RTE.RteUtility.isValidRteNodeId(c)){var a=RTE.RteUtility.getRteNodeId(c);if(!RTE.SU.isNullOrEmptyString(a)){var b=RTE.PasteCommon.CustomData.dict[a];if(!RTE.SU.isNullOrUndefined(b))return b[d]}}return null};RTE.PasteCommon.CustomData.removeObject=function(a,b){ULSdmo:;RTE.PasteCommon.CustomData.$3Q(a,b,null)};RTE.PasteCommon.AOperation=function(){};RTE.PasteCommon.SimpleOperationImplementation=function(){};RTE.PasteCommon.SimpleOperation=function(a,b,c){ULSdmo:;RTE.PasteCommon.SimpleOperation.initializeBase(this);if(!RTE.PasteCommon.SimpleOperationImplementation.factoryMethod)throw Error.notImplemented();this.$21_1=RTE.PasteCommon.SimpleOperationImplementation.factoryMethod(this,a,b,c)};RTE.PasteCommon.SimpleOperation.prototype={$21_1:null,get_implementation:function(){ULSdmo:;return this.$21_1},get_$5E_1:function(){ULSdmo:;return this.$21_1.get_isSynchronous()},set_$5E_1:function(a){ULSdmo:;this.$21_1.set_isSynchronous(a);return a},$4i_1:function(a){ULSdmo:;this.$21_1.changeStepCallback(a)},$7J_1:function(){ULSdmo:;this.$21_1.run()},$Au_1:function(){ULSdmo:;this.$21_1.cancel()},setDebugName:function(){}};RTE.PasteCommon.HtmlProcessorPercentage=function(){ULSdmo:;this.$2o_0=-1};RTE.PasteCommon.HtmlProcessorPercentage.prototype={$5x_0:0,$5u_0:null,update:function(d,c){ULSdmo:;var a=c;if(a&&a.$1j_0){if(this.$2o_0===-1&&a.$1j_0.length>0)this.$2o_0=a.$1j_0[0].parentNode.getElementsByTagName("*").length;if(this.$2o_0>0){var b=a.$1j_0[a.$2w_0];if(b&&b!==this.$5u_0)if(b.nodeType===1)this.$5x_0++;this.$5u_0=b}}return this.$2o_0>0?Math.min(.99,this.$5x_0/this.$2o_0):.99}};Type.registerNamespace("RTE.HtmlImport");RTE.HtmlImport.HtmlProcessorArguments=function(a){ULSdmo:;this.$1j_0=a.childNodes;this.$2w_0=0;this.$3A_0=false};RTE.HtmlImport.ProcessorInstructions=function(){};RTE.HtmlImport.ProcessorInstructions.prototype={notifyOnClose:1,ignoreCloseTag:2,pruneElement:3};RTE.HtmlImport.ProcessorInstructions.registerEnum("RTE.HtmlImport.ProcessorInstructions",false);RTE.HtmlImport.IFormattingSteward=function(){};RTE.HtmlImport.IFormattingSteward.registerInterface("RTE.HtmlImport.IFormattingSteward");RTE.HtmlImport.IHtmlEventAcceptor=function(){};RTE.HtmlImport.IHtmlEventAcceptor.registerInterface("RTE.HtmlImport.IHtmlEventAcceptor");RTE.HtmlImport.ISemanticEventAcceptor=function(){};RTE.HtmlImport.ISemanticEventAcceptor.registerInterface("RTE.HtmlImport.ISemanticEventAcceptor");RTE.HtmlImport.ListStyleType=function(){};RTE.HtmlImport.ListStyleType.prototype={unspecified:0,none:1,defaultUnordered:2,disc:3,circle:4,square:5,defaultOrdered:6,decimal:7,lowerAlpha:8,lowerRoman:9,upperAlpha:10,upperRoman:11};RTE.HtmlImport.ListStyleType.registerEnum("RTE.HtmlImport.ListStyleType",false);RTE.HtmlImport.WordConverterArguments=function(a){ULSdmo:;this.$5S_0=a;this.$1k_0=0;this.$5I_0={};this.$2Y_0=new Array(0);this.$s_0=new Array(0);this.$s_0[0]=new RTE.HtmlImport.LevelLists;this.$3H_0=null};RTE.HtmlImport.LevelLists=function(){ULSdmo:;this.$5J_0={};this.$31_0=-1};RTE.HtmlImport.ListItemMetadata=function(){};RTE.HtmlImport.ListMetadata=function(){ULSdmo:;this.$1a_0="UL";this.$2M_0=null;this.$2O_0=false;this.$48_0=0};RTE.HtmlImport.AHtmlNormalizer=function(a){ULSdmo:;this.steward=a};RTE.HtmlImport.AHtmlNormalizer.prototype={steward:null,reset:function(){ULSdmo:;this.steward.reset()},get_defaultFormatting:function(){ULSdmo:;return this.steward.get_defaultFormatting()},onText:function(a){ULSdmo:;this.steward.onText(a)},onLineBreak:function(){ULSdmo:;this.steward.onLineBreak()},onImage:function(a){ULSdmo:;this.steward.onImage(a)},onFormattingChange:function(a){ULSdmo:;this.steward.onFormattingChange(a)},onAnchorStart:function(a){ULSdmo:;this.steward.onAnchorStart(a)},onAnchorEnd:function(){ULSdmo:;this.steward.onAnchorEnd()},onParagraphStart:function(){ULSdmo:;this.steward.onParagraphStart()},onParagraphEnd:function(){ULSdmo:;this.steward.onParagraphEnd()},onListStart:function(a){ULSdmo:;this.steward.onListStart(a)},onListEnd:function(){ULSdmo:;this.steward.onListEnd()},onListItemStart:function(a){ULSdmo:;this.steward.onListItemStart(a)},onListItemEnd:function(){ULSdmo:;this.steward.onListItemEnd()},onTableStart:function(a){ULSdmo:;this.steward.onTableStart(a)},onTableEnd:function(){ULSdmo:;this.steward.onTableEnd()},onTableRowStart:function(){ULSdmo:;this.steward.onTableRowStart()},onTableRowEnd:function(){ULSdmo:;this.steward.onTableRowEnd()},onTableCellStart:function(a){ULSdmo:;this.steward.onTableCellStart(a)},onTableCellEnd:function(){ULSdmo:;this.steward.onTableCellEnd()},onTablePartStart:function(){ULSdmo:;this.steward.onTablePartStart()},onTablePartEnd:function(){ULSdmo:;this.steward.onTablePartEnd()}};RTE.HtmlImport.AHtmlPasteSteward=function(a){ULSdmo:;this.ownerDocument=a};RTE.HtmlImport.AHtmlPasteSteward.prototype={ownerDocument:null,generatedHtmlLocation:null,reset:function(){ULSdmo:;this.generatedHtmlLocation=this.ownerDocument.body}};RTE.HtmlImport.AHtmlTranslator=function(a){ULSdmo:;this.$$d_$Cm_0=Function.createDelegate(this,this.$Cm_0);this.normalizer=a};RTE.HtmlImport.AHtmlTranslator.prototype={normalizer:null,$16_0:null,$2m_0:null,get_$87_0:function(){ULSdmo:;return this.$2m_0.peek()},$3W_0:false,reset:function(){ULSdmo:;this.normalizer.reset();this.$16_0=new(RTE.HtmlImport.Stack$1.$$(Object));this.$2m_0=new(RTE.HtmlImport.Stack$1.$$(RTE.HtmlImport.IFormattingSteward));this.$2m_0.push(this.normalizer.get_defaultFormatting());this.$3W_0=false},onBeforeNewElement:function(){ULSdmo:;this.$3W_0=false},registerOnCloseCallback:function(a){ULSdmo:;if(!this.$3W_0){RTE.PasteCommon.Debug.$1J(!this.$16_0.get_count()||!!this.$16_0.peek(),"When encountering a new element, we should have a non-null callback on top of the stack if it's not empty.",582539);this.$16_0.push(null);this.$3W_0=true}this.$16_0.push(a)},onClose:function(){ULSdmo:;RTE.PasteCommon.Debug.$1J(!!this.$16_0.get_count()&&!!this.$16_0.peek(),"In OnClose, we should have a non-null callback on top of the stack.",582540);while(true){var a=this.$16_0.pop();if(!a)break;var b=a;b()}RTE.PasteCommon.Debug.$1J(!this.$16_0.get_count()||!!this.$16_0.peek(),"After OnClose, we should have a non-null callback on top of the stack if it's not empty.",582541)},setFormattingFromAttributes:function(){ULSdmo:;return false},notifyNormalizerOfCurrentFormatting:function(){ULSdmo:;var a=this;return this.handleSpecifiedFormatting(function(){ULSdmo:;return true})},handleSpecifiedFormatting:function(b){ULSdmo:;var a=this.get_$87_0().clone();if(b(a)){this.$2m_0.push(a);this.normalizer.onFormattingChange(a);this.registerOnCloseCallback(this.$$d_$Cm_0);return true}return false},handleCommonAttributes:function(a){ULSdmo:;if(!a.style)return 2;var b=this,c=this.handleSpecifiedFormatting(function(c){ULSdmo:;return b.setFormattingFromAttributes(c,a)});return c?1:2},$Cm_0:function(){ULSdmo:;this.$2m_0.pop();this.normalizer.onFormattingChange(this.get_$87_0())},onText:function(){},onAOpen:function(){ULSdmo:;return 2},onAbbrOpen:function(){ULSdmo:;RTE.PasteCommon.Debug.$6("ABBR tags are transparent by default.  If this behavior has been overriden, provide a real handler",582542);return 2},onAcronymOpen:function(){ULSdmo:;RTE.PasteCommon.Debug.$6("ACRONYM tags are transparent by default.  If this behavior has been overriden, provide a real handler",582543);return 2},onAddressOpen:function(){ULSdmo:;RTE.PasteCommon.Debug.$6("ADDRESS tags are transparent by default.  If this behavior has been overriden, provide a real handler",582544);return 2},onAppletOpen:function(){ULSdmo:;RTE.PasteCommon.Debug.$6("APPLET tags are pruned by default.  If this behavior has been overriden, provide a real handler",582545);return 3},onAreaTag:function(){ULSdmo:;RTE.PasteCommon.Debug.$6("AREA tags are pruned by default.  If this behavior has been overriden, provide a real handler",582546)},onBOpen:function(){ULSdmo:;return 2},onBaseTag:function(){ULSdmo:;RTE.PasteCommon.Debug.$6("BASE tags are pruned by default.  If this behavior has been overriden, provide a real handler",582547)},onBasefontTag:function(){ULSdmo:;RTE.PasteCommon.Debug.$6("BASEFONT tags are pruned by default.  If this behavior has been overriden, provide a real handler",582548)},onBdoOpen:function(){ULSdmo:;RTE.PasteCommon.Debug.$6("BDO tags are transparent by default.  If this behavior has been overriden, provide a real handler",582549);return 2},onBigOpen:function(){ULSdmo:;return 2},onBlockquoteOpen:function(){ULSdmo:;return 2},onBodyOpen:function(){ULSdmo:;RTE.PasteCommon.Debug.$6("BODY tags are transparent by default.  If this behavior has been overriden, provide a real handler",582550);return 2},onBrTag:function(){},onButtonOpen:function(){ULSdmo:;RTE.PasteCommon.Debug.$6("BUTTON tags are transparent by default.  If this behavior has been overriden, provide a real handler",582551);return 2},onCaptionOpen:function(){ULSdmo:;return 2},onCenterOpen:function(){ULSdmo:;return 2},onCiteOpen:function(){ULSdmo:;return 2},onCodeOpen:function(){ULSdmo:;return 2},onColTag:function(){},onColgroupOpen:function(){ULSdmo:;return 2},onDdOpen:function(){ULSdmo:;return 2},onDelOpen:function(){ULSdmo:;return 2},onDfnOpen:function(){ULSdmo:;return 2},onDirOpen:function(){ULSdmo:;return 2},onDivOpen:function(){ULSdmo:;return 2},onDlOpen:function(){ULSdmo:;return 2},onDtOpen:function(){ULSdmo:;return 2},onEmOpen:function(){ULSdmo:;return 2},onFieldsetOpen:function(){ULSdmo:;RTE.PasteCommon.Debug.$6("FIELDSET tags are transparent by default.  If this behavior has been overriden, provide a real handler",582552);return 2},onFontOpen:function(){ULSdmo:;return 2},onFormOpen:function(){ULSdmo:;RTE.PasteCommon.Debug.$6("FORM tags are transparent by default.  If this behavior has been overriden, provide a real handler",582553);return 2},onFrameTag:function(){ULSdmo:;RTE.PasteCommon.Debug.$6("FRAME tags are pruned by default.  If this behavior has been overriden, provide a real handler",582554)},onFramesetOpen:function(){ULSdmo:;RTE.PasteCommon.Debug.$6("FRAMESET tags are transparent by default.  If this behavior has been overriden, provide a real handler",582555);return 2},onH1Open:function(){ULSdmo:;return 2},onH2Open:function(){ULSdmo:;return 2},onH3Open:function(){ULSdmo:;return 2},onH4Open:function(){ULSdmo:;return 2},onH5Open:function(){ULSdmo:;return 2},onH6Open:function(){ULSdmo:;return 2},onHeadOpen:function(){ULSdmo:;RTE.PasteCommon.Debug.$6("HEAD tags are pruned by default.  If this behavior has been overriden, provide a real handler",582556);return 3},onHrTag:function(){},onHtmlOpen:function(){ULSdmo:;return 2},onIOpen:function(){ULSdmo:;return 2},onIframeOpen:function(){ULSdmo:;RTE.PasteCommon.Debug.$6("IFRAME tags are pruned by default.  If this behavior has been overriden, provide a real handler",582557);return 3},onImgTag:function(){},onInputTag:function(){ULSdmo:;RTE.PasteCommon.Debug.$6("INPUT tags are pruned by default.  If this behavior has been overriden, provide a real handler",582558)},onInsOpen:function(){ULSdmo:;return 2},onIsindexOpen:function(){ULSdmo:;RTE.PasteCommon.Debug.$6("ISINDEX tags are pruned by default.  If this behavior has been overriden, provide a real handler",582559);return 3},onKbdOpen:function(){ULSdmo:;return 2},onLabelOpen:function(){ULSdmo:;return 2},onLegendOpen:function(){ULSdmo:;return 2},onLiOpen:function(){ULSdmo:;return 2},onLinkTag:function(){ULSdmo:;RTE.PasteCommon.Debug.$6("LINK tags are pruned by default.  If this behavior has been overriden, provide a real handler",582560)},onMapOpen:function(){ULSdmo:;RTE.PasteCommon.Debug.$6("MAP tags are pruned by default.  If this behavior has been overriden, provide a real handler",582561);return 3},onMenuOpen:function(){ULSdmo:;return 2},onMetaTag:function(){ULSdmo:;RTE.PasteCommon.Debug.$6("META tags are pruned by default.  If this behavior has been overriden, provide a real handler",582562)},onNoframesOpen:function(){ULSdmo:;RTE.PasteCommon.Debug.$6("NOFRAMES tags are transparent by default.  If this behavior has been overriden, provide a real handler",582563);return 2},onNoscriptOpen:function(){ULSdmo:;RTE.PasteCommon.Debug.$6("NOSCRIPT tags are transparent by default.  If this behavior has been overriden, provide a real handler",582592);return 2},onObjectOpen:function(){ULSdmo:;RTE.PasteCommon.Debug.$6("OBJECT tags are pruned by default.  If this behavior has been overriden, provide a real handler",582593);return 3},onOlOpen:function(){ULSdmo:;return 2},onOptgroupOpen:function(){ULSdmo:;RTE.PasteCommon.Debug.$6("OPTGROUP tags are transparent by default.  If this behavior has been overriden, provide a real handler",582594);return 2},onOptionOpen:function(){ULSdmo:;return 2},onPOpen:function(){ULSdmo:;return 2},onParamTag:function(){ULSdmo:;RTE.PasteCommon.Debug.$6("PARAM tags are pruned by default.  If this behavior has been overriden, provide a real handler",582595)},onPreOpen:function(){ULSdmo:;return 2},onQOpen:function(){ULSdmo:;RTE.PasteCommon.Debug.$6("Q tags are transparent by default.  If this behavior has been overriden, provide a real handler",582596);return 2},onSOpen:function(){ULSdmo:;return 2},onSampOpen:function(){ULSdmo:;return 2},onScriptOpen:function(){ULSdmo:;RTE.PasteCommon.Debug.$6("SCRIPT tags are pruned by default.  If this behavior has been overriden, provide a real handler",582597);return 3},onSelectOpen:function(){ULSdmo:;RTE.PasteCommon.Debug.$6("SELECT tags are transparent by default.  If this behavior has been overriden, provide a real handler",582598);return 2},onSmallOpen:function(){ULSdmo:;return 2},onSpanOpen:function(){ULSdmo:;RTE.PasteCommon.Debug.$6("SPAN tags are transparent by default.  If this behavior has been overriden, provide a real handler",582599);return 2},onStrikeOpen:function(){ULSdmo:;return 2},onStrongOpen:function(){ULSdmo:;return 2},onStyleOpen:function(){ULSdmo:;RTE.PasteCommon.Debug.$6("STYLE tags are pruned by default.  If this behavior has been overriden, provide a real handler",582600);return 3},onSubOpen:function(){ULSdmo:;return 2},onSupOpen:function(){ULSdmo:;return 2},onTableOpen:function(){ULSdmo:;return 2},onTbodyOpen:function(){ULSdmo:;return 2},onTdOpen:function(){ULSdmo:;return 2},onTextareaOpen:function(){ULSdmo:;RTE.PasteCommon.Debug.$6("TEXTAREA tags are transparent by default.  If this behavior has been overriden, provide a real handler",582601);return 2},onTfootOpen:function(){ULSdmo:;return 2},onThOpen:function(){ULSdmo:;return 2},onTheadOpen:function(){ULSdmo:;return 2},onTitleOpen:function(){ULSdmo:;RTE.PasteCommon.Debug.$6("TITLE tags are pruned by default.  If this behavior has been overriden, provide a real handler",582602);return 3},onTrOpen:function(){ULSdmo:;return 2},onTtOpen:function(){ULSdmo:;return 2},onUOpen:function(){ULSdmo:;return 2},onUlOpen:function(){ULSdmo:;return 2},onVarOpen:function(){ULSdmo:;return 2},onUnknownOpen:function(){ULSdmo:;RTE.PasteCommon.Debug.$6("If the HTML Processor has registered an unrecognized tag, its Translator must override OnUnknownOpen to handle it",582603);return 2}};RTE.HtmlImport.AQueuingHtmlNormalizer=function(a){ULSdmo:;this.$$d_processTablePartEnd=Function.createDelegate(this,this.processTablePartEnd);this.$$d_processTablePartStart=Function.createDelegate(this,this.processTablePartStart);this.$$d_processTableCellEnd=Function.createDelegate(this,this.processTableCellEnd);this.$$d_processTableRowEnd=Function.createDelegate(this,this.processTableRowEnd);this.$$d_processTableRowStart=Function.createDelegate(this,this.processTableRowStart);this.$$d_processTableEnd=Function.createDelegate(this,this.processTableEnd);this.$$d_processListItemEnd=Function.createDelegate(this,this.processListItemEnd);this.$$d_processListEnd=Function.createDelegate(this,this.processListEnd);this.$$d_processParagraphEnd=Function.createDelegate(this,this.processParagraphEnd);this.$$d_processParagraphStart=Function.createDelegate(this,this.processParagraphStart);this.$$d_processAnchorEnd=Function.createDelegate(this,this.processAnchorEnd);this.$$d_processLineBreak=Function.createDelegate(this,this.processLineBreak);RTE.HtmlImport.AQueuingHtmlNormalizer.initializeBase(this,[a])};RTE.HtmlImport.AQueuingHtmlNormalizer.prototype={queueMode:false,onText:function(a){ULSdmo:;if(this.queueMode){var b=this;this.get_queueManager().$L_0(function(){ULSdmo:;b.processText(a)});return}this.processText(a)},processText:function(a){ULSdmo:;this.steward.onText(a)},onLineBreak:function(){ULSdmo:;if(this.queueMode){this.get_queueManager().$L_0(this.$$d_processLineBreak);return}this.processLineBreak()},processLineBreak:function(){ULSdmo:;this.steward.onLineBreak()},onImage:function(a){ULSdmo:;if(this.queueMode){var b=this;this.get_queueManager().$L_0(function(){ULSdmo:;b.processImage(a)});return}this.processImage(a)},processImage:function(a){ULSdmo:;this.steward.onImage(a)},onFormattingChange:function(a){ULSdmo:;if(this.queueMode){var b=this;this.get_queueManager().$L_0(function(){ULSdmo:;b.processFormattingChange(a)});return}this.processFormattingChange(a)},processFormattingChange:function(a){ULSdmo:;this.steward.onFormattingChange(a)},onAnchorStart:function(a){ULSdmo:;if(this.queueMode){var b=this;this.get_queueManager().$L_0(function(){ULSdmo:;b.processAnchorStart(a)});return}this.processAnchorStart(a)},processAnchorStart:function(a){ULSdmo:;this.steward.onAnchorStart(a)},onAnchorEnd:function(){ULSdmo:;if(this.queueMode){this.get_queueManager().$L_0(this.$$d_processAnchorEnd);return}this.processAnchorEnd()},processAnchorEnd:function(){ULSdmo:;this.steward.onAnchorEnd()},onParagraphStart:function(){ULSdmo:;if(this.queueMode){this.get_queueManager().$L_0(this.$$d_processParagraphStart);return}this.processParagraphStart()},processParagraphStart:function(){ULSdmo:;this.steward.onParagraphStart()},onParagraphEnd:function(){ULSdmo:;if(this.queueMode){this.get_queueManager().$L_0(this.$$d_processParagraphEnd);return}this.processParagraphEnd()},processParagraphEnd:function(){ULSdmo:;this.steward.onParagraphEnd()},onListStart:function(a){ULSdmo:;if(this.queueMode){var b=this;this.get_queueManager().$L_0(function(){ULSdmo:;b.processListStart(a)});return}this.processListStart(a)},processListStart:function(a){ULSdmo:;this.steward.onListStart(a)},onListEnd:function(){ULSdmo:;if(this.queueMode){this.get_queueManager().$L_0(this.$$d_processListEnd);return}this.processListEnd()},processListEnd:function(){ULSdmo:;this.steward.onListEnd()},onListItemStart:function(a){ULSdmo:;if(this.queueMode){var b=this;this.get_queueManager().$L_0(function(){ULSdmo:;b.processListItemStart(a)});return}this.processListItemStart(a)},processListItemStart:function(a){ULSdmo:;this.steward.onListItemStart(a)},onListItemEnd:function(){ULSdmo:;if(this.queueMode){this.get_queueManager().$L_0(this.$$d_processListItemEnd);return}this.processListItemEnd()},processListItemEnd:function(){ULSdmo:;this.steward.onListItemEnd()},onTableStart:function(a){ULSdmo:;if(this.queueMode){var b=this;this.get_queueManager().$L_0(function(){ULSdmo:;b.processTableStart(a)});return}this.processTableStart(a)},processTableStart:function(a){ULSdmo:;this.steward.onTableStart(a)},onTableEnd:function(){ULSdmo:;if(this.queueMode){this.get_queueManager().$L_0(this.$$d_processTableEnd);return}this.processTableEnd()},processTableEnd:function(){ULSdmo:;this.steward.onTableEnd()},onTableRowStart:function(){ULSdmo:;if(this.queueMode){this.get_queueManager().$L_0(this.$$d_processTableRowStart);return}this.processTableRowStart()},processTableRowStart:function(){ULSdmo:;this.steward.onTableRowStart()},onTableRowEnd:function(){ULSdmo:;if(this.queueMode){this.get_queueManager().$L_0(this.$$d_processTableRowEnd);return}this.processTableRowEnd()},processTableRowEnd:function(){ULSdmo:;this.steward.onTableRowEnd()},onTableCellStart:function(a){ULSdmo:;if(this.queueMode){var b=this;this.get_queueManager().$L_0(function(){ULSdmo:;b.processTableCellStart(a)});return}this.processTableCellStart(a)},processTableCellStart:function(a){ULSdmo:;this.steward.onTableCellStart(a)},onTableCellEnd:function(){ULSdmo:;if(this.queueMode){this.get_queueManager().$L_0(this.$$d_processTableCellEnd);return}this.processTableCellEnd()},processTableCellEnd:function(){ULSdmo:;this.steward.onTableCellEnd()},onTablePartStart:function(){ULSdmo:;if(this.queueMode){this.get_queueManager().$L_0(this.$$d_processTablePartStart);return}this.processTablePartStart()},processTablePartStart:function(){ULSdmo:;this.steward.onTablePartStart()},onTablePartEnd:function(){ULSdmo:;if(this.queueMode){this.get_queueManager().$L_0(this.$$d_processTablePartEnd);return}this.processTablePartEnd()},processTablePartEnd:function(){ULSdmo:;this.steward.onTablePartEnd()}};RTE.HtmlImport.DefaultHtmlNormalizer=function(a){ULSdmo:;RTE.HtmlImport.DefaultHtmlNormalizer.initializeBase(this,[a]);this.$1I_2=new(RTE.HtmlImport.Stack$1.$$(RTE.HtmlImport.DefaultHtmlNormalizer.ContentState))};RTE.HtmlImport.DefaultHtmlNormalizer.prototype={$4_2:null,$1I_2:null,reset:function(){ULSdmo:;RTE.HtmlImport.AHtmlNormalizer.prototype.reset.call(this);this.$4_2=new RTE.HtmlImport.DefaultHtmlNormalizer.ContentState(this);this.$1I_2.clear();this.queueMode=false},get_queueManager:function(){ULSdmo:;return this.$4_2&&this.$4_2.get_$1h_1()?this.$4_2.$1F_1:this.$4_2},ensureReadyForText:function(a){ULSdmo:;RTE.PasteCommon.Debug.$7w(this.$4_2.$24_1,this.$4_2.$2U_1===!this.$4_2.$23_1,582607);if(!this.$4_2.$23_1){this.closeExpiredImpliedList();this.steward.onParagraphStart();this.$4_2.$23_1=true;this.$4_2.$2U_1=false}if(!a&&this.$4_2.$2z_1&&!this.$4_2.$3E_1){this.steward.onAnchorStart(this.$4_2.$2z_1);this.$4_2.$3E_1=true}},ensureOutsideHyperlink:function(){ULSdmo:;if(!this.$4_2.$3E_1)return;RTE.PasteCommon.Debug.assertTag(this.$4_2.$23_1&&!!this.$4_2.$2z_1,582608);this.steward.onAnchorEnd();this.$4_2.$3E_1=false},ensureOutsideParagraph:function(){ULSdmo:;RTE.PasteCommon.Debug.$1J(!this.$4_2.$3E_1,"It's invalid to call EnsureOutsideParagraph while inside a hyperlink!",582609);if(!this.$4_2.$23_1)return;this.steward.onParagraphEnd();this.$4_2.$23_1=false;this.$4_2.$49_1=""},ensureOutsideListItem:function(a){ULSdmo:;RTE.PasteCommon.Debug.$1J(!this.$4_2.$23_1,"It's invalid to call EnsureOutsideListItem while inside a paragraph!",582610);if(!this.$4_2.$24_1)return;if(this.$4_2.$2U_1){if(!a){this.steward.onParagraphStart();this.steward.onParagraphEnd();this.steward.onListItemEnd();this.$4_2.$24_1=false}}else{this.steward.onListItemEnd();this.$4_2.$24_1=false;this.$4_2.$2U_1=true}},ensureCurrentContentEnded:function(a){ULSdmo:;this.ensureOutsideHyperlink();this.ensureOutsideParagraph();this.ensureOutsideListItem(a)},openNewImpliedList:function(){ULSdmo:;this.steward.onListStart(new RTE.HtmlImport.ListSemanticArgs(2,1));this.$4_2.$28_1++;this.$4_2.$3t_1=true},closeExpiredImpliedList:function(){ULSdmo:;if(!this.$4_2.$24_1&&this.$4_2.$3t_1){RTE.PasteCommon.Debug.assertTag(this.$4_2.$28_1===1,582611);this.steward.onListEnd();this.$4_2.$28_1--;this.$4_2.$3t_1=false}},processText:function(a){ULSdmo:;a=a.replace(RTE.HtmlImport.DefaultHtmlNormalizer.$8y," ");if(a.startsWith(" ")&&(this.$4_2.$49_1.endsWith(" ")||this.$4_2.$49_1===""))a=a.substring(1,a.length);if(a==="")return;this.$4_2.$49_1+=a;this.ensureReadyForText();this.steward.onText(a)},processLineBreak:function(){ULSdmo:;this.ensureOutsideHyperlink();this.ensureReadyForText(true);this.steward.onLineBreak()},processFormattingChange:function(a){ULSdmo:;if(this.$4_2.get_$1h_1())return;this.steward.onFormattingChange(a)},processAnchorStart:function(a){ULSdmo:;this.ensureOutsideHyperlink();this.$4_2.$2z_1=a},processAnchorEnd:function(){ULSdmo:;this.ensureOutsideHyperlink();this.$4_2.$2z_1=null},processParagraphStart:function(){ULSdmo:;this.ensureCurrentContentEnded(true)},processParagraphEnd:function(){ULSdmo:;this.ensureCurrentContentEnded(true)},processListStart:function(a){ULSdmo:;this.ensureCurrentContentEnded(false);this.closeExpiredImpliedList();this.steward.onListStart(a);this.$4_2.$28_1++},processListEnd:function(){ULSdmo:;RTE.PasteCommon.Debug.assertTag(this.$4_2.$28_1>0&&!this.$4_2.$3t_1,582612);this.ensureCurrentContentEnded(false);this.steward.onListEnd();this.$4_2.$28_1--},processListItemStart:function(a){ULSdmo:;RTE.PasteCommon.Debug.$1J(!this.$4_2.$24_1,"It had seemed that the browser wouldn't ever nest LIs in the DOM, but apparently it does.\nInvestigate this case, and then turn this Assert into a Log (or remove it)",582613);this.ensureCurrentContentEnded(false);!this.$4_2.$28_1&&this.openNewImpliedList();this.steward.onListItemStart(a);this.$4_2.$24_1=true;this.$4_2.$2U_1=true},processListItemEnd:function(){ULSdmo:;this.ensureCurrentContentEnded(false)},onTableStart:function(){ULSdmo:;if(this.$4_2.get_$1h_1())return;RTE.PasteCommon.Debug.assertTag(this.queueMode===!this.$1I_2.get_isEmpty(),582614);RTE.PasteCommon.Debug.$7w(!this.queueMode,this.get_queueManager().get_$CI_0(),582615);this.queueMode=true;this.$4_2.$1F_1=new RTE.HtmlImport.DefaultHtmlNormalizer.NormalizedTable(this)},processTableStart:function(){ULSdmo:;RTE.PasteCommon.Debug.$6("We should handle Tables directly in OnTableStart",582616)},onTableEnd:function(){ULSdmo:;RTE.PasteCommon.Debug.assertTag(this.queueMode&&this.$4_2.get_$1h_1(),582617);if(!this.$4_2.$1F_1)return;var a=this.$4_2.$1F_1;this.$4_2.$1F_1=null;if(this.$1I_2.get_isEmpty()){this.queueMode=false;a.$8Q_1()}else this.get_queueManager().$L_0(a.$$d_$8Q_1)},processTableEnd:function(){ULSdmo:;RTE.PasteCommon.Debug.$6("We should handle Tables directly in OnTableEnd",582618)},onTableRowStart:function(){ULSdmo:;if(!this.$4_2.get_$1h_1())return;this.$4_2.$1F_1.$AX_1()},processTableRowStart:function(){ULSdmo:;RTE.PasteCommon.Debug.$6("We should handle Table Rows directly in OnTableRowStart",582619)},onTableRowEnd:function(){},processTableRowEnd:function(){ULSdmo:;RTE.PasteCommon.Debug.$6("We should handle Table Rows directly in OnTableRowEnd",582620)},onTableCellStart:function(c){ULSdmo:;var a=false;if(this.$4_2.get_$1h_1()){var b=new RTE.HtmlImport.DefaultHtmlNormalizer.ContentState(this);if(this.$4_2.$1F_1.$AW_1(c.colSpan,c.rowSpan,b)){this.$1I_2.push(this.$4_2);this.$4_2=b}else a=true}else a=true;if(a)this.$4_2.$5Q_1++},processTableCellStart:function(){ULSdmo:;RTE.PasteCommon.Debug.$6("We should handle Table Cells directly in OnTableCellStart",582621)},onTableCellEnd:function(){ULSdmo:;if(this.$4_2.$5Q_1>0){this.$4_2.$5Q_1--;return}RTE.PasteCommon.Debug.assertTag(!this.$1I_2.get_isEmpty()&&!this.$4_2.get_$1h_1(),582622);this.$4_2=this.$1I_2.pop();RTE.PasteCommon.Debug.assertTag(this.$4_2.get_$1h_1(),582623)},processTableCellEnd:function(){ULSdmo:;RTE.PasteCommon.Debug.$6("We should handle Table Cells directly in OnTableCellEnd",582624)}};RTE.HtmlImport.DefaultHtmlNormalizer.NormalizedTable=function(a){ULSdmo:;this.$$d_$8Q_1=Function.createDelegate(this,this.$8Q_1);RTE.HtmlImport.DefaultHtmlNormalizer.NormalizedTable.initializeBase(this);this.$Q_1=a;this.$w_1=new(RTE.HtmlImport.List$1.$$(Array));this.$3Z_1=new Array(0);this.$1c_1=-1;this.$1H_1=0};RTE.HtmlImport.DefaultHtmlNormalizer.NormalizedTable.prototype={$Q_1:null,get_$3S_1:function(){ULSdmo:;return this.$Q_1.steward},$w_1:null,$1c_1:0,$1H_1:0,$3Z_1:null,$AX_1:function(){ULSdmo:;this.$1c_1++;this.$1H_1=0},get_$B5_1:function(){ULSdmo:;while(this.$1H_1>=this.$w_1.get_count())this.$w_1.add(new Array(this.$1c_1+1));return this.$w_1.get_item(this.$1H_1)},$AW_1:function(f,g,h){ULSdmo:;if(this.$1c_1<0)return false;while(this.$3Z_1[this.$1H_1]>=this.$1c_1)this.$1H_1++;var a=new RTE.HtmlImport.DefaultHtmlNormalizer.NormalizedTable.TableCell(f,g,h);this.get_$B5_1()[this.$1c_1]=a;if(a.$4E_0>1)for(var c=this.$1c_1+a.$4E_0-1,d=this.$1H_1,e=this.$1H_1+a.$3e_0-1,b=d;b<=e;b++){if(this.$3Z_1[b]>=c)continue;this.$3Z_1[b]=c}this.$1H_1+=a.$3e_0;return true},$DY_0:function(){ULSdmo:;RTE.PasteCommon.Debug.assertTag(!this.$Q_1.$4_2.get_$1h_1(),582605);this.$Q_1.$4_2.$1F_1=this},$DK_0:function(){ULSdmo:;this.$Q_1.$4_2.$1F_1=null},$8Q_1:function(){ULSdmo:;this.$BI_0(true);for(var c=this.$1c_1+1,g=true,b=0;b<this.$w_1.get_count();b++){for(var i=this.$w_1.get_item(b),h=true,d=0;d<c;d++)if(i[d]){h=false;break}if(h){this.$w_1.removeAt(b);b--}else g=false}if(g)return;this.$Q_1.ensureCurrentContentEnded(true);this.$Q_1.closeExpiredImpliedList();RTE.PasteCommon.Debug.assertTag(c>0&&this.$w_1.get_count()>0,582606);this.get_$3S_1().onTableStart(new RTE.HtmlImport.TableSemanticArgs(c,this.$w_1.get_count()));for(var e=0;e<c;e++){this.get_$3S_1().onTableRowStart();for(var f=0;f<this.$w_1.get_count();f++){var a=this.$w_1.get_item(f)[e],j=!a?0:a.$3e_0,k=!a?0:a.$4E_0;this.get_$3S_1().onTableCellStart(new RTE.HtmlImport.TableCellSemanticArgs(j,k));if(a){a.$3f_0.$DY_0();a.$3f_0.$BI_0();this.$Q_1.ensureCurrentContentEnded(false);this.$Q_1.closeExpiredImpliedList();a.$3f_0.$DK_0()}this.get_$3S_1().onTableCellEnd()}this.get_$3S_1().onTableRowEnd()}this.get_$3S_1().onTableEnd();this.$Q_1.$4_2.$2U_1=false;this.$Q_1.ensureOutsideListItem(false)}};RTE.HtmlImport.DefaultHtmlNormalizer.NormalizedTable.TableCell=function(a,b,c){ULSdmo:;RTE.PasteCommon.Debug.assertTag(a>0&&b>0&&!!c,582604);this.$3e_0=a;this.$4E_0=b;this.$3f_0=c};RTE.HtmlImport.DefaultHtmlNormalizer.ContentState=function(a){ULSdmo:;RTE.HtmlImport.DefaultHtmlNormalizer.ContentState.initializeBase(this);this.$Q_1=a};RTE.HtmlImport.DefaultHtmlNormalizer.ContentState.prototype={$Q_1:null,$23_1:false,$49_1:"",$3E_1:false,$2z_1:null,$28_1:0,$3t_1:false,$24_1:false,$2U_1:false,$1F_1:null,get_$1h_1:function(){ULSdmo:;return!!this.$1F_1},$5Q_1:0,$DY_0:function(){ULSdmo:;this.$Q_1.$1I_2.push(this.$Q_1.$4_2);this.$Q_1.$4_2=this},$DK_0:function(){ULSdmo:;this.$Q_1.$4_2=this.$Q_1.$1I_2.pop()}};RTE.HtmlImport.DefaultHtmlTranslator=function(a){ULSdmo:;this.$$d_$Co_1=Function.createDelegate(this,this.$Co_1);this.$7f_1={none:1,disc:3,circle:4,square:5,"1":7,A:10,a:8,I:11,i:9,armenian:7,decimal:7,"decimal-leading-zero":7,georgian:7,"lower-alpha":8,"lower-greek":8,"lower-latin":8,"lower-roman":9,"upper-alpha":10,"upper-latin":10,"upper-roman":11};RTE.HtmlImport.DefaultHtmlTranslator.initializeBase(this,[a])};RTE.HtmlImport.DefaultHtmlTranslator.$6H=function(f){ULSdmo:;var a="";if(!f||f==="")return a;a=f.trim();if(a.startsWith("rgb")){a=a.substring(a.indexOf("(")+1,a.length-1);var d=a.split(",");if(d.length!==3)return"";a="";for(var e=0;e<d.length;e++){var b=parseInt(d[e]);if(isNaN(b)||b<0||b>255)return"";var c=b.toString(16);if(c.length===1)c="0"+c;a+=c}return a}if(RTE.HtmlImport.DefaultHtmlTranslator.$6f[a.toLowerCase()])return RTE.HtmlImport.DefaultHtmlTranslator.$6f[a.toLowerCase()];if(a.startsWith("#"))a=a.substring(1,a.length);return isNaN(parseInt(a,16))||a.length!==6?"":a};RTE.HtmlImport.DefaultHtmlTranslator.$9J=function(a){ULSdmo:;if(!a||a==="")return false;a=a.toLowerCase();return a.indexOf("monospace")>=0||a.indexOf("consolas")>=0||a.indexOf("courier")>=0};RTE.HtmlImport.DefaultHtmlTranslator.$8c=function(b,d,e){ULSdmo:;RTE.PasteCommon.Debug.assertTag(e>=0,596181);var c=b[d],a=parseInt(c);RTE.PasteCommon.Debug.log("GetAttributeValueAsNonNegativeInt("+(b.tagName||b.nodeType.toString())+", "+d+")\nrawValue:  "+c+" | intValue:  "+a,"HtmlImport.Translator",RTE.PasteCommon.LogLevel.$5m);return isNaN(a)||a<0?e:a};RTE.HtmlImport.DefaultHtmlTranslator.prototype={$2n_1:null,get_listStyleTypes:function(){ULSdmo:;return this.$7f_1},getListStyleTypeFromElement:function(c,e){ULSdmo:;var a,b=!c.style?"":c.style.listStyleType;if(b&&b!==""){RTE.PasteCommon.Debug.log("list-style-type:  "+b,"HtmlImport.Translator",RTE.PasteCommon.LogLevel.$5m);a=this.get_listStyleTypes()[b];if(a)return a}var d=c.type;if(d&&d!==""){RTE.PasteCommon.Debug.log("list type attribute:  "+b,"HtmlImport.Translator",RTE.PasteCommon.LogLevel.$5m);a=this.get_listStyleTypes()[d.toLowerCase()];if(a)return a}return e},$Co_1:function(){ULSdmo:;this.$2n_1.pop();this.normalizer.onListEnd()},$3m_1:function(c,d){ULSdmo:;var b=this.getListStyleTypeFromElement(c,d?6:2),a;if(d){var e=RTE.HtmlImport.DefaultHtmlTranslator.$8c(c,"start",1);a=new RTE.HtmlImport.ListSemanticArgs(b,e)}else a=new RTE.HtmlImport.ListSemanticArgs(b,1);this.$2n_1.push(a);this.normalizer.onListStart(a);this.registerOnCloseCallback(this.$$d_$Co_1);return 1},reset:function(){ULSdmo:;RTE.HtmlImport.AHtmlTranslator.prototype.reset.call(this);this.$2n_1=new(RTE.HtmlImport.Stack$1.$$(RTE.HtmlImport.ListSemanticArgs))},setFormattingFromAttributes:function(c,e){ULSdmo:;var a=false,d;try{d=e.getAttribute("xml:lang")||e.lang}catch(n){RTE.PasteCommon.Debug.log("Exception getting the lang or xml:lang attribute","HtmlImport.Translator",RTE.PasteCommon.LogLevel.$AS);d=null}if(d&&d!=="")a=c.setLang(d)||a;var h=e.dir;if(h)a=c.setTextDir(h)||a;var b=e.style;if(b){if(b.fontWeight){var f=RTE.PasteCommon.StringUtils.toUpper(b.fontWeight),j=parseInt(f);if(!isNaN(j))if(j>=600)a=c.setBold(true)||a;else a=c.setBold(false)||a;else if(f==="BOLD")a=c.setBold(true)||a;else if(f==="NORMAL")a=c.setBold(false)||a}if(b.textAlign)a=c.setTextAlign(b.textAlign.toLowerCase())||a;if(b.fontStyle){var g=RTE.PasteCommon.StringUtils.toUpper(b.fontStyle);if(g==="ITALIC"||g==="OBLIQUE")a=c.setItalics(true)||a;else if(g==="NORMAL")a=c.setItalics(false)||a}var i=b.textDecoration.toLowerCase();if(b.textDecorationUnderline||i.indexOf("underline")>=0)a=c.setUnderline(true)||a;if(b.textDecorationLineThrough||i.indexOf("line-through")>=0)a=c.setStrikethrough(true)||a;if(b.verticalAlign){var k=RTE.PasteCommon.StringUtils.toUpper(b.verticalAlign);if(k==="SUB")a=c.setSubscript(true)||a;else if(k==="SUPER")a=c.setSuperscript(true)||a}if(b.fontFamily)if(RTE.HtmlImport.DefaultHtmlTranslator.$9J(b.fontFamily))a=c.setFontface("consolas")||a;if(b.color){var l=b.color;a=c.setFontColor(RTE.HtmlImport.DefaultHtmlTranslator.$6H(l))||a}if(b.backgroundColor){var m=b.backgroundColor;a=c.setFontHighlight(RTE.HtmlImport.DefaultHtmlTranslator.$6H(m))||a}}return a},onText:function(a){ULSdmo:;this.normalizer.onText(a)},onAOpen:function(c){ULSdmo:;var b=c.href;if(b&&b!==""){this.normalizer.onAnchorStart(b);var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onAnchorEnd||(a.$$d_onAnchorEnd=Function.createDelegate(a,a.onAnchorEnd)));return 1}return 2},onBOpen:function(){ULSdmo:;var c=this,a=this.handleSpecifiedFormatting(function(a){ULSdmo:;return a.setBold(true)});return a?1:2},onBigOpen:function(){ULSdmo:;var c=this,a=this.handleSpecifiedFormatting(function(a){ULSdmo:;return a.growFontsize()});return a?1:2},onBlockquoteOpen:function(){ULSdmo:;this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onBrTag:function(){ULSdmo:;this.normalizer.onLineBreak()},onCaptionOpen:function(){ULSdmo:;this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onCiteOpen:function(){ULSdmo:;var c=this,a=this.handleSpecifiedFormatting(function(a){ULSdmo:;return a.setItalics(true)});return a?1:2},onCenterOpen:function(){ULSdmo:;var c=this;this.handleSpecifiedFormatting(function(a){ULSdmo:;return a.setTextAlign("center")});this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onCodeOpen:function(){ULSdmo:;var c=this,a=this.handleSpecifiedFormatting(function(a){ULSdmo:;return a.setFontface("consolas")});return a?1:2},onDelOpen:function(){ULSdmo:;var c=this,a=this.handleSpecifiedFormatting(function(a){ULSdmo:;return a.setStrikethrough(true)});return a?1:2},onDdOpen:function(a){ULSdmo:;return this.$3m_1(a,false)},onDfnOpen:function(){ULSdmo:;var c=this,a=this.handleSpecifiedFormatting(function(a){ULSdmo:;return a.setItalics(true)});return a?1:2},onDirOpen:function(a){ULSdmo:;return this.$3m_1(a,false)},onDivOpen:function(b){ULSdmo:;var c=b.getAttribute("align"),d=this;this.handleSpecifiedFormatting(function(a){ULSdmo:;return a.setTextAlign(c)});this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onDlOpen:function(){ULSdmo:;this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onDtOpen:function(){ULSdmo:;this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onEmOpen:function(){ULSdmo:;var c=this,a=this.handleSpecifiedFormatting(function(a){ULSdmo:;return a.setItalics(true)});return a?1:2},onFontOpen:function(a){ULSdmo:;var c=this,b=this.handleSpecifiedFormatting(function(b){ULSdmo:;var c=RTE.HtmlImport.DefaultHtmlTranslator.$9J(a.getAttribute("face"))&&b.setFontface("consolas"),d=b.setFontColor(RTE.HtmlImport.DefaultHtmlTranslator.$6H(a.getAttribute("color")));return c||d});return b?1:2},onH1Open:function(){ULSdmo:;var c=this;this.handleSpecifiedFormatting(function(a){ULSdmo:;return a.setHeading(1)});this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onH2Open:function(){ULSdmo:;var c=this;this.handleSpecifiedFormatting(function(a){ULSdmo:;return a.setHeading(2)});this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onH3Open:function(){ULSdmo:;var c=this;this.handleSpecifiedFormatting(function(a){ULSdmo:;return a.setHeading(3)});this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onH4Open:function(){ULSdmo:;var c=this;this.handleSpecifiedFormatting(function(a){ULSdmo:;return a.setHeading(4)});this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onH5Open:function(){ULSdmo:;var c=this;this.handleSpecifiedFormatting(function(a){ULSdmo:;return a.setHeading(5)});this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onH6Open:function(){ULSdmo:;var c=this;this.handleSpecifiedFormatting(function(a){ULSdmo:;return a.setHeading(6)});this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onHrTag:function(){ULSdmo:;this.normalizer.onLineBreak()},onImgTag:function(a){ULSdmo:;var f=a.src,g=a.alt,d=a.width,e=a.height;if(!d&&!e&&a.currentStyle){var b=a.currentStyle.width,c=a.currentStyle.height;if(b&&b.indexOf("px")!==-1)d=parseInt(b.substring(0,b.indexOf("px")));if(c&&c.indexOf("px")!==-1)e=parseInt(c.substring(0,c.indexOf("px")))}var h=new RTE.HtmlImport.ImageSemanticArgs(f,g,d,e);this.normalizer.onImage(h)},onIOpen:function(){ULSdmo:;var c=this,a=this.handleSpecifiedFormatting(function(a){ULSdmo:;return a.setItalics(true)});return a?1:2},onInsOpen:function(){ULSdmo:;var c=this,a=this.handleSpecifiedFormatting(function(a){ULSdmo:;return a.setUnderline(true)});return a?1:2},onKbdOpen:function(){ULSdmo:;var c=this,a=this.handleSpecifiedFormatting(function(a){ULSdmo:;return a.setFontface("consolas")});return a?1:2},onLabelOpen:function(){ULSdmo:;this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onLegendOpen:function(){ULSdmo:;this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onLiOpen:function(d){ULSdmo:;var b,e=this.getListStyleTypeFromElement(d,0),c=RTE.HtmlImport.DefaultHtmlTranslator.$8c(d,"value",0);if(this.$2n_1.get_count()>0)b=this.$2n_1.peek();else{b=new RTE.HtmlImport.ListSemanticArgs(2,1);if(!c)c=1}b.$Ak_0(e,c);this.normalizer.onListItemStart(b.$Ay_0());var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onListItemEnd||(a.$$d_onListItemEnd=Function.createDelegate(a,a.onListItemEnd)));return 1},onMenuOpen:function(a){ULSdmo:;return this.$3m_1(a,false)},onOlOpen:function(a){ULSdmo:;return this.$3m_1(a,true)},onOptionOpen:function(){ULSdmo:;this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onPOpen:function(b){ULSdmo:;var c=b.getAttribute("align"),d=this;this.handleSpecifiedFormatting(function(a){ULSdmo:;return a.setTextAlign(c)});this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onPreOpen:function(){ULSdmo:;this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onSOpen:function(){ULSdmo:;var c=this,a=this.handleSpecifiedFormatting(function(a){ULSdmo:;return a.setStrikethrough(true)});return a?1:2},onSampOpen:function(){ULSdmo:;var c=this,a=this.handleSpecifiedFormatting(function(a){ULSdmo:;return a.setFontface("consolas")});return a?1:2},onSmallOpen:function(){ULSdmo:;var c=this,a=this.handleSpecifiedFormatting(function(a){ULSdmo:;return a.shrinkFontsize()});return a?1:2},onStrikeOpen:function(){ULSdmo:;var c=this,a=this.handleSpecifiedFormatting(function(a){ULSdmo:;return a.setStrikethrough(true)});return a?1:2},onStrongOpen:function(){ULSdmo:;var c=this,a=this.handleSpecifiedFormatting(function(a){ULSdmo:;return a.setBold(true)});return a?1:2},onSubOpen:function(){ULSdmo:;var c=this,a=this.handleSpecifiedFormatting(function(a){ULSdmo:;return a.setSubscript(true)});return a?1:2},onSupOpen:function(){ULSdmo:;var c=this,a=this.handleSpecifiedFormatting(function(a){ULSdmo:;return a.setSuperscript(true)});return a?1:2},onTableOpen:function(){ULSdmo:;var c=this;this.handleSpecifiedFormatting(function(a){ULSdmo:;return a.clearFormatting()});this.normalizer.onTableStart(new RTE.HtmlImport.TableSemanticArgs(0,0));var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onTableEnd||(a.$$d_onTableEnd=Function.createDelegate(a,a.onTableEnd)));return 1},onTdOpen:function(b){ULSdmo:;var c=parseInt(b.colSpan),d=parseInt(b.rowSpan);RTE.PasteCommon.Debug.assertTag(c>0&&d>0,596182);this.normalizer.onTableCellStart(new RTE.HtmlImport.TableCellSemanticArgs(c,d));var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onTableCellEnd||(a.$$d_onTableCellEnd=Function.createDelegate(a,a.onTableCellEnd)));this.notifyNormalizerOfCurrentFormatting();return 1},onThOpen:function(a){ULSdmo:;this.onTdOpen(a);var b=this;this.handleSpecifiedFormatting(function(a){ULSdmo:;var b=a.setBold(true),c=a.setTextAlign("center");return b||c});return 1},onTrOpen:function(){ULSdmo:;this.normalizer.onTableRowStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onTableRowEnd||(a.$$d_onTableRowEnd=Function.createDelegate(a,a.onTableRowEnd)));return 1},onTtOpen:function(){ULSdmo:;var c=this,a=this.handleSpecifiedFormatting(function(a){ULSdmo:;return a.setFontface("consolas")});return a?1:2},onUOpen:function(){ULSdmo:;var c=this,a=this.handleSpecifiedFormatting(function(a){ULSdmo:;return a.setUnderline(true)});return a?1:2},onUlOpen:function(a){ULSdmo:;return this.$3m_1(a,false)},onVarOpen:function(){ULSdmo:;var c=this,a=this.handleSpecifiedFormatting(function(a){ULSdmo:;return a.setUnderline(true)});return a?1:2}};RTE.HtmlImport.HtmlProcessor=function(a){ULSdmo:;this.$$d_$Ct_0=Function.createDelegate(this,this.$Ct_0);this.$3_0=a;this.$Dd_0()};RTE.HtmlImport.HtmlProcessor.$CV=function(a){ULSdmo:;a.nodeType!==3&&RTE.PasteCommon.CustomData.$3Q(a,"alreadyPasted",true)};RTE.HtmlImport.HtmlProcessor.$Bz=function(a){ULSdmo:;return a.nodeType!==3&&RTE.PasteCommon.CustomData.getObject(a,"alreadyPasted")};RTE.HtmlImport.HtmlProcessor.$4R=function(a){ULSdmo:;a.$2w_0++;a.$3A_0=false;return a.$2w_0<a.$1j_0.length};RTE.HtmlImport.HtmlProcessor.prototype={$3_0:null,$5z_0:null,$2r_0:null,$1z_0:null,$1y_0:null,registerNewTag:function(a){ULSdmo:;a=RTE.PasteCommon.StringUtils.toUpper(a);if(this.$2r_0[a]){RTE.PasteCommon.Debug.assertTag(!!this.$1y_0[a],596183);delete this.$2r_0[a]}else if(this.$1z_0[a]){RTE.PasteCommon.Debug.assertTag(!!this.$1y_0[a],596184);delete this.$1z_0[a]}else{var b=this.$3_0;this.$1y_0[a]=b.$$d_onUnknownOpen||(b.$$d_onUnknownOpen=Function.createDelegate(b,b.onUnknownOpen))}},process:function(a,b){ULSdmo:;if(!a){RTE.PasteCommon.Debug.$63(596185);return}this.$3_0.reset();this.$9p_0(new RTE.HtmlImport.HtmlProcessorArguments(a),b)},$9p_0:function(b,c){ULSdmo:;if(!b.$1j_0.length)return;var a=new RTE.PasteCommon.SimpleOperation(c,this.$$d_$Ct_0,b);!c&&a.set_$5E_1(true);a.$7J_1()},$Ct_0:function(e,f){ULSdmo:;var b=f,a=b.$1j_0[b.$2w_0];if(a.nodeType===3){this.$3_0.onBeforeNewElement();this.$3_0.onText(a.nodeValue);return RTE.HtmlImport.HtmlProcessor.$4R(b)}if(a.nodeType!==1){RTE.PasteCommon.Debug.log("Skipping over DOMElement with NodeType = "+a.nodeType,"HtmlProcessor",RTE.PasteCommon.LogLevel.$90);return RTE.HtmlImport.HtmlProcessor.$4R(b)}if(!b.$3A_0){var c=RTE.PasteCommon.StringUtils.toUpper(a.tagName);if(!RTE.HtmlImport.HtmlProcessor.$Bz(a)&&!this.$1z_0[c]){RTE.HtmlImport.HtmlProcessor.$CV(a);this.$3_0.onBeforeNewElement();if(this.$5z_0[c]){this.$Cb_0(a,c);return RTE.HtmlImport.HtmlProcessor.$4R(b)}var d=false;switch(this.$Ca_0(a,c)){case 1:d=true;break;case 3:return RTE.HtmlImport.HtmlProcessor.$4R(b)}switch(this.$3_0.handleCommonAttributes(a)){case 1:d=true}b.$3A_0=d;this.$9p_0(new RTE.HtmlImport.HtmlProcessorArguments(a),e);if(!e.get_$5E_1())return true}}if(b.$3A_0){RTE.PasteCommon.Debug.assertTag(!this.$1z_0[RTE.PasteCommon.StringUtils.toUpper(a.tagName)],596187);RTE.PasteCommon.Debug.assertTag(!!this.$1y_0[RTE.PasteCommon.StringUtils.toUpper(a.tagName)],596188);this.$3_0.onClose()}return RTE.HtmlImport.HtmlProcessor.$4R(b)},$Cb_0:function(c,a){ULSdmo:;RTE.PasteCommon.Debug.assertTag(a===RTE.PasteCommon.StringUtils.toUpper(c.tagName),596189);RTE.PasteCommon.Debug.assertTag(!this.$1z_0[a],596190);if(this.$2r_0[a])return;var b=this.$1y_0[a];RTE.PasteCommon.Debug.assertTag(!!b,596191);b(c);return},$Ca_0:function(c,a){ULSdmo:;RTE.PasteCommon.Debug.assertTag(a===RTE.PasteCommon.StringUtils.toUpper(c.tagName),596192);RTE.PasteCommon.Debug.assertTag(!this.$1z_0[a],596193);if(!this.$2r_0[a]){var b=this.$1y_0[a];if(b)return b(c)}return 2},$Dd_0:function(){ULSdmo:;this.$5z_0={AREA:true,BASE:true,BASEFONT:true,BR:true,COL:true,FRAME:true,HR:true,IMG:true,INPUT:true,LINK:true,META:true,PARAM:true};this.$2r_0={ABBR:true,ACRONYM:true,ADDRESS:true,BDO:true,BODY:true,BUTTON:true,FIELDSET:true,FORM:true,FRAMESET:true,NOFRAMES:true,NOSCRIPT:true,OPTGROUP:true,Q:true,SELECT:true,SPAN:true,TEXTAREA:true};this.$1z_0={APPLET:true,AREA:true,BASE:true,BASEFONT:true,FRAME:true,HEAD:true,HTML:true,IFRAME:true,INPUT:true,ISINDEX:true,LINK:true,MAP:true,META:true,OBJECT:true,PARAM:true,SCRIPT:true,STYLE:true,TITLE:true};var D=this.$3_0,E=this.$3_0,F=this.$3_0,G=this.$3_0,H=this.$3_0,I=this.$3_0,J=this.$3_0,K=this.$3_0,L=this.$3_0,M=this.$3_0,O=this.$3_0,P=this.$3_0,S=this.$3_0,T=this.$3_0,W=this.$3_0,X=this.$3_0,ab=this.$3_0,bb=this.$3_0,eb=this.$3_0,fb=this.$3_0,ib=this.$3_0,jb=this.$3_0,lb=this.$3_0,nb=this.$3_0,pb=this.$3_0,rb=this.$3_0,ub=this.$3_0,wb=this.$3_0,xb=this.$3_0,zb=this.$3_0,Bb=this.$3_0,Eb=this.$3_0,Gb=this.$3_0,Ib=this.$3_0,Jb=this.$3_0,Lb=this.$3_0,N=this.$3_0,Q=this.$3_0,R=this.$3_0,U=this.$3_0,V=this.$3_0,Y=this.$3_0,Z=this.$3_0,cb=this.$3_0,db=this.$3_0,gb=this.$3_0,hb=this.$3_0,kb=this.$3_0,mb=this.$3_0,ob=this.$3_0,qb=this.$3_0,sb=this.$3_0,tb=this.$3_0,vb=this.$3_0,yb=this.$3_0,Ab=this.$3_0,Cb=this.$3_0,Db=this.$3_0,Fb=this.$3_0,Hb=this.$3_0,Kb=this.$3_0,Mb=this.$3_0,a=this.$3_0,b=this.$3_0,c=this.$3_0,d=this.$3_0,e=this.$3_0,f=this.$3_0,g=this.$3_0,h=this.$3_0,i=this.$3_0,j=this.$3_0,k=this.$3_0,l=this.$3_0,m=this.$3_0,n=this.$3_0,o=this.$3_0,p=this.$3_0,q=this.$3_0,r=this.$3_0,s=this.$3_0,t=this.$3_0,u=this.$3_0,v=this.$3_0,w=this.$3_0,x=this.$3_0,y=this.$3_0,z=this.$3_0,A=this.$3_0,B=this.$3_0,C=this.$3_0;this.$1y_0={A:D.$$d_onAOpen||(D.$$d_onAOpen=Function.createDelegate(D,D.onAOpen)),ABBR:E.$$d_onAbbrOpen||(E.$$d_onAbbrOpen=Function.createDelegate(E,E.onAbbrOpen)),ACRONYM:F.$$d_onAcronymOpen||(F.$$d_onAcronymOpen=Function.createDelegate(F,F.onAcronymOpen)),ADDRESS:G.$$d_onAddressOpen||(G.$$d_onAddressOpen=Function.createDelegate(G,G.onAddressOpen)),APPLET:H.$$d_onAppletOpen||(H.$$d_onAppletOpen=Function.createDelegate(H,H.onAppletOpen)),AREA:I.$$d_onAreaTag||(I.$$d_onAreaTag=Function.createDelegate(I,I.onAreaTag)),B:J.$$d_onBOpen||(J.$$d_onBOpen=Function.createDelegate(J,J.onBOpen)),BASE:K.$$d_onBaseTag||(K.$$d_onBaseTag=Function.createDelegate(K,K.onBaseTag)),BASEFONT:L.$$d_onBasefontTag||(L.$$d_onBasefontTag=Function.createDelegate(L,L.onBasefontTag)),BDO:M.$$d_onBdoOpen||(M.$$d_onBdoOpen=Function.createDelegate(M,M.onBdoOpen)),BIG:O.$$d_onBigOpen||(O.$$d_onBigOpen=Function.createDelegate(O,O.onBigOpen)),BLOCKQUOTE:P.$$d_onBlockquoteOpen||(P.$$d_onBlockquoteOpen=Function.createDelegate(P,P.onBlockquoteOpen)),BODY:S.$$d_onBodyOpen||(S.$$d_onBodyOpen=Function.createDelegate(S,S.onBodyOpen)),BR:T.$$d_onBrTag||(T.$$d_onBrTag=Function.createDelegate(T,T.onBrTag)),BUTTON:W.$$d_onButtonOpen||(W.$$d_onButtonOpen=Function.createDelegate(W,W.onButtonOpen)),CAPTION:X.$$d_onCaptionOpen||(X.$$d_onCaptionOpen=Function.createDelegate(X,X.onCaptionOpen)),CENTER:ab.$$d_onCenterOpen||(ab.$$d_onCenterOpen=Function.createDelegate(ab,ab.onCenterOpen)),CITE:bb.$$d_onCiteOpen||(bb.$$d_onCiteOpen=Function.createDelegate(bb,bb.onCiteOpen)),CODE:eb.$$d_onCodeOpen||(eb.$$d_onCodeOpen=Function.createDelegate(eb,eb.onCodeOpen)),COL:fb.$$d_onColTag||(fb.$$d_onColTag=Function.createDelegate(fb,fb.onColTag)),COLGROUP:ib.$$d_onColgroupOpen||(ib.$$d_onColgroupOpen=Function.createDelegate(ib,ib.onColgroupOpen)),DD:jb.$$d_onDdOpen||(jb.$$d_onDdOpen=Function.createDelegate(jb,jb.onDdOpen)),DEL:lb.$$d_onDelOpen||(lb.$$d_onDelOpen=Function.createDelegate(lb,lb.onDelOpen)),DFN:nb.$$d_onDfnOpen||(nb.$$d_onDfnOpen=Function.createDelegate(nb,nb.onDfnOpen)),DIR:pb.$$d_onDirOpen||(pb.$$d_onDirOpen=Function.createDelegate(pb,pb.onDirOpen)),DIV:rb.$$d_onDivOpen||(rb.$$d_onDivOpen=Function.createDelegate(rb,rb.onDivOpen)),DL:ub.$$d_onDlOpen||(ub.$$d_onDlOpen=Function.createDelegate(ub,ub.onDlOpen)),DT:wb.$$d_onDtOpen||(wb.$$d_onDtOpen=Function.createDelegate(wb,wb.onDtOpen)),EM:xb.$$d_onEmOpen||(xb.$$d_onEmOpen=Function.createDelegate(xb,xb.onEmOpen)),FIELDSET:zb.$$d_onFieldsetOpen||(zb.$$d_onFieldsetOpen=Function.createDelegate(zb,zb.onFieldsetOpen)),FONT:Bb.$$d_onFontOpen||(Bb.$$d_onFontOpen=Function.createDelegate(Bb,Bb.onFontOpen)),FORM:Eb.$$d_onFormOpen||(Eb.$$d_onFormOpen=Function.createDelegate(Eb,Eb.onFormOpen)),FRAME:Gb.$$d_onFrameTag||(Gb.$$d_onFrameTag=Function.createDelegate(Gb,Gb.onFrameTag)),FRAMESET:Ib.$$d_onFramesetOpen||(Ib.$$d_onFramesetOpen=Function.createDelegate(Ib,Ib.onFramesetOpen)),H1:Jb.$$d_onH1Open||(Jb.$$d_onH1Open=Function.createDelegate(Jb,Jb.onH1Open)),H2:Lb.$$d_onH2Open||(Lb.$$d_onH2Open=Function.createDelegate(Lb,Lb.onH2Open)),H3:N.$$d_onH3Open||(N.$$d_onH3Open=Function.createDelegate(N,N.onH3Open)),H4:Q.$$d_onH4Open||(Q.$$d_onH4Open=Function.createDelegate(Q,Q.onH4Open)),H5:R.$$d_onH5Open||(R.$$d_onH5Open=Function.createDelegate(R,R.onH5Open)),H6:U.$$d_onH6Open||(U.$$d_onH6Open=Function.createDelegate(U,U.onH6Open)),HEAD:V.$$d_onHeadOpen||(V.$$d_onHeadOpen=Function.createDelegate(V,V.onHeadOpen)),HR:Y.$$d_onHrTag||(Y.$$d_onHrTag=Function.createDelegate(Y,Y.onHrTag)),HTML:Z.$$d_onHtmlOpen||(Z.$$d_onHtmlOpen=Function.createDelegate(Z,Z.onHtmlOpen)),I:cb.$$d_onIOpen||(cb.$$d_onIOpen=Function.createDelegate(cb,cb.onIOpen)),IFRAME:db.$$d_onIframeOpen||(db.$$d_onIframeOpen=Function.createDelegate(db,db.onIframeOpen)),IMG:gb.$$d_onImgTag||(gb.$$d_onImgTag=Function.createDelegate(gb,gb.onImgTag)),INPUT:hb.$$d_onInputTag||(hb.$$d_onInputTag=Function.createDelegate(hb,hb.onInputTag)),INS:kb.$$d_onInsOpen||(kb.$$d_onInsOpen=Function.createDelegate(kb,kb.onInsOpen)),ISINDEX:mb.$$d_onIsindexOpen||(mb.$$d_onIsindexOpen=Function.createDelegate(mb,mb.onIsindexOpen)),KBD:ob.$$d_onKbdOpen||(ob.$$d_onKbdOpen=Function.createDelegate(ob,ob.onKbdOpen)),LABEL:qb.$$d_onLabelOpen||(qb.$$d_onLabelOpen=Function.createDelegate(qb,qb.onLabelOpen)),LEGEND:sb.$$d_onLegendOpen||(sb.$$d_onLegendOpen=Function.createDelegate(sb,sb.onLegendOpen)),LI:tb.$$d_onLiOpen||(tb.$$d_onLiOpen=Function.createDelegate(tb,tb.onLiOpen)),LINK:vb.$$d_onLinkTag||(vb.$$d_onLinkTag=Function.createDelegate(vb,vb.onLinkTag)),MAP:yb.$$d_onMapOpen||(yb.$$d_onMapOpen=Function.createDelegate(yb,yb.onMapOpen)),MENU:Ab.$$d_onMenuOpen||(Ab.$$d_onMenuOpen=Function.createDelegate(Ab,Ab.onMenuOpen)),META:Cb.$$d_onMetaTag||(Cb.$$d_onMetaTag=Function.createDelegate(Cb,Cb.onMetaTag)),NOFRAMES:Db.$$d_onNoframesOpen||(Db.$$d_onNoframesOpen=Function.createDelegate(Db,Db.onNoframesOpen)),NOSCRIPT:Fb.$$d_onNoscriptOpen||(Fb.$$d_onNoscriptOpen=Function.createDelegate(Fb,Fb.onNoscriptOpen)),OBJECT:Hb.$$d_onObjectOpen||(Hb.$$d_onObjectOpen=Function.createDelegate(Hb,Hb.onObjectOpen)),OL:Kb.$$d_onOlOpen||(Kb.$$d_onOlOpen=Function.createDelegate(Kb,Kb.onOlOpen)),OPTGROUP:Mb.$$d_onOptgroupOpen||(Mb.$$d_onOptgroupOpen=Function.createDelegate(Mb,Mb.onOptgroupOpen)),OPTION:a.$$d_onOptionOpen||(a.$$d_onOptionOpen=Function.createDelegate(a,a.onOptionOpen)),P:b.$$d_onPOpen||(b.$$d_onPOpen=Function.createDelegate(b,b.onPOpen)),PARAM:c.$$d_onParamTag||(c.$$d_onParamTag=Function.createDelegate(c,c.onParamTag)),PRE:d.$$d_onPreOpen||(d.$$d_onPreOpen=Function.createDelegate(d,d.onPreOpen)),Q:e.$$d_onQOpen||(e.$$d_onQOpen=Function.createDelegate(e,e.onQOpen)),S:f.$$d_onSOpen||(f.$$d_onSOpen=Function.createDelegate(f,f.onSOpen)),SAMP:g.$$d_onSampOpen||(g.$$d_onSampOpen=Function.createDelegate(g,g.onSampOpen)),SCRIPT:h.$$d_onScriptOpen||(h.$$d_onScriptOpen=Function.createDelegate(h,h.onScriptOpen)),SELECT:i.$$d_onSelectOpen||(i.$$d_onSelectOpen=Function.createDelegate(i,i.onSelectOpen)),SMALL:j.$$d_onSmallOpen||(j.$$d_onSmallOpen=Function.createDelegate(j,j.onSmallOpen)),SPAN:k.$$d_onSpanOpen||(k.$$d_onSpanOpen=Function.createDelegate(k,k.onSpanOpen)),STRIKE:l.$$d_onStrikeOpen||(l.$$d_onStrikeOpen=Function.createDelegate(l,l.onStrikeOpen)),STRONG:m.$$d_onStrongOpen||(m.$$d_onStrongOpen=Function.createDelegate(m,m.onStrongOpen)),STYLE:n.$$d_onStyleOpen||(n.$$d_onStyleOpen=Function.createDelegate(n,n.onStyleOpen)),SUB:o.$$d_onSubOpen||(o.$$d_onSubOpen=Function.createDelegate(o,o.onSubOpen)),SUP:p.$$d_onSupOpen||(p.$$d_onSupOpen=Function.createDelegate(p,p.onSupOpen)),TABLE:q.$$d_onTableOpen||(q.$$d_onTableOpen=Function.createDelegate(q,q.onTableOpen)),TBODY:r.$$d_onTbodyOpen||(r.$$d_onTbodyOpen=Function.createDelegate(r,r.onTbodyOpen)),TD:s.$$d_onTdOpen||(s.$$d_onTdOpen=Function.createDelegate(s,s.onTdOpen)),TEXTAREA:t.$$d_onTextareaOpen||(t.$$d_onTextareaOpen=Function.createDelegate(t,t.onTextareaOpen)),TFOOT:u.$$d_onTfootOpen||(u.$$d_onTfootOpen=Function.createDelegate(u,u.onTfootOpen)),TH:v.$$d_onThOpen||(v.$$d_onThOpen=Function.createDelegate(v,v.onThOpen)),THEAD:w.$$d_onTheadOpen||(w.$$d_onTheadOpen=Function.createDelegate(w,w.onTheadOpen)),TITLE:x.$$d_onTitleOpen||(x.$$d_onTitleOpen=Function.createDelegate(x,x.onTitleOpen)),TR:y.$$d_onTrOpen||(y.$$d_onTrOpen=Function.createDelegate(y,y.onTrOpen)),TT:z.$$d_onTtOpen||(z.$$d_onTtOpen=Function.createDelegate(z,z.onTtOpen)),U:A.$$d_onUOpen||(A.$$d_onUOpen=Function.createDelegate(A,A.onUOpen)),UL:B.$$d_onUlOpen||(B.$$d_onUlOpen=Function.createDelegate(B,B.onUlOpen)),VAR:C.$$d_onVarOpen||(C.$$d_onVarOpen=Function.createDelegate(C,C.onVarOpen))}}};RTE.HtmlImport.List$1=function(){ULSdmo:;this.$W_0=[]};RTE.HtmlImport.List$1.$$=function(f){ULSdmo:;var a="List$1$1$"+f.getName().replace(/\./g,"_");if(!RTE.HtmlImport[a]){var e=RTE.HtmlImport[a]=function(){ULSdmo:;(this.$$gta=this.$$gta||{})["RTE.HtmlImport.List$1"]={T:f};for(var b=[],a=0;a<arguments.length;++a)b[a]=arguments[a];RTE.HtmlImport.List$1.apply(this,b)};e.registerClass("RTE.HtmlImport."+a);var c=RTE.HtmlImport.List$1.prototype;for(var d in c){var b={key:d,value:c[d]};if("constructor"!==b.key)e.prototype[b.key]=b.value}}return RTE.HtmlImport[a]};RTE.HtmlImport.List$1.prototype={$W_0:null,get_count:function(){ULSdmo:;return this.$W_0.length},get_item:function(a){ULSdmo:;return this.$W_0[a]},set_item:function(b,a){ULSdmo:;this.$W_0[b]=a;return a},add:function(a){ULSdmo:;Array.add(this.$W_0,a)},clear:function(){ULSdmo:;Array.clear(this.$W_0)},contains:function(a){ULSdmo:;return Array.contains(this.$W_0,a)},forEach:function(a){ULSdmo:;var b=this;Array.forEach(this.$W_0,function(c){ULSdmo:;RTE.PasteCommon.Debug.assertTag(b.$$gta["RTE.HtmlImport.List$1"].T.isInstanceOfType(c),596194);a(c)})},getRange:function(c,b){ULSdmo:;RTE.PasteCommon.Debug.assertTag(c+b<=this.get_count(),596195);for(var d=new(RTE.HtmlImport.List$1.$$(this.$$gta["RTE.HtmlImport.List$1"].T)),a=0;a<b;a++)d.add(this.get_item(c+a));return d},indexOf:function(a){ULSdmo:;return Array.indexOf(this.$W_0,a)},insert:function(a,b){ULSdmo:;Array.insert(this.$W_0,a,b)},remove:function(a){ULSdmo:;return Array.remove(this.$W_0,a)},removeAt:function(a){ULSdmo:;Array.removeAt(this.$W_0,a)},removeRange:function(b,a){ULSdmo:;RTE.PasteCommon.Debug.assertTag(b+a<=this.get_count(),598016);for(var c=0;c<a;c++)Array.removeAt(this.$W_0,b)},reverse:function(){ULSdmo:;this.$W_0.reverse()},sort:function(){ULSdmo:;this.$W_0.sort()},toArray:function(){ULSdmo:;return Array.clone(this.$W_0)}};RTE.HtmlImport.PlaintextHtmlTranslator=function(a){ULSdmo:;RTE.HtmlImport.PlaintextHtmlTranslator.initializeBase(this,[a])};RTE.HtmlImport.PlaintextHtmlTranslator.prototype={onText:function(a){ULSdmo:;this.normalizer.onText(a)},onBlockquoteOpen:function(){ULSdmo:;this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onBrTag:function(){ULSdmo:;this.normalizer.onLineBreak()},onCaptionOpen:function(){ULSdmo:;this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onCenterOpen:function(){ULSdmo:;this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onDdOpen:function(){ULSdmo:;this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onDivOpen:function(){ULSdmo:;this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onDlOpen:function(){ULSdmo:;this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onDtOpen:function(){ULSdmo:;this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onH1Open:function(){ULSdmo:;this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onH2Open:function(){ULSdmo:;this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onH3Open:function(){ULSdmo:;this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onH4Open:function(){ULSdmo:;this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onH5Open:function(){ULSdmo:;this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onH6Open:function(){ULSdmo:;this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onHrTag:function(){ULSdmo:;this.normalizer.onLineBreak()},onLabelOpen:function(){ULSdmo:;this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onLegendOpen:function(){ULSdmo:;this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onLiOpen:function(){ULSdmo:;this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onOptionOpen:function(){ULSdmo:;this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onPOpen:function(){ULSdmo:;this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onPreOpen:function(){ULSdmo:;this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onTdOpen:function(){ULSdmo:;this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onThOpen:function(){ULSdmo:;this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onTrOpen:function(){ULSdmo:;this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1}};RTE.HtmlImport.QueueNode$1=function(){ULSdmo:;this.data=this.$$gta["RTE.HtmlImport.QueueNode$1"].TNode===Number||Type.isEnum(this.$$gta["RTE.HtmlImport.QueueNode$1"].TNode)?0:this.$$gta["RTE.HtmlImport.QueueNode$1"].TNode===Boolean?false:null};RTE.HtmlImport.QueueNode$1.$$=function(f){ULSdmo:;var a="QueueNode$1$1$"+f.getName().replace(/\./g,"_");if(!RTE.HtmlImport[a]){var e=RTE.HtmlImport[a]=function(){ULSdmo:;(this.$$gta=this.$$gta||{})["RTE.HtmlImport.QueueNode$1"]={TNode:f};for(var b=[],a=0;a<arguments.length;++a)b[a]=arguments[a];RTE.HtmlImport.QueueNode$1.apply(this,b)};e.registerClass("RTE.HtmlImport."+a);var c=RTE.HtmlImport.QueueNode$1.prototype;for(var d in c){var b={key:d,value:c[d]};if("constructor"!==b.key)e.prototype[b.key]=b.value}}return RTE.HtmlImport[a]};RTE.HtmlImport.QueueNode$1.prototype={next:null};RTE.HtmlImport.Queue$1=function(){ULSdmo:;this.$1w_0=null;this.$15_0=null;this.$P_0=0};RTE.HtmlImport.Queue$1.$$=function(f){ULSdmo:;var a="Queue$1$1$"+f.getName().replace(/\./g,"_");if(!RTE.HtmlImport[a]){var e=RTE.HtmlImport[a]=function(){ULSdmo:;(this.$$gta=this.$$gta||{})["RTE.HtmlImport.Queue$1"]={T:f};for(var b=[],a=0;a<arguments.length;++a)b[a]=arguments[a];RTE.HtmlImport.Queue$1.apply(this,b)};e.registerClass("RTE.HtmlImport."+a);var c=RTE.HtmlImport.Queue$1.prototype;for(var d in c){var b={key:d,value:c[d]};if("constructor"!==b.key)e.prototype[b.key]=b.value}}return RTE.HtmlImport[a]};RTE.HtmlImport.Queue$1.prototype={$1w_0:null,$15_0:null,$P_0:0,get_count:function(){ULSdmo:;return this.$P_0},get_isEmpty:function(){ULSdmo:;return!this.$P_0||!this.$1w_0||!this.$15_0},enqueue:function(b){ULSdmo:;var a=new(RTE.HtmlImport.QueueNode$1.$$(this.$$gta["RTE.HtmlImport.Queue$1"].T));a.data=b;if(this.get_isEmpty()){this.$1w_0=a;this.$15_0=a}else{RTE.PasteCommon.Debug.assertTag(!!this.$15_0,598018);this.$1w_0.next=a;this.$1w_0=a}this.$P_0++},front:function(){ULSdmo:;return this.get_isEmpty()?null:this.$15_0.data},dequeue:function(){ULSdmo:;if(this.get_isEmpty()){RTE.PasteCommon.Debug.$6("Attempting to Dequeue from an empty Queue!",598019);return null}var a=this.$15_0;this.$15_0=a.next;this.$P_0--;if(!this.$15_0){this.$1w_0=null;RTE.PasteCommon.Debug.assertTag(this.get_isEmpty(),598020)}return a.data},clear:function(){ULSdmo:;this.$1w_0=null;this.$15_0=null;this.$P_0=0},toArray:function(){ULSdmo:;for(var c=new Array(this.$P_0),a=this.$15_0,b=0;b<this.$P_0;b++){if(!a){RTE.PasteCommon.Debug.$6("The Queue's Count is wrong!  Returning a partially-filled array",598021);break}c[b]=a.data;a=a.next}RTE.PasteCommon.Debug.$1J(!a,"The Queue's Count is wrong!  Returning a partial array",598022);return c}};RTE.HtmlImport.QueuedEventManager=function(){ULSdmo:;this.$2q_0=new(RTE.HtmlImport.Queue$1.$$(Object))};RTE.HtmlImport.QueuedEventManager.prototype={$2q_0:null,get_$CI_0:function(){ULSdmo:;return this.$2q_0.get_isEmpty()},$L_0:function(a){ULSdmo:;this.$2q_0.enqueue(a)},$BI_0:function(a){ULSdmo:;a&&this.$DY_0();while(!this.$2q_0.get_isEmpty()){var b=this.$2q_0.dequeue();b()}a&&this.$DK_0()},$DY_0:function(){},$DK_0:function(){}};RTE.HtmlImport.ListSemanticArgs=function(a,b){ULSdmo:;RTE.PasteCommon.Debug.$1J(!!a,"Lists must specify a ListStyleType (eg DefaultUnordered/Ordered, Disc, Decimal, etc)",598024);this.$2p_0=a;this.$2G_0=0;this.$2H_0=b;this.$1f_0=b===1;this.$1b_0=-1;this.$2s_0=true};RTE.HtmlImport.ListSemanticArgs.prototype={$2p_0:0,$2G_0:0,$1b_0:0,$2s_0:false,get_listStyleType:function(){ULSdmo:;return this.get_isListItemStyleSpecified()?this.$2G_0:this.$2p_0},get_isListStyleSpecified:function(){ULSdmo:;return this.$2p_0!==2&&this.$2p_0!==6},get_isListItemStyleSpecified:function(){ULSdmo:;return!!this.$2G_0},get_startNumber:function(){ULSdmo:;return this.$2H_0},$2H_0:0,get_isListNumbered:function(){ULSdmo:;return this.get_listStyleType()>=6},get_isAutoNumber:function(){ULSdmo:;return this.$1f_0},$1f_0:false,get_currentNumber:function(){ULSdmo:;RTE.PasteCommon.Debug.assertTag(this.$1b_0>=0,598023);return this.$2s_0?this.$2H_0+this.$1b_0:this.$1b_0},$Ay_0:function(){ULSdmo:;var a=new RTE.HtmlImport.ListSemanticArgs(this.$2p_0,this.$2H_0);a.$2G_0=this.$2G_0;a.$1f_0=this.$1f_0;a.$1b_0=this.$1b_0;a.$2s_0=this.$2s_0;return a},$Ak_0:function(b,a){ULSdmo:;RTE.PasteCommon.Debug.assertTag(a>=0,598025);this.$2G_0=b;if(a>0){this.$1f_0=false;this.$1b_0=a;this.$2s_0=false}else{this.$1b_0++;this.$1f_0=true}},resetListStartNumber:function(a){ULSdmo:;this.$2H_0=a}};RTE.HtmlImport.TableSemanticArgs=function(a,b){ULSdmo:;this.rowCount=a;this.colCount=b};RTE.HtmlImport.TableSemanticArgs.prototype={rowCount:0,colCount:0};RTE.HtmlImport.TableCellSemanticArgs=function(a,b){ULSdmo:;this.colSpan=a;this.rowSpan=b};RTE.HtmlImport.TableCellSemanticArgs.prototype={colSpan:0,rowSpan:0};RTE.HtmlImport.ImageSemanticArgs=function(a,b,c,d){ULSdmo:;this.src=a;this.alt=b;this.width=c;this.height=d};RTE.HtmlImport.ImageSemanticArgs.prototype={src:null,alt:null,width:0,height:0};RTE.HtmlImport.StackNode$1=function(){ULSdmo:;this.data=this.$$gta["RTE.HtmlImport.StackNode$1"].TNode===Number||Type.isEnum(this.$$gta["RTE.HtmlImport.StackNode$1"].TNode)?0:this.$$gta["RTE.HtmlImport.StackNode$1"].TNode===Boolean?false:null};RTE.HtmlImport.StackNode$1.$$=function(f){ULSdmo:;var a="StackNode$1$1$"+f.getName().replace(/\./g,"_");if(!RTE.HtmlImport[a]){var e=RTE.HtmlImport[a]=function(){ULSdmo:;(this.$$gta=this.$$gta||{})["RTE.HtmlImport.StackNode$1"]={TNode:f};for(var b=[],a=0;a<arguments.length;++a)b[a]=arguments[a];RTE.HtmlImport.StackNode$1.apply(this,b)};e.registerClass("RTE.HtmlImport."+a);var c=RTE.HtmlImport.StackNode$1.prototype;for(var d in c){var b={key:d,value:c[d]};if("constructor"!==b.key)e.prototype[b.key]=b.value}}return RTE.HtmlImport[a]};RTE.HtmlImport.StackNode$1.prototype={next:null};RTE.HtmlImport.Stack$1=function(){ULSdmo:;this.$17_0=null;this.$P_0=0};RTE.HtmlImport.Stack$1.$$=function(f){ULSdmo:;var a="Stack$1$1$"+f.getName().replace(/\./g,"_");if(!RTE.HtmlImport[a]){var e=RTE.HtmlImport[a]=function(){ULSdmo:;(this.$$gta=this.$$gta||{})["RTE.HtmlImport.Stack$1"]={T:f};for(var b=[],a=0;a<arguments.length;++a)b[a]=arguments[a];RTE.HtmlImport.Stack$1.apply(this,b)};e.registerClass("RTE.HtmlImport."+a);var c=RTE.HtmlImport.Stack$1.prototype;for(var d in c){var b={key:d,value:c[d]};if("constructor"!==b.key)e.prototype[b.key]=b.value}}return RTE.HtmlImport[a]};RTE.HtmlImport.Stack$1.prototype={$17_0:null,$P_0:0,get_count:function(){ULSdmo:;return this.$P_0},get_isEmpty:function(){ULSdmo:;RTE.PasteCommon.Debug.assertTag(!this.$P_0===!this.$17_0,598026);return!this.$P_0||!this.$17_0},push:function(b){ULSdmo:;var a=new(RTE.HtmlImport.StackNode$1.$$(this.$$gta["RTE.HtmlImport.Stack$1"].T));a.data=b;a.next=this.$17_0;this.$17_0=a;this.$P_0++},peek:function(){ULSdmo:;return this.get_isEmpty()?null:this.$17_0.data},pop:function(){ULSdmo:;if(this.get_isEmpty()){RTE.PasteCommon.Debug.$6("Attempting to Pop off an empty Stack!",598027);return null}var a=this.$17_0;this.$17_0=a.next;this.$P_0--;return a.data},clear:function(){ULSdmo:;this.$17_0=null;this.$P_0=0},toArray:function(){ULSdmo:;for(var c=new Array(this.$P_0),a=this.$17_0,b=this.$P_0-1;b>=0;b--){if(!a){RTE.PasteCommon.Debug.$6("The Stack's Count is wrong!  Returning a partially-filled array",598028);break}c[b]=a.data;a=a.next}RTE.PasteCommon.Debug.$1J(!a,"The Stack's Count is wrong!  Returning a partial array",598029);return c}};RTE.HtmlImport.WordConverter=function(){ULSdmo:;this.$$d_$Cw_0=Function.createDelegate(this,this.$Cw_0);this.$$d_$Cx_0=Function.createDelegate(this,this.$Cx_0)};RTE.HtmlImport.WordConverter.$Bi=function(f,c,d){ULSdmo:;var a=RTE.HtmlImport.WordConverter.$9r(f,c.$2X_0,d),b=RTE.PasteCommon.CustomData.getObject(a,"UniqueListId");if(b&&b!==c.$1G_0||!b&&a.firstChild){var e=f.ownerDocument.createElement(d.$1a_0);a.parentNode.insertBefore(e,a.nextSibling);a=e}RTE.PasteCommon.CustomData.$3Q(a,"UniqueListId",c.$1G_0);return RTE.HtmlImport.WordConverter.$B0(a,d)};RTE.HtmlImport.WordConverter.$B0=function(a,c){ULSdmo:;if(c.$1a_0!==a.tagName){var b=a.ownerDocument.createElement(c.$1a_0);RTE.PasteCommon.CustomData.$3Q(b,"UniqueListId",RTE.PasteCommon.CustomData.getObject(a,"UniqueListId"));while(a.firstChild)b.appendChild(a.firstChild);a.parentNode.insertBefore(b,a);a.parentNode.removeChild(a);a=b}return a};RTE.HtmlImport.WordConverter.$9r=function(b,e,g){ULSdmo:;var c=null,a;if(e===1)a=RTE.HtmlImport.WordConverter.$6Y(b);else{c=RTE.HtmlImport.WordConverter.$9r(b,e-1,null);a=c.lastChild}if(a&&a.nodeType===1){var f=a.tagName.toUpperCase();if(f==="UL"||f==="OL")return a}var d=b.ownerDocument.createElement(g?g.$1a_0:"UL");if(e===1)b.parentNode.insertBefore(d,b);else c.appendChild(d);return d};RTE.HtmlImport.WordConverter.$82=function(c,d){ULSdmo:;for(var b=0;b<c.childNodes.length;b++){var a=c.childNodes[b];a.nodeType===1&&d>1&&RTE.HtmlImport.WordConverter.$82(a,d-1);a=RTE.HtmlImport.WordConverter.fixWordListComments(a,true);if(RTE.HtmlImport.WordConverter.$58(a)||RTE.HtmlImport.WordConverter.$9K(a)){c.removeChild(a);b--}}};RTE.HtmlImport.WordConverter.$Bf=function(c){ULSdmo:;if(c.nodeType===1){var a=RTE.HtmlImport.WordConverter.$8r(c,"mso-list");if(a&&a.length>0)try{var d=a.split(" ");if(d.length===3){var b=new RTE.HtmlImport.ListItemMetadata;b.$2X_0=Number.parseInvariant(d[1].substr(5));b.$5p_0=a;b.$77_0=c;return b}}catch(e){RTE.PasteCommon.Debug.$6("Error parsing mso-list: "+e.message,840342)}}return null};RTE.HtmlImport.WordConverter.$Bb=function(a){ULSdmo:;return a!=="o"&&a!=="\u00b7"&&a!=="\u00a7"&&a!=="-"?"OL":"UL"};RTE.HtmlImport.WordConverter.$6V=function(d,c){ULSdmo:;var b=null,a=d.firstChild;while(!b&&a){a=RTE.HtmlImport.WordConverter.fixWordListComments(a,true);if(RTE.HtmlImport.WordConverter.$9K(a)){if(typeof a.innerText==="string")b=a.innerText.trim();else b=a.textContent.trim();if(!b.length)b="o"}else if(a.nodeType===1&&c>1)b=RTE.HtmlImport.WordConverter.$6V(a,c-1);a=a.nextSibling}return b};RTE.HtmlImport.WordConverter.fixWordListComments=function(b,g){ULSdmo:;if(b.nodeType===8){var d=b.data;if(d&&d.trim().toLowerCase()==="[if !supportlists]"){for(var a=b,c=null,f=0;f<4;f++){a=RTE.HtmlImport.WordConverter.getRealNextSibling(a);if(!a)break;if(a.nodeType===8){d=a.data;if(d&&d.trim().toLowerCase()==="[endif]"){c=a;break}}}if(c){var e=b.ownerDocument.createElement("SPAN");e.setAttribute("style","mso-list: ignore");a=RTE.HtmlImport.WordConverter.getRealNextSibling(b);while(a!==c){a=a.nextSibling;e.appendChild(a.previousSibling)}c.parentNode.insertBefore(e,c);if(g){b.parentNode.removeChild(b);c.parentNode.removeChild(c)}b=e}}}return b};RTE.HtmlImport.WordConverter.$9K=function(b){ULSdmo:;if(b.nodeType===1){var a=RTE.HtmlImport.WordConverter.$8r(b,"mso-list");if(a&&a.length>0&&a.trim().toLowerCase()==="ignore")return true}return false};RTE.HtmlImport.WordConverter.$58=function(a){ULSdmo:;return a.nodeType===1&&!a.firstChild&&a.tagName.toUpperCase()==="SPAN"};RTE.HtmlImport.WordConverter.$8r=function(f,e){ULSdmo:;var a=f.getAttribute("style");if(a&&a.length>0&&a.indexOf(e)!==-1)for(var d=a.split(";"),b=0;b<d.length;b++){var c=d[b].split(":");if(c.length===2&&c[0].trim()===e)return c[1].trim()}return null};RTE.HtmlImport.WordConverter.$6Y=function(b){ULSdmo:;var a=b;do a=a.previousSibling;while(a&&RTE.HtmlImport.WordConverter.$6m(a));return a};RTE.HtmlImport.WordConverter.getRealNextSibling=function(b){ULSdmo:;var a=b;do a=a.nextSibling;while(a&&RTE.HtmlImport.WordConverter.$6m(a));return a};RTE.HtmlImport.WordConverter.$6m=function(a){ULSdmo:;if(!a)return true;if(a.nodeType===3){var b=a.nodeValue;b=b.replace(RTE.HtmlImport.WordConverter.$7e,"");return!b.trim().length}return a.nodeType===1&&a.firstChild===a.lastChild&&(a.tagName==="SPAN"||a.tagName==="FONT")?RTE.HtmlImport.WordConverter.$6m(a.firstChild):false};RTE.HtmlImport.WordConverter.$DL=function(c){ULSdmo:;for(var a=0;a<c.$s_0.length;a++){var b=c.$s_0[a];if(b)b.$31_0=-1}};RTE.HtmlImport.WordConverter.prototype={$7k_0:1,$4W_0:0,$4X_0:0,process:function(c,a){ULSdmo:;if(!c){RTE.PasteCommon.Debug.$63(840341);return}this.$4X_0=0;this.$4W_0=0;if(c.querySelectorAll){var b=c.querySelectorAll("p");if(b&&b.length>0){var d=new RTE.PasteCommon.SimpleOperation(a,this.$$d_$Cx_0,new RTE.HtmlImport.WordConverterArguments(b));d.set_$5E_1(!a||a.get_$5E_1());d.$7J_1()}}},$Cx_0:function(h,i){ULSdmo:;var a=i,c=a.$5S_0[a.$1k_0],d=RTE.HtmlImport.WordConverter.$Bf(c);if(d){var f=a.$s_0[d.$2X_0-1];if(!f){f=new RTE.HtmlImport.LevelLists;a.$s_0[d.$2X_0-1]=f}a.$3H_0&&RTE.HtmlImport.WordConverter.$6Y(c)!==a.$3H_0&&RTE.HtmlImport.WordConverter.$DL(a);var b=f.$5J_0[d.$5p_0];if(!b){b=new RTE.HtmlImport.ListMetadata;b.$1G_0=this.$7k_0++;b.$2M_0=RTE.HtmlImport.WordConverter.$6V(c,5);b.$2O_0=!b.$2M_0||!b.$2M_0.length;b.$1a_0=RTE.HtmlImport.WordConverter.$Bb(b.$2M_0);f.$5J_0[d.$5p_0]=b;a.$5I_0[b.$1G_0.toString()]=b}else if(!b.$2O_0&&b.$48_0===1){var g=RTE.HtmlImport.WordConverter.$6V(c,5);b.$1a_0=b.$2M_0===g?"UL":"OL"}d.$1G_0=b.$1G_0;if(b.$2O_0||b.$1a_0==="OL"&&b.$48_0>0&&f.$31_0!==d.$1G_0){b.$2O_0=true;a.$s_0[0].$31_0=-1;a.$s_0=a.$s_0.slice(0,1)}else{if(a.$s_0.length>d.$2X_0)a.$s_0=a.$s_0.slice(0,d.$2X_0);f.$31_0=d.$1G_0;a.$2Y_0[a.$2Y_0.length]=d;b.$48_0++}a.$3H_0=c}else{var e=a.$3H_0;if(e&&RTE.HtmlImport.WordConverter.$6Y(c)===e&&c.tagName===e.tagName&&c.className===e.className){e.appendChild(e.ownerDocument.createElement("BR"));e.appendChild(e.ownerDocument.createElement("BR"));while(c.firstChild)e.appendChild(c.firstChild);c.parentNode.removeChild(c)}}a.$1k_0++;if(a.$5S_0.length<=a.$1k_0){if(!a.$2Y_0.length)return false;a.$1k_0=0;h.$4i_1(this.$$d_$Cw_0)}return true},$Cw_0:function(h,g){ULSdmo:;var b=g,c=b.$2Y_0[b.$1k_0],a=c.$77_0,d=b.$5I_0[c.$1G_0.toString()];if(!d.$2O_0){var e=RTE.HtmlImport.WordConverter.$Bi(a,c,d);if(e){RTE.HtmlImport.WordConverter.$82(a,5);var f=a.ownerDocument.createElement("LI");while(a.firstChild)f.appendChild(a.firstChild);e.appendChild(f);a.parentNode.removeChild(a);if(d.$1a_0==="UL")this.$4W_0++;else this.$4X_0++}}b.$1k_0++;return b.$1k_0<b.$2Y_0.length}};RTE.Rectangle.registerClass("RTE.Rectangle");RTE.ShortcutEventArgs.registerClass("RTE.ShortcutEventArgs");RTE.HtmlCleanupArgs.registerClass("RTE.HtmlCleanupArgs");RTE.InsertTableOptions.registerClass("RTE.InsertTableOptions");RTE.InsertLinkOptions.registerClass("RTE.InsertLinkOptions");RTE.InsertImageOptions.registerClass("RTE.InsertImageOptions");RTE.TableCellInfo.registerClass("RTE.TableCellInfo");RTE.TableColumnInfo.registerClass("RTE.TableColumnInfo");RTE.TableGrid.registerClass("RTE.TableGrid");RTE.CircularArray.registerClass("RTE.CircularArray");RTE.HtmlTagName.registerClass("RTE.HtmlTagName");RTE.SelectionNodesProcessor.registerClass("RTE.SelectionNodesProcessor");RTE.ApplyOnSelectionProcessor.registerClass("RTE.ApplyOnSelectionProcessor",RTE.SelectionNodesProcessor);RTE.AtomicManager.registerClass("RTE.AtomicManager");RTE.AutocompleteParseData.registerClass("RTE.AutocompleteParseData");RTE.RTFieldFlags.registerClass("RTE.RTFieldFlags");RTE.Canvas.registerClass("RTE.Canvas");RTE.CanvasEvents.registerClass("RTE.CanvasEvents");RTE.CanvasRange.registerClass("RTE.CanvasRange");RTE.QuickRange.registerClass("RTE.QuickRange");RTE.Cursor.registerClass("RTE.Cursor");RTE.DirtyBitManager.registerClass("RTE.DirtyBitManager");RTE.DOMTreePosition.registerClass("RTE.DOMTreePosition");RTE.ExtractChildNodesProcessor.registerClass("RTE.ExtractChildNodesProcessor");RTE.FontCssClassPrefix.registerClass("RTE.FontCssClassPrefix");RTE.FontCommands.registerClass("RTE.FontCommands");RTE.HtmlCleanup.registerClass("RTE.HtmlCleanup");RTE.HtmlFormat.registerClass("RTE.HtmlFormat");RTE.HtmlAndSelection.registerClass("RTE.HtmlAndSelection");RTE.MovementKeys.registerClass("RTE.MovementKeys");RTE.SelectionClearingKeys.registerClass("RTE.SelectionClearingKeys");RTE.LayoutsEditor.registerClass("RTE.LayoutsEditor");RTE.LayoutsZone.registerClass("RTE.LayoutsZone");RTE.NodeDictionaryCache.registerClass("RTE.NodeDictionaryCache");RTE.ElementCommands.registerClass("RTE.ElementCommands");RTE.ParagraphCommands.registerClass("RTE.ParagraphCommands");RTE.PasteFlyout.registerClass("RTE.PasteFlyout");RTE.RtePasteManager.registerClass("RTE.RtePasteManager");RTE.PasteOperationArgs.registerClass("RTE.PasteOperationArgs");RTE.PasteMode.registerClass("RTE.PasteMode");RTE.WordConverterPasteMode.registerClass("RTE.WordConverterPasteMode",RTE.PasteMode);RTE.AsIsPasteMode.registerClass("RTE.AsIsPasteMode",RTE.WordConverterPasteMode);RTE.CleanPasteMode.registerClass("RTE.CleanPasteMode",RTE.WordConverterPasteMode);RTE.PlainTextPasteMode.registerClass("RTE.PlainTextPasteMode",RTE.PasteMode);RTE.PreviewManager.registerClass("RTE.PreviewManager");RTE.ScrollPosition.registerClass("RTE.ScrollPosition");RTE.ElementPlaceholderReplacer.registerClass("RTE.ElementPlaceholderReplacer");RTE.Range.registerClass("RTE.Range");RTE.RemoveStyleOnSelectionProcessor.registerClass("RTE.RemoveStyleOnSelectionProcessor",RTE.SelectionNodesProcessor);RTE.CommandState.registerClass("RTE.CommandState");RTE.RichTextEditor.registerClass("RTE.RichTextEditor");RTE.UnitValue.registerClass("RTE.UnitValue");RTE.RteUtility.registerClass("RTE.RteUtility");RTE.SU.registerClass("RTE.SU");RTE.Ie8TreeValidator.registerClass("RTE.Ie8TreeValidator");RTE.HtmlImport.AHtmlPasteSteward.registerClass("RTE.HtmlImport.AHtmlPasteSteward",null,RTE.HtmlImport.ISemanticEventAcceptor);RTE.RteHtmlPasteSteward.registerClass("RTE.RteHtmlPasteSteward",RTE.HtmlImport.AHtmlPasteSteward);RTE.RteHtmlPasteSteward.FormattingSteward.registerClass("RTE.RteHtmlPasteSteward.FormattingSteward",null,RTE.HtmlImport.IFormattingSteward);RTE.HtmlImport.AHtmlTranslator.registerClass("RTE.HtmlImport.AHtmlTranslator",null,RTE.HtmlImport.IHtmlEventAcceptor);RTE.HtmlImport.DefaultHtmlTranslator.registerClass("RTE.HtmlImport.DefaultHtmlTranslator",RTE.HtmlImport.AHtmlTranslator);RTE.RteHtmlTranslator.registerClass("RTE.RteHtmlTranslator",RTE.HtmlImport.DefaultHtmlTranslator);RTE.HtmlImport.AHtmlNormalizer.registerClass("RTE.HtmlImport.AHtmlNormalizer",null,RTE.HtmlImport.ISemanticEventAcceptor);RTE.HtmlImport.AQueuingHtmlNormalizer.registerClass("RTE.HtmlImport.AQueuingHtmlNormalizer",RTE.HtmlImport.AHtmlNormalizer);RTE.HtmlImport.DefaultHtmlNormalizer.registerClass("RTE.HtmlImport.DefaultHtmlNormalizer",RTE.HtmlImport.AQueuingHtmlNormalizer);RTE.RteHtmlNormalizer.registerClass("RTE.RteHtmlNormalizer",RTE.HtmlImport.DefaultHtmlNormalizer);RTE.Selection.registerClass("RTE.Selection");RTE.Snapshot.registerClass("RTE.Snapshot");RTE.SnapshotManager.registerClass("RTE.SnapshotManager");RTE.CssStyleInfo.registerClass("RTE.CssStyleInfo");RTE.StyleRuleUtility.registerClass("RTE.StyleRuleUtility");RTE.TableCommands.registerClass("RTE.TableCommands");RTE.TableKeyTabProcessor.registerClass("RTE.TableKeyTabProcessor",null,RTE.ICommandProcessor);RTE.UiServices.registerClass("RTE.UiServices");RTE.PasteCommon.Debug.registerClass("RTE.PasteCommon.Debug");RTE.PasteCommon.LogLevel.registerClass("RTE.PasteCommon.LogLevel");RTE.PasteCommon.StringUtils.registerClass("RTE.PasteCommon.StringUtils");RTE.PasteCommon.CustomData.registerClass("RTE.PasteCommon.CustomData");RTE.PasteCommon.AOperation.registerClass("RTE.PasteCommon.AOperation");RTE.PasteCommon.SimpleOperationImplementation.registerClass("RTE.PasteCommon.SimpleOperationImplementation");RTE.PasteCommon.SimpleOperation.registerClass("RTE.PasteCommon.SimpleOperation",RTE.PasteCommon.AOperation);RTE.PasteCommon.HtmlProcessorPercentage.registerClass("RTE.PasteCommon.HtmlProcessorPercentage");RTE.HtmlImport.HtmlProcessorArguments.registerClass("RTE.HtmlImport.HtmlProcessorArguments");RTE.HtmlImport.WordConverterArguments.registerClass("RTE.HtmlImport.WordConverterArguments");RTE.HtmlImport.LevelLists.registerClass("RTE.HtmlImport.LevelLists");RTE.HtmlImport.ListItemMetadata.registerClass("RTE.HtmlImport.ListItemMetadata");RTE.HtmlImport.ListMetadata.registerClass("RTE.HtmlImport.ListMetadata");RTE.HtmlImport.QueuedEventManager.registerClass("RTE.HtmlImport.QueuedEventManager");RTE.HtmlImport.DefaultHtmlNormalizer.NormalizedTable.registerClass("RTE.HtmlImport.DefaultHtmlNormalizer.NormalizedTable",RTE.HtmlImport.QueuedEventManager);RTE.HtmlImport.DefaultHtmlNormalizer.NormalizedTable.TableCell.registerClass("RTE.HtmlImport.DefaultHtmlNormalizer.NormalizedTable.TableCell");RTE.HtmlImport.DefaultHtmlNormalizer.ContentState.registerClass("RTE.HtmlImport.DefaultHtmlNormalizer.ContentState",RTE.HtmlImport.QueuedEventManager);RTE.HtmlImport.HtmlProcessor.registerClass("RTE.HtmlImport.HtmlProcessor");RTE.HtmlImport.PlaintextHtmlTranslator.registerClass("RTE.HtmlImport.PlaintextHtmlTranslator",RTE.HtmlImport.AHtmlTranslator);RTE.HtmlImport.ListSemanticArgs.registerClass("RTE.HtmlImport.ListSemanticArgs");RTE.HtmlImport.TableSemanticArgs.registerClass("RTE.HtmlImport.TableSemanticArgs");RTE.HtmlImport.TableCellSemanticArgs.registerClass("RTE.HtmlImport.TableCellSemanticArgs");RTE.HtmlImport.ImageSemanticArgs.registerClass("RTE.HtmlImport.ImageSemanticArgs");RTE.HtmlImport.WordConverter.registerClass("RTE.HtmlImport.WordConverter");function ms_rte_initialize(){ULSdmo:;RTE.HtmlTagName.AREA="AREA";RTE.HtmlTagName.b="B";RTE.HtmlTagName.BODY="BODY";RTE.HtmlTagName.BUTTON="BUTTON";RTE.HtmlTagName.BR="BR";RTE.HtmlTagName.CENTER="CENTER";RTE.HtmlTagName.DEL="DEL";RTE.HtmlTagName.EM="EM";RTE.HtmlTagName.EMBED="EMBED";RTE.HtmlTagName.FONT="FONT";RTE.HtmlTagName.LI="LI";RTE.HtmlTagName.HTML="HTML";RTE.HtmlTagName.i="I";RTE.HtmlTagName.IFRAME="IFRAME";RTE.HtmlTagName.TABLE="TABLE";RTE.HtmlTagName.TBODY="TBODY";RTE.HtmlTagName.TFOOT="TFOOT";RTE.HtmlTagName.THEAD="THEAD";RTE.HtmlTagName.TD="TD";RTE.HtmlTagName.TH="TH";RTE.HtmlTagName.TR="TR";RTE.HtmlTagName.UL="UL";RTE.HtmlTagName.OBJECT="OBJECT";RTE.HtmlTagName.OL="OL";RTE.HtmlTagName.OPTION="OPTION";RTE.HtmlTagName.MENU="MENU";RTE.HtmlTagName.DIR="DIR";RTE.HtmlTagName.p="P";RTE.HtmlTagName.DIV="DIV";RTE.HtmlTagName.BLOCKQUOTE="BLOCKQUOTE";RTE.HtmlTagName.a="A";RTE.HtmlTagName.IMG="IMG";RTE.HtmlTagName.INPUT="INPUT";RTE.HtmlTagName.META="META";RTE.HtmlTagName.LINK="LINK";RTE.HtmlTagName.PARAM="PARAM";RTE.HtmlTagName.h1="H1";RTE.HtmlTagName.h2="H2";RTE.HtmlTagName.h3="H3";RTE.HtmlTagName.h4="H4";RTE.HtmlTagName.h5="H5";RTE.HtmlTagName.h6="H6";RTE.HtmlTagName.HR="HR";RTE.HtmlTagName.s="S";RTE.HtmlTagName.SELECT="SELECT";RTE.HtmlTagName.SPAN="SPAN";RTE.HtmlTagName.SCRIPT="SCRIPT";RTE.HtmlTagName.STYLE="STYLE";RTE.HtmlTagName.STRIKE="STRIKE";RTE.HtmlTagName.STRONG="STRONG";RTE.HtmlTagName.SUP="SUP";RTE.HtmlTagName.SUB="SUB";RTE.HtmlTagName.SVG="SVG";RTE.HtmlTagName.TEXTAREA="TEXTAREA";RTE.HtmlTagName.u="U";RTE.HtmlTagName.XML="XML";RTE.HtmlTagName.blockElements=["ADDRESS","BLOCKQUOTE","BODY","CENTER","DD","DT","DIR","DIV","DL","FIELDSET","FORM","FRAMESET","H1","H2","H3","H3","H4","H5","H6","HR","ISINDEX","MENU","NOFRAMES","NOSCRIPT","LI","OL","P","PRE","TABLE","TBODY","TFOOT","TD","TH","THEAD","TR","UL"];RTE.HtmlTagName.$66={ADDRESS:true,BLOCKQUOTE:true,BODY:true,CENTER:true,DD:true,DT:true,DIR:true,DIV:true,DL:true,FIELDSET:true,FORM:true,FRAMESET:true,H1:true,H2:true,H3:true,H4:true,H5:true,H6:true,HR:true,ISINDEX:true,MENU:true,NOFRAMES:true,NOSCRIPT:true,LI:true,OL:true,P:true,PRE:true,TABLE:true,TBODY:true,TFOOT:true,TD:true,TH:true,THEAD:true,TR:true,UL:true};RTE.HtmlTagName.allowedElementStyleTags={P:true,H1:true,H2:true,H3:true,H4:true,H5:true,H6:true};RTE.HtmlTagName.tableCellTagNames=["TD","TH"];RTE.HtmlTagName.inlineElements=["A","ABBR","ACRONYM","B","BASEFONT","BDO","BIG","BR","CITE","CODE","DEL","DFN","EM","FONT","I","IMG","INPUT","KBD","LABEL","Q","S","SAMP","SELECT","SMALL","SPAN","STRIKE","STRONG","SUB","SUP","TEXTAREA","TT","U","VAR"];RTE.HtmlTagName.$93={A:true,ABBR:true,ACRONYM:true,B:true,BASEFONT:true,BDO:true,BIG:true,BR:true,CITE:true,CODE:true,DEL:true,DFN:true,EM:true,FONT:true,I:true,IMG:true,INPUT:true,KBD:true,LABEL:true,Q:true,S:true,SAMP:true,SELECT:true,SMALL:true,SPAN:true,STRIKE:true,STRONG:true,SUB:true,SUP:true,TEXTAREA:true,TT:true,U:true,VAR:true};RTE.HtmlTagName.inlineOrBlockElements=["APPLET","BUTTON","DEL","IFRAME","INS","MAP","OBJECT","SCRIPT"];RTE.HtmlTagName.$C8={APPLET:true,BUTTON:true,DEL:true,IFRAME:true,INS:true,MAP:true,OBJECT:true,SCRIPT:true};RTE.HtmlTagName.$B6={CENTER:true,FONT:true,MENU:true,S:true,STRIKE:true,U:true};RTE.HtmlTagName.$Ap={TABLE:true,TD:true,TH:true,TR:true};RTE.HtmlTagName.$AY={CAPTION:true,DIV:true,H1:true,H2:true,H3:true,H4:true,H5:true,H6:true,HR:true,IMG:true,INPUT:true,LEGEND:true,OBJECT:true,P:true,TABLE:true};RTE.HtmlTagName.$Dk={HR:true};RTE.HtmlTagName.$E2={HR:true,PRE:true,TD:true,TH:true};RTE.HtmlTagName.$Ar={IMG:true,OBJECT:true};RTE.HtmlTagName.$C5={TD:true,TH:true};RTE.HtmlTagName.$Cc={TD:true,TH:true};RTE.HtmlTagName.$Ai={LI:true};RTE.HtmlTagName.listElements=["OL","UL"];RTE.HtmlTagName.extendedListElements=["OL","UL","DIR","MENU"];RTE.ApplyOnSelectionProcessor.$1S=new RTE.ApplyOnSelectionProcessor;RTE.ApplyOnSelectionProcessor.$8R={color:"color",fontFamily:"face",fontSize:"size"};RTE.RTFieldFlags.$9s=2;RTE.Canvas.editableItemClass="ms-rtestate-write";RTE.Canvas.atomicItemClass="ms-rtestate-read";RTE.Canvas.regionItemClass="ms-rtestate-field";RTE.Canvas.removeOnPasteClass="ms-rtepaste-remove";RTE.Canvas.notifyOnAddedClass="ms-rtestate-notify";RTE.Canvas.notifyOnGenerateClass="ms-rtegenerate-notify";RTE.Canvas.objectGenerateClass="ms-rtegenerate-object";RTE.Canvas.skipOnGenerateClass="ms-rtegenerate-skip";RTE.Canvas.skipAllOnGenerateClass="ms-rtegenerate-allskip";RTE.Canvas.inputBoxClass="ms-inputBox";RTE.Canvas.inputBoxActiveClass="ms-inputBoxActive";RTE.Canvas.restrictionInlineStyle="UseInlineStyle";RTE.Canvas.$2K=[];RTE.Canvas.$6g=false;RTE.Canvas.$6h=false;RTE.Canvas.$2e=null;RTE.Canvas.$30=500;RTE.Canvas.$5A=false;RTE.Canvas.setTableWidths=true;RTE.Canvas.$32=false;RTE.Canvas.$r=null;RTE.Canvas.$2B=null;RTE.Canvas.$1W=false;RTE.Canvas.$1D=null;RTE.Canvas.$6r=null;RTE.Canvas.$5K=false;RTE.Canvas.$4D=new Array(0);RTE.Canvas.$2i=null;RTE.Canvas.$7O=null;RTE.Canvas.$2E=null;RTE.Canvas.$4o=false;RTE.Canvas.$3G=null;RTE.Canvas.$76=null;RTE.Canvas.$75=RTE.Canvas.onMouseMove;RTE.Canvas.$46=false;RTE.Canvas.$3v=null;RTE.Canvas.$AU=new RegExp("\\W","g");RTE.Canvas.$4b=null;RTE.Canvas.$29=null;RTE.Canvas.$7L=null;RTE.Canvas.$4f=null;RTE.Canvas.$6A=null;RTE.Canvas.$1Y=0;RTE.CanvasEvents.imageEvent="Image";RTE.CanvasEvents.linkEvent="Link";RTE.CanvasEvents.tableEvent="Table";RTE.CanvasEvents.atomicEvent="Atomic";RTE.CanvasEvents.editableRegionEvent="EditableRegion";RTE.CanvasEvents.elementEvent="Element";RTE.CanvasEvents.transferEvent="Transfer";RTE.CanvasEvents.htmlCleanupEvent="HtmlCleanup";RTE.CanvasEvents.handleShortcut="HandleShortcut";RTE.CanvasEvents.imageBlurEvent="ImageBlur";RTE.CanvasEvents.imageFocusEvent="ImageFocus";RTE.CanvasEvents.linkBlurEvent="LinkBlur";RTE.CanvasEvents.linkFocusEvent="LinkFocus";RTE.CanvasEvents.tableBlurEvent="TableBlur";RTE.CanvasEvents.tableFocusEvent="TableFocus";RTE.CanvasEvents.atomicBlurEvent="AtomicBlur";RTE.CanvasEvents.atomicFocusEvent="AtomicFocus";RTE.CanvasEvents.atomicDisconnectEvent="AtomicDisconnect";RTE.CanvasEvents.atomicStoreCurrentEvent="AtomicStoreCurrent";RTE.CanvasEvents.atomicRestoreCurrent="AtomicRestoreCurrent";RTE.CanvasEvents.editableRegionBlurEvent="EditableRegionBlur";RTE.CanvasEvents.editableRegionFocusEvent="EditableRegionFocus";RTE.CanvasEvents.editableRegionSelectionEvent="EditableRegionSelection";RTE.CanvasEvents.editableRegionChangedEvent="EditableRegionChanged";RTE.CanvasEvents.editableRegionBeforeRestoreEvent="EditableRegionBeforeRestore";RTE.CanvasEvents.editableRegionAfterRestoreEvent="EditableRegionAfterRestore";RTE.CanvasEvents.elementAddedEvent="ElementAdded";RTE.CanvasEvents.elementGenerateTagEvent="ElementGenerateTag";RTE.CanvasEvents.$5H=new Sys.EventHandlerList;RTE.CanvasEvents.$1r={};RTE.CanvasEvents.$1m=null;RTE.CanvasEvents.$35={};RTE.CanvasEvents.$3h=false;RTE.CanvasEvents.$5n=0;RTE.CanvasEvents.$AD=RTE.CanvasEvents.setImageSize;RTE.CanvasEvents.$64=RTE.CanvasEvents.onAtomicResize;RTE.CanvasRange.$4l=false;RTE.CanvasRange.$1B=null;RTE.CanvasRange.$7M=["TD","TH","TR","LI","BR"];RTE.CanvasRange.$5c=["TR","TBODY","TD","TH","LI"];RTE.Cursor.$5o=false;RTE.Cursor.$4V=null;RTE.Cursor.$5F=false;RTE.Cursor.$5G=false;RTE.Cursor.$1T=true;RTE.Cursor.s_range=new RTE.CanvasRange("cursor");RTE.Cursor.$5b=false;RTE.Cursor.$2R=false;RTE.Cursor.$3R=true;RTE.Cursor.$m=false;RTE.Cursor.$3L=null;RTE.Cursor.$4p=null;RTE.Cursor.$3P=false;RTE.Cursor.$4Z=false;RTE.Cursor.$J=null;RTE.Cursor.$3M=false;RTE.Cursor.$2f=false;RTE.Cursor.$18=0;RTE.Cursor.ignoreBeforePasteOrDrop=false;RTE.Cursor.$B=null;RTE.Cursor.$5U=null;RTE.Cursor.$6k=RTE.Cursor.$Cn;RTE.Cursor.$3o=false;RTE.Cursor.$4n=0;RTE.Cursor.$C=new RTE.CanvasRange("paste");RTE.Cursor.$2P=false;RTE.Cursor.$3r=false;RTE.Cursor.$3V=0;RTE.Cursor.$3U=true;RTE.Cursor.$AO=RTE.Cursor.$Du;RTE.DirtyBitManager.$4G=false;RTE.DirtyBitManager.$3O=false;RTE.FontCssClassPrefix.fontFamily="FontFace";RTE.FontCssClassPrefix.themeFontFamily="ThemeFontFace";RTE.FontCssClassPrefix.fontSize="FontSize";RTE.FontCssClassPrefix.standardColor="ForeColor";RTE.FontCssClassPrefix.themeColor="ThemeForeColor";RTE.FontCssClassPrefix.standardBackgroundColor="BackColor";RTE.FontCssClassPrefix.themeBackgroundColor="ThemeBackColor";RTE.FontCssClassPrefix.textStyle="Style";RTE.FontCssClassPrefix.elementWithStyle="Element";RTE.FontCommands.$6x=true;RTE.FontCommands.$9b=["UL","OL","MENU","DIR","TR","TBODY","TABLE"];RTE.FontCommands.$6w="pt";RTE.FontCommands.$6v=null;RTE.HtmlFormat.$8A=new RegExp("<span[^>]*id=(\"|'|)ms-rterangecursor-start(\"|'|)","i");RTE.HtmlFormat.$88=new RegExp("<span[^>]*id=(\"|'|)ms-rterangecursor-end(\"|'|)","i");RTE.HtmlFormat.$7A=new RegExp("\\n|\\r","g");RTE.HtmlFormat.$AT=new RegExp("style\\s*=\\s*(\"|')[^(\"|')]*white-space:\\s*pre","i");RTE.HtmlFormat.$2C=null;RTE.HtmlFormat.$2Q=null;RTE.MovementKeys.$l=null;RTE.SelectionClearingKeys.$e=null;RTE.LayoutsEditor.$2A=null;RTE.PasteFlyout.$T=null;RTE.RtePasteManager.setTableCellSizesClass="ms-rte-paste-settablesizes";RTE.RtePasteManager.setInitialImageSizeClass="ms-rte-paste-setimagesize";RTE.RtePasteManager.$2I=null;RTE.RtePasteManager.$1l=null;RTE.RtePasteManager.$2x=null;RTE.RtePasteManager.$3i=null;RTE.PasteMode.pasteAsIsId="PasteAsIs";RTE.PasteMode.pasteCleanId="PasteClean";RTE.PasteMode.pastePlainId="PastePlain";RTE.CleanPasteMode.passThroughClasses=new Array(0);RTE.PlainTextPasteMode.$7g=new RegExp("\x0d","gi");RTE.PlainTextPasteMode.$7i=new RegExp("\x0a","gi");RTE.PlainTextPasteMode.$7h=new RegExp("\x0a *\x0a","gi");RTE.PlainTextPasteMode.$7j=new RegExp("  +","gi");RTE.PreviewManager.$T=null;RTE.Range.$7N=["StartToEnd","StartToStart","EndToStart","EndToEnd"];RTE.RemoveStyleOnSelectionProcessor.keepStyleOnNode="ms-rteKeepStyles";RTE.RemoveStyleOnSelectionProcessor.$1S=new RTE.RemoveStyleOnSelectionProcessor;RTE.RichTextEditor.languageClass="Language";RTE.RichTextEditor.assetIconClassName="ms-asset-icon";RTE.RichTextEditor.$7b=["px","%"];RTE.RichTextEditor.positionClass="Position";RTE.RichTextEditor.imageClass="Image";RTE.RichTextEditor.$E0=["px","%"];RTE.RteUtility.$6i=RTE.RteUtility.$Da;RTE.RteUtility.$1X=String.fromCharCode(160);RTE.RteUtility.$1t="\u200b";RTE.RteUtility.$59=false;RTE.RteUtility.$5C=false;RTE.RteUtility.$2T=false;RTE.RteUtility.$57=-1;RTE.RteUtility.$6u=null;RTE.RteUtility.$6s=null;RTE.RteUtility.$6t=null;RTE.RteUtility.$5k=true;RTE.RteUtility.$52={};RTE.RteUtility.$53=0;RTE.RteUtility.$6C=RTE.RteUtility.$Aw;RTE.RteUtility.$7c={IMG:"true",BR:"true",INPUT:"true",META:"true",LINK:"true",PARAM:"true",AREA:"true",HR:"true"};RTE.RteUtility.$BN=RTE.RteUtility.$BM;RTE.RteUtility.$5h=document.createElement("DIV");RTE.RteUtility.$5i={};RTE.RteUtility.$4N=0;RTE.RteUtility.$AJ=new RegExp('<span((id|rtenodeid)="[^"]*"|style="display:[ ]*none;[ ]*"|\\s*)*>');RTE.RteUtility.$8I=new RegExp('<font(rtenodeid="[^"]*"|\\s*)*>');RTE.RteUtility.$AI=new RegExp('<div((id|rtenodeid)="[^"]*"|style="display:[ ]*none;[ ]*"|\\s*)*>');RTE.RteUtility.$6l=["UL","OL","TABLE","TBODY","THEAD","TFOOT","TR"];RTE.RteUtility.$4F={};RTE.RteUtility.$7K=false;RTE.RteUtility.$8J=new RegExp("(<span/>)","ig");RTE.RteUtility.$89=new RegExp('(<span(([^<]*) id=("|)ms-rterange([^-]*)-(end|start)("|)([^<]*)|)></span>|<span/>)',"ig");RTE.RteUtility.$7I=new RegExp("\\s*RteNodeId\\s*=\\s*(\"|'|)[\\d]*(\"|'|)","ig");RTE.RteUtility.$9q=new RegExp('(<span(([^<]*) id=("|)ms-rterange(?!cursor)([^-]*)-(end|start)("|)([^<]*)|)></span>|<span/>)',"ig");RTE.RteUtility.$AQ=["px","pt","%","em","in","mm","cm","ex","pc",""];RTE.RteUtility.$5r=0;RTE.RteUtility.$AM=new RegExp("^[ \\n\\r\\t\\v\\f]*$","i");RTE.RteUtility.$AL=new RegExp("^[ \\n\\r\\t\\v\\f\\u00A0\\u200B]*$","i");RTE.RteUtility.$72=1;RTE.RteUtility.$$cctor();RTE.RteHtmlPasteSteward.$h={};RTE.RteHtmlTranslator.$7n=new RegExp("^0(px|em|in|pt)$","i");RTE.SnapshotManager.$3u=null;RTE.SnapshotManager.$v=new RTE.CircularArray(200);RTE.SnapshotManager.$2g=new RTE.CircularArray(200);RTE.SnapshotManager.$9W=1;RTE.SnapshotManager.$5W=false;RTE.SnapshotManager.$3j=RTE.SnapshotManager.$Cf;RTE.SnapshotManager.$2l=false;RTE.SnapshotManager.$5X=false;RTE.SnapshotManager.$6N=RTE.SnapshotManager.$Cg;RTE.StyleRuleUtility.$41=null;RTE.StyleRuleUtility.$42=null;RTE.StyleRuleUtility.checkOnlyCssFromSameDomain=true;RTE.StyleRuleUtility.$5V=-1;RTE.StyleRuleUtility.$1Z={};RTE.StyleRuleUtility.$4O={};RTE.StyleRuleUtility.$4P=0;RTE.TableCommands.applyStyleToElement=null;RTE.TableCommands.$4T=["in","cm","px","%"];RTE.TableCommands.tableClass="Table";RTE.TableCommands.$5j="ms-rteTableGrid";RTE.UiServices.$I=new RTE.UiServices;RTE.PasteCommon.LogLevel.$5m=0;RTE.PasteCommon.LogLevel.$90=1;RTE.PasteCommon.LogLevel.$AS=2;RTE.PasteCommon.CustomData.dict={};RTE.PasteCommon.SimpleOperationImplementation.factoryMethod=null;RTE.HtmlImport.DefaultHtmlNormalizer.$8y=new RegExp("[ \x09\x0c\u200b\x0d\x0a]+","g");RTE.HtmlImport.DefaultHtmlTranslator.$6f={aliceblue:"F0F8FF",antiquewhite:"FAEBD7",aqua:"00FFFF",aquamarine:"7FFFD4",azure:"F0FFFF",beige:"F5F5DC",bisque:"FFE4C4",black:"000000",blanchedalmond:"FFEBCD",blue:"0000FF",blueviolet:"8A2BE2",brown:"A52A2A",burlywood:"DEB887",cadetblue:"5F9EA0",chartreuse:"7FFF00",chocolate:"D2691E",coral:"FF7F50",cornflowerblue:"6495ED",cornsilk:"FFF8DC",crimson:"DC143C",cyan:"00FFFF",darkblue:"00008B",darkcyan:"008B8B",darkgoldenrod:"B8860B",darkgray:"A9A9A9",darkgrey:"A9A9A9",darkgreen:"006400",darkkhaki:"BDB76B",darkmagenta:"8B008B",darkolivegreen:"556B2F",darkorange:"FF8C00",darkorchid:"9932CC",darkred:"8B0000",darksalmon:"E9967A",darkseagreen:"8FBC8F",darkslateblue:"483D8B",darkslategray:"2F4F4F",darkslategrey:"2F4F4F",darkturquoise:"00CED1",darkviolet:"9400D3",deeppink:"FF1493",deepskyblue:"00BFFF",dimgray:"696969",dimgrey:"696969",dodgerblue:"1E90FF",firebrick:"B22222",floralwhite:"FFFAF0",forestgreen:"228B22",fuchsia:"FF00FF",gainsboro:"DCDCDC",ghostwhite:"F8F8FF",gold:"FFD700",goldenrod:"DAA520",gray:"808080",grey:"808080",green:"008000",greenyellow:"ADFF2F",honeydew:"F0FFF0",hotpink:"FF69B4",indianred:"CD5C5C",indigo:"4B0082",ivory:"FFFFF0",khaki:"F0E68C",lavender:"E6E6FA",lavenderblush:"FFF0F5",lawngreen:"7CFC00",lemonchiffon:"FFFACD",lightblue:"ADD8E6",lightcoral:"F08080",lightcyan:"E0FFFF",lightgoldenrodyellow:"FAFAD2",lightgray:"D3D3D3",lightgrey:"D3D3D3",lightgreen:"90EE90",lightpink:"FFB6C1",lightsalmon:"FFA07A",lightseagreen:"20B2AA",lightskyblue:"87CEFA",lightslategray:"778899",lightslategrey:"778899",lightsteelblue:"B0C4DE",lightyellow:"FFFFE0",lime:"00FF00",limegreen:"32CD32",linen:"FAF0E6",magenta:"FF00FF",maroon:"800000",mediumaquamarine:"66CDAA",mediumblue:"0000CD",mediumorchid:"BA55D3",mediumpurple:"9370D8",mediumseagreen:"3CB371",mediumslateblue:"7B68EE",mediumspringgreen:"00FA9A",mediumturquoise:"48D1CC",mediumvioletred:"C71585",midnightblue:"191970",mintcream:"F5FFFA",mistyrose:"FFE4E1",moccasin:"FFE4B5",navajowhite:"FFDEAD",navy:"000080",oldlace:"FDF5E6",olive:"808000",olivedrab:"6B8E23",orange:"FFA500",orangered:"FF4500",orchid:"DA70D6",palegoldenrod:"EEE8AA",palegreen:"98FB98",paleturquoise:"AFEEEE",palevioletred:"D87093",papayawhip:"FFEFD5",peachpuff:"FFDAB9",peru:"CD853F",pink:"FFC0CB",plum:"DDA0DD",powderblue:"B0E0E6",purple:"800080",red:"FF0000",rosybrown:"BC8F8F",royalblue:"4169E1",saddlebrown:"8B4513",salmon:"FA8072",sandybrown:"F4A460",seagreen:"2E8B57",seashell:"FFF5EE",sienna:"A0522D",silver:"C0C0C0",skyblue:"87CEEB",slateblue:"6A5ACD",slategray:"708090",slategrey:"708090",snow:"FFFAFA",springgreen:"00FF7F",steelblue:"4682B4",tan:"D2B48C",teal:"008080",thistle:"D8BFD8",tomato:"FF6347",turquoise:"40E0D0",violet:"EE82EE",wheat:"F5DEB3",white:"FFFFFF",whitesmoke:"F5F5F5",yellow:"FFFF00",yellowgreen:"9ACD32"};RTE.HtmlImport.WordConverter.$7e=new RegExp("[\x0a|\x0d]","gi")}ms_rte_initialize();RTE.DomHelper=function(){};RTE.DomHelper.focus=function(a){ULSdmo:;if(a.contentWindow){var b=a.contentWindow;if(b.focus)try{b.focus()}catch(c){}}a.setActive&&a.setActive()};RTE.DomHelper.insertAdjacentHtml=function(a,c,e){ULSdmo:;if(a.insertAdjacentHTML)return a.insertAdjacentHTML(c,e);var d=a.ownerDocument.createRange();d.setStartBefore(a);var b=d.createContextualFragment(e);switch(c){case"afterEnd":if(a.nextSibling)a.parentNode.insertBefore(b,a.nextSibling);else a.parentNode.appendChild(b);break;case"beforeBegin":a.parentNode.insertBefore(b,a)}};RTE.DomHelper.insertAdjacentText=function(a,d,c){ULSdmo:;var b=document.createTextNode(c);switch(d){case"afterEnd":if(a.nextSibling&&RTE.RteUtility.isTextNode(a.nextSibling))a.nextSibling.nodeValue=c+a.nextSibling.nodeValue;else if(a.nextSibling)a.parentNode.insertBefore(b,a.nextSibling);else a.parentNode.appendChild(b);break;case"beforeBegin":if(a.previousSibling&&RTE.RteUtility.isTextNode(a.previousSibling))a.previousSibling.nodeValue+=c;else a.parentNode.insertBefore(b,a)}};RTE.DomHelper.insertAdjacentElement=function(a,c,b){ULSdmo:;if(a.insertAdjacentElement)return a.insertAdjacentElement(c,b);switch(c){case"afterEnd":if(a.nextSibling)a.parentNode.insertBefore(b,a.nextSibling);else a.parentNode.appendChild(b);break;case"beforeBegin":a.parentNode.insertBefore(b,a)}};RTE.DomHelper.getKeyCode=function(b){ULSdmo:;var a;if(b.rawEvent)a=b.rawEvent;else a=b;return a.charCode&&a.charCode!=0?a.charCode:a.keyCode?a.keyCode:void 0};RTE.DomHelper.preventDefault=function(b){ULSdmo:;var a;if(b.rawEvent)a=b.rawEvent;else a=b;a.returnValue=false;a.preventDefault&&a.preventDefault()};RTE.DomHelper.createRange=function(a){ULSdmo:;var b;if(a.createRange)b=a.createRange();else if(a.body.createTextRange)b=a.body.createTextRange();else{alert("Browser does not support CBX_GetRange");return}return b};RTE.DomHelper.createRangeFromSelection=function(a){ULSdmo:;if(a.createRange)try{return a.createRange()}catch(c){return null}return a.rangeCount>0?a.getRangeAt(0):null};RTE.DomHelper.duplicateRange=function(a){ULSdmo:;var b;if(a.duplicate)b=a.duplicate();if(a.cloneRange)b=a.cloneRange();return b};RTE.DomHelper.isRangeInRange=function(a,b){ULSdmo:;if(a.inRange)return a.inRange(b);var c=b.compareBoundaryPoints(Range.START_TO_START,a),d=b.compareBoundaryPoints(Range.END_TO_END,a);return c<=0&&d>=0};RTE.DomHelper.pasteHtmlIntoRange=function(a,b){ULSdmo:;if(a.pasteHTML){try{a.pasteHTML(b)}catch(d){a.text="";a.pasteHTML(b)}return}a.extractContents();var c=a.createContextualFragment(b);a.insertNode(c)};RTE.DomHelper.compareRangeEndPoints=function(a,c,b){ULSdmo:;if(a.compareEndPoints)return a.compareEndPoints(c,b);switch(c){case"StartToEnd":return-b.compareBoundaryPoints(Range.START_TO_END,a);break;case"StartToStart":return-b.compareBoundaryPoints(Range.START_TO_START,a);break;case"EndToStart":return-b.compareBoundaryPoints(Range.END_TO_START,a);break;case"EndToEnd":return-b.compareBoundaryPoints(Range.END_TO_END,a)}};RTE.DomHelper.setRangeEndPoint=function(b,c,a){ULSdmo:;if(b.setEndPoint)return b.setEndPoint(c,a);switch(c){case"StartToEnd":return b.setStart(a.endContainer,a.endOffset);break;case"StartToStart":return b.setStart(a.startContainer,a.startOffset);break;case"EndToStart":return b.setEnd(a.startContainer,a.startOffset);break;case"EndToEnd":return b.setEnd(a.endContainer,a.endOffset)}};RTE.DomHelper.isRangeVisible=function(a){ULSdmo:;var d=false,c=false,b=null;if(typeof a.text!=="undefined")b=a.text;else if(typeof a.toString!=="undefined")b=a.toString();d=b!=null&&b!="";if(a.htmlText!=undefined&&a.htmlText!=null&&a.htmlText.indexOf("<IMG")!=-1)c=true;return d||c};var ms_rte_load=function(){ULSdmo:;if(typeof _spBodyOnLoadCalled=="undefined"||_spBodyOnLoadCalled)window.setTimeout(RTE.Canvas.load,0);else _spBodyOnLoadFunctionNames.push("RTE.Canvas.load");_spRteScriptLoaded=true};if(typeof ExecuteAndRegisterBeginEndFunctions!="undefined")ExecuteAndRegisterBeginEndFunctions("ms.rte.js",ms_rte_initialize,null,ms_rte_load);else ms_rte_load();typeof Sys!="undefined"&&Sys&&Sys.Application&&Sys.Application.notifyScriptLoaded();typeof NotifyScriptLoadedAndExecuteWaitingJobs!="undefined"&&NotifyScriptLoadedAndExecuteWaitingJobs("ms.rte.js");typeof spWriteProfilerMark=="function"&&spWriteProfilerMark("perfMarkEnd_ms.rte.js");