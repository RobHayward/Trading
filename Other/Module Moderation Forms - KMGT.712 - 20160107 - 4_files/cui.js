function ULSqdK(){var a={};a.ULSTeamName="Windows SharePoint Services 4";a.ULSFileName="CUI.jss";return a}if("undefined"==typeof g_all_modules)g_all_modules={};g_all_modules["CUI.js"]={version:{rmj:16,rmm:0,rup:5312,rpr:1208}};typeof spWriteProfilerMark=="function"&&spWriteProfilerMark("perfMarkBegin_CUI.js");if(typeof IEnumerator=="undefined"){var IEnumerator=function(){};IEnumerator.prototype={get_current:null,moveNext:null,reset:null};IEnumerator.registerInterface("IEnumerator")}if(typeof IEnumerable=="undefined"){var IEnumerable=function(){};IEnumerable.prototype={getEnumerator:null};IEnumerable.registerInterface("IEnumerable")}Type.registerNamespace("CUI");Type.registerNamespace("CUI.Page");if(typeof CUI.Page.PageComponent=="undefined"){CUI.Page.ICommandHandler=function(){};CUI.Page.ICommandHandler.registerInterface("CUI.Page.ICommandHandler");CUI.Page.PageComponent=function(){};CUI.Page.PageComponent.prototype={init:function(){},getGlobalCommands:function(){a:;return null},getFocusedCommands:function(){a:;return null},handleCommand:function(){a:;return false},canHandleCommand:function(){a:;return false},isFocusable:function(){a:;return false},receiveFocus:function(){a:;return false},yieldFocus:function(){a:;return true},getId:function(){a:;return "PageComponent"}};CUI.Page.PageComponent.registerClass("CUI.Page.PageComponent",null,CUI.Page.ICommandHandler)}Type.registerNamespace("CUI");CUI.IRootBuildClient=function(){};CUI.IRootBuildClient.registerInterface("CUI.IRootBuildClient");CUI.ISelectableControl=function(){};CUI.ISelectableControl.registerInterface("CUI.ISelectableControl");CUI.QueryRecord=function(){};CUI.IDataSource=function(){};CUI.IDataSource.registerInterface("CUI.IDataSource");CUI.GalleryElementDimensions=function(){};CUI.GalleryElementDimensions.prototype={size16by16:1,size32by32:2,size48by48:3,size64by48:4,size72by96:5,size96by72:6,size96by96:7,size128by128:8,size190by30:9,size190by40:10,size190by50:11,size190by60:12,sizeCustom:13};CUI.GalleryElementDimensions.registerEnum("CUI.GalleryElementDimensions",false);CUI.IMenuItem=function(){};CUI.IMenuItem.registerInterface("CUI.IMenuItem");CUI.DeclarativeTemplateBuildContext=function(){};CUI.IRootUser=function(){};CUI.IRootUser.registerInterface("CUI.IRootUser");CUI.CommandInformation=function(){a:;this.CommandId=null;this.RootId=null;this.TabId=null;this.RootType=null;this.RootLocation=null};CUI.IModalController=function(){};CUI.IModalController.registerInterface("CUI.IModalController");CUI.DisabledCommandInfoProperties=function(){a:;this.Description=null;this.Title=null;this.Icon=null;this.IconClass=null;this.IconTop=null;this.IconLeft=null;this.HelpKeyWord=null};CUI.PMarker=function(){};CUI.PMarker.prototype={beginSession:1,endSession:2,perfCUIRibbonInitStart:7103,perfCUIRibbonInitPercvdEnd:7104,perfCUIRibbonTabSwitchWarmStart:7105,perfCUIRibbonTabSwitchWarmPercvdEnd:7106,perfCUIRibbonTabSwitchWarmEnd:7107,perfCUIRibbonCompleteConstruction:7108,perfCUIRibbonQueryDataStart:7109,perfCUIRibbonQueryDataEnd:7110,perfWSSWikiUpdatePanelStart:7111,perfWSSWikiUpdatePanelEnd:7112,perfWSSWebPartComponentMouseClickStart:7186,perfWSSWebPartComponentMouseClickEnd:7187,perfCUIAddAndPositionBackFrameStart:7188,perfCUIAddAndPositionBackFrameEnd:7189,perfCUIFlyoutAnchorOnClickStart:7190,perfCUIFlyoutAnchorOnClickEnd:7191,perfCUIDropDownOnArrowButtonClickStart:7192,perfCUIDropDownOnArrowButtonClickEnd:7193,perfWSSBreadcrumbStart:7386,perfWSSBreadcrumbEnd:7387,perfWSSSelectOrDeselectAllStart:7388,perfWSSSelectOrDeselectAllEnd:7389,perfWSSSelectItemStart:7390,perfWSSSelectItemEnd:7391,perfWSSFilterSortStart:7392,perfWSSFilterSortEnd:7393,perfWSSMMUOpenStart:7394,perfWSSMMUOpenEnd:7395,perfWSSECBClickStart:7396,perfWSSECBClickEnd:7397,perfSPSSaveStatusNoteBegin:7634,perfSPSSaveStatusNoteEnd:7635,perfWSSCalendarRenderStart:7644,perfWSSCalendarRenderEnd:7645,perfPLTxInstrumentStart:7698,perfPLTxInstrumentEnd:7699,perfCUIRibbonButtonOnClickStart:7700,perfCUIRibbonButtonOnClickEnd:7701,perfCUIRibbonInsertTableOnClickStart:7702,perfCUIRibbonInsertTableOnClickEnd:7703,perfCUIRibbonToggleButtonOnClickStart:7704,perfCUIRibbonToggleButtonOnClickEnd:7705,perfWSSDialogShow:7706,perfWSSDialogClosed:7707,perfWSSRTEDialogOnLoadEnd:7708,perfWSSRTEDialogOnOkButtonClickStart:7709,perfWSSRTEAutoCompleteSetResultsStart:7710,perfWSSRTEAutoCompleteSetResultsEnd:7711,perfCUIRibbonEditWikiPageStart:7735,perfCUIRibbonEditWikiPageEnd:7736,perfSPCalloutOpenStart:7901,perfSPCalloutOpenEnd:7902,perfSPCalloutCloseStart:7903,perfSPCalloutCloseEnd:7904,perfSPCreateAjaxMenuForCalloutStart:7905,perfSPCreateAjaxMenuForCalloutEnd:7906,perfSPCreateAjaxMenuForCalloutCallbackStart:7907,perfSPCreateAjaxMenuForCalloutCallbackEnd:7908,perfSPMyDocsExpCollHeadersStart:7909,perfSPMyDocsExpCollHeadersEnd:7910,perfSPMyDocsOnOpenedCallbackStart:7911,perfSPMyDocsOnOpenedCallbackEnd:7912,perfSPMyDocsRenderSharedWithStart:7913,perfSPMyDocsRenderSharedWithEnd:7914,perfDocMoveIsValidDestinationStart:8507,perfDocMoveIsValidDestinationEnd:8508,perfDocMoveGetDocumentUrlsStart:8509,perfDocMoveGetDocumentUrlsEnd:8510,perfDocMoveMoveDocumentStart:8511,perfDocMoveMoveDocumentEnd:8512,perfDocMoveCopyDocumentStart:8513,perfDocMoveCopyDocumentEnd:8514,perfDocMoveVerifyDestinationAsyncBegin:8515,perfDocMoveVerifyDestinationAsyncEnd:8516,perfDocMoveGetDocumentUrlsAsyncBegin:8517,perfDocMoveGetDocumentUrlsAsyncEnd:8518,perfDocMoveMoveDocumentAsyncBegin:8519,perfDocMoveMoveDocumentAsyncEnd:8520,perfDocMoveMoveSelectedDocsAsyncBegin:8521,perfDocMoveMoveSelectedDocsAsyncEnd:8522,perfSPMyDocsSharedWithMeRefreshViewStart:9007,perfSPMyDocsSharedWithMeRefreshViewEnd:9008,perfSPMyDocsSharingHintRefreshStart:9009,perfSPMyDocsSharingHintRefreshEnd:9010,perfDocMoveCreateDocumentFoldersAsyncBegin:9096,perfDocMoveCreateDocumentFoldersAsyncEnd:9097,perfDocMoveGetDocumentFoldersAsyncBegin:9098,perfDocMoveGetDocumentFoldersAsyncEnd:9099,perfSPFollowContentBegin:9206,perfSPFollowDocEnd:9207,perfSPFollowSiteEnd:9208,perfSPStopFollowContentBegin:9209,perfSPStopFollowContentEnd:9210,perfSPMPUpdateUIStart:10467,perfSPMPUpdateUIEnd:10468,perfSPMPUpdateViewToMatchStateEnd:10469,perfSPMPUpdateViewToMatchStateStart:10470,perfSPMPListItemSelectionChangedStart:10471,perfSPMPListItemSelectionChangedEnd:10472,perfSPMPStartWithDefault:10473,perfSPMPUpdateUIAndStateStart:10474,perfSPMPUpdateUIAndStateEnd:10475};CUI.PMarker.registerEnum("CUI.PMarker",false);CUI.BuildOptions=function(){};CUI.BuildOptions.prototype={lazyMenuInit:false,trimmedIds:null,attachToDOM:false,validateServerRendering:false,fixedPositioningEnabled:false,dataExtensions:null,clientID:null,percentPositivePattern:0,decimalSeparator:"."};CUI.BuildContext=function(){};CUI.DataNodeWrapper=function(a){this.$f_0=a};CUI.DataNodeWrapper.getFirstChildNodeWithName=function(f,g){for(var c=CUI.DataNodeWrapper.getNodeChildren(f),d=c.length,a=null,b=0;b<d;b++){a=c[b];var e=a.name;if(e===g)return a}return null};CUI.DataNodeWrapper.getNodeName=function(a){return a.name};CUI.DataNodeWrapper.getNodeChildren=function(b){if(CUI.ScriptUtility.isNullOrUndefined(b))return CUI.DataNodeWrapper.get_$9I();var a=b.children;if(CUI.ScriptUtility.isNullOrUndefined(a))return CUI.DataNodeWrapper.get_$9I();return a};CUI.DataNodeWrapper.get_$9I=function(){a:;if(CUI.ScriptUtility.isNullOrUndefined(CUI.DataNodeWrapper.$6x))CUI.DataNodeWrapper.$6x=[];return CUI.DataNodeWrapper.$6x};CUI.DataNodeWrapper.getNodeAttributes=function(a){return a.attrs};CUI.DataNodeWrapper.getNodeAttribute=function(b,c){var a=b.attrs;return a[c]};CUI.DataNodeWrapper.prototype={$f_0:null,get_node:function(){a:;return this.$f_0},set_node:function(a){this.$f_0=a;return a},get_name:function(){a:;return CUI.DataNodeWrapper.getNodeName(this.$f_0)},get_children:function(){a:;return CUI.DataNodeWrapper.getNodeChildren(this.$f_0)},get_attributes:function(){a:;return CUI.DataNodeWrapper.getNodeAttributes(this.$f_0)},get_hasChildren:function(){a:;return CUI.DataNodeWrapper.getNodeChildren(this.$f_0).length>0}};CUI.Builder=function(c,b,a){a:;this.$$d_$Bb_0=Function.createDelegate(this,this.$Bb_0);this.$$d_$8M_0=Function.createDelegate(this,this.$8M_0);this.$12_0=c;if(CUI.ScriptUtility.isNullOrUndefined(this.$12_0.trimmedIds))this.$12_0.trimmedIds={};this._elmPlaceholder=b;this.$26_0=a;this.$1a_0=this.$$d_$8M_0;$addHandler(window,"unload",this.$1a_0)};CUI.Builder.$98=function(b){var a=CUI.NativeUtility.createXMLDocFromString(b);if(CUI.ScriptUtility.isNullOrUndefined(a))return null;return CUI.Builder.$BM(a)};CUI.Builder.$BM=function(b){var a=CUI.Builder.convertNodeToJSON(b.documentElement);return window.JSON.parse(a)};CUI.Builder.convertNodeToJSON=function(b){a:;var a;a="{";a+='"name" : "';a+=CUI.NativeUtility.ecmaScriptStringLiteralEncode(b.nodeName);a+='",';a+='"attrs": {';var f=b.attributes;if(!CUI.ScriptUtility.isNullOrUndefined(b.attributes)){var g=f.length;if(g>0)for(var h=true,d=0;d<g;d++){var i=f.item(d);if(h)h=false;else a+=",";a+='"';a+=CUI.NativeUtility.ecmaScriptStringLiteralEncode(i.name);a+='"';a+=':"';a+=CUI.NativeUtility.ecmaScriptStringLiteralEncode(i.value);a+='"'}}a+="}";var c=b.childNodes;if(c){var j=c.length;if(j>0){a+=",";a+='"children":[';for(var k=true,e=0;e<j;e++){var l=c[e];if(l.nodeName==="#text")continue;if(k)k=false;else a+=",";a+=CUI.Builder.convertNodeToJSON(l)}a+="]"}}a+="}";return a};CUI.Builder.applyDataNodeExtensions=function(a,f){a:;if(CUI.ScriptUtility.isNullOrUndefined(a))return a;var m=a.attrs;if(CUI.ScriptUtility.isNullOrUndefined(m))return a;var n=m["Id"],g=f[n];if(!CUI.ScriptUtility.isNullOrUndefined(g)){for(var d=null,p=Number.MAX_VALUE,v=g.length,i=0;i<v;i++){var e=g[i];if(!e)return null;var q=CUI.DataNodeWrapper.getNodeAttribute(e,"Sequence");if(CUI.ScriptUtility.isNullOrUndefined(q)){if(CUI.ScriptUtility.isNullOrUndefined(d))d=e;continue}var r=parseInt(q);if(r<p){d=e;p=r}}if(!CUI.ScriptUtility.isNullOrUndefined(d))a=d}var b=a["children"];if(CUI.ScriptUtility.isNullOrUndefined(b)){b=[];a["children"]=b}for(var c=[],t=b.length,j=0;j<t;j++)Array.add(c,b[j]);var h=f[n+"._children"];if(!CUI.ScriptUtility.isNullOrUndefined(h)){for(var w=h.length,k=0;k<w;k++)Array.add(c,h[k]);c.sort(CUI.Builder.$BJ)}for(var o=[],u=c.length,l=0;l<u;l++){var s=CUI.Builder.applyDataNodeExtensions(c[l],f);!CUI.ScriptUtility.isNullOrUndefined(s)&&Array.add(o,s)}a["children"]=o;return a};CUI.Builder.$BJ=function(e,f){var a=CUI.DataNodeWrapper.getNodeAttribute(e,"Sequence"),b=CUI.DataNodeWrapper.getNodeAttribute(f,"Sequence");if(CUI.ScriptUtility.isNullOrUndefined(b)&&CUI.ScriptUtility.isNullOrUndefined(a))return 0;if(CUI.ScriptUtility.isNullOrUndefined(b))return -1;if(CUI.ScriptUtility.isNullOrUndefined(a))return 1;var c=parseInt(a),d=parseInt(b);if(c<d)return -1;else if(c>d)return 1;return 0};CUI.Builder.prototype={$26_0:null,$1a_0:null,$8M_0:function(){this.dispose()},$8N_0:function(a){a.$34_1=this.$12_0.fixedPositioningEnabled},dispose:function(){a:;this.$0_0=null;this.$12_0=null;this._elmPlaceholder=null;this.$26_0=null;this.$x_0=null;$removeHandler(window,"unload",this.$1a_0);this.$1a_0=null},$0_0:null,get_root:function(){a:;return this.$0_0},set_root:function(a){a:;this.$0_0=a;return a},$2f_0:false,get_inQuery:function(){a:;return this.$2f_0},set_inQuery:function(a){a:;this.$2f_0=a;return a},$x_0:null,get_dataSource:function(){a:;return this.$x_0},set_dataSource:function(a){a:;this.$x_0=a;return a},_elmPlaceholder:null,get_placeholder:function(){a:;return this._elmPlaceholder},$12_0:null,isIdTrimmed:function(a){a:;return this.$12_0.trimmedIds[a]},isNodeTrimmed:function(a){a:;var b=CUI.DataNodeWrapper.getNodeAttribute(a,"Id");return this.$12_0.trimmedIds[b]},$5M_0:function(a,c){var b=null,d=a.name;switch(d){case "ToggleButton":b=this.$BG_0(a,c);break;case "ComboBox":b=this.$Ax_0(a,c);break;case "DropDown":b=this.$Ay_0(a,c);break;case "Button":b=this.$Au_0(a,c);break;case "SplitButton":b=this.$BD_0(a,c);break;case "FlyoutAnchor":b=this.$Az_0(a,c);break;case "GalleryButton":b=this.$92_0(a,c,null);break;case "InsertTable":b=this.$B2_0(a,c);break;case "Label":b=this.$B5_0(a,c);break;case "MRUSplitButton":b=this.$B7_0(a,c);break;case "Spinner":b=this.$BB_0(a,c);break;case "TextBox":b=this.$BF_0(a,c);break;case "ColorPicker":b=this.$Aw_0(a,c);break;case "CheckBox":b=this.$Av_0(a,c);break;case "Separator":b=this.$BA_0(a,c);break;default:var e=a.attrs,f=e["Classname"];if(CUI.ScriptUtility.isNullOrUndefined(f))throw Error.create("Unable to create Control with tagname: "+d)}return b},$3r_0:function(c,d,e){var a=c.attrs,b=this.$0_0.$9E_1(a["Id"],a["Title"],a["Description"],a["MaxWidth"]);if(this.$12_0.lazyMenuInit&&e){b.$8Y_0(this.$$d_$Bb_0,c,d);return b}this.$9N_0(b,c,d);return b},$9N_0:function(g,h,i){for(var c=CUI.DataNodeWrapper.getNodeChildren(h),e=c.length,a=null,b=0;b<e;b++){a=c[b];var d=a.name;if(d!=="MenuSection")throw Error.create("Tags with the name: "+d+" cannot be children of Menu tags.");if(this.isNodeTrimmed(a))continue;var f=this.$B6_0(a,i);g.addChild(f)}},$Bb_0:function(b,c,d){var a=b;this.$9N_0(a,c,d);a.$8L_0(true);return a},$B6_0:function(c,i){var a=c.attrs,b=a["DisplayMode"];if(CUI.ScriptUtility.isNullOrUndefined(b))b="Menu";var d=this.$0_0.$9F_1(a["Id"],a["Title"],a["Description"],a["Scrollable"]==="true",a["MaxHeight"],b),g=CUI.DataNodeWrapper.getNodeName(CUI.DataNodeWrapper.getNodeChildren(c)[0]);if(g==="Controls")for(var h=CUI.DataNodeWrapper.getNodeChildren(CUI.DataNodeWrapper.getNodeChildren(c)[0]),j=h.length,e=null,f=0;f<j;f++){e=h[f];if(this.isNodeTrimmed(e))continue;var k=this.$5M_0(e,i);d.addChild(k.createComponentForDisplayMode(b))}else if(g==="Gallery"){var l=this.$B0_0(CUI.DataNodeWrapper.getNodeChildren(c)[0],i,true);d.addChild(l)}return d},$B0_0:function(e,i,l){for(var f=e.attrs,b=e.attrs,g=this.$0_0.$BS_1(b.Id,f["Title"],f["Description"],b),j=l?"Menu":"Default",h=CUI.DataNodeWrapper.getNodeChildren(e),k=h.length,a=null,c=0;c<k;c++){a=h[c];if(this.isNodeTrimmed(a))continue;var d;switch(CUI.DataNodeWrapper.getNodeName(a)){case "GalleryButton":d=this.$92_0(a,i,b.ElementDimensions);break;default:d=this.$5M_0(a,i)}g.addChild(d.createComponentForDisplayMode(j))}return g},$92_0:function(d,g,a){var b;if(CUI.ScriptUtility.isNullOrEmptyString(a)){var f=d.attrs;a=f["ElementDimensions"]}if(CUI.ScriptUtility.isNullOrEmptyString(a))b=2;else b=CUI.Gallery.$97(a);var c=d.attrs,e=new CUI.Controls.GalleryButton(this.$0_0,c.Id,c,b);return e},$BG_0:function(c){var a=c.attrs,b=new CUI.Controls.ToggleButton(this.$0_0,a.Id,a);return b},$Av_0:function(c){var a=c.attrs,b=new CUI.Controls.CheckBox(this.$0_0,a.Id,a);return b},$Aw_0:function(h){for(var e=h.attrs,d=CUI.DataNodeWrapper.getNodeChildren(CUI.DataNodeWrapper.getFirstChildNodeWithName(h,"Colors")),f=new Array(d.length),i=d.length,c=0;c<i;c++){var a=new CUI.Controls.ColorStyle,b=CUI.DataNodeWrapper.getNodeAttributes(d[c]),g=b["Title"];a.Title=CUI.ScriptUtility.isNullOrUndefined(g)?b["Alt"]:g;a.Color=b["Color"];a.DisplayColor=b["DisplayColor"];a.Style=b["Style"];f[c]=a}var j=new CUI.Controls.ColorPicker(this.$0_0,e.Id,e,f);return j},$Ax_0:function(d,r){var e=d.attrs,f=CUI.DataNodeWrapper.getNodeChildren(d),g=null,l=d.attrs,a=null;if(!CUI.Utility.$u(l.PopulateDynamically)){g=this.$3r_0(f[0],r,false);a={};for(var i=CUI.DataNodeWrapper.getNodeChildren(f[0]),m=i.length,b=0;b<m;b++)for(var n=CUI.DataNodeWrapper.getNodeChildren(i[b]),j=CUI.DataNodeWrapper.getNodeChildren(n[0]),o=j.length,c=0;c<o;c++){var k=j[c].attrs,p=k["LabelText"],q=k["MenuItemId"];a[p]=q}}var h=new CUI.Controls.ComboBox(this.$0_0,e.Id,e,g);h.set_menuItems(a);return h},$Ay_0:function(a,g){var b=a.attrs,d=CUI.DataNodeWrapper.getNodeChildren(a),c=null,e=a.attrs;if(!CUI.Utility.$u(e.PopulateDynamically))c=this.$3r_0(d[0],g,false);var f=new CUI.Controls.DropDown(this.$0_0,b.Id,b,c);return f},$Au_0:function(c){var a=c.attrs,b=new CUI.Controls.Button(this.$0_0,a.Id,a);return b},$BD_0:function(c,f){var a=c.attrs,d=CUI.DataNodeWrapper.getNodeChildren(c),b=null;if(!CUI.Utility.$u(a.PopulateDynamically))b=this.$3r_0(d[0],f,true);var e=new CUI.Controls.SplitButton(this.$0_0,a.Id,a,b);return e},$Az_0:function(a,g){var b=a.attrs,d=CUI.DataNodeWrapper.getNodeChildren(a),c=null,e=a.attrs;if(!CUI.Utility.$u(e.PopulateDynamically))c=this.$3r_0(d[0],g,true);var f=new CUI.Controls.FlyoutAnchor(this.$0_0,b.Id,b,c);return f},$B2_0:function(c){var a=c.attrs,b=new CUI.Controls.InsertTable(this.$0_0,a.Id,a);return b},$B5_0:function(c){var a=c.attrs,b=new CUI.Controls.Label(this.$0_0,a.Id,a);return b},$B7_0:function(a,g){var b=a.attrs,d=CUI.DataNodeWrapper.getNodeChildren(a),c=null,e=a.attrs;if(!CUI.Utility.$u(e.PopulateDynamically))c=this.$3r_0(d[0],g,false);var f=new CUI.Controls.MRUSplitButton(this.$0_0,b.Id,b,c);return f},$BA_0:function(c){var a=c.attrs,b=new CUI.Controls.Separator(this.$0_0,a.Id,a);return b},$BB_0:function(c){var a=c.attrs,b=this.$BC_0(c),d=new CUI.Controls.Spinner(this.$0_0,a.Id,a,b.units,b.allowedStrings);return d},$BF_0:function(c){var a=c.attrs,b=new CUI.Controls.TextBox(this.$0_0,a.Id,a);return b},$7r_0:function(a){if(typeof a==="string")return parseFloat(a);return a},$BL_0:function(a){if(typeof a==="string")return parseInt(a);return a},$BC_0:function(i){for(var d=CUI.DataNodeWrapper.getNodeChildren(i),e=[],f=[],h=d.length,b=0;b<h;b++){var c=d[b],g=CUI.DataNodeWrapper.getNodeName(c),a=CUI.DataNodeWrapper.getNodeAttributes(c);if(g==="Unit")Array.add(e,CUI.Controls.Spinner.createUnit(a["Name"],this.$BH_0(CUI.DataNodeWrapper.getNodeChildren(c)),this.$7r_0(a["MinimumValue"]),this.$7r_0(a["MaximumValue"]),this.$BL_0(a["DecimalDigits"]),this.$7r_0(a["Interval"])));else g==="AllowedText"&&Array.add(f,a["Value"])}return new CUI.Builder.SpinnerChildren(e,f)},$BH_0:function(b){for(var c=new Array(b.length),d=b.length,a=0;a<d;a++){var e=b[a],f=CUI.DataNodeWrapper.getNodeAttributes(e);c[a]=f["Value"]}return c},applyDataExtensions:function(a){a:;if(!CUI.ScriptUtility.isNullOrUndefined(a)&&!CUI.ScriptUtility.isNullOrUndefined(this.$12_0.dataExtensions))return CUI.Builder.applyDataNodeExtensions(a,this.$12_0.dataExtensions);else return a}};CUI.Builder.SpinnerChildren=function(a,b){this.units=a;this.allowedStrings=b};CUI.Builder.SpinnerChildren.prototype={units:null,allowedStrings:null};CUI.CommandEventArgs=function(a,b,c,d){CUI.CommandEventArgs.initializeBase(this);this.$6_1=a;this.$37_1=d;this.$3A_1=c;this.$I_1=b};CUI.CommandEventArgs.prototype={$6_1:null,$6N_1:0,$37_1:null,$3A_1:null,$I_1:0,$5e_1:null,get_id:function(){a:;return this.$6_1},get_parameters:function(){a:;return this.$37_1},get_sequenceNumber:function(){a:;return this.$6N_1},set_sequenceNumber:function(a){this.$6N_1=a;return a},get_source:function(){a:;return this.$3A_1},get_sourceControl:function(){a:;if(!CUI.ScriptUtility.isNullOrUndefined(this.$3A_1)&&CUI.ControlComponent.isInstanceOfType(this.$3A_1))return this.$3A_1.$N_1;return null},get_type:function(){a:;return this.$I_1},get_properties:function(){a:;return this.$37_1},get_commandInfo:function(){a:;if(CUI.ScriptUtility.isNullOrUndefined(this.$5e_1))this.$5e_1=new CUI.CommandInformation;return this.$5e_1}};CUI.Component=function(c,d,b,a){a:;this._componentWidth=-1;this._componentHeight=-1;this._componentTopPosition=-1;this._componentLeftPosition=-1;this.$6_0=d;this.$0_0=c;this.$1N_0=b;this.$5k_0=a;this.createChildArray()};CUI.Component.prototype={$6_0:null,$2y_0:null,$M_0:null,$0_0:null,$8_0:null,$i_0:true,$3p_0:true,$1Y_0:true,$4F_0:false,$5k_0:null,$1N_0:null,createChildArray:function(){a:;this.$7t_0()},$7t_0:function(){a:;if(CUI.ScriptUtility.isNullOrUndefined(this.$8_0))this.$8_0=new CUI.List},get_id:function(){a:;return this.$6_0},set_id:function(a){a:;this.$6_0=a;return a},get_$3_0:function(){a:;return this.$2y_0},set_$3_0:function(a){this.$2y_0=a;return a},get_root:function(){a:;return this.$0_0},get_parent:function(){a:;return this.$M_0},set_parent:function(a){a:;this.$M_0=a;return a},$17_0:function(){},$6c_0:function(){a:;return false},$6b_0:function(){a:;return false},$80_0:function(){},$82_0:function(){},$81_0:function(){return false},$9h_0:function(c){var a=this.$8_0.getEnumerator();while(a.moveNext()){var b=a.get_current();if(b.$6_0===c)return b}return null},getChild:function(a){a:;return this.$9h_0(a)},getChildByTitle:function(c){a:;var a=this.$8_0.getEnumerator();while(a.moveNext()){var b=a.get_current();if(b.get_title()===c)return b}return null},addChild:function(a){a:;this.$3q_0(a,true)},$3q_0:function(a,b){this.$8t_0(a,-1,b)},addChildAtIndex:function(a,b){a:;this.$8t_0(a,b,true)},$8t_0:function(a,b,c){c&&this.ensureCorrectChildType(a);if(!CUI.ScriptUtility.isNullOrUndefined(a.$M_0))throw Error.create("This child cannot be added because it has already been added \n to another Component in the hierarchy.  \n You must first call child.Parent.RemoveChild(child)");if(b===-1)this.$8_0.add(a);else this.$8_0.insert(b,a);a.$M_0=this;this.$11_0()},removeChild:function(b){a:;var a=this.$9h_0(b);if(CUI.ScriptUtility.isNullOrUndefined(a))throw Error.create("The child with id: "+b+" is not as child of this Component");this.$8_0.remove(a);a.$M_0=null;this.$11_0()},removeChildren:function(){a:;var a=this.$8_0.getEnumerator();while(a.moveNext()){var b=a.get_current();if(b)b.$M_0=null}this.$8_0.clear();this.$11_0()},ensureCorrectChildType:function(){a:;return},initRootMember:function(a){a:;if(!CUI.ScriptUtility.isNullOrUndefined(this.$0_0))throw Error.create("Root member has already been set for this Component.");this.$0_0=a},get_visible:function(){a:;return this.$3p_0},set_visible:function(a){a:;this.set_$74_0(a);return a},set_$74_0:function(a){var b=this.$3p_0;this.$3p_0=a;b!==this.$3p_0&&this.$11_0();return a},get_enabled:function(){a:;return this.$1Y_0},set_enabled:function(a){a:;if(this.$1Y_0===a&&this.$4F_0)return a;if(!CUI.ScriptUtility.isNullOrUndefined(this.$M_0)&&!this.$M_0.get_enabled()&&a)throw Error.create("This Component with id: "+this.$6_0+" cannot be Enabled because its parent is Disabled");this.$1Y_0=a;this.$4F_0=true;var b=this.$8_0.getEnumerator();while(b.moveNext()){var c=b.get_current();c.set_enabled(a)}this.onEnabledChanged(a);return a},onEnabledChanged:function(){},get_title:function(){a:;return this.$1N_0},set_title:function(a){a:;this.$1N_0=a;this.$11_0();return a},get_description:function(){a:;return this.$5k_0},set_description:function(a){a:;this.$5k_0=a;this.$11_0();return a},_lastWidthUpdate:0,_lastHeightUpdate:0,get_$BK_0:function(){a:;return this._componentHeight},_lastTopUpdate:0,get_$95_0:function(){a:;return this._componentTopPosition},_lastLeftUpdate:0,valueIsDirty:function(a){a:;if(CUI.Ribbon.isInstanceOfType(this.$0_0)){var b=this.$0_0;return a<b.get_$CR_3()}return false},$8Z_0:function(b){this.$i_0=b;if(CUI.ScriptUtility.isNullOrUndefined(this.$8_0))return;var a=this.$8_0.getEnumerator();while(a.moveNext()){var c=a.get_current();c.$8Z_0(b)}},$11_0:function(){a:;if(this.$i_0||this.$4G_0)return;this.$i_0=true;!CUI.ScriptUtility.isNullOrUndefined(this.$M_0)&&this.$M_0.$11_0()},$4G_0:false,$2A_0:function(){a:;this.$i_0=false},$3G_0:function(){a:;this.$i_0&&this.$2A_0()},$4Y_0:function(b){this.$6Z_0();this.$X_0();this.$i_0=false;if(b)if(!CUI.ScriptUtility.isNullOrUndefined(this.$8_0)){var a=this.$8_0.getEnumerator();while(a.moveNext()){var c=a.get_current();c.$4Y_0(b)}}},$6Z_0:function(){a:;var a=$get(this.$6_0);if(!CUI.ScriptUtility.isNullOrUndefined(a))this.set_$3_0(a);else throw Error.create("Attempting to attach to Id: "+this.$6_0+" but this id is not present in the DOM")},$X_0:function(){},$1x_0:function(){a:;if(!this.$2y_0){this.$2y_0=CUI.Utility.$4(this.get_domElementTagName());this.$2y_0.className=this.get_cssClass();this.$2y_0.id=this.$6_0}},get_domElementTagName:function(){a:;return "span"},get_cssClass:function(){a:;return ""},get_visibleInDOM:function(){a:;if(CUI.ScriptUtility.isNullOrUndefined(this.$M_0))return false;return this.$M_0.get_visibleInDOM()},$8d_0:function(){a:;if(!this.get_visible())return false;var a=this.$8_0.getEnumerator();while(a.moveNext()){var b=a.get_current();if(b.$8d_0())return true}return false},ensureDOMElementAndEmpty:function(){a:;if(CUI.ScriptUtility.isNullOrUndefined(this.get_$3_0()))this.$1x_0();else this.set_$3_0(CUI.Utility.removeChildNodes(this.get_$3_0()))},appendChildrenToElement:function(d){a:;var c=document.createDocumentFragment(),b=this.$8_0.getEnumerator();while(b.moveNext()){var a=b.get_current();a.$1x_0();c.appendChild(a.get_$3_0());a.$3G_0()}d.appendChild(c)},raiseCommandEvent:function(b,d,a){a:;var c=this.$0_0.$BP_1(b,d,this,a);this.$AN_0(c)},$AN_0:function(a){this.$3J_0(a)&&!CUI.ScriptUtility.isNullOrUndefined(this.$M_0)&&this.$M_0.$AN_0(a);this.$AF_0(a)},$3J_0:function(){return true},$AF_0:function(){},getTextValue:function(){a:;return null},receiveFocus:function(){},onMenuClosed:function(){a:;if(CUI.ScriptUtility.isNullOrUndefined(this.$8_0))return;var a=this.$8_0.getEnumerator();while(a.moveNext()){var b=a.get_current();b.onMenuClosed()}},$3P_0:null,$4u_0:null,$4v_0:null,$8Y_0:function(a,b,c){this.$3P_0=a;this.$4u_0=b;this.$4v_0=c},$5j_0:false,doDelayedInit:function(){a:;if(this.$5j_0)return;if(CUI.ScriptUtility.isNullOrUndefined(this.$3P_0))throw Error.create("No delayedinit handler present in this component: "+this.$6_0);this.$5j_0=true;this.$3P_0(this,this.$4u_0,this.$4v_0)},$8L_0:function(a){if(a){this.$3P_0=null;this.$4u_0=null;this.$4v_0=null;this.$11_0()}this.$5j_0=false},get_needsDelayIniting:function(){a:;return !CUI.ScriptUtility.isNullOrUndefined(this.$3P_0)},$4i_0:function(){a:;var a=this.$8_0.getEnumerator();while(a.moveNext()){var b=a.get_current();b.$4i_0()}},$4I_0:null,get_$4g_0:function(){a:;if(CUI.ScriptUtility.isNullOrUndefined(this.$4I_0)){this.$4I_0=new Date;this.$4I_0.setTime(0)}return this.$4I_0},set_$4g_0:function(a){this.$4I_0=a;return a},get_$AP_0:function(){a:;return this.get_$4g_0().getTime()<this.$0_0.get_$4g_0().getTime()},$AL_0:function(){a:;this.get_$AP_0()&&this.$4i_0()},dispose:function(){a:;if(!CUI.ScriptUtility.isNullOrUndefined(this.$8_0)){var a=this.$8_0.getEnumerator();while(a.moveNext()){var b=a.get_current();b.dispose()}this.$8_0=null}this.$M_0=null;this.$0_0=null;this.$4u_0=null;this.$3P_0=null;this.$4v_0=null;this.$2y_0=null}};CUI.ContextMenu=function(a,b,c,d,e){CUI.ContextMenu.initializeBase(this,[a,b,c,d,e])};CUI.ContextMenu.prototype={$2A_0:function(){a:;this.get_needsDelayIniting()&&this.doDelayedInit();this.ensureDOMElementAndEmpty();if(CUI.ScriptUtility.isNullOrUndefined(this.$Q_1)){this.$Q_1=CUI.Utility.$4("div");this.$Q_1.className="ms-cui-contextmenu-inner"}this.get_$3_0().appendChild(this.$Q_1);this.appendChildrenToElement(this.$Q_1);CUI.Menu.prototype.$2A_0.call(this)},get_cssClass:function(){a:;return "ms-cui-contextmenu"}};CUI.ContextMenuLauncher=function(a,b,c,d){CUI.ContextMenuLauncher.initializeBase(this,[a,b,c,d])};CUI.ContextMenuLauncher.prototype={$5B_2:null,$6U_2:null,$7m_2:0,$7n_2:0,$CS_2:function(a,b){this.$6U_2=b;this.$5B_2=this.getMenuPosition(a,null);if(this.launchMenu(null)){this.$AO_2();this.$D_1.$80_0()}return true},launchContextMenuAt:function(a,b,c){this.$7m_2=b;this.$7n_2=c;this.$6U_2=a;if(this.launchMenu(null)){this.$AO_2();this.$D_1.$80_0()}return true},positionMenu:function(b){if(this.$5B_2){this.$D_1.get_$3_0().style.top=this.$5B_2.y+"px";this.$D_1.get_$3_0().style.left=this.$5B_2.x+"px";this.$D_1.get_$3_0().style.position="absolute"}else{b.style.top="0px";b.style.left="0px";var a=this.$0_0.$89_1(b,this.$6U_2);a["launcherLeft"]=this.$7m_2;a["launcherTop"]=this.$7n_2;a["launcherWidth"]=0;a["launcherHeight"]=0;this.$0_0.$8a_1(b,a,this.get_menuDirection())}},getMenuPosition:function(a){var b=new Sys.UI.Bounds(0,0,0,0);if(!a)a=window.event;b.y=a.clientY;b.x=a.clientX;return b},$AO_2:function(){a:;this.$7_0.Command&&this.get_displayedComponent().raiseCommandEvent(this.$7_0.Command,4,null)}};CUI.ContextMenuRootProperties=function(){a:;CUI.ContextMenuRootProperties.initializeBase(this)};CUI.ContextMenuRootProperties.prototype={CommandMenuOpen:null,CommandMenuClose:null};CUI.ContextMenuRoot=function(b,a){a:;CUI.ContextMenuRoot.initializeBase(this,[b,a])};CUI.ContextMenuRoot.prototype={refresh:function(){a:;this.$2A_0();CUI.Root.prototype.$2A_0.call(this)},$2A_0:function(){a:;CUI.ScriptUtility.isNullOrUndefined(this.get_$3_0())&&this.$1x_0();this.set_$3_0(CUI.Utility.removeChildNodes(this.get_$3_0()));this.appendChildrenToElement(this.get_$3_0());this.$i_0=false},get_rootType:function(){a:;return "ContextMenu"},get_contextMenuRootProperties:function(){a:;return this.$7_1},ensureCorrectChildType:function(a){a:;if(!CUI.StandaloneDock.isInstanceOfType(a))throw Error.create("Only children of type StandaloneDock can be added to a ContextMenuRoot")},createContextMenu:function(a,b,f,e){a:;var g=new CUI.ContextMenu(this,b,f,e,null);if(!a)a=new CUI.Controls.ContextMenuControlProperties;a.CommandMenuOpen=this.get_contextMenuRootProperties().CommandMenuOpen;a.CommandMenuClose=this.get_contextMenuRootProperties().CommandMenuClose;var c=new CUI.Controls.ContextMenuControl(this,b+"Launcher",a,g);this.$2E_2[b]=c;var d=new CUI.StandaloneDock(this,"dock"+b);d.addChild(c.createComponentForDisplayMode("Menu"));this.addChild(d);this.refresh()},showContextMenuAt:function(b,c,d,e){a:;var a=this.$2E_2[b];if(CUI.ScriptUtility.isNullOrUndefined(a))throw Error.create('The context menu "'+b+'" does not exist');a.launchContextMenuAt(c,d,e)}};CUI.ControlProperties=function(){};CUI.ControlProperties.prototype={Command:null,Id:null,TemplateAlias:null,ToolTipDescription:null,ToolTipHelpKeyWord:null,ToolTipImage32by32:null,ToolTipImage32by32Class:null,ToolTipImage32by32Top:null,ToolTipImage32by32Left:null,ToolTipSelectedItemTitle:null,ToolTipShortcutKey:null,ToolTipTitle:null,LabelCss:null};CUI.Control=function(a,b,c){this.$$d_onDblClick=Function.createDelegate(this,this.onDblClick);this.$$d_onHelpKeyPress=Function.createDelegate(this,this.onHelpKeyPress);this.$$d_$g_0=Function.createDelegate(this,this.$g_0);this.$$d_launchToolTip=Function.createDelegate(this,this.launchToolTip);this.$0_0=a;this.$6_0=b;this.$7_0=c;this.$Y_0=[];this.$40_0=",";this.$2r_0={};a.$DB_1(this)};CUI.Control.createStandardControlDOMElement=function(f,g,h,i,j,k){var d,e,a,b,c;return c=CUI.Control.createStandardControlDOMElement_OutParameters(f,g,h,i,j,k,a={val:d},b={val:e}),d=a.val,e=b.val,c};CUI.Control.createStandardControlDOMElement_OutParameters=function(b,c,d,e,f,g,h,i){var a=e;return CUI.Control.createStandardControlDOMElementCore(b,c,d,a.Id,a.Image32by32,a.Image32by32Class,a.Image32by32Top,a.Image32by32Left,a.Image16by16,a.Image16by16Class,a.Image16by16Top,a.Image16by16Left,a.LabelText,a.LabelCss,a.Alt,a.Description,a.ToolTipTitle,f,g,h,i)};CUI.Control.createStandardControlDOMElementCore=function(y,e,b,I,J,K,L,M,N,O,C,D,i,z,d,A,n,P,j,E,F){if(CUI.ScriptUtility.isNullOrUndefined(i))i="";var o=false,k=true,c=CUI.Utility.$5O(),f=null;if(b==="Large")f="ms-cui-ctl-large";else if(b==="Medium")f="ms-cui-ctl-medium";else if(b==="Menu16"||b==="Menu"){f="ms-cui-ctl-menu";o=true}else if(b==="Menu32"){f="ms-cui-ctl-menu ms-cui-ctl-menu32";o=true}else f="ms-cui-ctl";CUI.Utility.ensureCSSClassOnElement(c,f);b==="Menu"&&CUI.Utility.ensureCSSClassOnElement(c,"ms-cui-textmenuitem");!CUI.ScriptUtility.isNullOrUndefined(n)&&c.setAttribute("aria-describedby",I+"_ToolTip");c.setAttribute("mscui:controltype",y.get_$96_0());var l=CUI.Utility.$4("img"),p=null,q=null,r=null,s=null,t=0;l.alt="";d=CUI.ScriptUtility.isNullOrEmptyString(d)?i:d;c.setAttribute("role",y.get_$2k_0());CUI.Controls.FlyoutAnchor.isInstanceOfType(y)&&c.setAttribute("aria-haspopup","true");if(CUI.ScriptUtility.isNullOrEmptyString(n)){if(b==="Small")c.title=d;l.alt=d;k=false}if(b==="Large"||b==="Menu32"){p=J;q=K;r=L;s=M;t=4}else{p=N;q=O;r=C;s=D;t=3}var G=CUI.Utility.$m(2,t,p,q,l,true,false,r,s),u=CUI.Utility.$4("span");u.className=b==="Large"?"ms-cui-ctl-largeIconContainer":"ms-cui-ctl-iconContainer";u.appendChild(G);var a=null,B=null;if(k)B=CUI.Utility.$2S(d);if(b!=="Small"||j){a=CUI.Utility.$4("span");if(b!=="Small"){if(b==="Large"){CUI.Utility.ensureCSSClassOnElement(a,"ms-cui-ctl-largelabel");a.innerHTML=CUI.Utility.$7z(i,j)}else{var w=i;if(j)w=w+" ";CUI.Utility.ensureCSSClassOnElement(a,"ms-cui-ctl-mediumlabel");CUI.UIUtility.setInnerText(a,w)}if(!CUI.ScriptUtility.isNullOrEmptyString(z))a.style.cssText=z;if(!CUI.ScriptUtility.isNullOrUndefined(e.get_$1R_1()))a.style.color=e.get_$1R_1()}else{CUI.Utility.ensureCSSClassOnElement(a,"ms-cui-ctl-smalllabel");CUI.UIUtility.setInnerText(a," ");a=CUI.Utility.$2S(d)}}else if(k)a=CUI.Utility.$2S(d);var v=null;if(j){var x=CUI.Utility.$4("img");x.alt="";if(CUI.ScriptUtility.isNullOrEmptyString(n))x.alt=d;v=CUI.Utility.$m(2,1,e.$7_1.ImageDownArrow,e.$7_1.ImageDownArrowClass,x,true,false,e.$7_1.ImageDownArrowTop,e.$7_1.ImageDownArrowLeft)}var g=null,h=null,m=null;if(b==="Menu32"){g=CUI.Utility.$4("span");g.className="ms-cui-ctl-menulabel";CUI.Utility.ensureCSSClassOnElement(a,"ms-cui-btn-title");g.appendChild(a);if(!CUI.ScriptUtility.isNullOrUndefined(A)){h=CUI.Utility.$4("span");if(!CUI.ScriptUtility.isNullOrUndefined(e.get_$1R_1()))h.style.color=e.get_$1R_1();CUI.Utility.ensureCSSClassOnElement(h,"ms-cui-btn-menu-description");CUI.Utility.$2B(h,A);h.style.display="block";g.appendChild(h)}m=CUI.Utility.$4("span");m.className="ms-cui-ctl-menu32clear";m.innerHTML="&nbsp;"}c.appendChild(u);if(!CUI.ScriptUtility.isNullOrUndefined(a)){if(!CUI.ScriptUtility.isNullOrUndefined(g)){c.appendChild(g);c.appendChild(m)}else{c.appendChild(a);b==="Small"&&j&&k&&c.appendChild(B)}!CUI.ScriptUtility.isNullOrUndefined(v)&&a.appendChild(v)}if(o){var H=CUI.Utility.$9B();c.appendChild(H)}E.val=a;F.val=l;return c};CUI.Control.createTwoAnchorControlDOMElementCore=function(u,g,a,A,B,C,D,E,F,G,x,y,h,c,l,m){var i=true;if(CUI.ScriptUtility.isNullOrUndefined(h))h="";var d=CUI.Utility.$4("span");if(a==="Large")d.className="ms-cui-ctl-large";else if(a==="Medium")d.className="ms-cui-ctl ms-cui-ctl-medium";else d.className="ms-cui-ctl ms-cui-ctl-small";!CUI.ScriptUtility.isNullOrUndefined(l)&&d.setAttribute("aria-describedby",A+"_ToolTip");d.setAttribute("mscui:controltype",u.get_$96_0());var f=CUI.Utility.$5O(),e=CUI.Utility.$5O();f.className="ms-cui-ctl-a1";e.className="ms-cui-ctl-a2";c=CUI.ScriptUtility.isNullOrEmptyString(c)?h:c;f.setAttribute("role",u.get_$2k_0());e.setAttribute("role",u.get_$2k_0());e.setAttribute("aria-haspopup","true");var j=CUI.Utility.$4("span");j.className="ms-cui-ctl-a1Internal";var n=CUI.Utility.$4("img"),o=null,p=null,q=null,r=null,s=0;n.alt="";if(CUI.ScriptUtility.isNullOrEmptyString(l)){if(a==="Small"){f.title=c;e.title=c}n.alt=c;i=false}if(a==="Large"||a==="Menu32"){o=B;p=C;q=D;r=E;s=4}else{o=F;p=G;q=x;r=y;s=3}var z=CUI.Utility.$m(2,s,o,p,n,true,false,q,r),t=null,v=null;if(i){t=CUI.Utility.$2S(c);v=CUI.Utility.$2S(c)}var b=null;if(a!=="Small"||m){b=CUI.Utility.$4("span");if(a!=="Small"){if(a==="Large"){CUI.Utility.ensureCSSClassOnElement(b,"ms-cui-ctl-largelabel");b.innerHTML=CUI.Utility.$7z(h,m)}else if(a==="Medium"){CUI.Utility.ensureCSSClassOnElement(b,"ms-cui-ctl-mediumlabel");CUI.UIUtility.setInnerText(b,h)}if(!CUI.ScriptUtility.isNullOrUndefined(g.get_$1R_1()))b.style.color=g.get_$1R_1()}}var k=null;if(m){var w=CUI.Utility.$4("img");if(CUI.ScriptUtility.isNullOrEmptyString(l))w.alt=c;k=CUI.Utility.$m(2,1,g.$7_1.ImageDownArrow,g.$7_1.ImageDownArrowClass,w,true,false,g.$7_1.ImageDownArrowTop,g.$7_1.ImageDownArrowLeft)}d.appendChild(f);d.appendChild(e);f.appendChild(j);j.appendChild(z);if(!CUI.ScriptUtility.isNullOrUndefined(b)){if(a==="Large"){e.appendChild(b);i&&f.appendChild(t)}else{j.appendChild(b);i&&e.appendChild(v)}a==="Small"&&i&&f.appendChild(t)}if(!CUI.ScriptUtility.isNullOrUndefined(k))if(a==="Large")b.appendChild(k);else e.appendChild(k);return d};CUI.Control.prototype={$0_0:null,$6_0:null,$Y_0:null,$7_0:null,$40_0:null,$2r_0:null,$1O_0:null,$5K_0:false,$6W_0:null,$6V_0:null,$1Y_0:false,$4F_0:false,$3p_0:true,get_controlProperties:function(){a:;return this.$7_0},$6R_0:null,get_stateProperties:function(){a:;if(CUI.ScriptUtility.isNullOrUndefined(this.$6R_0))this.$6R_0={};return this.$6R_0},$5f_0:null,get_commandProperties:function(){a:;if(CUI.ScriptUtility.isNullOrUndefined(this.$5f_0))this.$5f_0={};return this.$5f_0},get_templateAlias:function(){a:;return this.$7_0.TemplateAlias},get_$96_0:function(){a:;return "Control"},get_$2k_0:function(){a:;return "button"},ensureValidDisplayMode:function(a){if(this.$40_0.indexOf(","+a+",")!==-1)return;throw Error.create("The display mode with name: "+a+" is not valid for this control with id: "+this.$6_0)},refreshDOMElements:function(){a:;this.onStateChanged();!this.get_enabled()&&this.onEnabledChanged(false)},onStateChanged:function(){},$5g_0:null,getDOMElementForDisplayMode:function(b){this.ensureValidDisplayMode(b);var a=this.$2r_0[b];if(!CUI.ScriptUtility.isNullOrUndefined(a))return a;this.$5g_0=b;a=this.createDOMElementForDisplayMode(b);this.$5g_0=null;if(CUI.ScriptUtility.isNullOrEmptyString(a.id))a.id=this.$6_0+"-"+b;this.storeElementForDisplayMode(a,b);this.refreshDOMElements();return a},storeElementForDisplayMode:function(a,b){this.$2r_0[b]=a},$Aq_0:function(b){var a=$get(this.$6_0+"-"+b);!CUI.ScriptUtility.isNullOrUndefined(a)&&this.storeElementForDisplayMode(a,b)},$Ar_0:function(){},createComponentForDisplayMode:function(b){var a=this.createComponentForDisplayModeInternal(b);Array.add(this.$Y_0,a);return a},get_components:function(){a:;return this.$Y_0},createComponentForDisplayModeInternal:function(a){var b=this.$0_0.$BR_1(this.$6_0+"-"+a+this.$0_0.$2U_1(),a,this);return b},dispose:function(){a:;this.releaseEventHandlers();this.$0_0=null;this.$Y_0=null;this.$40_0=null;var a=this.$2r_0;for(var b in a){var c={key:b,value:a[b]};delete this.$2r_0[c.key]}this.$2r_0=null;!CUI.ScriptUtility.isNullOrUndefined(this.$1O_0)&&this.$1O_0.dispose()},releaseEventHandlers:function(){a:;var a=this.$2r_0;for(var b in a){var c={key:b,value:a[b]};CUI.Utility.$8Q(c.value)}},get_id:function(){a:;return this.$6_0},get_root:function(){a:;return this.$0_0},addDisplayMode:function(a){if(this.$40_0.indexOf(","+a+",")!==-1)return;this.$40_0+=a+","},ensureCorrectChildType:function(a){if(!CUI.ToolTip.isInstanceOfType(a))throw Error.create("Child Components may not be added to this type of ControlComponent.")},get_displayedComponent:function(){a:;for(var c=this.$Y_0.length,a=0;a<c;a++){var b=this.$Y_0[a];if(b.get_visibleInDOM())return b}return null},$3J_0:function(){return true},$AF_0:function(){},onMenuClosed:function(){},onClick:function(a){a.preventDefault()},onDblClick:function(a){a.preventDefault();if(!this.get_enabled())return;Sys.Browser.agent===Sys.Browser.InternetExplorer&&this.onClick(a)},onBeginFocus:function(){a:;window.clearInterval(this.$0_0.$2j_1);if(!CUI.ScriptUtility.isNullOrUndefined(this.$0_0.$3D_1))if(this.$0_0.$3D_1.$6_0===this.$6_0){this.launchToolTip();return}else{this.$0_0.$2l_1();this.$0_0.$2j_1=window.setTimeout(this.$$d_launchToolTip,500)}else this.$0_0.$2j_1=window.setTimeout(this.$$d_launchToolTip,500)},onEndFocus:function(){a:;window.clearInterval(this.$0_0.$2j_1);if(this.$5K_0)this.$0_0.$2j_1=window.setTimeout(this.$$d_$g_0,100)},onToolTipOpenned:function(){a:;this.$6W_0=this.$$d_onHelpKeyPress;this.$6V_0=this.$1O_0.$$d_$CW_1;$addHandler(document,"keydown",this.$6W_0);$addHandler(document,"click",this.$6V_0)},onToolTipClosed:function(){a:;$removeHandler(document,"keydown",this.$6W_0);$removeHandler(document,"click",this.$6V_0)},onHelpKeyPress:function(a){!CUI.ScriptUtility.isNullOrUndefined(this.$1O_0)&&this.$1O_0.$AB_1(a)},launchToolTip:function(){a:;if(CUI.ScriptUtility.isNullOrUndefined(this.$0_0))return;window.clearInterval(this.$0_0.$2j_1);if(this.$5K_0)return;!CUI.ScriptUtility.isNullOrUndefined(this.$0_0.$3D_1)&&this.$0_0.$3D_1.$6_0!==this.$6_0&&this.$0_0.$2l_1();if(CUI.ScriptUtility.isNullOrUndefined(this.$7_0.ToolTipTitle))return;this.$1O_0=new CUI.ToolTip(this.$0_0,this.$6_0+"_ToolTip",this.$7_0.ToolTipTitle,this.$7_0.ToolTipDescription,this.$7_0);if(!this.get_enabled()){var a=new CUI.DisabledCommandInfoProperties;a.Icon=this.$0_0.$7_1.ToolTipDisabledCommandImage16by16;a.IconClass=this.$0_0.$7_1.ToolTipDisabledCommandImage16by16Class;a.IconTop=this.$0_0.$7_1.ToolTipDisabledCommandImage16by16Top;a.IconLeft=this.$0_0.$7_1.ToolTipDisabledCommandImage16by16Left;a.Title=this.$0_0.$7_1.ToolTipDisabledCommandTitle;a.Description=this.$0_0.$7_1.ToolTipDisabledCommandDescription;a.HelpKeyWord=this.$0_0.$7_1.ToolTipDisabledCommandHelpKey;this.$1O_0.$1A_1=a}var b=this.get_displayedComponent();b.$7t_0();b.addChild(this.$1O_0);this.$1O_0.$Bd_1();this.$5K_0=true;this.$0_0.$3D_1=this;this.onToolTipOpenned()},$g_0:function(){a:;!CUI.ScriptUtility.isNullOrUndefined(this.$0_0)&&window.clearInterval(this.$0_0.$2j_1);if(!CUI.ScriptUtility.isNullOrUndefined(this.$1O_0)){this.$1O_0.$9u_1();this.$5K_0=false;this.onToolTipClosed();CUI.UIUtility.removeNode(this.$1O_0.get_$3_0());this.$1O_0=null}},get_enabled:function(){a:;return this.$1Y_0},set_enabled:function(a){if(this.$1Y_0===a&&this.$4F_0)return a;this.$1Y_0=a;this.$4F_0=true;this.onEnabledChanged(a);return a},get_$73_0:function(){a:;return this.$3p_0},get_enabledInternal:function(){a:;return this.$1Y_0},set_enabledInternal:function(a){this.$1Y_0=a;return a},$AX_0:function(a){this.$1Y_0=a;this.onEnabledChanged(a)},$AK_0:function(){a:;!CUI.ScriptUtility.isNullOrUndefined(this.$7_0.Command)&&this.pollForStateAndUpdateInternal(this.$7_0.Command,null,null,false)},pollForStateAndUpdateInternal:function(b,c,d,e){var a=this.$0_0.$3x_1(b,c,d,e);this.set_enabled((a&1)>0);return a},getTextValue:function(){a:;return ""},receiveFocus:function(){},$6b_0:function(){a:;return this.$9R_0()},$6c_0:function(){a:;return this.$9R_0()},$9R_0:function(){a:;var a=this.get_displayedComponent();if(!CUI.MenuItem.isInstanceOfType(a))return false;if(!a.get_$1H_2()){this.receiveFocus();return true}return false},$BI_0:function(){},$6h_0:function(){a:;var a=this.get_displayedComponent();if(CUI.ScriptUtility.isNullOrUndefined(a))return null;return a.get_$3_0()},$8c_0:function(){a:;return false}};CUI.ControlComponent=function(a,b,c,d){CUI.ControlComponent.initializeBase(this,[a,b,c,""]);this.$N_1=d;this.set_visible(this.$N_1.get_$73_0())};CUI.ControlComponent.prototype={$N_1:null,get_displayMode:function(){a:;return this.get_title()},createChildArray:function(){},$2A_0:function(){a:;this.$i_0=false},$6Z_0:function(){a:;this.$N_1.$Aq_0(this.get_displayMode())},$X_0:function(){a:;this.$N_1.$Ar_0(this.get_displayMode())},get_$3_0:function(){a:;return this.$N_1.getDOMElementForDisplayMode(this.get_title())},set_$3_0:function(a){throw Error.create("Cannot set the DOM Element of ControlComponents.  They get their DOM Elements from the Control.");return a},get_componentElement:function(){a:;return CUI.Component.prototype.get_$3_0.call(this)},get_enabled:function(){a:;return this.$N_1.get_enabled()},set_enabled:function(a){this.$N_1.set_enabled(a);return a},get_visible:function(){a:;if(this.$0_0.get_$Dd_1()&&!this.$N_1.get_$73_0())return false;return CUI.Component.prototype.get_visible.call(this)},set_visible:function(a){CUI.Component.prototype.set_visible.call(this,a);return a},get_componentWidth:function(){a:;if((this._componentWidth===-1||this.valueIsDirty(this._lastWidthUpdate))&&!CUI.ScriptUtility.isNullOrUndefined(this.get_$3_0()))this._componentWidth=this.get_$3_0().offsetWidth;return this._componentWidth},get_$BK_0:function(){a:;if((this._componentHeight===-1||this.valueIsDirty(this._lastHeightUpdate))&&!CUI.ScriptUtility.isNullOrUndefined(this.get_$3_0()))this._componentHeight=this.get_$3_0().offsetHeight;return this._componentHeight},get_$95_0:function(){a:;if((this._componentTopPosition===-1||this.valueIsDirty(this._lastTopUpdate))&&!CUI.ScriptUtility.isNullOrUndefined(this.get_$3_0()))this._componentTopPosition=CUI.UIUtility.calculateOffsetTop(this.get_$3_0());return this._componentTopPosition},get_componentLeftPosition:function(){a:;if((this._componentLeftPosition===-1||this.valueIsDirty(this._lastLeftUpdate))&&!CUI.ScriptUtility.isNullOrUndefined(this.get_$3_0()))this._componentLeftPosition=CUI.UIUtility.calculateOffsetLeft(this.get_$3_0());return this._componentLeftPosition},setEnabledRecursively:function(a){this.$N_1.$AX_0(a)},clone:function(){return this.$N_1.createComponentForDisplayMode(this.get_displayMode())},onEnabledChanged:function(a){this.$N_1.onEnabledChanged(a)},ensureCorrectChildType:function(a){this.$N_1.ensureCorrectChildType(a)},$3J_0:function(a){return this.$N_1.$3J_0(a)},$AF_0:function(a){this.$N_1.$AF_0(a)},get_textValue:function(){a:;return this.$N_1.getTextValue()},$4i_0:function(){a:;this.$N_1.$AK_0()},receiveFocus:function(){a:;this.$N_1.receiveFocus()},onMenuClosed:function(){a:;this.$N_1.onMenuClosed()},$8d_0:function(){a:;return this.$N_1.$8c_0()},dispose:function(){a:;this.$N_1.dispose();this.$N_1=null;CUI.Component.prototype.dispose.call(this)}};CUI.DataQueryResult=function(){};CUI.DataQueryResult.prototype={success:false,id:null,queryData:null,contextData:null};CUI.DataQuery=function(){};CUI.DataQuery.prototype={dataUrl:null,version:null,lcid:null,id:null,queryType:0,handler:null,data:null};CUI.DataSource=function(a,b,c){a:;this.$$d_onDataReturned=Function.createDelegate(this,this.onDataReturned);this.$5h_0=a;this.$6X_0=b;this.$65_0=c;this.$8s_0={}};CUI.DataSource.prototype={$5h_0:null,$8s_0:null,$6X_0:null,$65_0:null,get_dataUrl:function(){a:;return this.$5h_0},get_version:function(){a:;return this.$6X_0},get_lcid:function(){a:;return this.$65_0},runQuery:function(a){a:;var g=this.$6X_0;if(!CUI.ScriptUtility.isNullOrUndefined(a.version))g=a.version;var h=this.$65_0;if(!CUI.ScriptUtility.isNullOrUndefined(a.lcid))h=a.lcid;var f=this.$5h_0;if(!CUI.ScriptUtility.isNullOrUndefined(a.dataUrl))f=a.dataUrl;var b,c=null;if(f.indexOf("?")===-1)b=f+"?ver=";else b=f+"&ver=";b=b+g+"&id="+a.id+"&lcid="+h+"&qt=";switch(a.queryType){case 1:c="all";break;case 4:c="ribbontab";break;case 3:c="ribbonshallow";break;case 5:c="root";break;case 2:c="ribbonvisibletabdeep"}b+=c;CUI.PMetrics.perfMark(7109);var d=new Sys.Net.WebRequest;d.set_httpVerb("POST");d.set_url(b);var e=new CUI.QueryRecord;e.id=a.id;e.queryType=a.queryType;e.data=a.data;e.handler=a.handler;d.set_userContext(e);d.add_completed(this.$$d_onDataReturned);d.invoke()},onDataReturned:function(c){a:;CUI.PMetrics.perfMark(7110);var b=c.get_webRequest().get_userContext(),a=new CUI.DataQueryResult;a.contextData=b.data;a.id=b.id;if(c.get_responseAvailable())try{a.success=true;a.queryData=c.get_object();b.handler(a)}catch(d){}else{a.success=false;b.handler(a)}}};CUI.Gallery=function(a,b,c,d,e){this.$9_1=-1;CUI.Gallery.initializeBase(this,[a,b,c,d]);this.$3K_1=e;this.$4X_1=parseInt(this.$3K_1.Width);this.$4z_1=CUI.Gallery.$97(this.$3K_1.ElementDimensions)};CUI.Gallery.$97=function(a){switch(a){case "Size16by16":return 1;case "Size32by32":return 2;case "Size48by48":return 3;case "Size64by48":return 4;case "Size72by96":return 5;case "Size96by72":return 6;case "Size96by96":return 7;case "Size128by128":return 8;case "Size190by30":return 9;case "Size190by40":return 10;case "Size190by50":return 11;case "Size190by60":return 12;case "SizeCustom":return 13;default:throw Error.argument("s","The parameter s is not a valid GalleryElementDimension")}};CUI.Gallery.prototype={$3K_1:null,$4z_1:0,$4X_1:0,$6M_1:null,get_domElementTagName:function(){a:;return "table"},get_cssClass:function(){a:;return "ms-cui-gallery"},$2A_0:function(){a:;this.ensureDOMElementAndEmpty();var a=CUI.Utility.$4("tbody");this.get_$3_0().appendChild(a);this.appendChildrenToElement(a)},appendChildrenToElement:function(h){for(var g=Math.ceil(this.$8_0.$P_0/this.$4X_1),c,a,b,d=0,e=0;e<g;e++){c=CUI.Utility.$4("tr");for(var f=0;f<this.$4X_1;f++){a=CUI.Utility.$4("td");a.className="ms-cui-gallery-td ms-cui-gallery-element-"+this.$4z_1.toString();if(d<this.$8_0.$P_0){b=this.$8_0.get_item(d++);b.$1x_0();a.appendChild(b.get_$3_0());b.$3G_0()}c.appendChild(a)}h.appendChild(c)}},$6I_1:false,$3J_0:function(a){if(this.$6I_1)return true;if(a.$I_1===3){var c=a.$3A_1;if(!CUI.ISelectableControl.isInstanceOfType(c.$N_1))return CUI.Component.prototype.$3J_0.call(this,a);var d=c.$N_1;!CUI.ScriptUtility.isNullOrUndefined(this.$6M_1)&&this.$6M_1.deselect();this.$6M_1=d}if(a.$I_1===3||a.$I_1===7||a.$I_1===8){var b;switch(a.$I_1){case 3:b=this.$3K_1.Command;break;case 7:b=this.$3K_1.CommandPreview;break;case 8:b=this.$3K_1.CommandRevert;break;default:b=this.$3K_1.Command}b=b||a.$6_1;this.$6I_1=true;this.raiseCommandEvent(b,a.$I_1,a.$37_1);this.$6I_1=false;CUI.Component.prototype.$3J_0.call(this,a);return false}return CUI.Component.prototype.$3J_0.call(this,a)},$17_0:function(){a:;if(!this.$8_0.$P_0)return;this.$9_1=0;var a=this.$8_0.getEnumerator();while(a.moveNext()){var b=a.get_current();b.$17_0()}},$80_0:function(){a:;if(!this.$8_0.$P_0)return;this.$9_1>-1&&this.$8_0.get_item(this.$9_1).$17_0();this.$9_1=0;this.$8_0.get_item(this.$9_1).$80_0()},$82_0:function(){a:;var a=this.$8_0.$P_0;if(!a)return;this.$9_1>-1&&this.$8_0.get_item(this.$9_1).$17_0();this.$9_1=a-1;this.$8_0.get_item(this.$9_1).$82_0()},$81_0:function(d){if(!this.$8_0.$P_0)return false;var b=0,a=this.$8_0.getEnumerator();while(a.moveNext()){var c=a.get_current();if(c.$81_0(d)){this.$9_1>-1&&this.$8_0.get_item(this.$9_1).$17_0();this.$9_1=b;return true}b++}return false},$6c_0:function(){a:;if(this.$9_1===-1)this.$9_1=this.$8_0.$P_0-1;var a=this.$9_1,b=this.$8_0.getEnumeratorAtPos(a);while(b.movePrevious()){if(b.get_current().$6c_0()){if(a!==this.$9_1){this.$8_0.get_item(this.$9_1).$17_0();this.$9_1=a}return true}a--}this.$8_0.get_item(this.$9_1).$17_0();this.$9_1=-1;return false},$6b_0:function(){a:;if(this.$9_1===-1)this.$9_1=0;var a=this.$9_1,b=this.$8_0.getEnumeratorAtPos(a);while(b.moveNext()){if(b.get_current().$6b_0()){if(a!==this.$9_1){this.$8_0.get_item(this.$9_1).$17_0();this.$9_1=a}return true}a++}this.$8_0.get_item(this.$9_1).$17_0();this.$9_1=-1;return false},ensureCorrectChildType:function(a){if(!CUI.ControlComponent.isInstanceOfType(a))throw Error.create("Galleries can only have children controls of type GalleryButton");var b=a;if(!CUI.Controls.GalleryButton.isInstanceOfType(b.$N_1))throw Error.create("Galleries can only have children of type GalleryButton")},get_elementDimensions:function(){a:;return this.$4z_1},set_elementDimensions:function(a){this.$4z_1=a;return a},get_width:function(){a:;return this.$4X_1},set_width:function(a){this.$4X_1=a;return a}};CUI.Jewel=function(a,b){CUI.Jewel.initializeBase(this,[a,b])};CUI.Jewel.prototype={$8p_2:null,refresh:function(){a:;this.$2A_0();CUI.Root.prototype.refresh.call(this)},$2A_0:function(){a:;CUI.ScriptUtility.isNullOrUndefined(this.get_$3_0())&&this.$1x_0();this.set_$3_0(CUI.Utility.removeChildNodes(this.get_$3_0()));this.appendChildrenToElement(this.get_$3_0());this.$i_0=false},ensureCorrectChildType:function(a){a:;if(!CUI.ControlComponent.isInstanceOfType(a))throw Error.create('The child "'+a.$6_0+'" is not a ControlComponent');if(!CUI.Controls.JewelMenuLauncher.isInstanceOfType(a.$N_1))throw Error.create("Only children of type JewelMenuLauncher can be added to a Jewel")},get_cssClass:function(){a:;return "ms-cui-jewel "+CUI.Root.prototype.get_cssClass.call(this)},get_rootType:function(){a:;return "Jewel"},get_visibleInDOM:function(){a:;return true},set_$CQ_2:function(a){this.set_$1c_1(a);return a}};CUI.JewelBuildContext=function(){a:;CUI.JewelBuildContext.initializeBase(this)};CUI.JewelBuildContext.prototype={jewel:null,jewelId:null};CUI.JewelBuildOptions=function(){a:;CUI.JewelBuildOptions.initializeBase(this)};CUI.JewelBuilder=function(c,a,b){a:;this.$$d_$Cs_1=Function.createDelegate(this,this.$Cs_1);CUI.JewelBuilder.initializeBase(this,[c,a,b]);if(CUI.ScriptUtility.isNullOrUndefined(a))throw Error.create("Jewel placeholder DOM element is null or undefined.")};CUI.JewelBuilder.prototype={get_jewel:function(){a:;return this.$0_0},set_jewel:function(a){a:;this.$0_0=a;return a},buildJewel:function(c){a:;if(this.$2f_0)return false;if(this.isIdTrimmed(c))return true;var b=new CUI.JewelBuildContext;b.jewelId=c;this.$2f_0=true;var a=new CUI.DataQuery;a.id=b.jewelId;a.queryType=5;a.handler=this.$$d_$Cs_1;a.data=b;this.$x_0.runQuery(a);return true},$Cs_1:function(a){var b=a.contextData;a.queryData=this.applyDataExtensions(a.queryData);var c=CUI.DataNodeWrapper.getFirstChildNodeWithName(a.queryData,"Jewel");this.set_jewel(this.$B3_1(c,b));this.get_jewel().set_$CQ_2(this);this.get_jewel()._decimalSeparator=this.get_$A1_1().decimalSeparator;this.$26_0.onComponentCreated(this.get_jewel(),this.get_jewel().$6_0);if(this.get_$A1_1().attachToDOM)this.get_jewel().$4Y_0(true);else{this.get_jewel().$2A_0();this._elmPlaceholder.appendChild(this.get_jewel().get_$3_0());CUI.Utility.ensureCSSClassOnElement(this._elmPlaceholder,"loaded")}this.$8N_0(this.get_jewel());this.$26_0.onComponentBuilt(this.get_jewel(),this.get_jewel().$6_0)},$B3_1:function(a,d){if(CUI.ScriptUtility.isNullOrUndefined(a))throw Error.create("No Jewel element was present in the data");var b=new CUI.DataNodeWrapper(a);this.set_jewel(new CUI.Jewel(b.get_attributes()["Id"],b.get_attributes()));var c=this.$B4_1(a,d);this.get_jewel().addChild(c.createComponentForDisplayMode("Default"));this.get_jewel().$8p_2=c;return this.get_jewel()},$B4_1:function(a,g){var b=a.attrs,d=CUI.DataNodeWrapper.getNodeChildren(a),c=null,e=a.attrs;if(!CUI.Utility.$u(e.PopulateDynamically))c=this.$3r_0(d[0],g,false);var f=new CUI.Controls.JewelMenuLauncher(this.get_jewel(),b.Id,b,c);return f},get_$A1_1:function(){a:;return this.$12_0}};CUI.Menu=function(a,b,c,d,e){this.$9_1=-1;CUI.Menu.initializeBase(this,[a,b,c,d]);this.$66_1=e};CUI.Menu.prototype={$Q_1:null,$8o_1:null,$8m_1:null,$3k_1:null,$66_1:null,$2A_0:function(){a:;this.get_needsDelayIniting()&&this.doDelayedInit();this.ensureDOMElementAndEmpty();var c=this.$0_0._textDirection,a=this.get_$3_0(),b=this.$Q_1;if(!c)a.style.direction="ltr";else if(c===1){CUI.Utility.ensureCSSClassOnElement(a,"ms-cui-rtl");a.style.direction="rtl"}if(CUI.ScriptUtility.isNullOrUndefined(b)){b=CUI.Utility.$4("div");b.className="ms-cui-smenu-inner"}a.setAttribute("role","menu");a.appendChild(b);if(!CUI.ScriptUtility.isNullOrEmptyString(this.$66_1))a.style.maxWidth=this.$66_1;this.appendChildrenToElement(b);CUI.Component.prototype.$2A_0.call(this);$addHandler(a,"contextmenu",CUI.UIUtility.cancelEvent)},$1x_0:function(){a:;CUI.Component.prototype.$1x_0.call(this);var a=this.get_$3_0();if(!CUI.ScriptUtility.isNullOrUndefined(this.$0_0.get_$4Z_1())&&!CUI.ScriptUtility.isNullOrUndefined(this.$0_0.get_$1R_1())){a.style.backgroundColor=this.$0_0.get_$4Z_1();a.style.color=this.$0_0.get_$1R_1()}!CUI.ScriptUtility.isNullOrUndefined(this.$0_0.get_$Af_1())&&CUI.Utility.ensureCSSClassOnElement(a,this.$0_0.get_$Af_1());CUI.Utility.$6n()&&CUI.Utility.ensureCSSClassOnElement(a,"ms-cui-needIEFilter")},get_cssClass:function(){a:;return "ms-cui-menu"},get_domElementTagName:function(){a:;return "div"},ensureCorrectChildType:function(a){if(!CUI.MenuSection.isInstanceOfType(a))throw Error.create("Only MenuSection Components can be added to Menu Components.")},get_innerDiv:function(){a:;return this.$Q_1},set_innerDiv:function(a){this.$Q_1=a;return a},$6D_1:null,set_$AJ_1:function(a){a&&!CUI.ScriptUtility.isNullOrUndefined(this.$6D_1)&&this.$0_0.$3E_1(this.$6D_1);this.$6D_1=a;return a},get_componentWidth:function(){a:;if(this._componentWidth===-1&&!CUI.ScriptUtility.isNullOrUndefined(this.get_$3_0()))this._componentWidth=this.get_$3_0().offsetWidth;return this._componentWidth},get_$BK_0:function(){a:;if(this._componentHeight===-1&&!CUI.ScriptUtility.isNullOrUndefined(this.get_$3_0()))this._componentHeight=this.get_$3_0().offsetHeight;return this._componentHeight},get_$95_0:function(){a:;if(this._componentTopPosition===-1&&!CUI.ScriptUtility.isNullOrUndefined(this.get_$3_0()))this._componentTopPosition=CUI.UIUtility.calculateOffsetTop(this.get_$3_0());return this._componentTopPosition},get_componentLeftPosition:function(){a:;if(this._componentLeftPosition===-1&&!CUI.ScriptUtility.isNullOrUndefined(this.get_$3_0()))this._componentLeftPosition=CUI.UIUtility.calculateOffsetLeft(this.get_$3_0());return this._componentLeftPosition},$CN_1:function(){a:;this._componentWidth=-1;this._componentHeight=-1;this._componentTopPosition=-1;this._componentLeftPosition=-1},$4i_0:function(){a:;this.set_$4g_0(new Date);CUI.Component.prototype.$4i_0.call(this)},$17_0:function(){a:;if(!this.$8_0.$P_0)return;this.$9_1=0;var a=this.$8_0.getEnumerator();while(a.moveNext()){var b=a.get_current();b.$17_0()}},$80_0:function(){a:;if(!this.$8_0.$P_0)return;this.$9_1=0;this.$8_0.get_item(0).$80_0();this.$6b_0()},$82_0:function(){a:;var a=this.$8_0.$P_0;if(!a)return;this.$9_1=a-1;this.$8_0.get_item(this.$9_1).$82_0();this.$6c_0()},$81_0:function(d){if(!this.$8_0.$P_0)return false;this.$9_1=0;var b=0,a=this.$8_0.getEnumerator();while(a.moveNext()){var c=a.get_current();if(c.$81_0(d)){this.$9_1=b;return true}b++}return false},$6c_0:function(){a:;if(this.$9_1===-1)this.$9_1=this.$8_0.$P_0-1;var a=this.$8_0.getEnumeratorAtPos(this.$9_1),b=this.$9_1;while(a.movePrevious()){if(a.get_current().$6c_0()){this.$9_1=b;return true}b--}this.$9_1=-1;return false},$6b_0:function(){a:;if(this.$9_1===-1)this.$9_1=0;var a=this.$8_0.getEnumeratorAtPos(this.$9_1),b=this.$9_1;while(a.moveNext()){if(a.get_current().$6b_0()){this.$9_1=b;return true}b++}this.$9_1=-1;return false},$9l_1:function(a){return this.$9m_1(this,a)},$9m_1:function(b,g){var a;if(CUI.ControlComponent.isInstanceOfType(b)){var e=b;if(CUI.ISelectableControl.isInstanceOfType(e.$N_1)){var f=e.$N_1;if(f.getMenuItemId()===g)return f}}var d=b.$8_0;if(!CUI.ScriptUtility.isNullOrUndefined(d)){var c=d.getEnumerator();while(c.moveNext()){var h=c.get_current();a=this.$9m_1(h,g);if(a)return a}}return null},$CJ_1:function(){a:;var a=this.$8_0.getEnumerator();while(a.moveNext()){var c=a.get_current(),b=c.$8_0.getEnumerator();while(b.moveNext()){var d=b.get_current();if(d.get_visible())return true}}return false},get_visibleInDOM:function(){a:;return this.$64_1},$64_1:false,dispose:function(){a:;CUI.Component.prototype.dispose.call(this);this.$Q_1=null;this.$8o_1=null;this.$8m_1=null;this.$3k_1=null;try{$removeHandler(this.get_$3_0(),"contextmenu",CUI.Utility.get_returnFalseHandler())}catch(a){}}};CUI.MenuItem=function(a,b,c,d){CUI.MenuItem.initializeBase(this,[a,b,c,d])};CUI.MenuItem.prototype={$7E_2:false,get_$1H_2:function(){a:;return this.$7E_2},set_$1H_2:function(a){this.$7E_2=a;return a},$81_0:function(b){if(CUI.ISelectableControl.isInstanceOfType(this.$N_1)){var a=this.$N_1;if(a.getMenuItemId()===b)if(this.get_visible()&&this.get_enabled()){this.receiveFocus();this.set_$1H_2(true);return true}}return false},$6c_0:function(){a:;if(!this.get_visible())return false;this.set_$1H_2(this.$N_1.$6c_0());return this.get_$1H_2()},$6b_0:function(){a:;if(!this.get_visible())return false;this.set_$1H_2(this.$N_1.$6b_0());return this.get_$1H_2()},$17_0:function(){a:;this.set_$1H_2(false)}};CUI.MenuLauncherControlProperties=function(){a:;CUI.MenuLauncherControlProperties.initializeBase(this)};CUI.MenuLauncherControlProperties.prototype={CacheMenuVersions:null,CommandMenuOpen:null,CommandMenuClose:null,CommandValueId:null,PopulateDynamically:null,PopulateOnlyOnce:null,PopulateQueryCommand:null};CUI.BrowserUtility=function(){};CUI.BrowserUtility.$CO=function(){a:;return Sys.Browser.agent===Sys.Browser.Firefox||Sys.Browser.name.toLowerCase().indexOf("firefox")!==-1||navigator.userAgent.toLowerCase().indexOf("gecko")!==-1};CUI.MenuLauncher=function(a,b,c,d){this.$$d_$D1_1=Function.createDelegate(this,this.$D1_1);this.$$d_addAndPositionBackFrameInternal=Function.createDelegate(this,this.addAndPositionBackFrameInternal);this.$6E_1=-1;CUI.MenuLauncher.initializeBase(this,[a,b,c]);this.$D_1=d};CUI.MenuLauncher.dictToInt=function(a,b){return a[b]};CUI.MenuLauncher.prototype={$k_1:false,_selectedControl:null,get_menuLaunched:function(){a:;return this.$k_1},$D_1:null,get_launcherComponent:function(){a:;return this.get_displayedComponent()},get_$CT_1:function(){a:;if(CUI.Group.isInstanceOfType(this.get_launcherComponent())){var a=this.get_launcherComponent();return a.$T_2}return this.get_displayedComponent().get_$3_0()},get_menuDirection:function(){a:;return 2},$16_1:false,get_launchedByKeyboard:function(){a:;return this.$16_1},set_launchedByKeyboard:function(a){this.$16_1=a;return a},$2a_1:null,get_elmHadFocus:function(){a:;return this.$2a_1},set_elmHadFocus:function(a){this.$2a_1=a;return a},$3T_1:null,get_$8z_1:function(){a:;if(CUI.ScriptUtility.isNullOrUndefined(this.$3T_1))this.$3T_1=CUI.Utility.$9C();return this.$3T_1},launchMenu:function(n,o){if(this.$k_1)return false;this.$2a_1=n;CUI.Utility.$u(this.get_$2_1().PopulateDynamically)&&this.pollForDynamicMenu(true,o);if(CUI.ScriptUtility.isNullOrUndefined(this.$D_1))return false;if(!CUI.ScriptUtility.isNullOrUndefined(this.$4N_1)){this.$4N_1();this.$4N_1=null}this.$D_1.$3G_0();if(!this.$D_1.$CJ_1())return false;var b=this.get_displayedComponent();b.$7t_0();b.$4G_0=true;b.addChild(this.$D_1);b.$4G_0=false;this.$D_1.$AL_0();this.$D_1.$CN_1();var g=CUI.ScalableRoot.isInstanceOfType(this.$0_0),c=null,h=false;if(g){c=this.$0_0;h=c.get_$5Y_2();c.set_$5Y_2(false)}var a=this.$D_1.get_$3_0();a.style.visibility="hidden";a.style.position="absolute";a.style.top="0px";a.style.left="0px";a.style.zIndex=1001;a.style.maxHeight="100px";a.style.overflowY="scroll";document.body.appendChild(a);if(CUI.Utility.$3v()&&this.$0_0._textDirection===1){var d=a.offsetWidth;d=d>=18?d-18:0;var j=d+"px",k=this.$D_1.$8_0,e=k.getEnumerator();while(e.moveNext()){var l=e.get_current(),m=l.$8_0,f=m.getEnumerator();while(f.moveNext()){var i=f.get_current();if(CUI.MenuItem.isInstanceOfType(i))i.get_$3_0().style.width=j}}}this.positionMenu(a,this.get_$CT_1());Sys.Browser.agent===Sys.Browser.InternetExplorer&&this.addAndPositionBackFrame();this.$0_0.$At_1(this,this.$2a_1);this.$0_0.$Al_1(this);a.style.visibility="visible";this.$k_1=true;this.$D_1.$64_1=true;this.$C0_1();g&&c.set_$5Y_2(h);return true},$C0_1:function(){a:;if(CUI.ScriptUtility.isNullOrUndefined(this.$D_1.$3k_1)&&!CUI.ScriptUtility.isNullOrUndefined(this._selectedControl)){var d=this._selectedControl,b=d.get_displayedComponent();if(CUI.MenuItem.isInstanceOfType(b))this.$D_1.$3k_1=b}if(this.$16_1)this.$D_1.$80_0();else{var c=this.$D_1.$3k_1;if(!CUI.ScriptUtility.isNullOrUndefined(c)){var a=c.$N_1;if(CUI.Controls.ToggleButton.isInstanceOfType(a)&&CUI.ISelectableControl.isInstanceOfType(a)){var e=a;!this.$D_1.$81_0(e.getMenuItemId())&&this.$D_1.$80_0()}}}},addAndPositionBackFrame:function(){a:;this.$6E_1!==-1&&window.clearTimeout(this.$6E_1);this.$6E_1=window.setTimeout(this.$$d_addAndPositionBackFrameInternal,50)},addAndPositionBackFrameInternal:function(){a:;CUI.PMetrics.perfMark(7188);document.body.appendChild(this.get_$8z_1());CUI.Utility.$AM(this.get_$8z_1(),this.$D_1.get_$3_0());CUI.PMetrics.perfMark(7189)},onModalBodyClick:function(a){a.stopPropagation();this.$16_1=false;this.$0_0.$3E_1(this)},onModalBodyMouseOver:function(){},onModalBodyMouseOut:function(){},onModalContextMenu:function(a){a.preventDefault();this.$16_1=false;this.$0_0.$3E_1(this)},onModalKeyPress:function(a){if(a)if(a.rawEvent){var b=a.rawEvent;if(b.keyCode===27){a.stopPropagation();this.$16_1=true;this.$0_0.$3E_1(this)}if(b.keyCode===9)if(a.shiftKey){!this.$D_1.$6c_0()&&this.$D_1.$82_0();a.preventDefault()}else{!this.$D_1.$6b_0()&&this.$D_1.$80_0();a.preventDefault()}if(b.keyCode===40){!this.$D_1.$6b_0()&&this.$D_1.$80_0();a.stopPropagation()}if(b.keyCode===38){!this.$D_1.$6c_0()&&this.$D_1.$82_0();a.stopPropagation()}if(CUI.Controls.FlyoutAnchor.isInstanceOfType(this)){if(b.keyCode===39&&!this.$0_0._textDirection||b.keyCode===37&&this.$0_0._textDirection===1){!this.$D_1.$6b_0()&&this.$D_1.$80_0();a.stopPropagation()}if(b.keyCode===37&&!this.$0_0._textDirection||b.keyCode===39&&this.$0_0._textDirection===1){!this.$D_1.$6c_0()&&this.$D_1.$82_0();a.stopPropagation()}}}},positionMenu:function(a,c){if(CUI.ScriptUtility.isNullOrUndefined(a)||CUI.ScriptUtility.isNullOrUndefined(c))return;a.style.top="0px";a.style.left="0px";var b=this.$0_0.$89_1(a,c);if(CUI.Group.isInstanceOfType(this.get_launcherComponent()))b["launcherHeight"]=0;this.$0_0.$8a_1(a,b,this.get_menuDirection())},$5N_1:function(){a:;if(!this.$k_1)return;$clearHandlers(this.$D_1.get_$3_0());CUI.UIUtility.removeNode(this.$D_1.get_$3_0());!CUI.ScriptUtility.isNullOrUndefined(this.$3T_1)&&CUI.UIUtility.removeNode(this.$3T_1);this.$D_1.onMenuClosed();var a=this.$D_1.$M_0;a.$4G_0=true;a.removeChild(this.$D_1.$6_0);a.$4G_0=false;this.$k_1=false;this.$D_1.$64_1=false;this.$0_0.$Bi_1(this);!CUI.ScriptUtility.isNullOrUndefined(this.$2a_1)&&this.$16_1&&this.$2a_1.focus();this.$2a_1=null;this.$16_1=false;this.onLaunchedMenuClosed()},onMenuClosed:function(){},onLaunchedMenuClosed:function(){a:;this.$D_1.$17_0()},ensureCorrectChildType:function(a){if(!CUI.Menu.isInstanceOfType(a)&&!CUI.ToolTip.isInstanceOfType(a))throw Error.create("This Component can only have Menu and ToolTip Components as children.")},$3J_0:function(a){if(this.$k_1&&a.$I_1!==4&&a.$I_1!==5&&a.$I_1!==6&&a.$I_1!==7&&a.$I_1!==8&&a.$I_1!==9&&a.$I_1!==10){if(!CUI.ScriptUtility.isNullOrUndefined(a.get_sourceControl())){var b=a.get_sourceControl().get_displayedComponent();this.$D_1.$3k_1=b}this.$0_0.$3E_1(this)}return true},$7Z_1:false,$4N_1:null,pollForDynamicMenu:function(i,j){if(this.$7Z_1&&CUI.Utility.$u(this.get_$2_1().PopulateOnlyOnce))return;if(CUI.ScriptUtility.isNullOrUndefined(this.get_$2_1().PopulateQueryCommand))return;var a={},d;if(CUI.Utility.$u(this.get_$2_1().CacheMenuVersions)){d={};var e=this.$3N_1;for(var f in e){var h={key:f,value:e[f]};d[h.key]=true}a.CachedVersions=d}var g=this.$0_0.$3x_1(this.get_$2_1().PopulateQueryCommand,this.get_$2_1().PopulateQueryCommand,a,false);if((g&1)>0){var b=null,c=null;if(!CUI.ScriptUtility.isNullOrUndefined(a.PopulationJSON))c=a.PopulationJSON;else if(!CUI.ScriptUtility.isNullOrUndefined(a.PopulationXML))c=CUI.Builder.$98(a.PopulationXML);if(!CUI.ScriptUtility.isNullOrUndefined(c)){b=this.$0_0.get_$1c_1().$3r_0(c,new CUI.BuildContext,false);if(!CUI.ScriptUtility.isNullOrUndefined(b)){this.$7Z_1=true;if(CUI.Utility.$u(this.get_$2_1().CacheMenuVersions)&&!CUI.ScriptUtility.isNullOrUndefined(a.PopulationVersion))this.get_cachedMenuVersions()[a.PopulationVersion]=b}}else if(!CUI.ScriptUtility.isNullOrUndefined(a.PopulationVersion))b=this.get_cachedMenuVersions()[a.PopulationVersion];else if(i&&-1!==a.PollAgainInterval){this.$4N_1=j;window.setTimeout(this.$$d_$D1_1,a.PollAgainInterval);this.$D_1=null}if(!CUI.ScriptUtility.isNullOrUndefined(b)){this.$D_1=b;this.onDynamicMenuPopulated()}}},$D1_1:function(){a:;this.launchMenu(this.$2a_1,this.$4N_1)},onDynamicMenuPopulated:function(){},get_$2_1:function(){a:;return this.$7_0},$3N_1:null,get_cachedMenuVersions:function(){a:;if(CUI.ScriptUtility.isNullOrUndefined(this.$3N_1))this.$3N_1={};return this.$3N_1},dispose:function(){a:;CUI.Control.prototype.dispose.call(this);!CUI.ScriptUtility.isNullOrUndefined(this.$D_1)&&this.$D_1.dispose();if(!CUI.ScriptUtility.isNullOrUndefined(this.$3N_1)){var a=this.$3N_1;for(var b in a){var c={key:b,value:a[b]},d=c.value;d.dispose()}}this._selectedControl=null;this.$D_1=null;this.$3T_1=null}};CUI.MenuSection=function(a,b,c,d,e,f,g){this.$9_1=-1;CUI.MenuSection.initializeBase(this,[a,b,c,d]);this.$7d_1=e;this.$5D_1=f;this.$5l_1=g};CUI.MenuSection.prototype={$7d_1:false,$5D_1:null,$5l_1:null,$33_1:null,$E_1:null,$1f_1:null,$2A_0:function(){a:;this.ensureDOMElementAndEmpty();this.$33_1=CUI.Utility.$4("div");this.$33_1.className="ms-cui-menusection";this.get_$3_0().appendChild(this.$33_1);if(!CUI.ScriptUtility.isNullOrUndefined(this.get_title())){this.$E_1=CUI.Utility.$4("div");CUI.UIUtility.setInnerText(this.$E_1,this.get_title());this.$E_1.className="ms-cui-menusection-title";if(!CUI.ScriptUtility.isNullOrUndefined(this.$0_0.get_$4Z_1())&&!CUI.ScriptUtility.isNullOrUndefined(this.$0_0.get_$1R_1())){this.$E_1.style.backgroundColor=this.$0_0.get_$4Z_1();this.$E_1.style.color=this.$0_0.get_$1R_1()}this.$33_1.appendChild(this.$E_1)}this.$1f_1=CUI.Utility.$4("ul");this.$1f_1.className="ms-cui-menusection-items";var a;if(this.$5l_1==="Menu32"){if(!this.$0_0._textDirection)a="ms-cui-menusection-items32";else a="ms-cui-menusection-items32rtl";var b=this.$M_0;CUI.Menu.isInstanceOfType(b)&&CUI.Utility.ensureCSSClassOnElement(b.get_$3_0(),"ms-cui-menu32")}else if(this.$5l_1==="Menu16")if(!this.$0_0._textDirection)a="ms-cui-menusection-items16";else a="ms-cui-menusection-items16rtl";else a="";a!==""&&CUI.Utility.ensureCSSClassOnElement(this.$1f_1,a);if(this.$7d_1){this.$1f_1.style.overflowY="auto";this.$1f_1.style.position="relative"}if(!CUI.ScriptUtility.isNullOrEmptyString(this.$5D_1)){var c=parseInt(this.$5D_1)+2;this.$1f_1.style.maxHeight=this.$5D_1;this.$33_1.style.maxHeight=c+"px"}this.$33_1.appendChild(this.$1f_1);this.appendChildrenToElement(this.$1f_1);if(!CUI.ScriptUtility.isNullOrUndefined(this.$0_0.get_$4Z_1())&&!CUI.ScriptUtility.isNullOrUndefined(this.$0_0.get_$1R_1())){this.$1f_1.style.backgroundColor=this.$0_0.get_$4Z_1();this.$1f_1.style.color=this.$0_0.get_$1R_1()}},get_domElementTagName:function(){a:;return "div"},appendChildrenToElement:function(d){var a,c=this.$8_0.getEnumerator();while(c.moveNext()){var b=c.get_current();a=CUI.Utility.$4("li");a.className="ms-cui-menusection-items";b.$1x_0();a.appendChild(b.get_$3_0());d.appendChild(a);b.$3G_0()}},$17_0:function(){a:;if(!this.$8_0.$P_0)return;this.$9_1=0;var a=this.$8_0.getEnumerator();while(a.moveNext()){var b=a.get_current();b.$17_0()}},$80_0:function(){a:;if(!this.$8_0.$P_0)return;this.$9_1>-1&&this.$8_0.get_item(this.$9_1).$17_0();this.$9_1=0;this.$8_0.get_item(this.$9_1).$80_0()},$82_0:function(){a:;var a=this.$8_0.$P_0;if(!a)return;this.$9_1>-1&&this.$8_0.get_item(this.$9_1).$17_0();this.$9_1=a-1;this.$8_0.get_item(this.$9_1).$82_0()},$81_0:function(d){if(!this.$8_0.$P_0)return false;var b=0,a=this.$8_0.getEnumerator();while(a.moveNext()){var c=a.get_current();if(c.$81_0(d)){this.$9_1>-1&&this.$8_0.get_item(this.$9_1).$17_0();this.$9_1=b;return true}b++}return false},$6c_0:function(){a:;var b=this.$8_0.$P_0;if(this.$9_1===-1)this.$9_1=b-1;var a=this.$9_1,c=this.$8_0.getEnumeratorAtPos(a);while(c.movePrevious()){if(c.get_current().$6c_0()){if(a!==this.$9_1){this.$8_0.get_item(this.$9_1).$17_0();this.$9_1=a}return true}a--}b>0&&this.$8_0.get_item(this.$9_1).$17_0();this.$9_1=-1;return false},$6b_0:function(){a:;if(this.$9_1===-1)this.$9_1=0;var b=this.$8_0.getEnumeratorAtPos(this.$9_1),a=this.$9_1;while(b.moveNext()){if(b.get_current().$6b_0()){if(a!==this.$9_1){!CUI.ScriptUtility.isNullOrUndefined(this.$8_0.get_item(this.$9_1))&&this.$8_0.get_item(this.$9_1).$17_0();this.$9_1=a}return true}a++}this.$8_0.$P_0>0&&this.$8_0.get_item(this.$9_1).$17_0();this.$9_1=-1;return false},ensureCorrectChildType:function(a){if(!CUI.MenuItem.isInstanceOfType(a)&&!CUI.Gallery.isInstanceOfType(a)&&!CUI.GroupPopup.isInstanceOfType(a))throw Error.create("MenuSections can only have children of type MenuItem, Gallery or GroupPopup.")},$Ac_1:function(a){this.$1N_0=a;CUI.UIUtility.setInnerText(this.$E_1,a)},dispose:function(){a:;CUI.Component.prototype.dispose.call(this);this.$1f_1=null;this.$E_1=null;this.$33_1=null}};CUI.StandaloneDock=function(a,b){CUI.StandaloneDock.initializeBase(this,[a,b,"",""])};CUI.StandaloneDock.prototype={$2A_0:function(){a:;this.ensureDOMElementAndEmpty();this.appendChildrenToElement(this.get_$3_0());CUI.Component.prototype.$2A_0.call(this)},ensureCorrectChildType:function(a){if(!CUI.ControlComponent.isInstanceOfType(a))throw Error.create("Only children of type Control can be added to StandaloneDocks.")},get_visibleInDOM:function(){a:;return true}};CUI.StandaloneRootProperties=function(){a:;CUI.StandaloneRootProperties.initializeBase(this)};CUI.StandaloneRoot=function(b,a){a:;this.$2E_2={};CUI.StandaloneRoot.initializeBase(this,[b,a])};CUI.StandaloneRoot.prototype={get_createdControls:function(){a:;return this.$2E_2},get_rootType:function(){a:;return "Standalone"},get_$1c_1:function(){a:;if(!CUI.Root.prototype.get_$1c_1.call(this)){var a=new CUI.BuildOptions;a.lazyMenuInit=false;CUI.Root.prototype.set_$1c_1.call(this,new CUI.Builder(a,null,null));CUI.Root.prototype.get_$1c_1.call(this).$0_0=this}return CUI.Root.prototype.get_$1c_1.call(this)},set_$1c_1:function(a){CUI.Root.prototype.set_$1c_1.call(this,a);return a},setBuilder:function(a){a:;this.set_$1c_1(a);a.$0_0=this},get_standaloneRootProperties:function(){a:;return this.$7_1},addControl:function(a,c){a:;if(!CUI.ScriptUtility.isNullOrUndefined(this.$2E_2[a]))throw Error.create(String.format("Control id {0} already exists in this root.",a));var d=CUI.Builder.$98(c),b=this.get_$1c_1().$5M_0(d,new CUI.BuildContext);b.$AX_0(true);this.$2E_2[a]=b},removeControl:function(a){a:;var d=this.$2E_2[a];if(CUI.ScriptUtility.isNullOrUndefined(d))throw Error.create(String.format("Control with id '{0}' not found in root.",a));for(var c=this.$CD_2(a),b=0;b<c.length;b++)this.removeChild(c[b]);this.$2E_2[a]=null},getDOMElementForControlDisplayMode:function(b,c){a:;var d=this.$2E_2[b];if(CUI.ScriptUtility.isNullOrUndefined(d))throw Error.create(String.format("Control with id '{0}' not found in root.",b));var e=this.$CC_2(b,c),a=this.getChild(e);if(CUI.ScriptUtility.isNullOrUndefined(a)){a=new CUI.StandaloneDock(this,e);this.addChild(a)}CUI.ScriptUtility.isNullOrUndefined(a.getChild(b))&&a.addChild(d.createComponentForDisplayMode(c));return d.getDOMElementForDisplayMode(c)},pollForControlState:function(b){a:;var a=this.$2E_2[b];if(CUI.ScriptUtility.isNullOrUndefined(a))throw Error.create(String.format("Control with id '{0}' not found in root.",b));a.$AK_0()},$CC_2:function(a,b){return String.format("dock_{0}-{1}",a,b)},$CD_2:function(d){var b=[],a=this.$8_0.getEnumerator();while(a.moveNext()){var c=a.get_current();c.$6_0.startsWith("dock_"+d)&&Array.add(b,c.$6_0)}return b}};CUI.QAT=function(a,b){CUI.QAT.initializeBase(this,[a,b])};CUI.QAT.prototype={refresh:function(){a:;this.$2A_0();CUI.Root.prototype.refresh.call(this)},$2A_0:function(){a:;CUI.ScriptUtility.isNullOrUndefined(this.get_$3_0())&&this.$1x_0();this.set_$3_0(CUI.Utility.removeChildNodes(this.get_$3_0()));this.appendChildrenToElement(this.get_$3_0());this.$i_0=false},ensureCorrectChildType:function(a){a:;if(!CUI.ControlComponent.isInstanceOfType(a))throw Error.create("Only children of type ControlComponent can be added to a QAT")},get_cssClass:function(){a:;return "ms-cui-QAT "+CUI.Root.prototype.get_cssClass.call(this)},get_rootType:function(){a:;return "QAT"},get_visibleInDOM:function(){a:;return true},set_$DA_2:function(a){this.set_$1c_1(a);return a}};CUI.QATBuildContext=function(){a:;CUI.QATBuildContext.initializeBase(this)};CUI.QATBuildContext.prototype={QAT:null,qatId:null};CUI.QATBuildOptions=function(){a:;CUI.QATBuildOptions.initializeBase(this)};CUI.QATBuilder=function(c,a,b){a:;this.$$d_$Ct_1=Function.createDelegate(this,this.$Ct_1);CUI.QATBuilder.initializeBase(this,[c,a,b]);if(CUI.ScriptUtility.isNullOrUndefined(a))throw Error.create("QAT placeholder DOM element is null or undefined.")};CUI.QATBuilder.prototype={get_QAT:function(){a:;return this.$0_0},set_QAT:function(a){a:;this.$0_0=a;return a},buildQAT:function(c){a:;if(this.$2f_0)return false;if(this.isIdTrimmed(c))return true;var b=new CUI.QATBuildContext;b.qatId=c;this.$2f_0=true;var a=new CUI.DataQuery;a.id=b.qatId;a.queryType=5;a.handler=this.$$d_$Ct_1;a.data=b;this.$x_0.runQuery(a);return true},$Ct_1:function(a){var b=a.contextData;a.queryData=this.applyDataExtensions(a.queryData);this.set_QAT(this.$B8_1(CUI.DataNodeWrapper.getFirstChildNodeWithName(a.queryData,"QAT"),b));this.get_QAT().set_$DA_2(this);this.get_QAT()._percentPositivePattern=this.get_$8P_1().percentPositivePattern;this.get_QAT()._decimalSeparator=this.get_$8P_1().decimalSeparator;this.$26_0.onComponentCreated(this.get_QAT(),this.get_QAT().$6_0);if(this.get_$8P_1().attachToDOM)this.get_QAT().$4Y_0(true);else{this.get_QAT().$2A_0();this._elmPlaceholder.appendChild(this.get_QAT().get_$3_0());CUI.Utility.ensureCSSClassOnElement(this._elmPlaceholder,"loaded")}this.$8N_0(this.get_QAT());this.$26_0.onComponentBuilt(this.get_QAT(),this.get_QAT().$6_0)},$B8_1:function(d,f){if(CUI.ScriptUtility.isNullOrUndefined(d))throw Error.create("No QAT element was present in the data");var b=new CUI.DataNodeWrapper(d);this.set_QAT(new CUI.QAT(b.get_attributes()["Id"],b.get_attributes()));for(var c=CUI.DataNodeWrapper.getNodeChildren(CUI.DataNodeWrapper.getFirstChildNodeWithName(b.$f_0,"Controls")),a=0;a<c.length;a++)if(!this.isNodeTrimmed(c[a])){var e=this.$5M_0(c[a],f);this.get_QAT().addChild(e.createComponentForDisplayMode("Small"))}return this.get_QAT()},get_$8P_1:function(){a:;return this.$12_0}};CUI.RibbonPeripheralSection=function(){};CUI.ContextualGroup=function(a,b,c,d){this.$6_0=a;this.$1N_0=b;this.$2t_0=c;this.$n_0=d};CUI.ContextualGroup.$5R=function(a){switch(a){case 1:return "db";case 2:return "lb";case 3:return "tl";case 4:return "or";case 5:return "gr";case 6:return "mg";case 7:return "yl";case 8:return "pp";default:return ""}};CUI.ContextualGroup.prototype={$6_0:null,$1N_0:null,$2t_0:0,$n_0:null,$3B_0:0,get_id:function(){a:;return this.$6_0},get_count:function(){a:;return this.$3B_0},get_title:function(){a:;return this.$1N_0},get_color:function(){a:;return this.$2t_0},get_command:function(){a:;return this.$n_0},$1V_0:null,$E_0:null,$1p_0:null,get_$3_0:function(){a:;if(CUI.ScriptUtility.isNullOrUndefined(this.$1V_0)){this.$1V_0=CUI.Utility.$4("li");if(!CUI.ScriptUtility.isNullOrUndefined(this.$6_0))this.$1V_0.id=this.$6_0;this.$1V_0.className="ms-cui-cg";var c=CUI.ContextualGroup.$5R(this.$2t_0);c!==""&&CUI.Utility.ensureCSSClassOnElement(this.$1V_0,"ms-cui-cg-"+c);var a=CUI.Utility.$4("div");a.className="ms-cui-cg-i";if(!CUI.ScriptUtility.isNullOrUndefined(this.$6_0))a.id=this.$6_0+"_upper";this.$1V_0.appendChild(a);this.$E_0=CUI.Utility.$4("div");this.$E_0.className="ms-cui-cg-t";a.appendChild(this.$E_0);var b=CUI.Utility.$4("span");b.className="ms-cui-cg-t-i";CUI.UIUtility.setInnerText(b,this.$1N_0);this.$E_0.appendChild(b);this.$1p_0=CUI.Utility.$4("ul");this.$1p_0.className="ms-cui-ct-ul";if(!CUI.ScriptUtility.isNullOrUndefined(this.$6_0))this.$1p_0.id=this.$6_0+"_lower";this.$1V_0.appendChild(this.$1p_0);this.$3B_0=0}return this.$1V_0},$As_0:function(){a:;var a=$get(this.$6_0);if(!CUI.ScriptUtility.isNullOrUndefined(a)){this.$1V_0=a;this.$E_0=this.$1V_0.childNodes[0].childNodes[0];this.$1p_0=this.$1V_0.childNodes[1]}},$An_0:function(a){this.$1p_0.appendChild(a);this.$3B_0++;if(this.$3B_0===1)CUI.Utility.ensureCSSClassOnElement(this.$1p_0,"ms-cui-oneCtxTab");else this.$3B_0===2&&CUI.Utility.removeCSSClassFromElement(this.$1p_0,"ms-cui-oneCtxTab")},$Bq_0:function(){a:;!CUI.ScriptUtility.isNullOrUndefined(this.$1p_0)&&CUI.Utility.removeChildNodesSlow(this.$1p_0);this.$3B_0=0},dispose:function(){a:;this.$1V_0=null;this.$E_0=null;this.$1p_0=null;this.$3B_0=0}};CUI.DeclarativeTemplate=function(a){this.$$d_$Ba_1=Function.createDelegate(this,this.$Ba_1);CUI.DeclarativeTemplate.initializeBase(this);this.$x_1=new CUI.DataNodeWrapper(a)};CUI.DeclarativeTemplate.prototype={$x_1:null,createGroup:function(e,f,g,h,i,j,k,l){var a=new CUI.DeclarativeTemplateBuildContext;a.ribbon=e;a.controls=k;a.parameters=l;for(var b=e.$BT_3(f,g,h,i,j),c=0;c<this.$x_1.get_children().length;c++){var d=this.$BW_1(this.$x_1.get_children()[c],b,a);!CUI.ScriptUtility.isNullOrUndefined(d)&&b.addChild(d)}return b},$BW_1:function(b,d,e){var a=b.attrs.Title;if(a==="Popup"){var f=b.attrs.LayoutTitle;d.set_popupLayoutTitle(f);return null}var c=e.ribbon.$9D_3(d.$6_0+"-"+a,a);c.$8Y_0(this.$$d_$Ba_1,b,e);return c},$Ba_1:function(c,d,e){var a=c,b=e;this.$Bw_1(d,a,b);a.$8L_0(true);return a},$Bw_1:function(h,d,e){for(var b=h.children,c=0,a=0;a<b.length;a++){var f=b[a].name;if(f==="Section"){var g=this.$BX_1(b[a],e,d,c++);d.addChild(g)}else c=this.$8F_1(b[a],e,d,c)}},$BX_1:function(c,d,h,i){var b,e=c.attrs.Type,g=c.attrs.Alignment;switch(e){case "OneRow":b=2;break;case "TwoRow":b=3;break;case "ThreeRow":b=4;break;case "Divider":b=1;break;default:throw Error.create('Invalid Section attribute "Type" found in XML: '+e)}var f=1;if(g==="Middle")f=2;var a=d.ribbon.$2T_3(h.$6_0+"-"+i,b,f);if(b!==1){this.$8G_1(a.getRow(1),c.children[0],d);(a.$I_2===3||a.$I_2===4)&&this.$8G_1(a.getRow(2),c.children[1],d);a.$I_2===4&&this.$8G_1(a.getRow(3),c.children[2],d)}return a},$8G_1:function(d,g,e){for(var b=g.children,a=0;a<b.length;a++){var f=b[a].name,c=null;if(f==="ControlRef")c=this.$99_1(b[a],e);else if(f==="OverflowArea")this.$8F_1(b[a],e,d,a);else c=this.$BY_1(b[a],e,d,a);!CUI.ScriptUtility.isNullOrUndefined(c)&&d.addChild(c)}},$BY_1:function(g,d,h,i){for(var b=g.children,c=d.ribbon.$9G_3(h.$6_0+"-"+i),a=0;a<b.length;a++){var f=CUI.DataNodeWrapper.getNodeName(b[a]);if(f==="ControlRef"){var e=this.$99_1(b[a],d);!CUI.ScriptUtility.isNullOrUndefined(e)&&c.addChild(e)}else this.$8F_1(b[a],d,c,a)}if(!c.$8_0.$P_0)return null;return c},$99_1:function(f,g){var b=f.attrs,d=b["TemplateAlias"],e=b["DisplayMode"],a=g.controls[d],c=null;if(!CUI.ScriptUtility.isNullOrUndefined(a)&&CUI.Control.isInstanceOfType(a))c=a.createComponentForDisplayMode(e);return c},$8F_1:function(r,d,a,c){var i=CUI.DataNodeWrapper.getNodeAttributes(r),s=i["TemplateAlias"],m=CUI.DataNodeWrapper.getNodeName(r),j=d.controls[s];if(CUI.ScriptUtility.isNullOrUndefined(j))return c;var n=false,o=false,f=2;if(m==="OverflowSection"){n=CUI.Utility.$u(i["DividerBefore"]);o=CUI.Utility.$u(i["DividerAfter"]);if(n){var t=d.ribbon.$2T_3(a.$6_0+"-"+c++,1,1);a.addChild(t)}var p=i["Type"];switch(p){case "OneRow":f=2;break;case "TwoRow":f=3;break;case "ThreeRow":f=4;break;default:throw Error.create('Invalid Section attribute "Type" found in XML: '+p)}}var e=i["DisplayMode"];if(Array.isInstanceOfType(j))for(var q=j,b=null,g=0;g<q.length;g++){var k=q[g];if(m==="OverflowSection")if(f===2){if(CUI.ScriptUtility.isNullOrUndefined(b)){b=d.ribbon.$2T_3(a.$6_0+"-"+c++,2,1);a.addChild(b)}b.getRow(1).addChild(k.createComponentForDisplayMode(e))}else if(f===4){if(CUI.ScriptUtility.isNullOrUndefined(b)){b=d.ribbon.$2T_3(a.$6_0+"-"+c++,4,1);a.addChild(b)}b.getRow(g%3+1).addChild(k.createComponentForDisplayMode(e));if(g%3===2)b=null}else{if(CUI.ScriptUtility.isNullOrUndefined(b)){b=d.ribbon.$2T_3(a.$6_0+"-"+c++,3,1);a.addChild(b)}b.getRow(g%2+1).addChild(k.createComponentForDisplayMode(e));if(g%2===1)b=null}else a.addChild(k.createComponentForDisplayMode(e))}else{var l=j;if(m==="OverflowSection"){var h;if(f===2){h=d.ribbon.$2T_3(a.$6_0+"-"+c++,2,1);h.getRow(1).addChild(l.createComponentForDisplayMode(e))}else if(f===4){h=d.ribbon.$2T_3(a.$6_0+"-"+c++,4,1);h.getRow(1).addChild(l.createComponentForDisplayMode(e))}else{h=d.ribbon.$2T_3(a.$6_0+"-"+c++,3,1);h.getRow(1).addChild(l.createComponentForDisplayMode(e))}a.addChild(h)}else a.addChild(l.createComponentForDisplayMode(e))}if(o){var u=d.ribbon.$2T_3(a.$6_0+"-"+c++,1,1);a.addChild(u)}return c}};CUI.Group=function(a,b,c,d,e,f){CUI.Group.initializeBase(this,[a,b,c,d]);this.$n_2=e;this.$7_2=f};CUI.Group.prototype={$T_2:null,$E_2:null,$3Y_2:null,$W_2:null,$7_2:null,$2A_0:function(){a:;this.ensureDOMElementAndEmpty();if(CUI.ScriptUtility.isNullOrUndefined(this.$E_2)){this.$E_2=CUI.Utility.$4("span");this.$E_2.className="ms-cui-groupTitle"}else this.$E_2=CUI.Utility.removeChildNodes(this.$E_2);if(CUI.ScriptUtility.isNullOrUndefined(this.$T_2)){this.$T_2=CUI.Utility.$4("span");this.$T_2.className="ms-cui-groupBody"}else this.$T_2=CUI.Utility.removeChildNodes(this.$T_2);if(CUI.ScriptUtility.isNullOrUndefined(this.$3Y_2)){this.$3Y_2=CUI.Utility.$4("span");this.$3Y_2.className="ms-cui-groupSeparator"}var b=this.get_title();!CUI.ScriptUtility.isNullOrUndefined(b)&&CUI.UIUtility.setInnerText(this.$E_2,b);if(!CUI.ScriptUtility.isNullOrUndefined(this.$W_2)&&CUI.GroupPopupLayout.isInstanceOfType(this.$W_2)){this.$W_2.$1x_0();this.get_$3_0().appendChild(this.$W_2.get_$3_0());this.get_$3_0().appendChild(this.$3Y_2);this.$W_2.$3G_0()}else{var a=CUI.Utility.$4("span");a.className="ms-cui-groupContainer";a.appendChild(this.$T_2);a.appendChild(this.$E_2);this.get_$3_0().appendChild(a);this.get_$3_0().appendChild(this.$3Y_2);if(!CUI.ScriptUtility.isNullOrUndefined(this.$W_2)){this.$W_2.$1x_0();this.$T_2.appendChild(this.$W_2.get_$3_0());this.$W_2.$3G_0()}}CUI.Component.prototype.$2A_0.call(this)},$6Z_0:function(){a:;CUI.Component.prototype.$6Z_0.call(this);if(!CUI.ScriptUtility.isNullOrUndefined(this.$W_2)&&!CUI.GroupPopupLayout.isInstanceOfType(this.$W_2)){var a=this.get_$3_0().childNodes[0];this.$3Y_2=this.get_$3_0().childNodes[1];this.$T_2=a.childNodes[0];this.$E_2=a.childNodes[1]}},$4Y_0:function(a){this.$6Z_0();this.$X_0();this.$i_0=false;a&&!CUI.ScriptUtility.isNullOrUndefined(this.$W_2)&&this.$W_2.$4Y_0(true)},$1x_0:function(){a:;var a=this.get_$3_0();CUI.Component.prototype.$1x_0.call(this)},get_cssClass:function(){a:;return "ms-cui-group"},get_domElementTagName:function(){a:;return "li"},unselectLayout:function(){a:;this.selectLayout(null,null)},selectLayout:function(b,c){var a=null;if(b!=="Popup")a=CUI.ScriptUtility.isNullOrUndefined(b)?null:this.getChildByTitle(b);else{!CUI.ScriptUtility.isNullOrUndefined(c)&&this.set_popupLayoutTitle(c);this.$Bn_2();a=this.$4T_2}if(a===this.$W_2||CUI.ScriptUtility.isNullOrUndefined(a)&&CUI.ScriptUtility.isNullOrUndefined(this.$W_2))return;this.$W_2=!CUI.ScriptUtility.isNullOrUndefined(a)?a:null;if(!CUI.ScriptUtility.isNullOrUndefined(a)){a.$8Z_0(true);b==="Popup"&&this.$5G_2.$8Z_0(true)}this.$11_0()},get_selectedLayout:function(){a:;return this.$W_2},ensureCorrectChildType:function(a){if(!CUI.Layout.isInstanceOfType(a)&&!CUI.GroupPopupLayout.isInstanceOfType(a))throw Error.create("Only children of type Layout can be added to Groups");if(!CUI.ScriptUtility.isNullOrUndefined(this.getChildByTitle(a.get_title())))throw Error.create("A Layout with title "+a.get_title()+" already exists in this Group.")},get_$8O_2:function(){a:;if(CUI.ScriptUtility.isNullOrUndefined(this.$W_2)||CUI.ScriptUtility.isNullOrUndefined(this.$W_2.get_$3_0()))return false;return this.get_$3_0().offsetHeight<this.$W_2.get_$3_0().offsetHeight||this.get_$3_0().offsetWidth<this.$W_2.get_$3_0().offsetWidth},$n_2:null,get_command:function(){a:;return this.$n_2},$6F_2:null,get_popupLayoutTitle:function(){a:;return this.$6F_2},set_popupLayoutTitle:function(a){if(a==="Popup")throw Error.create("PopupLayoutTitle cannot be set to 'Popup'");var b=CUI.ScriptUtility.isNullOrUndefined(a)?null:this.getChildByTitle(a);if(CUI.ScriptUtility.isNullOrUndefined(b))throw Error.create("This Group does not have a Layout with Title: "+a);if(this.$6F_2===a)return a;this.$6F_2=a;!CUI.ScriptUtility.isNullOrUndefined(this.$4S_2)&&this.$4S_2.set_layoutTitle(a);return a},$4T_2:null,$3i_2:null,$4S_2:null,$5G_2:null,$6G_2:null,$Bn_2:function(){a:;if(!CUI.ScriptUtility.isNullOrUndefined(this.$4T_2))return;if(CUI.ScriptUtility.isNullOrUndefined(this.get_popupLayoutTitle()))throw Error.create("No PopupLayoutTitle has been set.");this.$4T_2=this.get_ribbon().$BV_3(this.$6_0+"-Popup",this);this.$5G_2=this.get_ribbon().$9E_1(this.$6_0+"-popupMenu",null,null,null);this.$6G_2=this.get_ribbon().$9F_1(this.$6_0+"-popupMenuSection",null,null,false,null,null);var a={};a.LabelText=this.get_title();var b=this.get_ribbon().get_ribbonProperties();if(!CUI.ScriptUtility.isNullOrUndefined(this.$7_2.Image32by32Popup)){a.Image32by32=this.$7_2.Image32by32Popup;a.Image32by32Class=this.$7_2.Image32by32PopupClass;a.Image32by32Top=this.$7_2.Image32by32PopupTop;a.Image32by32Left=this.$7_2.Image32by32PopupLeft}else{a.Image32by32=b.Image32by32GroupPopupDefault;a.Image32by32Class=b.Image32by32GroupPopupDefaultClass;a.Image32by32Left=b.Image32by32GroupPopupDefaultLeft;a.Image32by32Top=b.Image32by32GroupPopupDefaultTop}a.Command=this.$n_2;this.$3i_2=new CUI.Controls.FlyoutAnchor(this.get_ribbon(),this.$6_0+"-PopupAnchor",a,this.$5G_2);this.$3i_2.$5z_2=true;this.$3i_2.set_enabled(this.get_enabled());this.$4S_2=this.get_ribbon().$BU_3(this.$6_0+"-popupMenuItem",this);this.$4T_2.addChild(this.$3i_2.createComponentForDisplayMode("Large"));this.$5G_2.addChild(this.$6G_2);this.$6G_2.addChild(this.$4S_2);this.$4S_2.set_layoutTitle(this.get_popupLayoutTitle());this.addChild(this.$4T_2)},$4i_0:function(){a:;if(CUI.ScriptUtility.isNullOrUndefined(this.$n_2))this.set_enabled(true);else{var a=this.get_ribbon().$3x_1(this.$n_2,null,null,false);this.set_enabled((a&1)>0)}if(!this.get_enabled()||CUI.ScriptUtility.isNullOrUndefined(this.$W_2))return;this.$W_2.$4i_0()},onEnabledChanged:function(a){CUI.Component.prototype.onEnabledChanged.call(this,a);!CUI.ScriptUtility.isNullOrUndefined(this.$3i_2)&&this.$3i_2.set_enabled(a)},$8d_0:function(){a:;if(!CUI.ScriptUtility.isNullOrUndefined(this.$W_2)&&CUI.GroupPopupLayout.isInstanceOfType(this.$W_2)){this.$W_2.get_$3_0().getElementsByTagName("A")[0].focus();return true}return CUI.Component.prototype.$8d_0.call(this)}};CUI.GroupPopup=function(a,b,c){this.$$d_$CY_1=Function.createDelegate(this,this.$CY_1);CUI.GroupPopup.initializeBase(this,[a,b,"",""]);this.$3e_1=c};CUI.GroupPopup.prototype={$3e_1:null,$E_1:null,$T_1:null,$2A_0:function(){a:;this.ensureDOMElementAndEmpty();if(CUI.ScriptUtility.isNullOrUndefined(this.$E_1)){this.$E_1=CUI.Utility.$4("div");this.$E_1.className="ms-cui-groupTitle"}else this.$E_1=CUI.Utility.removeChildNodes(this.$E_1);if(CUI.ScriptUtility.isNullOrUndefined(this.$T_1)){this.$T_1=CUI.Utility.$4("div");this.$T_1.className="ms-cui-groupBody"}else this.$T_1=CUI.Utility.removeChildNodes(this.$T_1);CUI.UIUtility.setInnerText(this.$E_1,this.$3e_1.get_title());this.get_$3_0().appendChild(this.$T_1);this.get_$3_0().appendChild(this.$E_1);var a=this.$3e_1.getChildByTitle(this.$4J_1);if(CUI.ScriptUtility.isNullOrUndefined(a))throw Error.create("Cannot find Layout with title: "+this.$4J_1+" for this GroupPopup to use from the Group with id: "+this.$3e_1.$6_0);var b=a.clone(true);this.removeChildren();this.addChild(b);this.appendChildrenToElement(this.$T_1);CUI.Component.prototype.$2A_0.call(this)},$4J_1:null,get_layoutTitle:function(){a:;return this.$4J_1},set_layoutTitle:function(a){if(this.$4J_1===a)return a;this.$4J_1=a;this.$11_0();return a},get_cssClass:function(){a:;return "ms-cui-groupPopup"},$3z_1:null,$3J_0:function(a){if(a.$I_1===4){var b=a.get_sourceControl();if(this.$3z_1)return CUI.Component.prototype.$3J_0.call(this,a);this.$3z_1=b;this.$DZ_1()}else if(a.$I_1===10){this.$CK_1();this.$3z_1=null}return CUI.Component.prototype.$3J_0.call(this,a)},$3W_1:null,$5A_1:false,$DZ_1:function(){a:;if(this.$5A_1)return;if(!this.$3W_1){this.$3W_1=CUI.Utility.$9B();$addHandler(this.$3W_1,"click",this.$$d_$CY_1);this.get_$3_0().appendChild(this.$3W_1)}this.$3W_1.style.display="";this.$5A_1=true},$CK_1:function(){a:;if(!this.$5A_1)return;this.$3W_1.style.display="none";this.$5A_1=false},$CY_1:function(){this.$3z_1&&this.$3z_1.$5N_1()}};CUI.GroupPopupLayout=function(a,b,c){CUI.GroupPopupLayout.initializeBase(this,[a,b,"Popup"]);this.$3e_3=c};CUI.GroupPopupLayout.prototype={$3e_3:null,$2A_0:function(){a:;CUI.Layout.prototype.$2A_0.call(this)},get_cssClass:function(){a:;return null},ensureCorrectChildType:function(a){if(!CUI.ControlComponent.isInstanceOfType(a))throw Error.create("Only ControlComponents can be added to GroupPopupLayout.");if(this.$8_0.$P_0>0)throw Error.create("GroupPopupLayouts can only have one child")}};CUI.Layout=function(a,b,c){CUI.Layout.initializeBase(this,[a,b,c,""])};CUI.Layout.prototype={$2A_0:function(){a:;this.get_needsDelayIniting()&&this.doDelayedInit();this.ensureDOMElementAndEmpty();this.appendChildrenToElement(this.get_$3_0());CUI.Component.prototype.$2A_0.call(this)},$6Z_0:function(){a:;this.get_needsDelayIniting()&&this.doDelayedInit();this.set_$3_0($get(this.$M_0.$6_0+"-"+this.get_title()))},ensureCorrectChildType:function(a){if(!CUI.Section.isInstanceOfType(a))throw Error.create("Only children of Section can be added to a Layout")},get_cssClass:function(){a:;return "ms-cui-layout"},clone:function(c){this.get_needsDelayIniting()&&this.doDelayedInit();var a=this.get_ribbon().$9D_3("clonedLayout-"+this.get_ribbon().$2U_1(),this.get_title());if(!c)return a;var b=this.$8_0.getEnumerator();while(b.moveNext()){var d=b.get_current(),e=d.clone(c);a.addChild(e)}return a},get_visibleInDOM:function(){a:;if(CUI.Group.isInstanceOfType(this.$M_0)){var a=this.$M_0;return a.$W_2===this}else if(CUI.GroupPopup.isInstanceOfType(this.$M_0))return true;else return false}};CUI.RibbonEventCommandProperties=function(){a:;CUI.RibbonEventCommandProperties.initializeBase(this)};CUI.RibbonEventCommandProperties.prototype={Minimized:false,Maximized:false,Cancelable:false,CancelAction:false,ContextualGroupId:null};CUI.CommandContextSwitchCommandProperties=function(){};CUI.CommandContextSwitchCommandProperties.prototype={OldContextId:null,OldContextCommand:null,NewContextId:null,NewContextCommand:null,ChangedByUser:false};CUI.Ribbon=function(b,a){this.$$d_$Cd_3=Function.createDelegate(this,this.$Cd_3);this.$$d_$Cv_3=Function.createDelegate(this,this.$Cv_3);this.$$d_$Ce_3=Function.createDelegate(this,this.$Ce_3);this.$7S_3=new Date(0);CUI.Ribbon.initializeBase(this,[b,a]);this.$w_3={};this.$60_3=a.ShortcutKeyJumpToRibbon_Ctrl+a.ShortcutKeyJumpToRibbon_Alt+a.ShortcutKeyJumpToRibbon_Shift+a.ShortcutKeyJumpToRibbon_AccessKey;this.$7Q_3=a.ShortcutKeyJumpToFirstControl_Ctrl+a.ShortcutKeyJumpToFirstControl_Alt+a.ShortcutKeyJumpToFirstControl_Shift+a.ShortcutKeyJumpToFirstControl_AccessKey};CUI.Ribbon.prototype={$C_3:null,$1v_3:null,$1l_3:null,$z_3:null,$d_3:null,$p_3:null,$8l_3:null,$1U_3:null,$2J_3:null,$j_3:null,$31_3:null,$7V_3:null,$1n_3:null,$1m_3:null,$1o_3:null,$1j_3:null,$1i_3:null,$1k_3:null,$39_3:false,$32_3:null,$4H_3:null,$7Q_3:null,$60_3:null,$7X_3:null,$7Y_3:null,$7W_3:null,$7D_3:false,$68_3:null,get_storedFocus:function(){a:;return this.$32_3},set_storedFocus:function(a){a:;this.$32_3=a;return a},$8h_3:function(a){if(CUI.ScriptUtility.isNullOrUndefined(a))return false;else if(!CUI.ScriptUtility.isNullOrUndefined(a.id)&&a.id==="Ribbon")return false;else if(a.tagName==="BODY")return true;else return this.$8h_3(a.parentNode)},refresh:function(){a:;this.$2A_0();CUI.Root.prototype.refresh.call(this);this.$DI_2()},$2A_0:function(){a:;CUI.Root.prototype.$2A_0.call(this);this.$1x_0();this.$CI_3();var b=null,h=null,e=null,c=null,d=null;CUI.Utility.removeChildNodesSlow(this.$p_3);var n=this.$w_3;for(var q in n){var w={key:q,value:n[q]},x=w.value;x.$Bq_0()}var r=0,i=new CUI.List,o=this.$8_0.getEnumerator();while(o.moveNext()){var u=o.get_current();if(u.get_visible()){i.add(u);r++}}var j=0,s=i.$P_0,t=!(CUI.ScriptUtility.isNullOrEmptyString(this.get_ribbonProperties().ATTabPositionText)||CUI.ScriptUtility.isNullOrEmptyString(this.get_ribbonProperties().ATContextualTabText)),p=i.getEnumerator();while(p.moveNext()){var a=p.get_current();a.$7w_2();if(CUI.ScriptUtility.isNullOrUndefined(h)){h=a;this.$4H_3=h.$6_0}a.$DF_2();if(a.$13_2){if(!c||a.$s_2!==c){if(a.$s_2!==c)!CUI.ScriptUtility.isNullOrUndefined(e)&&e.$13_2&&CUI.Utility.ensureCSSClassOnElement(e.$E_2,"ms-cui-ct-last");c=a.$s_2;d=this.$w_3[a.$s_2];CUI.Utility.removeCSSClassFromElement(d.get_$3_0(),"ms-cui-cg-s");this.$8X_3(0);this.$p_3.appendChild(d.get_$3_0());CUI.Utility.ensureCSSClassOnElement(a.$E_2,"ms-cui-ct-first")}d.$An_0(a.$E_2)}else{if(c){CUI.Utility.ensureCSSClassOnElement(e.$E_2,"ms-cui-ct-last");c=null;d=null}if(t){j++;a.$AW_2(this.get_ribbonProperties().ATTabPositionText,null,null,j,s)}this.$p_3.appendChild(a.$E_2)}if(a===this.$C_3)b=a;e=a}if(c){CUI.Utility.ensureCSSClassOnElement(e.$E_2,"ms-cui-ct-last");e=null;c=null;d=null}var k=1;if(t)for(var l=0;l<r;l++){var f=i.get_item(l);if(f.$13_2){if(f.$s_2!==c){c=f.$s_2;d=this.$w_3[f.$s_2];k=1}f.$9K_2();f.$AW_2(this.get_ribbonProperties().ATTabPositionText,this.get_ribbonProperties().ATContextualTabText,d.$1N_0,k+j,s);k++}}if(!CUI.ScriptUtility.isNullOrUndefined(b))if(b.$13_2){var v=this.$6g_3(b.$s_2);CUI.Utility.ensureCSSClassOnElement(v.get_$3_0(),"ms-cui-cg-s");this.$8X_3(v.$2t_0)}else{if(!CUI.ScriptUtility.isNullOrUndefined(this.$4t_3)){CUI.Utility.removeCSSClassFromElement(this.$d_3,this.$4t_3);this.$4t_3=null}var m=b.$77_2;if(!CUI.ScriptUtility.isNullOrEmptyString(m)){CUI.Utility.ensureCSSClassOnElement(this.$d_3,m);this.$4t_3=m}}if(CUI.ScriptUtility.isNullOrUndefined(b)&&!this.$25_3){b=!CUI.ScriptUtility.isNullOrUndefined(this.$63_3)?this.$63_3:h;this.$6p_3(b)}if(this.$25_3)b=null;this.$DG_3();this.$Df_3();if(!CUI.ScriptUtility.isNullOrUndefined(b)){b.get_$AP_0()&&CUI.Utility.disableElement(this.$j_3);var y=this.$j_3.className.indexOf("ms-cui-disabled")!==-1;this.$j_3.className=b.$CB_2()+(y?" ms-cui-disabled":"")}this.$X_0();this.$i_0=false;if(this.$67_3&&!CUI.ScriptUtility.isNullOrUndefined(this.get_ribbonProperties().RootEventCommand)){var g=new CUI.RibbonEventCommandProperties;g.RootId=this.$6_0;g.RootType="Ribbon";g.Minimized=this.get_minimized();g.Maximized=!this.get_minimized();this.raiseCommandEvent(this.get_ribbonProperties().RootEventCommand,11,g);this.$67_3=false}},$DG_3:function(){a:;if(!CUI.ScriptUtility.isNullOrUndefined(this.get_ribbonProperties().PreTabSwitchCommand)){var a=new CUI.CommandContextSwitchCommandProperties;if(!CUI.ScriptUtility.isNullOrUndefined(this.$1v_3)&&this.$1v_3!==this.$C_3){a.OldContextId=this.$1v_3.$6_0;a.OldContextCommand=this.$1v_3.$n_2}else{a.OldContextId=null;a.OldContextCommand=null}if(!CUI.ScriptUtility.isNullOrUndefined(this.$C_3)){a.NewContextId=this.$C_3.$6_0;a.NewContextCommand=this.$C_3.$n_2;a.ChangedByUser=this.$C_3.$4U_2;this.raiseCommandEvent(this.get_ribbonProperties().PreTabSwitchCommand,2,a)}}},$4Y_0:function(f){this.$6Z_0();this.$X_0();this.$i_0=false;var e=this.$8_0;if(f)if(!CUI.ScriptUtility.isNullOrUndefined(e)){var c=e.getEnumerator();while(c.moveNext()){var a=c.get_current();if(!a.get_visible())continue;if(!CUI.ScriptUtility.isNullOrUndefined(this.$C_3)&&this.$C_3===a)this.$C_3.$4Y_0(f);else{a.$8x_2();a.$8y_2()}}}if(!CUI.ScriptUtility.isNullOrUndefined(this.$w_3)){var b=this.$w_3;for(var d in b){var g={key:d,value:b[d]};g.value.$As_0()}}},$6Z_0:function(){a:;CUI.Component.prototype.$6Z_0.call(this);!CUI.Utility.$6n()&&CUI.Utility.removeCSSClassFromElement(this.get_$3_0(),"ms-cui-needIEFilter");var a=this.get_$3_0().childNodes;this.$8l_3=$get("cui-"+this.$6_0+"-scrollCurtain");this.$31_3=a[0];this.$1l_3=a[1];this.$z_3=this.$1l_3.childNodes[0];this.$d_3=this.$1l_3.childNodes[1];this.$1U_3=this.$d_3.childNodes[0];if(a.length>2)this.$j_3=a[2];this.$2J_3=CUI.Utility.$6i(this.$z_3,"ms-cui-qat-container");this.$p_3=CUI.Utility.$6i(this.$d_3,"ms-cui-tts");if(CUI.ScriptUtility.isNullOrUndefined(this.$p_3))this.$p_3=CUI.Utility.$6i(this.$d_3,"ms-cui-tts-scale-1");if(CUI.ScriptUtility.isNullOrUndefined(this.$p_3))this.$p_3=CUI.Utility.$6i(this.$d_3,"ms-cui-tts-scale-2")},$X_0:function(){a:;this.$7X_3=this.$$d_$Ce_3;this.$7Y_3=this.$$d_$Cv_3;this.$7W_3=this.$$d_$Cd_3;$addHandler(this.get_$3_0(),"keydown",this.$7Y_3);if(!this.$7D_3){$addHandler(document,"keydown",this.$7X_3);$addHandler(this.$j_3,"keydown",this.$7W_3);this.$7D_3=true}CUI.ScalableRoot.prototype.$X_0.call(this)},$Ce_3:function(a){if(!CUI.ScriptUtility.isNullOrUndefined(a)&&!CUI.ScriptUtility.isNullOrUndefined(a.rawEvent)){var e=a.rawEvent.keyCode,b=a.ctrlKey?"t":"f";b+=a.altKey?"t":"f";b+=a.shiftKey?"t":"f";try{b+=String.fromCharCode(_processKeyCodes(e))}catch(d){return}var c=a.target;if(b===this.$7Q_3){this.$94_3();this.jumpToLastFocused(c)}else if(b===this.$60_3||!CUI.ScriptUtility.isNullOrEmptyString(this.$60_3)&&a.ctrlKey&&a.keyCode===117){a.preventDefault();a.stopPropagation();this.$94_3();this.jumpToRibbonTab(c)}}},$94_3:function(){a:;if(!CUI.ScriptUtility.isNullOrUndefined(document.selection)&&document.selection.type==="Control"){for(var a=document.selection.createRange(),b=a.length;b>0;b--)a.remove(b-1);a.select()}},jumpToLastFocused:function(a){a:;this.$1s_1&&this.$0_0.$4a_1();if(this.$8h_3(a))this.$32_3=a;if(!CUI.ScriptUtility.isNullOrUndefined(this.get_$q_1())){try{this.setFocus()}catch(b){}return}this.setFocusOnRibbon()},jumpToRibbonTab:function(a){a:;if(this.$8h_3(a))this.$32_3=a;this.$1s_1&&this.$0_0.$4a_1();if(!CUI.ScriptUtility.isNullOrEmptyString(this.$4H_3)){var b=$get(this.$4H_3+"-title");!CUI.ScriptUtility.isNullOrUndefined(b)&&b.firstChild.focus()}},setFocusOnTabTitle:function(){a:;if(!CUI.ScriptUtility.isNullOrEmptyString(this.$4H_3)){var a=$get(this.$4H_3+"-title");!CUI.ScriptUtility.isNullOrUndefined(a)&&a.firstChild.focus()}},$Cd_3:function(a){if(!CUI.ScriptUtility.isNullOrUndefined(a)&&!CUI.ScriptUtility.isNullOrUndefined(a.rawEvent)){var b=a.rawEvent.keyCode;if((a.ctrlKey||a.shiftKey)&&(b===39&&!this.$0_0._textDirection)||b===37&&this.$0_0._textDirection===1){a.preventDefault();a.stopPropagation();this.$C_3.$A5_2(true)}else if((a.ctrlKey||a.shiftKey)&&(b===37&&!this.$0_0._textDirection)||b===39&&this.$0_0._textDirection===1){a.preventDefault();a.stopPropagation();this.$C_3.$A5_2(false)}}},setFocusOnRibbon:function(){a:;if(this.$25_3)this.setFocusOnTabTitle();else this.$C_3.$AZ_2()},setFocusOnCurrentTab:function(){a:;if(!CUI.ScriptUtility.isNullOrUndefined(this.$C_3))this.$C_3.$DR_2();else this.setFocusOnRibbon()},setFocus:function(){a:;(this.$25_3||!CUI.Root.prototype.setFocus.call(this))&&this.setFocusOnTabTitle();return true},$Cv_3:function(a){if(!CUI.ScriptUtility.isNullOrUndefined(a)&&!CUI.ScriptUtility.isNullOrUndefined(a.rawEvent)&&!this.$1s_1)if(a.rawEvent.keyCode===27&&!CUI.ScriptUtility.isNullOrUndefined(this.$32_3)){a.stopPropagation();a.preventDefault();try{this.$32_3.focus()}catch(b){}this.$32_3=null}},$w_3:null,addContextualGroup:function(a,e,d,c){a:;var b=this.$w_3[a];if(!CUI.ScriptUtility.isNullOrUndefined(b))throw Error.create("A contextual group with id: "+a+" has already been added to this ribbon.");b=new CUI.ContextualGroup(a,e,d,c);this.$w_3[a]=b},get_contextualGroupIds:function(){a:;var c=[],a=this.$w_3;for(var b in a){var d={key:b,value:a[b]};Array.add(c,d.key)}return c},removeContextualGroup:function(a){a:;var d=this.$w_3[a];if(!CUI.ScriptUtility.isNullOrUndefined(d)){var b=this.$8_0.getEnumerator();while(b.moveNext()){var c=b.get_current();if(c.$13_2&&c.$s_2===a)throw Error.create("You cannot remove a contextual group when there are Tabs that refer to it.")}delete this.$w_3[a]}},showContextualGroup:function(a){a:;this.$8g_3(a,true)},hideContextualGroup:function(a){a:;this.$8g_3(a,false)},$8g_3:function(a,c){var f=this.$w_3[a];if(CUI.ScriptUtility.isNullOrUndefined(f))throw Error.create("This ribbon does not contain a contextual group with id: "+a);var e=false,d=this.$8_0.getEnumerator();while(d.moveNext()){var b=d.get_current();if(b.$s_2===a){if(b.get_visible()!==c)e=true;b.set_$74_0(c)}}if(e){this.$11_0();if(c)return a}return null},$DH_3:function(c){var a=this.get_ribbonProperties().ShowContextualGroupCommand;if(!CUI.ScriptUtility.isNullOrUndefined(a)){var b=new CUI.RibbonEventCommandProperties;b.ContextualGroupId=c;this.raiseCommandEvent(a,1,b)}},$6g_3:function(a){return this.$w_3[a]},addChildAtIndex:function(b,c){a:;this.ensureCorrectChildType(b);var a=b;if(CUI.ScriptUtility.isNullOrUndefined(a))throw Error.create("child must not be null or undefined.");if(a.$13_2){var d=this.$w_3[a.$s_2];if(CUI.ScriptUtility.isNullOrUndefined(d))throw Error.create("A contextual tab with contextual group id: "+a.$s_2+" cannot be added because  the ribbon does not have a contextual group with this id.")}CUI.Component.prototype.addChildAtIndex.call(this,b,c)},ensureCorrectChildType:function(a){a:;if(!CUI.Tab.isInstanceOfType(a))throw Error.create("Only children of type Tab can be added to a Ribbon")},get_cssClass:function(){a:;return "ms-cui-ribbon"},get_rootType:function(){a:;return "Ribbon"},$9L_3:function(){a:;if(CUI.ScriptUtility.isNullOrUndefined(this.$1U_3)){this.$1U_3=CUI.Utility.$4("div");this.$1U_3.id="jewelcontainer";this.$1U_3.className="ms-cui-jewel-container";this.$1U_3.style.display="none";this.$d_3.appendChild(this.$1U_3)}},$Bo_3:function(){a:;if(CUI.ScriptUtility.isNullOrUndefined(this.$2J_3)){this.$2J_3=CUI.Utility.$4("span");this.$2J_3.className="ms-cui-qat-container";this.$z_3.appendChild(this.$2J_3)}},$91_3:function(c,d,e){var a=new CUI.QATBuildOptions;a.attachToDOM=d;a.trimmedIds=this.get_$2o_3().$12_0.trimmedIds;var b=new CUI.QATBuilder(a,this.$2J_3,this.get_$2o_3().$26_0);b.$x_0=e;if(!b.buildQAT(c))throw Error.create("QAT could not be built");this._qat=b.get_QAT();this.$z_3.style.display="block"},$90_3:function(c,d,e){this.$1U_3.style.display="block";var a=new CUI.JewelBuildOptions;a.attachToDOM=d;a.trimmedIds=this.get_$2o_3().$12_0.trimmedIds;var b=new CUI.JewelBuilder(a,this.$1U_3,this.get_$2o_3().$26_0);b.$x_0=e;if(!b.buildJewel(c))throw Error.create("Jewel could not be built");this._jewel=b.get_jewel()},_qat:null,get_QAT:function(){a:;return this._qat},set_QAT:function(a){a:;this._qat=a;return a},_jewel:null,get_jewel:function(){a:;return this._jewel},set_jewel:function(a){a:;this._jewel=a;return a},$BZ_3:function(a,b,c,d,e,f){return new CUI.Tab(this,a,b,c,d,false,null,e,f)},$BQ_3:function(a,b,c,d,e,f,g){return new CUI.Tab(this,a,b,c,d,true,e,f,g)},$BT_3:function(a,b,c,d,e){return new CUI.Group(this,a,c,d,e,b)},$BU_3:function(a,b){return new CUI.GroupPopup(this,a,b)},$BV_3:function(a,b){return new CUI.GroupPopupLayout(this,a,b)},$9D_3:function(a,b){return new CUI.Layout(this,a,b)},$2T_3:function(a,b,c){return new CUI.Section(this,a,b,c)},$9G_3:function(a){return new CUI.Strip(this,a)},$63_3:null,$Df_3:function(){a:;!CUI.ScriptUtility.isNullOrUndefined(this.$C_3)&&this.$C_3.$1x_0();if(!CUI.ScriptUtility.isNullOrUndefined(this.$C_3)&&!this.$C_3.$13_2)this.$63_3=this.$C_3;if(CUI.ScriptUtility.isNullOrUndefined(this.$C_3)||!this.$C_3.$8_0.$P_0)!CUI.ScriptUtility.isNullOrUndefined(this.get_$3_0())&&!CUI.ScriptUtility.isNullOrUndefined(this.$j_3)&&this.get_$3_0().lastChild===this.$j_3&&this.get_$3_0().removeChild(this.$j_3);else!CUI.ScriptUtility.isNullOrUndefined(this.$j_3)&&this.get_$3_0().appendChild(this.$j_3);if(CUI.ScriptUtility.isNullOrUndefined(this.$C_3))return;var c=this.$C_3.$i_0;this.$C_3.$3G_0();if(this.$C_3.$8_0.$P_0>0&&!CUI.ScriptUtility.isNullOrUndefined(this.$j_3)){var b=false;if(this.$j_3.hasChildNodes()){b=this.$j_3.firstChild===this.$C_3.get_$3_0();!b&&this.$j_3.removeChild(this.$j_3.firstChild)}!b&&this.$j_3.appendChild(this.$C_3.get_$3_0())}if(!CUI.ScriptUtility.isNullOrUndefined(this.get_ribbonProperties().TabSwitchCommand)&&this.$1v_3!==this.$C_3){var a=new CUI.CommandContextSwitchCommandProperties;if(!CUI.ScriptUtility.isNullOrUndefined(this.$1v_3)&&this.$1v_3!==this.$C_3){a.OldContextId=this.$1v_3.$6_0;a.OldContextCommand=this.$1v_3.$n_2}else{a.OldContextId=null;a.OldContextCommand=null}if(!CUI.ScriptUtility.isNullOrUndefined(this.$C_3)){a.NewContextId=this.$C_3.$6_0;a.NewContextCommand=this.$C_3.$n_2;a.ChangedByUser=this.$C_3.$4U_2}this.raiseCommandEvent(this.get_ribbonProperties().TabSwitchCommand,2,a);this.$Dh_3(this.$C_3)}if(!CUI.ScriptUtility.isNullOrUndefined(this.$C_3)){this.$C_3.$4U_2=false;this.$C_3.$16_2&&this.$C_3.$AZ_2()}},$6p_3:function(a){if(!CUI.ScriptUtility.isNullOrUndefined(a)){this.$11_0();a.$8f_2(true,false);if(this.$C_3&&this.$C_3.$13_2){var c=this.$6g_3(this.$C_3.$s_2),b=CUI.ContextualGroup.$5R(c.$2t_0);if(b!=="")this.$2v_3="ms-cui-ct-topBar-"+b}!a.$13_2&&this.$8X_3(0);!CUI.ScriptUtility.isNullOrUndefined(this.$C_3)&&this.$C_3!==a&&this.$C_3.$8f_2(false,false);this.$C_3=a;this.set_$3w_3(false)}this.set_$q_1(null)},$Dh_3:function(a){this.$1v_3=a},selectTabById:function(b){a:;var a=this.getChild(b);if(!CUI.ScriptUtility.isNullOrUndefined(a)){if(a.get_selected()&&a.get_visible())return true;a.$13_2&&!a.get_visible()&&this.showContextualGroup(a.$s_2);if(a.get_visible()){a.set_selected(true);return true}}return false},selectTabByCommand:function(a){a:;if(this.get_selectedTabCommand()===a)return true;var b=this.$8_0.getEnumerator();while(b.moveNext()){var c=b.get_current();if(c.$n_2===a)return this.selectTabById(c.$6_0)}return false},$8X_3:function(b){var a=CUI.ContextualGroup.$5R(b);if(a===""){CUI.Utility.removeCSSClassFromElement(this.$d_3,this.$2v_3);this.$2v_3=null}else{this.$2v_3&&CUI.Utility.removeCSSClassFromElement(this.$d_3,this.$2v_3);this.$2v_3="ms-cui-ct-topBar-"+a;CUI.Utility.ensureCSSClassOnElement(this.$d_3,this.$2v_3)}},$2v_3:null,$4t_3:null,get_selectedTabCommand:function(){a:;return this.$C_3?this.$C_3.$n_2:null},get_selectedTabId:function(){a:;return this.$C_3?this.$C_3.$6_0:null},$9q_3:function(){a:;if(CUI.ScriptUtility.isNullOrUndefined(this.$C_3))return 0;return this.$j_3.offsetHeight-this.$C_3.get_$3_0().offsetHeight},$6j_3:function(){a:;if(CUI.ScriptUtility.isNullOrUndefined(this.$C_3))return 0;return this.$j_3.offsetWidth-this.$C_3.$CF_2()},$8D_3:function(){a:;return this.get_$3_0().offsetWidth},$9n_3:function(){a:;return 100},$9u_3:function(){a:;this.$7V_3=this.get_$3_0().style.display;this.get_$3_0().style.display="none";return},$DY_3:function(){a:;this.get_$3_0().style.display=this.$7V_3;if(this.$8D_3()<this.$9n_3()){this.get_$3_0().style.display="none";return}},$DK_3:function(m){var c=20;if(CUI.ScriptUtility.isNullOrUndefined(this.get_$3_0()))return false;if(!CUI.ScriptUtility.isNullOrUndefined(this.$C_3)&&!this.$C_3.$6L_2){var e=null;if(this.$4W_1)e=this.getLocalDataValue(this.$C_3.$6_0);var k=this._lastWindowResizeWidthHeight;if(!CUI.ScriptUtility.isNullOrUndefined(e)&&e.startsWith(k)){var a=e.split("|");if(!CUI.ScriptUtility.isNullOrUndefined(a)&&a.length===4){var b=parseInt(a[1]),j=parseInt(a[2]),l=a[3];c=j>c?j:c;if(!isNaN(b)&&b>=0)if(b>=0&&b<this.$C_3.get_scaling().$1w_0.length){this.$C_3.scaleIndex(b);this.$C_3.$6L_2=true;this.$2A_0();if(l===this.get_$1c_1().get_ribbonBuildOptions().scalingHint){this.$C_3.$62_2=this._lastWindowResizeWidthHeight;return true}}}}}if(CUI.ScriptUtility.isNullOrUndefined(this.$C_3))return false;this.$C_3.$i_0&&this.$2A_0();if(m&&this.$8D_3()>0)if(!CUI.ScriptUtility.isNullOrUndefined(this.get_$3_0()))if(this.get_$3_0().style.display!=="none"&&this.$8D_3()<this.$9n_3())this.$9u_3();else this.get_$3_0().style.display==="none"&&this.$DY_3();var d=0,g=false;while((this.$6j_3()<0||this.$9q_3()<0||this.$C_3.get_$8O_2())&&d<25){if(!this.$C_3.scaleDown()){g=true;break}this.$2A_0();d++}if(g);var f=0,h=0;if(d<=0)while(this.$6j_3()>c&&f<25){if(!this.$C_3.scaleUp())break;this.$2A_0();f++;if(this.$6j_3()<=0||this.$9q_3()<0||this.$C_3.get_$8O_2()){this.$C_3.scaleDown();this.$2A_0();h++;break}}if(this.$4W_1&&this.$C_3.$1G_2>=-1){this.$Dc_3();this.$C_3.$6L_2=true}this.$C_3.$62_2=this._lastWindowResizeWidthHeight;this.$8T_3();var i=d>0||f-h>0;if(i)!CUI.ScriptUtility.isNullOrUndefined(this.get_ribbonProperties().ScaleCommand)&&this.raiseCommandEvent(this.get_ribbonProperties().ScaleCommand,1,null);return i},$DW_3:function(){a:;return this.$0_0._textDirection===1&&CUI.Utility.$3v()},$DS_3:function(){a:;this.$p_3.style.width="auto";var a=this.$93_3(this.$p_3);this.$p_3.style.width=a+"px";this.$p_3.setAttribute("_widthAdded",true)},$93_3:function(h){for(var a=0,e=h.children,g=e.length,d=0;d<g;d++){var b=e[d];if(!CUI.ScriptUtility.isNullOrUndefined(b)&&b.nodeName==="LI"&&b.offsetWidth>0){var c=b.childNodes[1];if(!CUI.ScriptUtility.isNullOrUndefined(c)&&c.nodeName==="UL"){c.style.width="auto";var f=this.$93_3(c);c.style.width=f+"px";a=a+f+4}else a=a+b.offsetWidth+2}}return a},get_$8v_3:function(){a:;var a=this.get_$1c_1();if(CUI.ScriptUtility.isNullOrUndefined(a))return true;var b=a.get_ribbonBuildOptions();if(CUI.ScriptUtility.isNullOrUndefined(b))return true;return b.lazyTabInit&&this.get_headerScalingEnabled()},$8T_3:function(){a:;this.$DW_3()&&this.$DS_3();this.scaleHeaderInternal(this.$1l_3);if(!CUI.ScriptUtility.isNullOrUndefined(this.$p_3)){var c=this.$p_3.className,a=0;if(c.indexOf("ms-cui-tts-scale-1")!==-1)a=1;else if(c.indexOf("ms-cui-tts-scale-2")!==-1)a=2;var b=this.$8_0.getEnumerator();while(b.moveNext()){var d=b.get_current();d.onTitleScale(a)}}},$DI_2:function(){a:;if(this.$25_3){this.$8T_3();return false}var a=this.$DK_3(false);this.$7S_3=new Date;return a},$DJ_3:function(a){!CUI.ScriptUtility.isNullOrUndefined(this.$C_3)&&this.$C_3.$AR_2(a)},get_$CR_3:function(){a:;return this.$7S_3.getTime()},$Dc_3:function(){a:;this.storeLocalData(this.$C_3.$6_0,CUI.Utility.$3s().toString()+CUI.Utility.$4e().toString()+"|"+this.$C_3.$1G_2.toString()+"|"+this.$6j_3().toString()+"|"+this.get_$1c_1().get_ribbonBuildOptions().scalingHint)},$25_3:false,$8q_3:false,$67_3:false,get_minimized:function(){a:;return this.$25_3},set_minimized:function(a){a:;if(this.$25_3!==a){this.set_$3w_3(a);!a&&this.get_$5U_1()&&this.pollForStateAndUpdate()}return a},$7T_3:false,get_$3w_3:function(){a:;return this.$25_3},set_$3w_3:function(a){if(this.$25_3!==a||!this.$7T_3){this.$11_0();this.$8q_3=!a;this.$67_3=true;this.$25_3=a;this.$7T_3=true;if(!a)CUI.Utility.ensureCSSClassOnElement(this.$d_3,"ms-cui-topBarMaximized");else CUI.Utility.removeCSSClassFromElement(this.$d_3,"ms-cui-topBarMaximized");if(a&&!CUI.ScriptUtility.isNullOrUndefined(this.$C_3)){this.$C_3.$8f_2(false,false);this.$C_3=null}}return a},$4i_0:function(){a:;this.set_$4g_0(new Date);this.$2D_1=false;var i={},a=[],e=this.$w_3;for(var f in e){var b={key:f,value:e[f]},g=b.value,c=false;if(!CUI.ScriptUtility.isNullOrUndefined(g.$n_0))c=this.get_rootUser().isRootCommandEnabled(g.$n_0,this);if(c)i[b.key]=true;var h=this.$8g_3(b.key,c);h&&Array.add(a,h)}this._qat&&this._qat.pollForStateAndUpdate();this._jewel&&this._jewel.pollForStateAndUpdate();if(this.$i_0){this.$2A_0();this.$8T_3();for(var d=0;d<a.length;d++)this.$DH_3(a[d])}!CUI.ScriptUtility.isNullOrUndefined(this.$C_3)&&this.$C_3.$4i_0();if(this.$2D_1){this.$DI_2();this.$2D_1=false}this.ensureGlobalDisablingRemoved()},$3J_0:function(a){if(a.$I_1!==11){a.get_commandInfo().RootLocation=a.$I_1===2?"UpperRibbon":"LowerRibbon";if(a.$I_1===2){var b=a.$37_1;a.get_commandInfo().TabId=b.NewContextId}}return CUI.Root.prototype.$3J_0.call(this,a)},get_jewelElement:function(){a:;return this.$1U_3},set_jewelElement:function(a){a:;this.$1U_3=a;return a},get_ribbonProperties:function(){a:;return this.$7_1},get_$2o_3:function(){a:;return this.get_$1c_1()},set_$2o_3:function(a){this.set_$1c_1(a);return a},$8n_3:null,get_domElementTagName:function(){a:;return "div"},$1x_0:function(){a:;CUI.Root.prototype.$1x_0.call(this);this.get_$3_0().setAttribute("aria-describedby","ribboninstructions");this.get_$3_0().setAttribute("role","toolbar");this.$Bs_3();this.$Bt_3();this.$Bo_3();this.$9L_3();this.$Bp_3();this.$Bm_3();this.$9L_3()},$Bt_3:function(){a:;if(CUI.ScriptUtility.isNullOrUndefined(this.$z_3)){this.$z_3=CUI.Utility.$4("div");this.$z_3.className="ms-cui-topBar1";this.$z_3.style.display="none";this.$1l_3.appendChild(this.$z_3)}if(CUI.ScriptUtility.isNullOrUndefined(this.$d_3)){this.$d_3=CUI.Utility.$4("div");this.$d_3.className="ms-cui-topBar2";if(!this.get_minimized())this.$d_3.className="ms-cui-topBar2 ms-cui-topBarMaximized";this.$1l_3.appendChild(this.$d_3)}},$Bs_3:function(){a:;if(CUI.ScriptUtility.isNullOrUndefined(this.$31_3)){this.$31_3=CUI.Utility.$4("span");this.$31_3.className="ms-cui-hidden";this.$31_3.id="ribboninstruction";CUI.Utility.$2B(this.$31_3,this.$7_1.NavigationHelpText)}if(CUI.ScriptUtility.isNullOrUndefined(this.$1l_3)){this.$1l_3=CUI.Utility.$4("div");this.$1l_3.className="ms-cui-ribbonTopBars";this.get_$3_0().appendChild(this.$31_3);this.get_$3_0().appendChild(this.$1l_3)}},$Bp_3:function(){a:;if(CUI.ScriptUtility.isNullOrUndefined(this.$j_3)){this.$j_3=CUI.Utility.$4("div");CUI.Utility.disableElement(this.$j_3)}},$Bm_3:function(){a:;if(CUI.ScriptUtility.isNullOrUndefined(this.$1i_3))this.$1i_3=$get(this.$2s_1+"-QATRowCenter");if(CUI.ScriptUtility.isNullOrUndefined(this.$1k_3))this.$1k_3=$get(this.$2s_1+"-QATRowRight");if(CUI.ScriptUtility.isNullOrUndefined(this.$1j_3))this.$1j_3=$get(this.$2s_1+"-QATRowLeft");if(CUI.ScriptUtility.isNullOrUndefined(this.$1n_3))this.$1n_3=$get(this.$2s_1+"-TabRowLeft");if(CUI.ScriptUtility.isNullOrUndefined(this.$1m_3))this.$1m_3=$get(this.$2s_1+"-TabRowInline");if(CUI.ScriptUtility.isNullOrUndefined(this.$1o_3))this.$1o_3=$get(this.$2s_1+"-TabRowRight")},$CI_3:function(){a:;if(!this.$39_3&&!CUI.ScriptUtility.isNullOrUndefined(this.$1i_3)&&this.$1i_3.parentNode!==this.$z_3){this.$1i_3.parentNode&&this.$1i_3.parentNode.removeChild(this.$1i_3);this.$z_3.appendChild(this.$1i_3);this.$1i_3.style.display="inline-block";this.$z_3.style.display="block";CUI.Utility.$2C(this.$1i_3,true,false)}if(!this.$39_3&&!CUI.ScriptUtility.isNullOrUndefined(this.$1k_3)&&this.$1k_3.parentNode!==this.$z_3){this.$1k_3.parentNode&&this.$1k_3.parentNode.removeChild(this.$1k_3);this.$z_3.appendChild(this.$1k_3);this.$1k_3.style.display="inline-block";this.$z_3.style.display="block";CUI.Utility.$2C(this.$1k_3,true,false)}if(!this.$39_3&&!CUI.ScriptUtility.isNullOrUndefined(this.$1j_3)&&this.$1j_3.parentNode!==this.$2J_3){this.$1j_3.parentNode&&this.$1j_3.parentNode.removeChild(this.$1j_3);this.$2J_3.appendChild(this.$1j_3);this.$1j_3.style.display="inline-block";this.$z_3.style.display="block";CUI.Utility.$2C(this.$1j_3,true,false)}if(!this.$39_3&&!CUI.ScriptUtility.isNullOrUndefined(this.$1n_3)&&this.$1n_3.parentNode!==this.$d_3){this.$1n_3.parentNode&&this.$1n_3.parentNode.removeChild(this.$1n_3);this.$d_3.appendChild(this.$1n_3);this.$1n_3.style.display="block";CUI.Utility.$2C(this.$1n_3,true,false)}if(CUI.ScriptUtility.isNullOrUndefined(this.$p_3)){this.$p_3=CUI.Utility.$4("ul");this.$p_3.setAttribute("role","tablist");this.$p_3.className="ms-cui-tts";this.$d_3.appendChild(this.$p_3)}if(!this.$39_3&&!CUI.ScriptUtility.isNullOrUndefined(this.$1m_3)&&this.$1m_3.parentNode!==this.$d_3){this.$1m_3.parentNode&&this.$1m_3.parentNode.removeChild(this.$1m_3);this.$d_3.appendChild(this.$1m_3);this.$1m_3.style.display="inline-block";CUI.Utility.$2C(this.$1m_3,true,false)}if(!this.$39_3&&!CUI.ScriptUtility.isNullOrUndefined(this.$1o_3)&&this.$1o_3.parentNode!==this.$d_3){this.$1o_3.parentNode&&this.$1o_3.parentNode.removeChild(this.$1o_3);this.$d_3.appendChild(this.$1o_3);this.$1o_3.style.display="block";CUI.Utility.$2C(this.$1o_3,true,false)}this.$39_3=true},ensureGlobalDisablingRemoved:function(){a:;CUI.Utility.enableElement(this.$p_3);this.$9M_3();this._jewel&&this._jewel.set_enabled(true);this._qat&&this._qat.pollForStateAndUpdate()},$9M_3:function(){a:;CUI.Utility.enableElement(this.$j_3)},get_rootUser:function(){a:;return CUI.Root.prototype.get_rootUser.call(this)},set_rootUser:function(a){a:;CUI.Root.prototype.set_rootUser.call(this,a);!CUI.ScriptUtility.isNullOrUndefined(this._qat)&&this._qat.set_rootUser(a);!CUI.ScriptUtility.isNullOrUndefined(this._jewel)&&this._jewel.set_rootUser(a);return a},dispose:function(){a:;this.set_$Be_1(true);var a=this.$0_0;if(!CUI.ScriptUtility.isNullOrUndefined(a)){var d=a.$2j_1;!CUI.ScriptUtility.isNullOrUndefined(d)&&window.clearTimeout(d);a.$2l_1()}if(this.$68_3){$removeHandler(this.get_$3_0(),"contextmenu",this.$68_3);this.$68_3=null}CUI.ScalableRoot.prototype.dispose.call(this);this.$1v_3=null;this.$C_3=null;this.$1l_3=null;this.$p_3=null;this.$1U_3=null;this.$j_3=null;this.$1n_3=null;this.$1m_3=null;this.$1o_3=null;this.$2J_3=null;this.$1j_3=null;this.$1i_3=null;this.$1k_3=null;this.$z_3=null;this.$d_3=null;var b=this.$w_3;for(var c in b){var e={key:c,value:b[c]},f=e.value;f.dispose()}this.$w_3=null}};CUI.RibbonCommand=function(){};CUI.RibbonCommand.$9o=function(d){var a=window._v_rg_spbutton;if(a){var b=a[d];if(b){var c=$get(b);return c}}return null};CUI.RibbonCommand.serverButton=function(b){a:;var a=CUI.RibbonCommand.$9o(b);if(a){var c=a;if(CUI.BrowserUtility.$CO())if(a.tagName!=="A")CUI.NativeUtility.ffClick(a);else window.location.href=c.href;else a.click()}};CUI.RibbonCommand.serverQueryButton=function(a){a:;var b=CUI.RibbonCommand.$9o(a);return !!b};CUI.RibbonCommand.serverControlLabel=function(c){a:;var a=window._v_rg_spbutton;if(a){var b=a[c];if(b){var d=$get(b);return d.value}}return null};CUI.RibbonBuildContext=function(){a:;CUI.RibbonBuildContext.initializeBase(this)};CUI.RibbonBuildContext.prototype={clone:function(){a:;var a=new CUI.RibbonBuildContext;a.initializedTab=this.initializedTab;a.initialScalingIndex=this.initialScalingIndex;a.initialTabId=this.initialTabId;a.ribbon=this.ribbon;return a},initializedTab:null,initialTabId:null,initialScalingIndex:0,ribbon:null};CUI.RibbonBuildOptions=function(){a:;this.initialScalingIndex=-1;CUI.RibbonBuildOptions.initializeBase(this)};CUI.RibbonBuildOptions.prototype={lazyTabInit:false,shallowTabs:false,showQATId:null,showJewelId:null,minimized:false,shownTabs:null,shownContextualGroups:null,initiallyVisibleContextualGroups:null,normalizedContextualGroups:null,trimEmptyGroups:false,initialTabSelectedByUser:false,launchedByKeyboard:false,scalingHint:"0"};CUI.RibbonBuilder=function(c,a,b){a:;this.$$d_$Cu_1=Function.createDelegate(this,this.$Cu_1);this.$$d_$Bc_1=Function.createDelegate(this,this.$Bc_1);this.$$d_$AG_1=Function.createDelegate(this,this.$AG_1);CUI.RibbonBuilder.initializeBase(this,[c,a,b]);if(CUI.ScriptUtility.isNullOrUndefined(a))throw Error.create("Ribbon placeholder DOM element is null or undefined.")};CUI.RibbonBuilder.prototype={get_ribbon:function(){a:;return this.$0_0},set_ribbon:function(a){a:;this.$0_0=a;return a},get_ribbonBuildOptions:function(){a:;return this.$12_0},fetchAndProcessRibbonData:function(c,d){a:;if(CUI.ScriptUtility.isNullOrUndefined(c))throw Error.create("Initial tab for ribbon is null or undefined");if(this.$2f_0)return false;var b=new CUI.RibbonBuildContext;b.initialTabId=c;if(!CUI.ScriptUtility.isNullOrUndefined(this.get_ribbonBuildOptions().attachToDOM)&&this.get_ribbonBuildOptions().attachToDOM)b.initialScalingIndex=this.get_ribbonBuildOptions().initialScalingIndex;this.$2f_0=true;var a=new CUI.DataQuery;a.id=b.initialTabId;a.queryType=2;a.handler=d;a.data=b;this.$x_0.runQuery(a);return true},buildRibbonAndInitialTab:function(a){a:;return this.fetchAndProcessRibbonData(a,this.$$d_$AG_1)},buildRibbonFromData:function(d,c){a:;var b=new CUI.RibbonBuildContext;b.initialTabId=c;if(!CUI.ScriptUtility.isNullOrUndefined(this.get_ribbonBuildOptions().attachToDOM)&&this.get_ribbonBuildOptions().attachToDOM)b.initialScalingIndex=this.get_ribbonBuildOptions().initialScalingIndex;var a=new CUI.DataQueryResult;a.success=true;a.queryData=d;a.contextData=b;this.$AG_1(a)},$AG_1:function(a){var c=a.contextData;if(CUI.ScriptUtility.isNullOrUndefined(a.queryData))return;a.queryData=this.applyDataExtensions(a.queryData);CUI.Utility.ensureCSSClassOnElement(this._elmPlaceholder,"loaded");var d=CUI.DataNodeWrapper.getFirstChildNodeWithName(a.queryData,"Templates");!CUI.ScriptUtility.isNullOrUndefined(d)&&CUI.TemplateManager.get_instance().loadTemplates(d);this.set_ribbon(this.$B9_1(a.queryData,c));if(CUI.ScriptUtility.isNullOrUndefined(this.get_ribbon()))return;this.get_ribbon().set_$2o_3(this);this.get_ribbon()._decimalSeparator=this.get_ribbonBuildOptions().decimalSeparator;this.$26_0.onComponentCreated(this.get_ribbon(),this.get_ribbon().$6_0);this.get_ribbon()._percentPositivePattern=this.get_ribbonBuildOptions().percentPositivePattern;if(this.get_ribbonBuildOptions().minimized)this.get_ribbon().set_$3w_3(true);else{this.get_ribbon().set_$3w_3(false);var b=this.get_ribbon().getChild(c.initialTabId);if(!CUI.ScriptUtility.isNullOrUndefined(b)){b.$4U_2=this.get_ribbonBuildOptions().initialTabSelectedByUser;this.get_ribbon().$6p_3(b);this.get_ribbon().$8n_3=b}}this.get_ribbon().$2s_1=this.get_ribbonBuildOptions().clientID;var e=!this.get_ribbonBuildOptions().minimized&&this.get_ribbonBuildOptions().attachToDOM;if(e){!this.$12_0.minimized&&this.get_ribbon().$DJ_3(c.initialScalingIndex-1);this.get_ribbon().$4Y_0(true);!CUI.ScriptUtility.isNullOrEmptyString(this.get_ribbonBuildOptions().showQATId)&&this.get_ribbon().$91_3(this.get_ribbonBuildOptions().showQATId,true,this.$x_0);!CUI.ScriptUtility.isNullOrEmptyString(this.get_ribbonBuildOptions().showJewelId)&&this.get_ribbon().$90_3(this.get_ribbonBuildOptions().showJewelId,true,this.$x_0)}else{this.get_ribbon().$1x_0();!CUI.ScriptUtility.isNullOrEmptyString(this.get_ribbonBuildOptions().showQATId)&&this.get_ribbon().$91_3(this.get_ribbonBuildOptions().showQATId,false,this.$x_0);!CUI.ScriptUtility.isNullOrEmptyString(this.get_ribbonBuildOptions().showJewelId)&&this.get_ribbon().$90_3(this.get_ribbonBuildOptions().showJewelId,false,this.$x_0);CUI.Utility.removeChildNodesSlow(this._elmPlaceholder);this._elmPlaceholder.appendChild(this.get_ribbon().get_$3_0())}this.get_ribbon().$DI_2();this.$8N_0(this.get_ribbon());this.$26_0.onComponentBuilt(this.get_ribbon(),this.get_ribbon().$6_0);this.get_ribbonBuildOptions().launchedByKeyboard&&this.get_ribbon().setFocusOnRibbon();CUI.PMetrics.perfMark(7104)},$Cu_1:function(d){var a=d.contextData;if(d.success){var g=CUI.DataNodeWrapper.getFirstChildNodeWithName(d.queryData,"Ribbon"),e=CUI.DataNodeWrapper.getFirstChildNodeWithName(g,"Tabs"),b=null;if(CUI.ScriptUtility.isNullOrUndefined(e)||!CUI.DataNodeWrapper.getNodeChildren(e).length)for(var j=CUI.DataNodeWrapper.getFirstChildNodeWithName(g,"ContextualTabs"),i=CUI.DataNodeWrapper.getNodeChildren(j),f=0;f<i.length;f++){var k=i[f];b=CUI.DataNodeWrapper.getNodeChildren(k);if(b.length>0)break}else b=CUI.DataNodeWrapper.getNodeChildren(e);var c=CUI.DataNodeWrapper.getFirstChildNodeWithName(d.queryData,"Templates");c=this.applyDataExtensions(c);!CUI.ScriptUtility.isNullOrUndefined(c)&&CUI.TemplateManager.get_instance().loadTemplates(c);var h=this.applyDataExtensions(b[0]);!CUI.ScriptUtility.isNullOrUndefined(h)&&this.$7y_1(a.initializedTab,h,a);a.initializedTab.get_ribbon().$6p_3(a.initializedTab);a.initializedTab.$8L_0(true)}CUI.PMetrics.perfMark(7106)},$B9_1:function(j,g){var d=CUI.DataNodeWrapper.getFirstChildNodeWithName(j,"Ribbon");if(CUI.ScriptUtility.isNullOrUndefined(d))return null;var a=new CUI.DataNodeWrapper(d);this.set_ribbon(new CUI.Ribbon(a.get_attributes()["Id"],a.get_attributes()));this.get_ribbon().$4W_1=true;var h=CUI.DataNodeWrapper.getNodeChildren(CUI.DataNodeWrapper.getFirstChildNodeWithName(a.$f_0,"Tabs"));this.$8u_1(h,null,g);var e=CUI.DataNodeWrapper.getFirstChildNodeWithName(a.$f_0,"ContextualTabs");if(!CUI.ScriptUtility.isNullOrUndefined(e))for(var c=CUI.DataNodeWrapper.getNodeChildren(e),i=!CUI.ScriptUtility.isNullOrUndefined(this.get_ribbonBuildOptions().shownContextualGroups),b=0;b<c.length;b++){if(i){var f=CUI.DataNodeWrapper.getNodeAttributes(c[b])["Id"];if(!CUI.ScriptUtility.isNullOrUndefined(f))if(CUI.ScriptUtility.isNullOrUndefined(this.get_ribbonBuildOptions().shownContextualGroups[f]))continue}this.$Ak_1(c[b],g)}return this.get_ribbon()},$Ak_1:function(g,h){var b=CUI.DataNodeWrapper.getNodeAttributes(g),a=0,c=b["Id"],d=!CUI.ScriptUtility.isNullOrUndefined(this.get_ribbonBuildOptions().normalizedContextualGroups)&&!CUI.ScriptUtility.isNullOrUndefined(this.get_ribbonBuildOptions().normalizedContextualGroups[c])&&this.get_ribbonBuildOptions().normalizedContextualGroups[c];if(!d){switch(b["Color"]){case "DarkBlue":a=1;break;case "LightBlue":a=2;break;case "Magenta":a=6;break;case "Green":a=5;break;case "Orange":a=4;break;case "Purple":a=8;break;case "Teal":a=3;break;case "Yellow":a=7;break;default:a=0}this.get_ribbon().addContextualGroup(c,b["Title"],a,b["Command"])}var e=CUI.DataNodeWrapper.getNodeChildren(g);if(!d)for(var f=0;f<e.length;f++){var i=CUI.DataNodeWrapper.getNodeAttribute(e[f],"Id");if(i===h.initialTabId){if(CUI.ScriptUtility.isNullOrUndefined(this.get_ribbonBuildOptions().initiallyVisibleContextualGroups))this.get_ribbonBuildOptions().initiallyVisibleContextualGroups={};this.get_ribbonBuildOptions().initiallyVisibleContextualGroups[c]=true;break}}this.$8u_1(e,d?null:b["Id"],h)},$8u_1:function(b,f,g){for(var d=!CUI.ScriptUtility.isNullOrUndefined(this.get_ribbonBuildOptions().shownTabs),a=0;a<b.length;a++){if(d){var c=CUI.DataNodeWrapper.getNodeAttributes(b[a])["Id"];if(!CUI.ScriptUtility.isNullOrUndefined(c))if(CUI.ScriptUtility.isNullOrUndefined(this.get_ribbonBuildOptions().shownTabs[c]))continue}var e=this.$BE_1(b[a],g,f);this.get_ribbon().addChild(e)}},$BE_1:function(d,e,c){var a=new CUI.DataNodeWrapper(d),b;if(CUI.ScriptUtility.isNullOrUndefined(c))b=this.get_ribbon().$BZ_3(a.get_attributes()["Id"],a.get_attributes()["Title"],a.get_attributes()["Description"],a.get_attributes()["Command"],a.get_attributes()["CssClass"],a.get_attributes()["ContainerCssClass"]);else{b=this.get_ribbon().$BQ_3(a.get_attributes()["Id"],a.get_attributes()["Title"],a.get_attributes()["Description"],a.get_attributes()["Command"],c,a.get_attributes()["CssClass"],a.get_attributes()["ContainerCssClass"]);!CUI.ScriptUtility.isNullOrUndefined(this.get_ribbonBuildOptions().initiallyVisibleContextualGroups)&&this.get_ribbonBuildOptions().initiallyVisibleContextualGroups[c]&&b.set_$74_0(true)}if(!a.get_children().length)b.$8Y_0(this.$$d_$Bc_1,a.$f_0,e.clone());else this.$7y_1(b,d,e);return b},$7y_1:function(f,n,q){for(var o=CUI.DataNodeWrapper.getFirstChildNodeWithName(n,"Groups"),d=CUI.DataNodeWrapper.getNodeChildren(o),g={},b=0;b<d.length;b++){if(this.isNodeTrimmed(d[b]))continue;var m=this.$B1_1(d[b],q);if(!CUI.ScriptUtility.isNullOrUndefined(m))f.addChild(m);else{var k=CUI.DataNodeWrapper.getNodeAttribute(d[b],"Id");if(!CUI.ScriptUtility.isNullOrUndefined(k))g[k]=k}}for(var p=CUI.DataNodeWrapper.getFirstChildNodeWithName(n,"Scaling"),h=CUI.DataNodeWrapper.getNodeChildren(p),i=null,j=false,e=0;e<h.length;e++){var l=CUI.DataNodeWrapper.getNodeName(h[e]),c=CUI.DataNodeWrapper.getNodeAttributes(h[e]),a=c["GroupId"];if(l==="MaxSize"){if(this.isIdTrimmed(a)||!CUI.ScriptUtility.isNullOrUndefined(g[a]))continue;f.get_scaling().setGroupMaxSize(a,c["Size"])}else if(l==="Scale"){if(this.isIdTrimmed(a)||!CUI.ScriptUtility.isNullOrUndefined(g[a]))continue;f.get_scaling().addScalingStep(new CUI.ScalingStep(a,c["Size"],c["PopupSize"],i,j));i=null;j=false}else if(l==="LowScaleWarning"){i=c["Message"];j=true}else throw Error.create("Was expecting a node with name MaxSize or Scale.")}f.scaleMax()},$Bc_1:function(d,e,g){var b=g,c=d,f=new CUI.DataNodeWrapper(e);b.initializedTab=d;if(!f.get_hasChildren()){var a=new CUI.DataQuery;a.id=b.initializedTab.$6_0;a.queryType=4;a.handler=this.$$d_$Cu_1;a.data=b;this.$x_0.runQuery(a);return null}this.$7y_1(c,e,b);c.$8L_0(true);this.get_ribbon().refresh();return c},$B1_1:function(n,o){var a=new CUI.DataNodeWrapper(n),j=a.get_attributes()["Template"],k=CUI.TemplateManager.get_instance().getTemplate(j);if(CUI.ScriptUtility.isNullOrUndefined(k))throw Error.create("A template with name: "+j+" could not be loaded.");for(var c={},g=null,d=0;d<a.get_children().length;d++)if(a.get_children()[d].name==="Controls"){g=a.get_children()[d];break}if(CUI.ScriptUtility.isNullOrUndefined(g))throw Error.create("No Controls node found in this Group tag.");for(var h=CUI.DataNodeWrapper.getNodeChildren(g),l=true,e=0;e<h.length;e++){if(this.isNodeTrimmed(h[e]))continue;l=false;var b=this.$5M_0(h[e],o),f=c[b.get_templateAlias()];if(CUI.ScriptUtility.isNullOrUndefined(f))c[b.get_templateAlias()]=b;else if(Array.isInstanceOfType(f))Array.add(f,b);else{var i=[];Array.add(i,f);Array.add(i,b);c[b.get_templateAlias()]=i}}if(this.get_ribbonBuildOptions().trimEmptyGroups&&l)return null;var m=k.createGroup(this.get_ribbon(),a.get_attributes()["Id"],a.get_attributes(),a.get_attributes()["Title"],a.get_attributes()["Description"],a.get_attributes()["Command"],c,null);return m}};CUI.RibbonComponent=function(a,b,c,d){CUI.RibbonComponent.initializeBase(this,[a,b,c,d])};CUI.RibbonComponent.prototype={get_ribbon:function(){a:;return this.$0_0}};CUI.Row=function(a,b){CUI.Row.initializeBase(this,[a,b,"",""])};CUI.Row.prototype={$2A_0:function(){a:;this.ensureDOMElementAndEmpty();CUI.Component.prototype.appendChildrenToElement.call(this,this.get_$3_0());CUI.Component.prototype.$2A_0.call(this)},$6Z_0:function(){a:;this.set_$3_0($get(this.$M_0.$6_0+"-"+this.$M_0.$8_0.indexOf(this)))},ensureCorrectChildType:function(a){if(!CUI.Strip.isInstanceOfType(a)&&!CUI.ControlComponent.isInstanceOfType(a))throw Error.create("Only children of type Strip and ControlComponent can be added to Row Components.")},get_domElementTagName:function(){a:;return "span"},get_cssClass:function(){a:;var a=this.$M_0.$I_2;if(a===2)return "ms-cui-row-onerow";else return "ms-cui-row"}};CUI.ScalingStep=function(a,b,c,d,e){if(CUI.ScriptUtility.isNullOrUndefined(a)||CUI.ScriptUtility.isNullOrUndefined(b))throw Error.create("groupId, layoutName and message cannot be undefined or null");this.$2L_0=a;this.$5C_0=b;this.$6H_0=c;this.$7c_0=d;this.$7l_0=e};CUI.ScalingStep.prototype={$2L_0:null,$5C_0:null,$6H_0:null,$7c_0:null,$7l_0:false,$1b_0:null,$AY_0:function(a){this.$1b_0=a},get_groupId:function(){a:;return this.$2L_0},get_layoutName:function(){a:;return this.$5C_0},get_popupSize:function(){a:;return this.$6H_0},get_scaleWarningMessage:function(){a:;return this.$7c_0},get_hasScaleWarning:function(){a:;return this.$7l_0},get_previousLayoutName:function(){a:;if(CUI.ScriptUtility.isNullOrUndefined(this.$1b_0))return null;for(var c=this.$1b_0.getGroupMaxSize(this.$2L_0),d=this.$1b_0.$1w_0,a=0;a<d.length;a++){var b=d[a];if(b===this)break;if(b.$2L_0===this.$2L_0)c=b.$5C_0}return c}};CUI.Scaling=function(){a:;this.$4L_0={};this.$1w_0=[]};CUI.Scaling.prototype={$4L_0:null,$1w_0:null,setGroupMaxSize:function(a,b){this.$4L_0[a]=b;this.$i_0=true},removeGroupMaxSize:function(a){delete this.$4L_0[a];this.$i_0=true},getGroupMaxSize:function(a){return this.$4L_0[a]},addScalingStep:function(a){if(CUI.ScriptUtility.isNullOrUndefined(a))throw Error.create("step must be definined and not null");if(CUI.ScriptUtility.isNullOrUndefined(this.$4L_0[a.$2L_0]))throw Error.create("You must set the GroupMaxSize of Group: "+a.$2L_0+" before you add ScalingSteps for it");this.addScalingStepAtIndex(a,this.$1w_0.length)},addScalingStepAtIndex:function(a,b){if(Array.contains(this.$1w_0,a))throw Error.create("This ScalingInfo already contains this ScaleStep");Array.insert(this.$1w_0,b,a);a.$AY_0(this);this.$i_0=true},removeScalingStep:function(a){Array.remove(this.$1w_0,a);a.$AY_0(null);this.$i_0=true},get_steps:function(){a:;return Array.clone(this.$1w_0)},get_stepsInternal:function(){a:;return this.$1w_0},$i_0:true};CUI.Section=function(a,b,c,d){CUI.Section.initializeBase(this,[a,b,"",""]);this.$I_2=c;this.$4p_2=d;switch(c){case 4:this.$3q_0(new CUI.Row(a,b+"-0"),false);this.$3q_0(new CUI.Row(a,b+"-1"),false);this.$3q_0(new CUI.Row(a,b+"-2"),false);break;case 3:this.$3q_0(new CUI.Row(a,b+"-0"),false);this.$3q_0(new CUI.Row(a,b+"-1"),false);break;case 2:this.$3q_0(new CUI.Row(a,b+"-0"),false);break;case 1:break;default:throw Error.create("Invalid SectionType")}};CUI.Section.prototype={$I_2:0,$4p_2:0,$2A_0:function(){a:;this.ensureDOMElementAndEmpty();this.appendChildrenToElement(this.get_$3_0());this.$1x_0();if(this.$I_2!==1){var a=this.$8_0;this.$7o_2(a,1);(this.$I_2===3||this.$I_2===4)&&this.$7o_2(a,2);this.$I_2===4&&this.$7o_2(a,3)}this.$i_0=false},$6Z_0:function(){a:;this.set_$3_0($get(this.$M_0.$6_0+"-"+this.$M_0.$8_0.indexOf(this).toString()))},$7o_2:function(b,c){var a=b.get_item(c-1);a.$1x_0();if(this.$I_2===3)a.get_$3_0().className="ms-cui-row-tworow";this.get_$3_0().appendChild(a.get_$3_0());a.$3G_0()},get_cssClass:function(){a:;if(this.$4p_2===2)return "ms-cui-section-alignmiddle";else return "ms-cui-section"},get_type:function(){a:;return this.$I_2},get_alignment:function(){a:;return this.$4p_2},removeChild:function(){throw Error.create("Cannot directly add and remove children from Section Components")},addChildAtIndex:function(){throw Error.create("Cannot directly add and remove children from Section Components")},getRow:function(a){switch(this.$I_2){case 4:if(a<1||a>3)throw Error.create("This Section type only has Row numbers 1, 2 and 3.");break;case 3:if(a<1||a>2)throw Error.create("This Section type only has Row numbers 1 and 2");break;case 2:if(a!==1)throw Error.create("This Section type only has Row number 1.");break;default:throw Error.create("This Section type does not have any rows")}return this.$8_0.get_item(a-1)},$1x_0:function(){a:;if(!CUI.ScriptUtility.isNullOrUndefined(this.get_$3_0()))return;if(this.$I_2===1){var a=CUI.Utility.$4("span");a.className="ms-cui-section-divider";this.set_$3_0(a);return}CUI.Component.prototype.$1x_0.call(this)},ensureCorrectChildType:function(b){var a=this.$8_0.$P_0;if(this.$I_2===2&&a>0||this.$I_2===3&&a>1||this.$I_2===4&&a>2)throw Error.create("No more children can be added to a Section of this type.");if(this.$I_2===1)throw Error.create("Cannot add child components to Divider Section types.");if(!CUI.Row.isInstanceOfType(b))throw Error.create("Only children of type Row can be added to Section Components.")},clone:function(d){var b=this.get_ribbon().$2T_3("clonedSection-"+this.get_ribbon().$2U_1(),this.$I_2,this.$4p_2);if(!d)return b;var g=0,e=this.$8_0.getEnumerator();while(e.moveNext()){var h=e.get_current(),f=h.$8_0.getEnumerator();while(f.moveNext()){var a=f.get_current(),c=null;if(CUI.ControlComponent.isInstanceOfType(a)){var i=a;c=i.clone(d)}else if(CUI.Strip.isInstanceOfType(a))c=a.clone(d);b.getRow(g+1).addChild(c)}g++}return b},get_domElementTagName:function(){a:;return "span"}};CUI.Strip=function(a,b){CUI.Strip.initializeBase(this,[a,b,"",""])};CUI.Strip.prototype={$2A_0:function(){a:;this.ensureDOMElementAndEmpty();this.appendChildrenToElement(this.get_$3_0());CUI.Component.prototype.$2A_0.call(this)},$6Z_0:function(){a:;this.set_$3_0($get(this.$M_0.$6_0+"-"+this.$M_0.$8_0.indexOf(this)))},ensureCorrectChildType:function(a){if(!CUI.ControlComponent.isInstanceOfType(a))throw Error.create("Only children of type Control can be added to Strips.")},get_cssClass:function(){a:;return "ms-cui-strip"},clone:function(c){var a=this.get_ribbon().$9G_3("clonedStrip-"+this.get_ribbon().$2U_1());if(!c)return a;var b=this.$8_0.getEnumerator();while(b.moveNext()){var d=b.get_current();a.addChild(d.clone(c))}return a}};CUI.Tab=function(d,e,f,g,h,a,i,b,c){this.$$d_$Ae_2=Function.createDelegate(this,this.$Ae_2);this.$$d_$D0_2=Function.createDelegate(this,this.$D0_2);this.$$d_$AI_2=Function.createDelegate(this,this.$AI_2);this.$$d_$Cz_2=Function.createDelegate(this,this.$Cz_2);CUI.Tab.initializeBase(this,[d,e,f,g]);this.$1G_2=-1;this.$1b_2=new CUI.Scaling;this.$13_2=a;this.$s_2=i;this.$n_2=h;this.$79_2=CUI.ScriptUtility.isNullOrUndefined(b)?"":b;this.$77_2=CUI.ScriptUtility.isNullOrUndefined(c)?"":c;a&&this.set_$74_0(false)};CUI.Tab.prototype={$5H_2:false,$E_2:null,$t_2:null,$3b_2:null,$2Z_2:null,$1G_2:0,$79_2:null,$77_2:null,$13_2:false,$s_2:null,$2A_0:function(){a:;this.ensureDOMElementAndEmpty();this.$7w_2();this.appendChildrenToElement(this.get_$3_0());CUI.Component.prototype.$2A_0.call(this)},$8x_2:function(){a:;this.$E_2=$get(this.$6_0+"-title");this.$t_2=this.$E_2.childNodes[0];this.$3b_2=this.$t_2.childNodes[0];this.$2Z_2=this.$t_2.childNodes[1]},$8y_2:function(){a:;$addHandler(this.$t_2,"dblclick",this.$$d_$Cz_2);$addHandler(this.$t_2,"click",this.$$d_$AI_2);$addHandler(this.$t_2,"keydown",this.$$d_$D0_2)},$6Z_0:function(){a:;CUI.Component.prototype.$6Z_0.call(this);this.$8x_2()},$X_0:function(){a:;CUI.Component.prototype.$X_0.call(this);this.$8y_2()},$1x_0:function(){a:;if(!CUI.ScriptUtility.isNullOrUndefined(this.get_$3_0()))return;CUI.Component.prototype.$1x_0.call(this);this.get_$3_0().setAttribute("role","tabpanel");this.get_$3_0().setAttribute("aria-labelledby",this.$6_0+"-title")},get_domElementTagName:function(){a:;return "ul"},$Br_2:function(){a:;if(CUI.ScriptUtility.isNullOrUndefined(this.$E_2))this.$E_2=CUI.Utility.$4("li")},$9K_2:function(){a:;if(CUI.ScriptUtility.isNullOrUndefined(this.$2Z_2))this.$2Z_2=CUI.Utility.$4("span")},onTitleScale:function(a){if(!CUI.ScriptUtility.isNullOrUndefined(this.$E_2)&&!this.get_ribbon().get_$8v_3())this.$E_2.title=a>=2?this.get_title():""},$7w_2:function(){a:;var a=" ";if(CUI.ScriptUtility.isNullOrUndefined(this.$t_2)){this.$Br_2();this.$t_2=CUI.Utility.$4("a");CUI.Utility.$29(this.$t_2);this.$t_2.className="ms-cui-tt-a";this.$3b_2=CUI.Utility.$4("span");this.$3b_2.className="ms-cui-tt-span";this.$E_2.appendChild(this.$t_2);this.$t_2.appendChild(this.$3b_2);this.$X_0()}else{a+=this.$E_2.className.indexOf("ms-cui-ct-first")>-1?"ms-cui-ct-first ":"";a+=this.$E_2.className.indexOf("ms-cui-ct-last")>-1?"ms-cui-ct-last":"";a=a.trimEnd()}this.$E_2.className=this.$9p_2()+a;this.$E_2.id=this.$6_0+"-title";this.$E_2.setAttribute("role","tab");this.$E_2.setAttribute("aria-selected",this.$5H_2);CUI.UIUtility.setInnerText(this.$3b_2,this.get_title());if(this.get_ribbon().get_$8v_3())this.$E_2.title=this.get_title();!CUI.ScriptUtility.isNullOrEmptyString(this.get_description())&&this.$t_2.setAttribute("title",this.get_description())},$AW_2:function(d,a,e,b,c){CUI.ScriptUtility.isNullOrUndefined(this.$2Z_2)&&this.$9K_2();if(this.$13_2)a=String.format(a,e,b,c);else a=String.format(d,b,c);CUI.UIUtility.setInnerText(this.$2Z_2,a);CUI.Utility.ensureCSSClassOnElement(this.$2Z_2,"ms-cui-hidden");this.$t_2.appendChild(this.$2Z_2)},$DF_2:function(){a:;this.$E_2.className=this.$9p_2()},get_cssClass:function(){a:;return this.$C9_2()},get_selected:function(){a:;return this.$5H_2},set_selected:function(a){if(!this.get_visible())throw Error.create("Tabs must be visible and enabled in order to be selected.");if(a){if(this.get_needsDelayIniting()){this.doDelayedInit();return a}this.get_ribbon().$6p_3(this);this.get_ribbon().set_$3w_3(false);this.get_ribbon().$2A_0();this.$62_2!==this.get_ribbon()._lastWindowResizeWidthHeight&&this.get_ribbon().$DI_2();this.$AL_0();this.$16_2=false}else throw Error.create("Selected cannot be set to false explicitly.\nSelecting another Tab will do this implicitly.");return a},$DC_2:function(){a:;if(!CUI.ScriptUtility.isNullOrUndefined(this.get_ribbon().get_$2o_3())&&!CUI.ScriptUtility.isNullOrUndefined(this.get_ribbon().get_$2o_3().get_ribbonBuildOptions())&&!CUI.ScriptUtility.isNullOrEmptyString(this.get_ribbon().get_$2o_3().get_ribbonBuildOptions().clientID)){var a=$get(this.get_ribbon().get_$2o_3().get_ribbonBuildOptions().clientID+"_activeTabId");if(a)a.value=this.$6_0}},$8f_2:function(a,b){a&&this.$DC_2();this.$5H_2=a;this.$11_0();b&&this.$7w_2()},$8L_0:function(a){CUI.Component.prototype.$8L_0.call(this,a);this.get_ribbon().$DI_2();this.get_ribbon().pollForStateAndUpdate()},ensureCorrectChildType:function(a){if(!CUI.Group.isInstanceOfType(a))throw Error.create("Only children of type Group can be added to Tab Components")},$1b_2:null,get_scaling:function(){a:;if(CUI.ScriptUtility.isNullOrUndefined(this.$1b_2))this.$1b_2=new CUI.Scaling;return this.$1b_2},get_currentScalingIndex:function(){a:;return this.$1G_2},$62_2:null,scaleMax:function(){a:;this.$8U_2();this.$11_0()},$8U_2:function(){a:;var a=this.$8_0.getEnumerator();while(a.moveNext()){var b=a.get_current(),c=this.$1b_2.getGroupMaxSize(b.$6_0);!CUI.ScriptUtility.isNullOrUndefined(c)&&b.selectLayout(c,null)}this.$1G_2=-1},scaleIndex:function(a){this.$AR_2(a);this.$11_0()},$AR_2:function(a){this.$8U_2();while(a>this.$1G_2)if(!this.$AQ_2())break},$DL_2:function(){a:;if(this.$1G_2===-2){this.$8U_2();return true}if(this.$1G_2===-1)return false;var b=this.$1b_2.$1w_0,a=b[this.$1G_2],c=this.getChild(a.$2L_0);c.selectLayout(a.get_previousLayoutName(),null);this.$1G_2--;return true},scaleUp:function(){a:;var a=this.$DL_2();a&&this.$11_0();return a},$AQ_2:function(){a:;if(this.$1G_2===-2){this.scaleMax();return true}var b=this.$1b_2.$1w_0;if(b.length<=this.$1G_2+1)return false;this.$1G_2++;var a=b[this.$1G_2],c=this.getChild(a.$2L_0);c.selectLayout(a.$5C_0,a.$6H_0);return true},scaleDown:function(){a:;var a=this.$AQ_2();a&&this.$11_0();return a},$6L_2:false,$CF_2:function(){a:;for(var b=0,c=this.get_$3_0().childNodes,a=0;a<c.length;a++)b+=c[a].offsetWidth;return b},get_contextual:function(){a:;return this.$13_2},get_contextualGroupId:function(){a:;return this.$s_2},$4U_2:false,$16_2:false,$D0_2:function(a){if(!CUI.ScriptUtility.isNullOrUndefined(a)&&!CUI.ScriptUtility.isNullOrUndefined(a.rawEvent)){var b=a.rawEvent.keyCode;if(b===13){this.$16_2=true;a.stopPropagation();this.$AI_2(a)}}},$AI_2:function(a){CUI.PMetrics.perfMark(7105);a.preventDefault();this.$6O_2=true;if(this.get_selected())window.setTimeout(this.$$d_$Ae_2,500);else this.$Ae_2()},$6O_2:true,$Ae_2:function(){a:;if(!this.$6O_2)return;this.$4U_2=true;this.get_ribbon().$9J_1();this.set_selected(true);this.get_ribbon().$2l_1();this.get_ribbon().set_$q_1(null);CUI.PMetrics.perfMark(7107)},$A5_2:function(f){var g=document.activeElement,h=this.$9O_2(g),b=this.$8_0.$P_0,e,c=0,d=this.$8_0.getEnumerator();while(d.moveNext()){var i=d.get_current();if(i.$6_0===h)break;c++}var a;if(f)a=(c+1)%b;else a=c-1;if(a<0)a=b+a;while(a!==c){e=this.$8_0.get_item(a);if(e.$8d_0())return;if(f)a=(a+1)%b;else a=a-1;if(a<0)a=b+a}},$9O_2:function(a){if(a.nodeName==="LI")return a.id;else return this.$9O_2(a.parentNode)},$AZ_2:function(){a:;var b=false,a=this.$8_0.getEnumerator();while(a.moveNext()){var c=a.get_current();if(c.$8d_0()){b=true;return}}!b&&this.$t_2.focus()},$DR_2:function(){a:;!CUI.ScriptUtility.isNullOrUndefined(this.$t_2)&&this.$t_2.focus()},$Cz_2:function(b){this.$6O_2=false;b.preventDefault();if(!CUI.ScriptUtility.isNullOrUndefined(this.get_ribbon().get_ribbonProperties().PreToggleMinimizedCommand)){var a=new CUI.RibbonEventCommandProperties;a.RootId=this.get_ribbon().$6_0;a.RootType="Ribbon";a.Minimized=!this.get_ribbon().get_$3w_3();a.Maximized=!a.Minimized;a.Cancelable=true;a.CancelAction=false;this.raiseCommandEvent(this.get_ribbon().get_ribbonProperties().PreToggleMinimizedCommand,11,a);if(a.CancelAction)return}this.get_ribbon().set_$3w_3(true);this.get_ribbon().$2A_0()},get_$8O_2:function(){a:;if(!CUI.ScriptUtility.isNullOrUndefined(this.get_$3_0())&&!CUI.ScriptUtility.isNullOrUndefined(this.get_$3_0().lastChild)){var b=CUI.Utility.$9j(this.get_$3_0().lastChild);if(this.$0_0._textDirection!==1&&CUI.Utility.$3s()<=b.width+b.x)return true}var a=this.$8_0.getEnumerator();while(a.moveNext()){var c=a.get_current();if(c.get_$8O_2())return true}return false},$9p_2:function(){a:;var a="ms-cui-tt "+this.$79_2;if(this.$5H_2)a+=" ms-cui-tt-s";return a},$C9_2:function(){a:;var a="ms-cui-tabBody";if(this.$13_2)a+=" ms-cui-tabBody-"+CUI.ContextualGroup.$5R(this.get_ribbon().$6g_3(this.$s_2).$2t_0);return a},$CB_2:function(){a:;var a="ms-cui-tabContainer";if(this.$13_2)a+=" ms-cui-tabContainer-"+CUI.ContextualGroup.$5R(this.get_ribbon().$6g_3(this.$s_2).$2t_0);return a},get_visible:function(){a:;return CUI.Component.prototype.get_visible.call(this)},set_visible:function(a){if(this.$13_2)throw Error.create("Visibility of Contextual Tabs cannot be set explicitly.");CUI.Component.prototype.set_visible.call(this,a);return a},$n_2:null,get_command:function(){a:;return this.$n_2},$3J_0:function(a){a.get_commandInfo().TabId=this.$6_0;return CUI.Component.prototype.$3J_0.call(this,a)},$4i_0:function(){a:;if(CUI.ScriptUtility.isNullOrUndefined(this.$n_2))this.set_enabled(true);else{var a=this.get_ribbon().$3x_1(this.$n_2,null,null,false);this.set_enabled((a&1)>0)}if(this.get_enabled()){this.set_$4g_0(new Date);CUI.Component.prototype.$4i_0.call(this)}this.get_ribbon().$9M_3()},dispose:function(){a:;CUI.Component.prototype.dispose.call(this);CUI.Utility.$8Q(this.$E_2);this.$2Z_2=null;this.$E_2=null;this.$t_2=null;this.$3b_2=null}};CUI.Template=function(){};CUI.TemplateManager=function(){a:;this.$3l_0={}};CUI.TemplateManager.get_instance=function(){a:;if(CUI.ScriptUtility.isNullOrUndefined(CUI.TemplateManager.$5y))CUI.TemplateManager.$5y=new CUI.TemplateManager;return CUI.TemplateManager.$5y};CUI.TemplateManager.prototype={$3l_0:null,addTemplate:function(a,b){this.$3l_0[b]=a},removeTemplate:function(a){this.$3l_0[a]=null},getTemplate:function(a){return this.$3l_0[a]},loadTemplates:function(c){for(var e=new CUI.DataNodeWrapper(c),d=CUI.DataNodeWrapper.getFirstChildNodeWithName(c,"RibbonTemplates"),b=CUI.DataNodeWrapper.getNodeChildren(d),a=0;a<b.length;a++)this.$CU_0(b[a])},$CU_0:function(c){var a=new CUI.DataNodeWrapper(c),b=a.get_attributes()["Id"],d=a.get_attributes()["Classname"];if(!CUI.ScriptUtility.isNullOrUndefined(this.$3l_0[b]))return;if(CUI.ScriptUtility.isNullOrUndefined(d))this.$3l_0[b]=new CUI.DeclarativeTemplate(c)}};CUI.RootUser=function(){};CUI.RootProperties=function(){};CUI.RootProperties.prototype={CssClass:null,Culture:null,RootEventCommand:null,ImageDownArrow:null,ImageDownArrowClass:null,ImageDownArrowTop:null,ImageDownArrowLeft:null,ImageSideArrow:null,ImageSideArrowClass:null,ImageSideArrowTop:null,ImageSideArrowLeft:null,ImageUpArrow:null,ImageUpArrowClass:null,ImageUpArrowTop:null,ImageUpArrowLeft:null,TextDirection:null,ToolTipFooterText:null,ToolTipFooterImage16by16:null,ToolTipFooterImage16by16Class:null,ToolTipFooterImage16by16Top:null,ToolTipFooterImage16by16Left:null,ToolTipDisabledCommandImage16by16:null,ToolTipDisabledCommandImage16by16Class:null,ToolTipDisabledCommandImage16by16Top:null,ToolTipDisabledCommandImage16by16Left:null,ToolTipDisabledCommandDescription:null,ToolTipDisabledCommandTitle:null,ToolTipDisabledCommandHelpKey:null,ToolTipHelpCommand:null,ToolTipSelectedItemTitlePrefix:null};CUI.RootEventCommandProperties=function(){};CUI.RootEventCommandProperties.prototype={RootId:null,RootType:null};CUI.Root=function(b,a){this.$$d_$Cj_1=Function.createDelegate(this,this.$Cj_1);this.$$d_$Cm_1=Function.createDelegate(this,this.$Cm_1);this.$$d_$Cn_1=Function.createDelegate(this,this.$Cn_1);this.$$d_$Cl_1=Function.createDelegate(this,this.$Cl_1);this.$$d_onWindowScroll=Function.createDelegate(this,this.onWindowScroll);this.$$d_$8M_1=Function.createDelegate(this,this.$8M_1);this.$$d_$Ck_1=Function.createDelegate(this,this.$Ck_1);this.$38_1=-1;this.$4R_1=-1;CUI.Root.initializeBase(this,[null,b,null,null]);this.initRootMember(this);this.$7_1=a;this.$Y_1={};this.$78_1={};this.$76_1=0;this.$7j_1=0;if(!CUI.ScriptUtility.isNullOrUndefined(a.TextDirection))this._textDirection=a.TextDirection.toLowerCase()==="rtl"?1:0;if(!CUI.ScriptUtility.isNullOrEmptyString(a.Culture))this._culture=a.Culture.toLowerCase();else this._culture="en-us";this.$6C_1=this.$$d_$Ck_1;this.$1a_1=this.$$d_$8M_1;$addHandler(document,"keydown",this.$6C_1);$addHandler(window,"unload",this.$1a_1)};CUI.Root.$1Q=function(a,b){if(CUI.ScriptUtility.isNullOrUndefined(a))return 0;return a[b]};CUI.Root.prototype={$Y_1:null,$78_1:null,$76_1:0,$7j_1:0,$7b_1:false,$61_1:null,$7R_1:null,_textDirection:0,_culture:null,_percentPositivePattern:0,_decimalSeparator:null,$2s_1:null,$7F_1:true,get_initializing:function(){a:;return this.$7F_1},get_$q_1:function(){a:;return this.$61_1},set_$q_1:function(a){if(!this.$1s_1)this.$61_1=a;return a},get_$4f_1:function(){a:;return this.$7R_1},set_$4f_1:function(a){if(!this.$1s_1){this.$7R_1=a;this.$61_1=a}return a},$9J_1:function(){a:;!CUI.ScriptUtility.isNullOrUndefined(this.get_$q_1())&&this.get_$q_1().$BI_0()},get_$Dd_1:function(){a:;return false},get_$4Z_1:function(){a:;return null},get_$1R_1:function(){a:;return null},get_$Af_1:function(){a:;return this.$7_1.CssClass},$DB_1:function(a){this.$78_1[a.$6_0]=a},$2A_0:function(){a:;CUI.Component.prototype.$2A_0.call(this);this.$7F_1=false;if(!this.$7b_1){$addHandler(window,"scroll",this.$$d_onWindowScroll);this.$7b_1=true}},$1x_0:function(){a:;CUI.Component.prototype.$1x_0.call(this);this._textDirection===1&&CUI.Utility.ensureCSSClassOnElement(this.get_$3_0(),"ms-cui-rtl");CUI.Utility.$6n()&&CUI.Utility.ensureCSSClassOnElement(this.get_$3_0(),"ms-cui-needIEFilter");!CUI.ScriptUtility.isNullOrUndefined(this.$7_1.CssClass)&&CUI.Utility.ensureCSSClassOnElement(this.get_$3_0(),this.$7_1.CssClass)},setFocus:function(){a:;var a=this.get_$q_1();if(CUI.ScriptUtility.isNullOrUndefined(a))return false;return a.$8c_0()},restoreFocus:function(){a:;var a=this.get_$4f_1();if(CUI.ScriptUtility.isNullOrUndefined(a))return false;return a.$8c_0()},$8j_1:false,refresh:function(){a:;!CUI.ScriptUtility.isNullOrUndefined(this.$27_1)&&this.$27_1.onRootRefreshed(this)},attach:function(){a:;this.$4Y_0(true)},$2D_1:false,get_needScaling:function(){a:;return this.$2D_1},set_needScaling:function(a){a:;this.$2D_1=a;return a},$27_1:null,get_rootUser:function(){a:;return this.$27_1},set_rootUser:function(a){a:;this.$27_1=a;return a},$5b_1:null,get_$1c_1:function(){a:;return this.$5b_1},set_$1c_1:function(a){this.$5b_1=a;return a},get_$5U_1:function(){a:;return !CUI.ScriptUtility.isNullOrUndefined(this.$27_1)},$3x_1:function(d,c,e,f){var a=0,b=this.$27_1.isRootCommandEnabled(d,this);if(b)a|=1;if(CUI.ScriptUtility.isNullOrUndefined(c)||!f&&!b)return a;if(this.$27_1.executeRootCommand(c,e,null,this))a|=2;return a},pollForStateAndUpdate:function(){a:;this.$4i_0()},$4i_0:function(){a:;this.set_$4g_0(new Date);CUI.Component.prototype.$4i_0.call(this);this.ensureGlobalDisablingRemoved()},ensureGlobalDisablingRemoved:function(){a:;CUI.Utility.enableElement(this.get_$3_0())},get_element:function(){a:;return this.get_$3_0()},get_cssClass:function(){a:;return "ms-cui-disabled"},get_textDirection:function(){a:;return this._textDirection},$2U_1:function(){a:;return this.$7j_1++},$9F_1:function(a,b,c,d,e,f){return new CUI.MenuSection(this,a,b,c,d,e,f)},$9E_1:function(a,b,c,d){return new CUI.Menu(this,a,b,c,d)},$BS_1:function(a,b,c,d){return new CUI.Gallery(this,a,b,c,d)},$BR_1:function(a,b,c){return new CUI.ControlComponent(this,a,b,c)},$4b_1:function(a,b,c){return new CUI.MenuItem(this,a,b,c)},$BP_1:function(a,b,c,d){return new CUI.CommandEventArgs(a,b,c,d)},$Bu_1:function(a){if(CUI.ScriptUtility.isNullOrUndefined(a.$6_1))return;a.$6N_1=this.$CG_1();var b=a.get_commandInfo();b.CommandId=a.$6_1;b.RootId=this.$6_0;b.RootType=this.get_rootType();!CUI.ScriptUtility.isNullOrUndefined(this.$27_1)&&this.$27_1.executeRootCommand(a.$6_1,a.$37_1,b,this)},$3J_0:function(a){this.$Bu_1(a);return true},get_rootType:function(){a:;return "Root"},$CG_1:function(){a:;return this.$76_1++},$e_1:null,$Al_1:function(a){if(CUI.ScriptUtility.isNullOrUndefined(this.$e_1))this.$e_1=[];Array.add(this.$e_1,a)},$5c_1:false,$3E_1:function(c){if(CUI.ScriptUtility.isNullOrUndefined(this.$e_1))return;this.$5c_1=true;for(var b=Array.indexOf(this.$e_1,c),a=this.$e_1.length-1;a>=b;a--){this.$e_1[a].$5N_1();Array.removeAt(this.$e_1,a)}this.$5c_1=false},$4a_1:function(){a:;if(this.$5c_1||CUI.ScriptUtility.isNullOrUndefined(this.$e_1))return;for(var a=this.$e_1.length-1;a>=0;a--){this.$e_1[a].$5N_1();Array.removeAt(this.$e_1,a)}},$3D_1:null,$2l_1:function(){a:;if(CUI.ScriptUtility.isNullOrUndefined(this.$3D_1))return;this.$3D_1.$g_0()},$2j_1:0,$3n_1:null,get_$8i_1:function(){a:;if(Sys.Browser.agent===Sys.Browser.InternetExplorer&&CUI.ScriptUtility.isNullOrUndefined(this.$3n_1)){this.$3n_1=CUI.Utility.$9C();this.$3n_1.className="ms-cui-tooltip-backFrame";this.$3n_1.style.visibility="hidden";document.body.appendChild(this.$3n_1)}return this.$3n_1},$1s_1:false,$14_1:null,$2N_1:null,$19_1:null,$At_1:function(b){if(CUI.ScriptUtility.isNullOrUndefined(this.$2N_1))this.$2N_1=[];Array.add(this.$2N_1,b);this.$19_1=b;if(this.$1s_1)return false;var a=this.get_$A4_1();a.style.visibility="hidden";document.body.appendChild(a);a.style.visibility="visible";this.$1s_1=true;return true},$Bi_1:function(a){if(a!==this.$19_1)return;if(!this.$1s_1)throw Error.create("Cannot end modal mode because the Ribbon is not in Modal Mode");Array.removeAt(this.$2N_1,this.$2N_1.length-1);this.$19_1=null;if(this.$2N_1.length>0)this.$19_1=this.$2N_1[this.$2N_1.length-1];CUI.ScriptUtility.isNullOrUndefined(this.$19_1)&&this.$Bk_1()},$Bk_1:function(){a:;if(!this.$1s_1)return;if(!this.$2N_1.length){document.body.removeChild(this.get_$A4_1());this.$1s_1=false;if(Sys.Browser.agent===Sys.Browser.InternetExplorer){$clearHandlers(this.$14_1);this.$14_1=null}}},get_$A4_1:function(){a:;if(CUI.ScriptUtility.isNullOrUndefined(this.$14_1)){this.$14_1=CUI.Utility.$4("div");if(Sys.Browser.agent===Sys.Browser.InternetExplorer)this.$14_1.className="ms-cui-modalDiv-ie";else this.$14_1.className="ms-cui-modalDiv-ff";CUI.Utility.$6n()&&CUI.Utility.ensureCSSClassOnElement(this.$14_1,"ms-cui-modalDiv-ie8");CUI.Utility.$2C(this.$14_1,true,false);$addHandler(this.$14_1,"click",this.$$d_$Cl_1);$addHandler(this.$14_1,"mouseover",this.$$d_$Cn_1);$addHandler(this.$14_1,"mouseout",this.$$d_$Cm_1);$addHandler(this.$14_1,"contextmenu",this.$$d_$Cj_1)}return this.$14_1},$6C_1:null,$1a_1:null,$Cj_1:function(a){!CUI.ScriptUtility.isNullOrUndefined(this.$19_1)&&this.$19_1.onModalContextMenu(a)},$Cl_1:function(a){!CUI.ScriptUtility.isNullOrUndefined(this.$19_1)&&this.$19_1.onModalBodyClick(a)},$Cn_1:function(a){!CUI.ScriptUtility.isNullOrUndefined(this.$19_1)&&this.$19_1.onModalBodyMouseOver(a)},$Cm_1:function(a){!CUI.ScriptUtility.isNullOrUndefined(this.$19_1)&&this.$19_1.onModalBodyMouseOut(a)},$Ck_1:function(a){if(!this.$1s_1)return;!CUI.ScriptUtility.isNullOrUndefined(this.$19_1)&&this.$19_1.onModalKeyPress(a)},onWindowScroll:function(){a:;this.$4a_1();this.$2l_1()},$Bz_1:function(){a:;this.$9J_1()},$8M_1:function(){this.$4a_1();this.$2l_1();this.dispose()},dispose:function(){a:;if(this.$3R_1)return;this.$3R_1=true;!CUI.ScriptUtility.isNullOrUndefined(this.get_$3_0())&&this.$8j_1&&$removeHandler(this.get_$3_0(),"contextmenu",CUI.Utility.get_returnFalseHandler());try{$removeHandler(document,"keydown",this.$6C_1)}catch(a){}$removeHandler(window,"unload",this.$1a_1);!CUI.ScriptUtility.isNullOrUndefined(this.$14_1)&&$clearHandlers(this.$14_1);this.$14_1=null;this.$27_1=null;this.$5b_1=null;CUI.Component.prototype.dispose.call(this)},$3R_1:false,set_$Be_1:function(a){this.$3R_1=a;return a},get_componentWidth:function(){a:;if(this._componentWidth===-1&&!CUI.ScriptUtility.isNullOrUndefined(this.get_$3_0()))this._componentWidth=this.get_$3_0().offsetWidth;return this._componentWidth},get_$BK_0:function(){a:;if(this._componentHeight===-1&&!CUI.ScriptUtility.isNullOrUndefined(this.get_$3_0()))this._componentHeight=this.get_$3_0().offsetHeight;return this._componentHeight},get_$95_0:function(){a:;if(this._componentTopPosition===-1&&!CUI.ScriptUtility.isNullOrUndefined(this.get_$3_0()))this._componentTopPosition=CUI.UIUtility.calculateOffsetTop(this.get_$3_0());return this._componentTopPosition},get_componentLeftPosition:function(){a:;if(this._componentLeftPosition===-1&&!CUI.ScriptUtility.isNullOrUndefined(this.get_$3_0()))this._componentLeftPosition=CUI.UIUtility.calculateOffsetLeft(this.get_$3_0());return this._componentLeftPosition},$4s_1:"",get_cookieDataVersion:function(){a:;return this.$4s_1},set_cookieDataVersion:function(a){a:;this.$4s_1=a;return a},$4W_1:false,get_useDataCookie:function(){a:;return this.$4W_1},set_useDataCookie:function(a){a:;this.$4W_1=a;return a},storeLocalData:function(b,a){a:;window.localStorage[b]=a},getLocalDataValue:function(b){a:;var a=null;a=window.localStorage.getItem(b);return a},storeDataCookie:function(c,b){a:;var a=new Date;a.setTime(a.getTime()+6.048e8);document.cookie=c+"="+this.$4s_1+b+"; expires="+a.toDateString()+"; path=/"},getDataCookieValue:function(a){a:;a=this.$4s_1+a;for(var d=document.cookie.split(";"),c=0;c<d.length;c++){var b=d[c].trimStart();if(b.startsWith(a))if(b.startsWith(a+"="))return b.substring(a.length+1,b.length)}return null},$7_1:null,$34_1:false,$8a_1:function(b,f,z){var d=false;if(CUI.ScriptUtility.isNullOrUndefined(b)||CUI.ScriptUtility.isNullOrUndefined(f))return;var a,c,h=CUI.Root.$1Q(f,"launcherLeft"),m=CUI.Root.$1Q(f,"launcherTop"),i=CUI.Root.$1Q(f,"launcherWidth"),x=CUI.Root.$1Q(f,"launcherHeight"),e=CUI.Root.$1Q(f,"flyOutWidth"),A=CUI.Root.$1Q(f,"flyOutHeight"),p=CUI.Root.$1Q(f,"flyOutRealHeight"),l=CUI.Root.$1Q(f,"viewportWidth"),q=CUI.Root.$1Q(f,"viewportHeight"),g=CUI.Root.$1Q(f,"viewableLeft"),k=CUI.Root.$1Q(f,"viewableTop"),j=!this.$0_0._textDirection,u=false,v=false,n=z===1;b.style.maxHeight="none";b.style.top="0px";b.style.overflowY="visible";b.style.width="auto";e=b.offsetWidth;if(n){if(j){a=h+i;a+=2}else a=h-e;c=m}else{if(j)a=h;else a=h+i-e;c=m+x;var r=i>=2?i-2:i;if(r>e)e=r;b.style.minWidth=r+"px"}if(this.$34_1){c+=k;a+=g}b.style.top=c+"px";b.style.left=a+"px";if(e<=l)if(a+e>g+l){if(n&&j&&h-e>g)a=h-e;else{a=g+l-e-5;u=true}d=true}else if(a<g){if(n&&!j&&h+i+e<g+l)a=h+i;else{a=g+5;v=true}d=true}else d=false;else if(j){a=g;d=true}else{a=g+l-e;d=true}if(d){b.style.left=a+"px";d=false}if(c+p>k+q){var y=c,w=k+q-c;c=m-p;if(this.$34_1)c+=k;if(c<0)c=k;var o=m;if(!this.$34_1)o-=k;d=true;if(o<p){if(o<w){c=y;b.style.maxHeight=w+"px";d=false}else b.style.maxHeight=o+"px";var s,t;this.$Bl_1(b,t={val:s}),s=t.val;if(j&&u||!j&&!v){a-=s;b.style.left=a+"px"}}else if(n){c=q-b.offsetHeight;d=true}}else d=false;if(d){b.style.top=c+"px";d=false}b.style.overflowY="auto"},$Bl_1:function(a,d){var b=a.offsetWidth;a.style.overflowY="scroll";a.style.width="auto";var c=a.offsetWidth;d.val=c-b},$89_1:function(d,b){var a={};if(CUI.ScriptUtility.isNullOrUndefined(d)||CUI.ScriptUtility.isNullOrUndefined(b))return a;a["launcherWidth"]=b.offsetWidth;a["launcherHeight"]=b.offsetHeight;var e=b.offsetTop,f=b.offsetLeft;if(!CUI.ScriptUtility.isNullOrUndefined(b.offsetParent))for(var g=b.offsetParent;!CUI.ScriptUtility.isNullOrUndefined(g);g=g.offsetParent){e+=g.offsetTop;f+=g.offsetLeft}else{e=b.offsetTop;f=b.offsetLeft}if(!CUI.ScriptUtility.isNullOrUndefined(b.parentNode)){for(var i=0,h=0,c=b.parentNode;!CUI.ScriptUtility.isNullOrUndefined(c);c=c.parentNode){if(c.scrollTop>0)i+=c.scrollTop;if(c.scrollLeft>0)if(c===document.documentElement&&CUI.Utility.$3v()&&this.$0_0._textDirection===1)h+=document.body.scrollLeft;else h+=c.scrollLeft}if(e>=i)e-=i;if(f>=h)f-=h}a["launcherTop"]=e;a["launcherLeft"]=f;a["viewportWidth"]=CUI.Utility.$3s();a["viewportHeight"]=CUI.Utility.$4e();if(CUI.ScriptUtility.isNullOrUndefined(a["viewportWidth"])){a["viewportWidth"]=document.documentElement.clientWidth;a["viewportHeight"]=document.documentElement.clientHeight}if(CUI.ScriptUtility.isNullOrUndefined(a["viewportWidth"])){a["viewportWidth"]=document.body.clientWidth;a["viewportHeight"]=document.body.clientHeight}a["viewableTop"]=document.documentElement.scrollTop;a["viewableLeft"]=document.documentElement.scrollLeft;if(CUI.ScriptUtility.isNullOrUndefined(a["viewableTop"])){a["viewableTop"]=window.pageYOffset;a["viewableLeft"]=window.pageXOffset}if(CUI.ScriptUtility.isNullOrUndefined(a["viewableTop"])){a["viewableTop"]=document.body.scrollTop;a["viewableLeft"]=document.body.scrollLeft}if(CUI.Utility.$3v()&&this.$0_0._textDirection===1)a["viewableLeft"]=document.body.scrollLeft;a["flyOutHeight"]=d.offsetHeight;a["flyOutRealHeight"]=d.scrollHeight;var j=d.style.overflowY;d.style.overflowY="visible";a["flyOutWidth"]=d.offsetWidth;d.style.overflowY=j;return a}};CUI.ScalableRoot=function(a,b){this.$$d_$D4_2=Function.createDelegate(this,this.$D4_2);this._viewPortWidth=CUI.Utility.$3s();this._viewPortHeight=CUI.Utility.$4e();CUI.ScalableRoot.initializeBase(this,[a,b]);this._lastWindowResizeWidthHeight=this.$9r_2()};CUI.ScalableRoot.prototype={$6Y_2:false,$4O_2:null,$5x_2:false,_lastWindowResizeWidthHeight:null,$8k_2:true,get_$5Y_2:function(){a:;return this.$6Y_2},set_$5Y_2:function(a){if(a===this.$6Y_2)return a;if(a)$addHandler(window,"resize",this.$4O_2);else try{$removeHandler(window,"resize",this.$4O_2)}catch(b){}this.$6Y_2=a;return a},$X_0:function(){a:;this.$4O_2=this.$$d_$D4_2;this.set_$5Y_2(true);CUI.Component.prototype.$X_0.call(this)},$9r_2:function(){a:;return CUI.Utility.$3s().toString()+CUI.Utility.$4e().toString()},$Dm_2:function(){a:;return this._viewPortWidth!==CUI.Utility.$3s()||this._viewPortHeight!==CUI.Utility.$4e()},$DE_2:function(){a:;this._viewPortWidth=CUI.Utility.$3s();this._viewPortHeight=CUI.Utility.$4e()},$D4_2:function(){var a=this.$9r_2();if(this._lastWindowResizeWidthHeight===a)return;this._lastWindowResizeWidthHeight=a;if(!this.$5x_2&&this.$8k_2&&this.$Dm_2()){this.$DE_2();this.$5x_2=true;this._componentWidth=this._componentHeight=-1;this.$4a_1();this.$2l_1();var b=this.$DI_2();b&&this.pollForStateAndUpdate();this.$5x_2=false}},get_headerScalingEnabled:function(){a:;return !CUI.ScriptUtility.isNullOrUndefined(window._ribbonScaleHeader)},scaleHeaderInternal:function(a){a:;this.get_headerScalingEnabled()&&window._ribbonScaleHeader(a,this.$0_0._textDirection===1)},dispose:function(){a:;if(!CUI.ScriptUtility.isNullOrUndefined(this.$4O_2)){this.set_$5Y_2(false);this.$4O_2=null}CUI.Root.prototype.dispose.call(this)}};CUI.ToolTip=function(b,c,d,e,a){this.$$d_$CW_1=Function.createDelegate(this,this.$CW_1);CUI.ToolTip.initializeBase(this,[b,c,d,e]);this.$7_1=a;if(!CUI.ScriptUtility.isNullOrEmptyString(a.ToolTipShortcutKey))if(!this.$0_0._textDirection)this.$1N_0=String.format("{0} ({1})",this.get_title(),this.$7_1.ToolTipShortcutKey);else this.$1N_0=String.format("({1}) {0}",this.get_title(),this.$7_1.ToolTipShortcutKey)};CUI.ToolTip.prototype={$T_1:null,$Q_1:null,$E_1:null,$1T_1:null,$4y_1:null,$43_1:null,$59_1:null,$2x_1:null,$5m_1:null,$5n_1:null,$3V_1:null,$50_1:null,$2z_1:null,$5p_1:null,$51_1:null,$52_1:null,$6P_1:null,$6Q_1:null,$7g_1:null,$7h_1:null,$7i_1:null,$7_1:null,$1A_1:null,$2A_0:function(){a:;this.get_needsDelayIniting()&&this.doDelayedInit();this.ensureDOMElementAndEmpty();this.get_$3_0().setAttribute("role","tooltip");this.get_$3_0().setAttribute("aria-hidden","true");if(CUI.ScriptUtility.isNullOrUndefined(this.$T_1)){this.$T_1=CUI.Utility.$4("div");this.$T_1.className="ms-cui-tooltip-body"}else this.$T_1=CUI.Utility.removeChildNodes(this.$T_1);this.get_$3_0().appendChild(this.$T_1);if(CUI.ScriptUtility.isNullOrUndefined(this.$Q_1)){this.$Q_1=CUI.Utility.$4("div");this.$Q_1.className="ms-cui-tooltip-glow";this.$T_1.appendChild(this.$Q_1)}else this.$Q_1=CUI.Utility.removeChildNodes(this.$Q_1);if(CUI.ScriptUtility.isNullOrUndefined(this.$E_1)){this.$E_1=CUI.Utility.$4("h1");if(this.$1N_0.length>100)CUI.UIUtility.setInnerText(this.$E_1,this.$1N_0.substr(0,100));else CUI.UIUtility.setInnerText(this.$E_1,this.get_title());this.$Q_1.appendChild(this.$E_1)}if(CUI.ScriptUtility.isNullOrUndefined(this.$4y_1)&&!CUI.ScriptUtility.isNullOrEmptyString(this.$7_1.ToolTipImage32by32)){this.$4y_1=CUI.Utility.$4("img");this.$43_1=CUI.Utility.$m(2,4,this.$7_1.ToolTipImage32by32,this.$7_1.ToolTipImage32by32Class,this.$4y_1,true,false,this.$7_1.ToolTipImage32by32Top,this.$7_1.ToolTipImage32by32Left);this.$43_1.className=this.$43_1.className+" ms-cui-tooltip-bitmap ";this.$Q_1.appendChild(this.$43_1)}var b=this.$7_1.ToolTipSelectedItemTitle,a=this.get_description();if(CUI.ScriptUtility.isNullOrUndefined(this.$1T_1)&&(!CUI.ScriptUtility.isNullOrEmptyString(a)||!CUI.ScriptUtility.isNullOrEmptyString(b))){this.$1T_1=CUI.Utility.$4("div");this.$1T_1.className="ms-cui-tooltip-description";if(!CUI.ScriptUtility.isNullOrUndefined(this.$7_1.ToolTipImage32by32))this.$1T_1.style.width="80%";this.$Q_1.appendChild(this.$1T_1);var c=this.$0_0.$7_1.ToolTipSelectedItemTitlePrefix;if(!CUI.ScriptUtility.isNullOrEmptyString(b)&&!CUI.ScriptUtility.isNullOrEmptyString(c)){var d=String.format(c,b);this.$59_1=CUI.Utility.$4("p");CUI.Utility.$2B(this.$59_1,d);this.$1T_1.appendChild(this.$59_1);this.$7i_1=CUI.Utility.$4("br");this.$1T_1.appendChild(this.$7i_1)}if(!CUI.ScriptUtility.isNullOrEmptyString(a))if(a.length>512)this.$1T_1.innerHTML=this.$1T_1.innerHTML+CUI.Utility.$9x(a.substr(0,512),true);else this.$1T_1.innerHTML=this.$1T_1.innerHTML+CUI.Utility.$9x(a,true)}if(CUI.ScriptUtility.isNullOrUndefined(this.$2x_1)&&!CUI.ScriptUtility.isNullOrUndefined(this.$1A_1)&&!CUI.ScriptUtility.isNullOrEmptyString(this.$1A_1.Title)){this.$6P_1=CUI.Utility.$4("div");this.$6P_1.className="ms-cui-tooltip-clear";this.$Q_1.appendChild(this.$6P_1);this.$7g_1=CUI.Utility.$4("hr");this.$Q_1.appendChild(this.$7g_1);this.$3V_1=CUI.Utility.$4("div");this.$3V_1.className="ms-cui-tooltip-footer";this.$Q_1.appendChild(this.$3V_1);this.$50_1=CUI.Utility.$4("span");CUI.Utility.$2B(this.$50_1,this.$1A_1.Title);this.$5m_1=CUI.Utility.$4("img");this.$5n_1=CUI.Utility.$m(2,3,this.$1A_1.Icon,this.$1A_1.IconClass,this.$5m_1,true,false,this.$1A_1.IconTop,this.$1A_1.IconLeft);this.$5n_1.style.verticalAlign="top";this.$3V_1.appendChild(this.$5n_1);this.$3V_1.appendChild(this.$50_1);if(!CUI.ScriptUtility.isNullOrUndefined(this.$1A_1.Description)){this.$2x_1=CUI.Utility.$4("div");this.$2x_1.className="ms-cui-tooltip-description";this.$2x_1.style.width="90%";CUI.Utility.$2B(this.$2x_1,this.$1A_1.Description);this.$Q_1.appendChild(this.$2x_1)}}if(CUI.ScriptUtility.isNullOrUndefined(this.$2z_1)&&!CUI.ScriptUtility.isNullOrUndefined(this.$0_0.$7_1.ToolTipFooterImage16by16)&&!CUI.ScriptUtility.isNullOrUndefined(this.$0_0.$7_1.ToolTipFooterText)&&(!CUI.ScriptUtility.isNullOrUndefined(this.$1A_1)&&!CUI.ScriptUtility.isNullOrEmptyString(this.$1A_1.HelpKeyWord)||!CUI.ScriptUtility.isNullOrEmptyString(this.$7_1.ToolTipHelpKeyWord))){this.$6Q_1=CUI.Utility.$4("div");this.$6Q_1.className="ms-cui-tooltip-clear";this.$Q_1.appendChild(this.$6Q_1);this.$7h_1=CUI.Utility.$4("hr");this.$Q_1.appendChild(this.$7h_1);this.$2z_1=CUI.Utility.$4("div");this.$2z_1.className="ms-cui-tooltip-footer";this.$Q_1.appendChild(this.$2z_1);this.$52_1=CUI.Utility.$4("span");CUI.Utility.$2B(this.$52_1,this.$0_0.$7_1.ToolTipFooterText);this.$5p_1=CUI.Utility.$4("img");this.$51_1=CUI.Utility.$m(2,3,this.$0_0.$7_1.ToolTipFooterImage16by16,this.$0_0.$7_1.ToolTipFooterImage16by16Class,this.$5p_1,true,false,this.$0_0.$7_1.ToolTipFooterImage16by16Top,this.$0_0.$7_1.ToolTipFooterImage16by16Left);this.$51_1.style.verticalAlign="top";this.$2z_1.appendChild(this.$51_1);this.$2z_1.appendChild(this.$52_1)}this.appendChildrenToElement(this.$T_1);CUI.Component.prototype.$2A_0.call(this)},$Bd_1:function(){a:;this.$2A_0();this.get_$3_0().style.visibility="hidden";this.get_$3_0().style.position="absolute";this.get_$3_0().style.top="0px";this.get_$3_0().style.left="0px";document.body.appendChild(this.get_$3_0());this.$D7_1();if(Sys.Browser.agent===Sys.Browser.InternetExplorer){CUI.Utility.$AM(this.$0_0.get_$8i_1(),this.get_$3_0());this.$0_0.get_$8i_1().style.visibility="visible"}this.get_$3_0().style.visibility="visible";this.set_visible(true);this.get_$3_0().setAttribute("aria-hidden","false");return true},$9u_1:function(){a:;if(!CUI.ScriptUtility.isNullOrUndefined(this.get_$3_0())){this.get_$3_0().style.visibility="hidden";this.get_$3_0().setAttribute("aria-hidden","true")}if(Sys.Browser.agent===Sys.Browser.InternetExplorer)this.$0_0.get_$8i_1().style.visibility="hidden";this.set_visible(false)},get_cssClass:function(){a:;return "ms-cui-tooltip"},get_innerDiv:function(){a:;return this.$Q_1},set_innerDiv:function(a){this.$Q_1=a;return a},$D7_1:function(){a:;var b=this.get_$3_0(),c=this.$M_0.get_$3_0();if(CUI.ScriptUtility.isNullOrUndefined(b)||CUI.ScriptUtility.isNullOrUndefined(c))return;b.style.top="0px";b.style.left="0px";var a=this.$0_0.$89_1(b,c),f=CUI.Root.$1Q(a,"flyOutWidth");if(this.$M_0.get_$95_0()>this.$0_0.get_$95_0()&&this.$M_0.get_$95_0()+this.$M_0.get_$BK_0()<this.$0_0.get_$95_0()+this.$0_0.get_$BK_0()){a["launcherTop"]=this.$0_0.get_$95_0();a["launcherHeight"]=this.$0_0.get_$BK_0()}else{var d=CUI.Root.$1Q(a,"launcherLeft"),e=CUI.Root.$1Q(a,"launcherTop");d+=30;e+=10;a["launcherLeft"]=d;a["launcherTop"]=e}this.$0_0.$8a_1(b,a,2);b.style.minWidth=f+"px"},$CW_1:function(){this.$0_0&&this.$0_0.$2l_1()},$AB_1:function(a){if(a)if(a.rawEvent){var e=113,f=123,c=a.rawEvent.keyCode;if(c===e||c===f){var b=null;if(!CUI.ScriptUtility.isNullOrUndefined(this.$7_1.ToolTipHelpKeyWord))b=this.$7_1.ToolTipHelpKeyWord;if(!CUI.ScriptUtility.isNullOrUndefined(this.$1A_1)&&!CUI.ScriptUtility.isNullOrEmptyString(this.$1A_1.HelpKeyWord))b=this.$1A_1.HelpKeyWord;if(!CUI.ScriptUtility.isNullOrUndefined(b)){var d={};d["HelpKeyword"]=b;!CUI.ScriptUtility.isNullOrUndefined(this.$0_0.$7_1.ToolTipHelpCommand)&&this.raiseCommandEvent(this.$0_0.$7_1.ToolTipHelpCommand,1,d)}a.preventDefault();a.stopPropagation();a.rawEvent.cancelBubble=true;a.rawEvent.returnValue=false}else this.$0_0.$2l_1()}},dispose:function(){a:;CUI.Component.prototype.dispose.call(this);this.$T_1=null;this.$1T_1=null;this.$4y_1=null;this.$43_1=null;this.$2x_1=null;this.$5m_1=null;this.$3V_1=null;this.$50_1=null;this.$2z_1=null;this.$5p_1=null;this.$51_1=null;this.$52_1=null;this.$Q_1=null;this.$E_1=null;this.$59_1=null}};CUI.Unit=function(a,b,c,d,e,f){this.$5E_0=a;this.$4n_0=b;this.$4M_0=c;this.$4K_0=d;this.$5i_0=e;this.$6S_0=f};CUI.Unit.prototype={$5E_0:null,$4n_0:null,$4M_0:0,$4K_0:0,$5i_0:0,$6S_0:0,$7q_0:function(b){if(!b)return false;for(var a=0;a<this.$4n_0.length;a++)if(this.$4n_0[a].toLowerCase()===b.toLowerCase())return true;return false},$Dj_0:function(a){if(typeof a!=="number")return -1;if(a<this.$4M_0)return 2;if(a>this.$4K_0)return 3;var b=a.toString(),c=b.indexOf(".");if(c>-1){var d=b.substr(c+1);if(d.length>this.$5i_0)return 1}return 0},get_$6a_0:function(){a:;return this.$4n_0[0]}};CUI.Utility=function(){};CUI.Utility.removeChildNodes=function(a){if(CUI.ScriptUtility.isNullOrUndefined(a))return null;var c=a.parentNode;if(c){var d=a.cloneNode(false);c.replaceChild(d,a);return d}else{var b=a.firstChild,e;while(b){e=b.nextSibling;a.removeChild(b);b=e}return a}};CUI.Utility.removeChildNodesSlow=function(a){while(a.hasChildNodes())a.removeChild(a.firstChild)};CUI.Utility.toggleCSSClassOnElement=function(a,b,c){if(!CUI.ScriptUtility.isNullOrUndefined(a))if(c)CUI.Utility.ensureCSSClassOnElement(a,b);else CUI.Utility.removeCSSClassFromElement(a,b)};CUI.Utility.ensureCSSClassOnElement=function(c,d){if(CUI.ScriptUtility.isNullOrUndefined(c))return;var a=c.className;if(!CUI.ScriptUtility.isNullOrUndefined(a)&&a.indexOf(d)!==-1)return;var b=a.trim()+" "+d;b=b.trim();c.className=b};CUI.Utility.isDescendantOf=function(b,a){while(!CUI.ScriptUtility.isNullOrUndefined(a)){try{if(a.nodeName.toLowerCase()==="body")break}catch(c){if(a===b)return true;break}if(a===b)return true;a=a.parentNode}return false};CUI.Utility.removeCSSClassFromElement=function(a,c){if(CUI.ScriptUtility.isNullOrUndefined(a)||CUI.ScriptUtility.isNullOrUndefined(c)||CUI.ScriptUtility.isNullOrUndefined(a.className))return;var b=a.className;if(b!==b.replace(c,""))a.className=b.replace(c,"")};CUI.Utility.setEnabledOnElement=function(a,b){if(b)CUI.Utility.enableElement(a);else CUI.Utility.disableElement(a)};CUI.Utility.enableElement=function(a){if(CUI.ScriptUtility.isNullOrUndefined(a))return;CUI.Utility.removeCSSClassFromElement(a,"ms-cui-disabled");a.removeAttribute("aria-disabled")};CUI.Utility.disableElement=function(a){if(CUI.ScriptUtility.isNullOrUndefined(a))return;CUI.Utility.ensureCSSClassOnElement(a,"ms-cui-disabled");a.setAttribute("aria-disabled","true")};CUI.Utility.setDisabledAttribute=function(a,b){if(CUI.ScriptUtility.isNullOrUndefined(a))return;a.disabled=b};CUI.Utility.$29=function(a){a.setAttribute("href","javascript:;");a.setAttribute("onclick","return false;")};CUI.Utility.$5O=function(){a:;var a=CUI.Utility.$4("a");a.href="javascript:;";a.setAttribute("onclick","return false;");return a};CUI.Utility.$9j=function(d){var a=d,e=0,f=0,g=d.offsetWidth,h=d.offsetHeight;while(!CUI.ScriptUtility.isNullOrUndefined(a)&&!CUI.ScriptUtility.isNullOrUndefined(a.nodeName)&&a.nodeName.toLowerCase()!=="body"){var b=a.clientLeft;if(CUI.ScriptUtility.isNullOrUndefined(b))b=0;var c=a.clientTop;if(CUI.ScriptUtility.isNullOrUndefined(c))c=0;e+=a.offsetLeft+b;f+=a.offsetTop+c;a=a.offsetParent}return new Sys.UI.Bounds(e,f,g,h)};CUI.Utility.$2B=function(a,b){CUI.UIUtility.setInnerText(a,b)};CUI.Utility.$9x=function(b,m){var c=new Sys.StringBuilder;if(CUI.ScriptUtility.isNullOrEmptyString(b)||0===b.length)return null;var k=false,e=0,l=0,a=0,i=b.length;while(a<i){var f,j=b.charCodeAt(a);if(j<63)f=CUI.Utility.$9w[j];else if(j>=160&&j<=255)f=-2;else f=0;if(f){if(l>0){c.append(b.substring(e,e+l));l=0}e=a+1;if(f===-2){c.append("&#");c.append(j.toString());c.append(";")}else if(f===8){var n=b.charAt(a+1);if(n===" "||k)c.append(CUI.Utility.$1C[f]);else c.append(" ")}else{if(f===2&&m){if(a+5<i&&b.charAt(a+1)==="n"&&b.charAt(a+2)==="b"&&b.charAt(a+3)==="s"&&b.charAt(a+4)==="p"&&b.charAt(a+5)===";"){c.append(CUI.Utility.$1C[8]);a+=6;e+=5;continue}if(a+5<i&&b.charAt(a+1)==="#"&&b.charAt(a+2)==="1"&&b.charAt(a+3)==="6"&&b.charAt(a+4)==="0"&&b.charAt(a+5)===";"){c.append(CUI.Utility.$1C[8]);a+=6;e+=5;continue}}else if(f===4&&m){var g,d,h;g=b.charAt(a+1);if("b"===g||"B"===g){d=b.charAt(a+2);if(">"===d){c.append(CUI.Utility.$1C[9]);a+=3;e+=2;continue}else if("r"===d||"R"===d){h=b.charAt(a+3);if(">"===h){c.append(CUI.Utility.$1C[7]);a+=4;e+=3;continue}if("/"===h){var o=b.charAt(a+4);if(o===">"){c.append(CUI.Utility.$1C[7]);a+=5;e+=4;continue}}if(" "===h){var p=b.charAt(a+4),q=b.charAt(a+5);if(p==="/"&&q===">"){c.append(CUI.Utility.$1C[7]);a+=6;e+=5;continue}}}}else if("i"===g||"I"===g){d=b.charAt(a+2);if(">"===d){c.append(CUI.Utility.$1C[10]);a+=3;e+=2;continue}}else if("p"===g||"P"===g){d=b.charAt(a+2);if(">"===d){c.append(CUI.Utility.$1C[11]);a+=3;e+=2;continue}}else if("u"===g||"U"===g){d=b.charAt(a+2);if(">"===d){c.append(CUI.Utility.$1C[12]);a+=3;e+=2;continue}}else if("/"===g){h=b.charAt(a+3);if(">"===h){d=b.charAt(a+2);if("b"===d||"B"===d){c.append(CUI.Utility.$1C[13]);a+=4;e+=3;continue}else if("i"===d||"I"===d){c.append(CUI.Utility.$1C[14]);a+=4;e+=3;continue}else if("p"===d||"P"===d){c.append(CUI.Utility.$1C[15]);a+=4;e+=3;continue}else if("u"===d||"U"===d){c.append(CUI.Utility.$1C[16]);a+=4;e+=3;continue}}}}else if(f===7)k=true;else k=false;c.append(CUI.Utility.$1C[f])}}else{k=false;l++}a++}e<i&&c.append(b.substring(e,i));return c.toString()};CUI.Utility.$3L=function(a,b){if(CUI.ScriptUtility.isNullOrUndefined(a)){a=b;if(CUI.ScriptUtility.isNullOrUndefined(a))a=""}return a};CUI.Utility.$2R=function(a,b){if(!CUI.ScriptUtility.isNullOrUndefined(a)&&!CUI.ScriptUtility.isNullOrUndefined(b)&&a.className!==b)a.className=b};CUI.Utility.$2C=function(a,c,d){if(CUI.ScriptUtility.isNullOrUndefined(a)||a.nodeName==="#text")return;if(c)a.setAttribute("unselectable","on");else a.setAttribute("unselectable","off");if(d){var b=a.firstChild;while(b){CUI.Utility.$2C(b,c,true);b=b.nextSibling}}};CUI.Utility.$m=function(e,m,f,g,b,n,h,i,j){var a=null;if(e===1)a=CUI.Utility.$4("div");else if(e===3)a=h?CUI.Utility.$BN():CUI.Utility.$4("a");else a=h?CUI.Utility.$BO():CUI.Utility.$4("span");var c="",o={};c=CUI.Utility.$9y[m];var k=!CUI.ScriptUtility.isNullOrUndefined(i),l=!CUI.ScriptUtility.isNullOrUndefined(j),d=!CUI.ScriptUtility.isNullOrUndefined(g);if(n)c+=" ms-cui-img-cont-float";else c+=" ms-cui-img-container";if(d)b.className=g;a.className+=" "+c;if(!CUI.ScriptUtility.isNullOrEmptyString(f)){a.appendChild(b);b.src=f;if(k)b.style.top=i+"px";if(l)b.style.left=j+"px";else if(!d)b.style.left="0px"}return a};CUI.Utility.$1y=function(a,e,f,g,h,i,j){a.style.display="inline-block";if(!CUI.ScriptUtility.isNullOrUndefined(f))a.className=f;if(!CUI.ScriptUtility.isNullOrEmptyString(j))a.style.height=j+"px";if(!CUI.ScriptUtility.isNullOrEmptyString(i))a.style.width=i+"px";if(!CUI.ScriptUtility.isNullOrEmptyString(e))a.style.backgroundImage="url("+e+")";var c="0px",d="0px",b=false;if(!CUI.ScriptUtility.isNullOrEmptyString(h)){c=h+"px";b=true}if(!CUI.ScriptUtility.isNullOrEmptyString(g)){d=g+"px";b=true}if(b)a.style.backgroundPosition=c+" "+d};CUI.Utility.$9C=function(){a:;var a=CUI.Utility.$4("iframe");a.style.position="absolute";a.style.visibility="hidden";a.style.borderWidth="0px";return a};CUI.Utility.$9B=function(){a:;var a=CUI.Utility.$4("span");if(Sys.Browser.agent===Sys.Browser.InternetExplorer)a.className="ms-cui-glass-ie";else a.className="ms-cui-glass-ff";return a};CUI.Utility.$AM=function(a,b){a.style.position="absolute";a.style.visibility="hidden";a.style.left=b.style.left;a.style.top=b.style.top;var c=b.offsetWidth,d=b.offsetHeight;if(CUI.Utility.$CP()){c-=4;d-=4}a.style.width=c.toString()+"px";a.style.height=d.toString()+"px";a.style.visibility="visible"};CUI.Utility.$20=function(a,b){if(CUI.ScriptUtility.isNullOrUndefined(b)||CUI.ScriptUtility.isNullOrUndefined(a)||CUI.ScriptUtility.isNullOrUndefined(a.ToolTipTitle))return;b.setAttribute("aria-describedby",a.Id+"_ToolTip")};CUI.Utility.$7z=function(a,f){var b,e="<br />",d=a.lastIndexOf("\u200b\u200b"),c=a.lastIndexOf(" ");if(d!==-1){b=CUI.Utility.$3u(a.substr(0,d))+e;if(d<a.length)b+=CUI.Utility.$3u(a.substr(d+2))}else if(c!==-1){b=CUI.Utility.$3u(a.substr(0,c))+e;if(c<a.length)b+=CUI.Utility.$3u(a.substr(c+1));if(f)b+=" "}else if(c===-1&&f)b=CUI.Utility.$3u(a)+e;else b=CUI.Utility.$3u(a);return b};CUI.Utility.$3u=function(c){if(CUI.ScriptUtility.isNullOrEmptyString(c))return "";for(var a=new Sys.StringBuilder,e=c.length,b=0;b<e;b++){var d=c.charAt(b);switch(d){case "<":a.append("&lt;");break;case ">":a.append("&gt;");break;case "&":a.append("&amp;");break;case '"':a.append("&quot;");break;case "'":a.append("&#39;");break;default:a.append(d)}}return a.toString()};CUI.Utility.$8Q=function(a){if(CUI.ScriptUtility.isNullOrUndefined(a))return;$clearHandlers(a);if(!CUI.ScriptUtility.isNullOrUndefined(a.childNodes))for(var b=0;b<a.childNodes.length;b++)CUI.Utility.$8Q(a.childNodes[b])};CUI.Utility.$BO=function(){a:;var a=CUI.Utility.$4("span");a.className="ms-cui-block";return a};CUI.Utility.$BN=function(){a:;var a=CUI.Utility.$4("a");a.className="ms-cui-block";return a};CUI.Utility.$u=function(a){if(CUI.ScriptUtility.isNullOrUndefined(a))return false;return a==="True"||a==="true"};CUI.Utility.$3s=function(){a:;var a=window.innerWidth;if(CUI.ScriptUtility.isNullOrUndefined(a))a=document.documentElement.clientWidth;if(CUI.ScriptUtility.isNullOrUndefined(a))a=document.body.clientWidth;return a};CUI.Utility.$4e=function(){a:;var a=window.innerHeight;if(CUI.ScriptUtility.isNullOrUndefined(a))a=document.documentElement.clientHeight;if(CUI.ScriptUtility.isNullOrUndefined(a))a=document.body.clientHeight;return a};CUI.Utility.$6i=function(b,c){var a=CUI.Utility.$CA(b,c,true);return a&&a.length>0?a[0]:null};CUI.Utility.$CA=function(a,c,d){if(!CUI.ScriptUtility.isNullOrUndefined(a.getElementsByClassName)){var b=a.getElementsByClassName(c);if(d){if(CUI.ScriptUtility.isNullOrUndefined(b)||b.length<=1)return b;var e=[];e[0]=b[0];return e}return b}if(!CUI.ScriptUtility.isNullOrUndefined(a.querySelectorAll)){if(d){var f=a.querySelector("."+c),g=[];if(!CUI.ScriptUtility.isNullOrUndefined(f))g[0]=f;return g}return a.querySelectorAll("."+c)}else return CUI.Utility.$9g(a,c,d)};CUI.Utility.$9g=function(e,f,d){for(var a=[],g=0,b,c=0;c<e.childNodes.length;c++){b=e.childNodes[c];if(!CUI.ScriptUtility.isNullOrUndefined(b.className)&&b.className.indexOf(f)>=0){a[g++]=b;if(d)break}a=a.concat(CUI.Utility.$9g(b,f,d));if(a.length>0&&d)break}return a};CUI.Utility.$8V=function(a){if(!CUI.ScriptUtility.isNullOrUndefined(a.select))a.select();else if(CUI.Utility.$6m()){var b=a.createTextRange();b.moveStart("character",0);b.moveEnd("character",a.value.length);b.select()}else a.setSelectionRange(0,a.value.length)};CUI.Utility.$6m=function(){a:;if(!CUI.Utility.$7L){CUI.Utility.$7M=Sys.Browser.agent===Sys.Browser.InternetExplorer;CUI.Utility.$7L=true}return CUI.Utility.$7M};CUI.Utility.$3v=function(){a:;if(!CUI.Utility.$7I){if(CUI.Utility.$6m()&&!window.document.documentMode)CUI.Utility.$7N=true;CUI.Utility.$7I=true}return CUI.Utility.$7N};CUI.Utility.$6n=function(){a:;if(!CUI.Utility.$7J){var a=window.document.documentMode;if(CUI.Utility.$6m()&&(!a||a<=8))CUI.Utility.$7O=true;CUI.Utility.$7J=true}return CUI.Utility.$7O};CUI.Utility.$CP=function(){a:;if(!CUI.Utility.$7K){var a=window.document.documentMode;if(CUI.Utility.$6m()&&a&&a>=9)CUI.Utility.$7P=true;CUI.Utility.$7K=true}return CUI.Utility.$7P};CUI.Utility.$8B=function(a,b){return CUI.Utility.$CE(a,[b])};CUI.Utility.$CE=function(b,e){var f=e.length;if(!b)return null;for(var c=0;c<f;c++)if(b.tagName.toLowerCase()===e[c].toLowerCase())return b;var a=b.parentNode;while(a){for(var d=0;d<f;d++)if(a.tagName.toLowerCase()===e[d].toLowerCase())return a;a=a.parentNode}return null};CUI.Utility.$4=function(b){var a=document.createElement(b);a.setAttribute("unselectable","on");return a};CUI.Utility.$2S=function(b){var a=document.createElement("label");a.setAttribute("unselectable","on");a.className="ms-cui-hidden";CUI.UIUtility.setInnerText(a,b);return a};CUI.Utility.$7s=function(a){return document.createElement(a)};CUI.Utility.$8e=function(b,a){if(CUI.ScriptUtility.isNullOrUndefined(a))return;b.style.imeMode=CUI.Utility.$u(a)?"auto":"disabled"};CUI.Utility.get_returnFalseHandler=function(){a:;if(CUI.ScriptUtility.isNullOrUndefined(CUI.Utility.$6J))CUI.Utility.$6J=CUI.NativeUtility.returnFalse;return CUI.Utility.$6J};CUI.Utility.$DX=function(a){return a>1};CUI.Utility.$DV=function(a){return !a||a===3};CUI.ScriptUtility=function(){};CUI.ScriptUtility.isNullOrEmptyString=function(a){var b=null;return a===b||typeof a==="undefined"||!a.length};CUI.ScriptUtility.isNullOrUndefined=function(a){var b=null;return a===b||typeof a==="undefined"};CUI.ScriptUtility.isUndefined=function(a){return typeof a==="undefined"};CUI.UIUtility=function(){};CUI.UIUtility.generateRandomElementId=function(){a:;var b=null,c=null;do{var a=Math.random();a=a*1e5;a=Math.round(a);b="rnd"+a.toString();c=$get(b)}while(c);return b};CUI.UIUtility.cancelEvent=function(a){if(a){a.preventDefault();a.stopPropagation()}};CUI.UIUtility.insertBefore=function(c,a){var b=a.parentNode;b.insertBefore(c,a)};CUI.UIUtility.insertAfter=function(c,b){var a=b.parentNode;if(a.lastChild===b)a.appendChild(c);else a.insertBefore(c,b.nextSibling)};CUI.UIUtility.removeNode=function(a){a.parentNode&&a.parentNode.removeChild(a)};CUI.UIUtility.calculateOffsetLeft=function(a){var b=0;while(a){b+=a.offsetLeft;a=a.offsetParent}return b};CUI.UIUtility.calculateOffsetTop=function(a){var b=0;while(a){b+=a.offsetTop;a=a.offsetParent}return b};CUI.UIUtility.setInnerText=function(a,b){CUI.NativeUtility.setInnerText(a,b)};CUI.UIUtility.isTextNode=function(a){return a.nodeType===3||a.nodeType===4};CUI.UIUtility.isNodeOfType=function(c,b){for(var a=0;a<b.length;a++)if(c.tagName===b[a])return true;return false};CUI.ListNode=function(a,b,c){this.next=c;this.previous=b;this.data=a};CUI.ListNode.prototype={next:null,previous:null,data:null};CUI.List=function(){};CUI.List.prototype={$1q_0:null,$3C_0:null,$P_0:0,add:function(a){if(!this.$1q_0)this.$1q_0=this.$3C_0=new CUI.ListNode(a,null,null);else this.$3C_0=this.$3C_0.next=new CUI.ListNode(a,this.$3C_0,null);this.$P_0++},insert:function(c,d){if(c>this.$P_0||0>c)throw Error.argumentOutOfRange("pos");if(c===this.$P_0){this.add(d);return}var a=this.$1q_0;while(0!==c--)a=a.next;var b=new CUI.ListNode(d,a.previous,a);if(!a.previous)this.$1q_0=b;else a.previous.next=b;if(!a.next)this.$3C_0=b;else a.next.previous=b},remove:function(b){var a=this.$1q_0;while(a){if(a.data===b)break;a=a.next}if(!a)return false;if(!a.previous)this.$1q_0=a.next;else a.previous.next=a.next;if(!a.next)this.$3C_0=a.previous;else a.next.previous=a.previous;return true},clear:function(){a:;var a=this.$1q_0,b;this.$1q_0=null;this.$3C_0=null;while(a){b=a.next;a.previous=null;a.next=null;a=b}},indexOf:function(c){var a=this.$1q_0,b=0;while(a){if(a.data===c)break;a=a.next;b++}if(!a)return -1;return b},get_item:function(b){var a=this.$8w_0(b);return a.data},get_count:function(){a:;return this.$P_0},getEnumerator:function(){a:;return new CUI.ListEnumerator(this.$1q_0)},getEnumeratorAtPos:function(b){var a=this.$8w_0(b);return new CUI.ListEnumerator(a)},toArray:function(){a:;var b=new Array(this.$P_0),c=0,a=this.getEnumerator();while(a.moveNext()){var d=a.get_current();b[c]=d;c++}return b},$8w_0:function(c){var a=this.$1q_0,b=0;while(b!==c){if(!a)throw Error.argumentOutOfRange("pos");a=a.next;b++}return a}};CUI.ListEnumerator=function(a){this.$3c_0=a};CUI.ListEnumerator.prototype={$3c_0:null,$f_0:null,get_current:function(){a:;if(!this.$f_0)throw Error.argumentOutOfRange();return this.$f_0.data},moveNext:function(){a:;if(!this.$f_0){this.$f_0=this.$3c_0;return !!this.$3c_0}if(!this.$f_0.next)return false;this.$f_0=this.$f_0.next;return true},movePrevious:function(){a:;if(!this.$f_0){this.$f_0=this.$3c_0;return !!this.$3c_0}if(!this.$f_0.previous)return false;this.$f_0=this.$f_0.previous;return true},reset:function(){a:;this.$f_0=this.$3c_0}};CUI.JsonXmlElement=function(b,a){a:;this.name=b;if(!a)a={};this.attrs=a};CUI.JsonXmlElement.prototype={get_name:function(){a:;return this.name},get_attributes:function(){a:;return this.attrs},appendChild:function(c,a){a:;var b=new CUI.JsonXmlElement(c,a);return this.appendChildNode(b)},appendChildNode:function(b){a:;var a=this.children;if(!a){a=[];this.children=a}Array.add(a,b);return b},get_childNodes:function(){a:;return this.children}};Type.registerNamespace("CUI.Controls");CUI.Controls.ColorStyle=function(){a:;this.Title=null;this.Color=null;this.Style=null;this.DisplayColor=null};CUI.Controls.ColorPickerResult=function(){};CUI.Controls.ContextMenuControlProperties=function(){a:;CUI.Controls.ContextMenuControlProperties.initializeBase(this)};CUI.Controls.ContextMenuControl=function(a,b,c,d){CUI.Controls.ContextMenuControl.initializeBase(this,[a,b,c,d]);this.addDisplayMode("Menu")};CUI.Controls.ContextMenuControl.prototype={$8I_3:null,createDOMElementForDisplayMode:function(a){switch(a){case "Menu":this.$8I_3=CUI.Utility.$4("span");return this.$8I_3;default:this.ensureValidDisplayMode(a);return null}},onEnabledChanged:function(){},onMenuButtonClick:function(a){if(!this.get_enabled())return;this.$CS_2(a,null);this.get_displayedComponent().raiseCommandEvent(this.get_$2_3().CommandMenuOpen,4,null)},onLaunchedMenuClosed:function(){a:;this.get_displayedComponent().raiseCommandEvent(this.get_$2_3().CommandMenuClose,10,null)},get_$2_3:function(){a:;return this.$7_0}};CUI.Controls.ButtonCommandProperties=function(){};CUI.Controls.Button=function(a,b,c){this.$$d_handleTabBlur=Function.createDelegate(this,this.handleTabBlur);this.$$d_handleTabFocus=Function.createDelegate(this,this.handleTabFocus);this.$$d_handleMouseBlur=Function.createDelegate(this,this.handleMouseBlur);this.$$d_handleMouseFocus=Function.createDelegate(this,this.handleMouseFocus);this.$$d_onClick=Function.createDelegate(this,this.onClick);CUI.Controls.Button.initializeBase(this,[a,b,c]);this.addDisplayMode("Small");this.addDisplayMode("Medium");this.addDisplayMode("Large");this.addDisplayMode("Menu");this.addDisplayMode("Menu16");this.addDisplayMode("Menu32");this.$1Z_1=this.get_$2_1().LabelText;this.get_stateProperties()["LabelText"]=this.$1Z_1};CUI.Controls.Button.prototype={$G_1:null,$2H_1:null,$22_1:null,$A_1:null,$2I_1:null,$o_1:null,$B_1:null,$2K_1:null,$S_1:null,$48_1:null,$55_1:null,$c_1:null,$49_1:null,$56_1:null,$1r_1:null,$r_1:null,$5q_1:null,$5r_1:null,$5s_1:null,$1e_1:null,$1K_1:null,$1Z_1:null,createComponentForDisplayModeInternal:function(a){var b;if(a.startsWith("Menu")){b=this.$0_0.$4b_1(this.$6_0+"-"+a+this.$0_0.$2U_1(),a,this);this.$1r_1=this.get_$2_1().MenuItemId;this.$r_1=this.get_$2_1().CommandValueId;if(CUI.ScriptUtility.isNullOrEmptyString(this.$r_1))this.$r_1=this.$1r_1}else b=CUI.Control.prototype.createComponentForDisplayModeInternal.call(this,a);return b},createDOMElementForDisplayMode:function(a){return this.$3F_1(a,true)},$3F_1:function(r,a){var s=CUI.ScriptUtility.isNullOrUndefined(this.get_$2_1().Alt)?this.getTextValue():this.get_$2_1().Alt,q;switch(r){case "Large":var b,c,d;this.$G_1=(d=CUI.Control.createStandardControlDOMElement_OutParameters(this,this.$0_0,"Large",this.get_$2_1(),false,false,b={val:this.$22_1},c={val:this.$2H_1}),this.$22_1=b.val,this.$2H_1=c.val,d);a&&this.$Ar_0("Large");return this.$G_1;case "Medium":var e,f,g;this.$A_1=(g=CUI.Control.createStandardControlDOMElement_OutParameters(this,this.$0_0,"Medium",this.get_$2_1(),false,false,e={val:this.$o_1},f={val:this.$2I_1}),this.$o_1=e.val,this.$2I_1=f.val,g);a&&this.$Ar_0("Medium");return this.$A_1;case "Small":var h,i,j;this.$B_1=(j=CUI.Control.createStandardControlDOMElement_OutParameters(this,this.$0_0,"Small",this.get_$2_1(),false,false,h={val:q},i={val:this.$2K_1}),q=h.val,this.$2K_1=i.val,j);a&&this.$Ar_0("Small");return this.$B_1;case "Menu":case "Menu16":var k,l,m;this.$S_1=(m=CUI.Control.createStandardControlDOMElement_OutParameters(this,this.$0_0,"Menu16",this.get_$2_1(),true,false,k={val:this.$48_1},l={val:this.$55_1}),this.$48_1=k.val,this.$55_1=l.val,m);a&&this.$Ar_0("Menu16");return this.$S_1;case "Menu32":var n,o,p;this.$c_1=(p=CUI.Control.createStandardControlDOMElement_OutParameters(this,this.$0_0,"Menu32",this.get_$2_1(),true,false,n={val:this.$49_1},o={val:this.$56_1}),this.$49_1=n.val,this.$56_1=o.val,p);a&&this.$Ar_0("Menu32");return this.$c_1;default:this.ensureValidDisplayMode(r);return null}},$Aq_0:function(d){var a=$get(this.$6_0+"-"+d);this.storeElementForDisplayMode(a,d);if(CUI.ScriptUtility.isNullOrUndefined(a))return;for(var b=a,f=0;f<3;f++){b=b.firstChild;if(CUI.ScriptUtility.isNullOrUndefined(b))return}var e=b,c=null;if(d!=="Small"){c=a.childNodes[1];if(CUI.ScriptUtility.isNullOrUndefined(c))return}switch(d){case "Large":this.$G_1=a;this.$2H_1=e;this.$22_1=c;break;case "Medium":this.$A_1=a;this.$2I_1=e;this.$o_1=c;break;case "Small":this.$B_1=a;this.$2K_1=e}},$Ar_0:function(a){switch(a){case "Large":this.$X_1(this.$G_1,true);break;case "Medium":this.$X_1(this.$A_1,true);break;case "Small":this.$X_1(this.$B_1,true);break;case "Menu32":this.$X_1(this.$c_1,false);break;case "Menu16":this.$X_1(this.$S_1,false);break;case "Menu":this.$X_1(this.$S_1,false)}},$X_1:function(a,b){$addHandler(a,"click",this.$$d_onClick);b&&$addHandler(a,"dblclick",this.$$d_onDblClick);$addHandler(a,"mouseover",this.$$d_handleMouseFocus);$addHandler(a,"mouseout",this.$$d_handleMouseBlur);$addHandler(a,"focus",this.$$d_handleTabFocus);$addHandler(a,"blur",this.$$d_handleTabBlur)},onEnabledChanged:function(a){CUI.Utility.setEnabledOnElement(this.$G_1,a);CUI.Utility.setEnabledOnElement(this.$A_1,a);CUI.Utility.setEnabledOnElement(this.$B_1,a);CUI.Utility.setEnabledOnElement(this.$S_1,a);CUI.Utility.setEnabledOnElement(this.$c_1,a);!a&&this.$1d_1()},get_$96_0:function(){a:;return "Button"},$AK_0:function(){a:;if(!CUI.ScriptUtility.isNullOrUndefined(this.$7_0.Command)){var d=this.pollForStateAndUpdateInternal(this.get_$2_1().Command,this.get_$2_1().QueryCommand,this.get_stateProperties(),true);if((d&2)>0){var a=this.get_stateProperties()["LabelText"];if(CUI.ScriptUtility.isNullOrUndefined(a)){a=this.get_$2_1().LabelText;this.get_stateProperties()["LabelText"]=this.get_$2_1().LabelText}if(this.$1Z_1!==a){if(!CUI.ScriptUtility.isNullOrUndefined(this.$22_1))this.$22_1.innerHTML=CUI.Utility.$7z(a,false);!CUI.ScriptUtility.isNullOrUndefined(this.$o_1)&&CUI.Utility.$2B(this.$o_1,a);!CUI.ScriptUtility.isNullOrUndefined(this.$48_1)&&CUI.Utility.$2B(this.$48_1,a);!CUI.ScriptUtility.isNullOrUndefined(this.$49_1)&&CUI.Utility.$2B(this.$49_1,a);this.$0_0.$2D_1=true;this.$1Z_1=a}var c=CUI.Utility.$3L(this.get_stateProperties()["Image32by32Class"],this.get_$2_1().Image32by32Class),b=CUI.Utility.$3L(this.get_stateProperties()["Image16by16Class"],this.get_$2_1().Image16by16Class);CUI.Utility.$2R(this.$2H_1,c);CUI.Utility.$2R(this.$2I_1,b);CUI.Utility.$2R(this.$2K_1,b);CUI.Utility.$2R(this.$55_1,b);CUI.Utility.$2R(this.$56_1,c)}}},getTextValue:function(){a:;return this.$1Z_1},receiveFocus:function(){a:;this.onBeginFocus();var a=this.get_displayedComponent();if(CUI.ScriptUtility.isNullOrUndefined(a))return;a.set_$1H_2(true);!CUI.ScriptUtility.isNullOrUndefined(this.$S_1)&&this.$S_1.focus();!CUI.ScriptUtility.isNullOrUndefined(this.$c_1)&&this.$c_1.focus()},getDropDownDOMElementForDisplayMode:function(b){var a;switch(b){case "Large":a=this.$5q_1;break;case "Medium":a=this.$5r_1;break;case "Small":a=this.$5s_1;break;case "Menu":a=this.$1e_1;break;case "Text":a=this.$1K_1;break;default:a=CUI.Utility.$4("span")}if(a)return a;return this.$9A_1(b)},$9A_1:function(b){var a;switch(b){case "Large":a=this.$3F_1(b,false).cloneNode(true);this.$G_1=null;a.style.height="auto";a.childNodes[1].style.height="auto";this.$5q_1=a;break;case "Medium":a=this.$3F_1(b,false).cloneNode(true);this.$A_1=null;this.$5r_1=a;break;case "Small":a=this.$3F_1(b,false).cloneNode(true);this.$B_1=null;this.$5s_1=a;break;case "Menu":this.$1e_1=this.$3F_1("Menu",false).cloneNode(true);this.$S_1=null;return this.$1e_1;case "Text":var c=CUI.Utility.$4("a");CUI.Utility.$29(c);this.$1K_1=CUI.Utility.$4("span");this.$1K_1.className="ms-cui-textmenuitem";CUI.UIUtility.setInnerText(c,this.get_$2_1().LabelText);this.$1K_1.appendChild(c);return this.$1K_1;default:this.ensureValidDisplayMode(b);return null}return a},deselect:function(){},getMenuItemId:function(){a:;return this.$1r_1},getCommandValueId:function(){a:;return this.$r_1},$8c_0:function(){a:;if(!this.get_enabled()||!this.get_$73_0())return false;this.get_displayedComponent().get_$3_0().focus();return true},focusOnDisplayedComponent:function(){a:;this.receiveFocus()},onClick:function(d){!CUI.ScriptUtility.isNullOrUndefined(CUI.PMetrics)&&CUI.PMetrics.perfMark(7700);d.preventDefault();d.stopPropagation();this.$g_0();if(!this.get_enabled())return;this.$0_0.set_$4f_1(this);var b=1,a=this.get_stateProperties(),c=this.get_$2_1().CommandType;if(!CUI.ScriptUtility.isNullOrUndefined(c)&&c==="OptionSelection")b=3;a["CommandValueId"]=this.$r_1;a["MenuItemId"]=this.$1r_1;a["SourceControlId"]=this.$6_0;this.get_displayedComponent().raiseCommandEvent(this.get_$2_1().Command,b,a);!CUI.ScriptUtility.isNullOrUndefined(CUI.PMetrics)&&CUI.PMetrics.perfMark(7701)},handleMouseFocus:function(){this.onBeginFocus();if(!this.get_enabled())return;var a=this.get_displayedComponent();CUI.MenuItem.isInstanceOfType(a)&&a.set_$1H_2(true);if(CUI.ScriptUtility.isNullOrUndefined(this.get_$2_1().CommandPreview))return;var b=this.get_stateProperties();b["CommandValueId"]=this.$r_1;b["MenuItemId"]=this.$1r_1;var c=5,d=this.get_$2_1().CommandType;if(!CUI.ScriptUtility.isNullOrUndefined(d)&&d==="OptionSelection")c=7;a.raiseCommandEvent(this.get_$2_1().CommandPreview,c,b)},handleMouseBlur:function(){this.$1d_1();this.onEndFocus();if(!this.get_enabled())return;var a=this.get_displayedComponent();CUI.MenuItem.isInstanceOfType(a)&&a.set_$1H_2(false);if(CUI.ScriptUtility.isNullOrUndefined(this.get_$2_1().CommandRevert))return;var c=6,b=this.get_stateProperties();b["CommandValueId"]=this.$r_1;b["MenuItemId"]=this.$1r_1;var d=this.get_$2_1().CommandType;if(!CUI.ScriptUtility.isNullOrUndefined(d)&&d==="OptionSelection")c=8;a.raiseCommandEvent(this.get_$2_1().CommandRevert,c,b)},handleTabFocus:function(){this.onBeginFocus();var a=this.get_displayedComponent();if(CUI.MenuItem.isInstanceOfType(a)){a.set_$1H_2(true);this.$3t_1(this.get_enabled())}else this.get_enabled()&&this.$0_0.set_$q_1(this)},handleTabBlur:function(){this.$1d_1();this.onEndFocus();if(!this.get_enabled())return;var a=this.get_displayedComponent();CUI.MenuItem.isInstanceOfType(a)&&a.set_$1H_2(false)},onMenuClosed:function(){a:;this.$1d_1();this.$g_0()},$1d_1:function(){a:;!CUI.ScriptUtility.isNullOrUndefined(this.$G_1)&&CUI.Utility.removeCSSClassFromElement(this.$G_1,"ms-cui-ctl-hoveredOver");!CUI.ScriptUtility.isNullOrUndefined(this.$A_1)&&CUI.Utility.removeCSSClassFromElement(this.$A_1,"ms-cui-ctl-hoveredOver");!CUI.ScriptUtility.isNullOrUndefined(this.$B_1)&&CUI.Utility.removeCSSClassFromElement(this.$B_1,"ms-cui-ctl-hoveredOver");if(!CUI.ScriptUtility.isNullOrUndefined(this.$S_1)){CUI.Utility.removeCSSClassFromElement(this.$S_1,"ms-cui-ctl-hoveredOver");CUI.Utility.removeCSSClassFromElement(this.$S_1,"ms-cui-ctl-disabledHoveredOver")}if(!CUI.ScriptUtility.isNullOrUndefined(this.$c_1)){CUI.Utility.removeCSSClassFromElement(this.$c_1,"ms-cui-ctl-hoveredOver");CUI.Utility.removeCSSClassFromElement(this.$c_1,"ms-cui-ctl-disabledHoveredOver")}},$3t_1:function(b){var a="ms-cui-ctl-hoveredOver";if(!b){a="ms-cui-ctl-disabledHoveredOver";!CUI.ScriptUtility.isNullOrUndefined(this.$S_1)&&CUI.Utility.ensureCSSClassOnElement(this.$S_1,a);!CUI.ScriptUtility.isNullOrUndefined(this.$c_1)&&CUI.Utility.ensureCSSClassOnElement(this.$c_1,a)}else{!CUI.ScriptUtility.isNullOrUndefined(this.$G_1)&&CUI.Utility.ensureCSSClassOnElement(this.$G_1,a);!CUI.ScriptUtility.isNullOrUndefined(this.$A_1)&&CUI.Utility.ensureCSSClassOnElement(this.$A_1,a);!CUI.ScriptUtility.isNullOrUndefined(this.$B_1)&&CUI.Utility.ensureCSSClassOnElement(this.$B_1,a);!CUI.ScriptUtility.isNullOrUndefined(this.$S_1)&&CUI.Utility.ensureCSSClassOnElement(this.$S_1,a);!CUI.ScriptUtility.isNullOrUndefined(this.$c_1)&&CUI.Utility.ensureCSSClassOnElement(this.$c_1,a)}},dispose:function(){a:;CUI.Control.prototype.dispose.call(this);this.$G_1=null;this.$22_1=null;this.$2H_1=null;this.$A_1=null;this.$o_1=null;this.$2I_1=null;this.$B_1=null;this.$2K_1=null;this.$S_1=null;this.$48_1=null;this.$55_1=null;this.$c_1=null;this.$49_1=null;this.$56_1=null;this.$1r_1=null;this.$r_1=null;this.$5q_1=null;this.$5r_1=null;this.$5s_1=null;this.$1e_1=null;this.$1K_1=null;this.$1Z_1=null},get_$2_1:function(){a:;return this.$7_0}};CUI.Controls.CheckBoxCommandProperties=function(){};CUI.Controls.CheckBox=function(a,b,c){this.$$d_$AC_2=Function.createDelegate(this,this.$AC_2);this.$$d_$A9_2=Function.createDelegate(this,this.$A9_2);this.$$d_$6r_2=Function.createDelegate(this,this.$6r_2);this.$$d_$6s_2=Function.createDelegate(this,this.$6s_2);this.$$d_$5T_2=Function.createDelegate(this,this.$5T_2);this.$$d_$4h_2=Function.createDelegate(this,this.$4h_2);this.$$d_onClick=Function.createDelegate(this,this.onClick);CUI.Controls.CheckBox.initializeBase(this,[a,b,c])};CUI.Controls.CheckBox.prototype={$B_2:null,$15_2:null,$A_2:null,$y_2:null,$o_2:null,createDOMElementForDisplayMode:function(c){var a=CUI.ScriptUtility.isNullOrUndefined(this.get_$2_2().Alt)?this.get_$2_2().LabelText:this.get_$2_2().Alt;if(CUI.ScriptUtility.isNullOrUndefined(a))a="";switch(c){case "Small":this.$B_2=CUI.Utility.$4("span");this.$B_2.className="ms-cui-cbx";this.$B_2.setAttribute("mscui:controltype",this.get_$96_0());this.$15_2=CUI.Utility.$4("input");this.$15_2.type="checkbox";this.$15_2.className="ms-cui-cbx-input";this.$15_2.id=this._id+"-Small-checkbox";if(CUI.ScriptUtility.isNullOrUndefined(this.get_$2_2().ToolTipTitle))this.$15_2.title=a;this.$15_2.setAttribute("role",this.get_$2k_0());CUI.Utility.$20(this.get_$2_2(),this.$15_2);this.$X_2(this.$15_2,null);this.$B_2.appendChild(this.$15_2);return this.$B_2;case "Medium":this.$A_2=CUI.Utility.$4("span");this.$A_2.className="ms-cui-cbx";this.$A_2.setAttribute("mscui:controltype",this.get_$96_0());this.$y_2=CUI.Utility.$4("input");this.$y_2.type="checkbox";this.$y_2.className="ms-cui-cbx-input";this.$y_2.id=this._id+"-Medium-checkbox";if(CUI.ScriptUtility.isNullOrUndefined(this.get_$2_2().ToolTipTitle))this.$y_2.title=a;this.$y_2.setAttribute("role",this.get_$2k_0());CUI.Utility.$20(this.get_$2_2(),this.$y_2);var b=false;if(!CUI.ScriptUtility.isNullOrUndefined(this.get_$2_2().LabelText)){this.$o_2=CUI.Utility.$4("label");if(CUI.Utility.$3v())this.$o_2.setAttribute("htmlFor",this._id+"-Medium-checkbox");else this.$o_2.setAttribute("for",this._id+"-Medium-checkbox");CUI.Utility.$2B(this.$o_2,this.get_$2_2().LabelText);b=true}this.$X_2(this.$y_2,this.$o_2);this.$A_2.appendChild(this.$y_2);b&&this.$A_2.appendChild(this.$o_2);return this.$A_2;default:this.ensureValidDisplayMode(c);return null}},$Aq_0:function(b){var a=$get(this.$6_0+"-"+b);this.storeElementForDisplayMode(a,b);switch(b){case "Medium":this.$A_2=a;this.$y_2=a.firstChild;this.$o_2=a.childNodes[1];break;case "Small":this.$B_2=a;this.$15_2=a.firstChild}},$Ar_0:function(a){switch(a){case "Medium":this.$X_2(this.$y_2,this.$o_2);break;case "Small":this.$X_2(this.$15_2,null)}},$X_2:function(a,b){$addHandler(a,"click",this.$$d_onClick);$addHandler(a,"focus",this.$$d_$4h_2);$addHandler(a,"blur",this.$$d_$5T_2);$addHandler(a,"mouseover",this.$$d_$6s_2);$addHandler(a,"mouseout",this.$$d_$6r_2);$addHandler(a,"keydown",this.$$d_$A9_2);if(!CUI.ScriptUtility.isNullOrUndefined(b)){$addHandler(b,"click",this.$$d_$AC_2);$addHandler(b,"keydown",this.$$d_$A9_2);$addHandler(b,"mouseover",this.$$d_$6s_2);$addHandler(b,"mouseout",this.$$d_$6r_2)}},onEnabledChanged:function(a){if(a){CUI.Utility.enableElement(this.$B_2);CUI.Utility.enableElement(this.$A_2)}else{CUI.Utility.disableElement(this.$B_2);CUI.Utility.disableElement(this.$A_2)}CUI.Utility.setDisabledAttribute(this.$15_2,!a);CUI.Utility.setDisabledAttribute(this.$y_2,!a)},get_$96_0:function(){a:;return "CheckBox"},get_$2k_0:function(){a:;return "checkbox"},onClick:function(){this.$g_0();if(!this.get_enabled())return;var b=9,a=this.get_displayedComponent();switch(a.get_displayMode()){case "Small":this.get_stateProperties()["On"]=this.$15_2.checked;break;case "Medium":this.get_stateProperties()["On"]=this.$y_2.checked;break;default:this.ensureValidDisplayMode(a.get_displayMode());return}a.raiseCommandEvent(this.get_$2_2().Command,b,this.get_stateProperties());if(this.$0_0.get_$5U_1())this.$AK_0();else this.setState(this.get_stateProperties()["On"])},$4h_2:function(){this.onBeginFocus();if(!this.get_enabled())return;this.$0_0.set_$q_1(this);if(CUI.ScriptUtility.isNullOrUndefined(this.get_$2_2().CommandPreview))return;this.get_displayedComponent().raiseCommandEvent(this.get_$2_2().CommandPreview,5,this.get_stateProperties())},$A9_2:function(a){if(!CUI.ScriptUtility.isNullOrUndefined(a))a.keyCode===13&&this.$AC_2(a)},$6s_2:function(){this.onBeginFocus();if(!this.get_enabled())return;if(CUI.ScriptUtility.isNullOrUndefined(this.get_$2_2().CommandPreview))return;this.get_displayedComponent().raiseCommandEvent(this.get_$2_2().CommandPreview,5,this.get_stateProperties())},$5T_2:function(){this.onEndFocus();if(!this.get_enabled())return;if(CUI.ScriptUtility.isNullOrUndefined(this.get_$2_2().CommandRevert))return;this.get_displayedComponent().raiseCommandEvent(this.get_$2_2().CommandRevert,6,this.get_stateProperties())},$6r_2:function(){this.onEndFocus();if(!this.get_enabled())return;if(CUI.ScriptUtility.isNullOrUndefined(this.get_$2_2().CommandRevert))return;this.get_displayedComponent().raiseCommandEvent(this.get_$2_2().CommandRevert,6,this.get_stateProperties())},$AC_2:function(a){a.preventDefault();this.$g_0();if(!this.get_enabled())return;this.$0_0.set_$q_1(this);this.setState(!this.$y_2.checked);this.onClick(a)},setState:function(a){if(!CUI.ScriptUtility.isNullOrUndefined(this.$15_2))this.$15_2.checked=a;if(!CUI.ScriptUtility.isNullOrUndefined(this.$y_2))this.$y_2.checked=a},$AK_0:function(){a:;var a=this.pollForStateAndUpdateInternal(this.get_$2_2().Command,this.get_$2_2().QueryCommand,this.get_stateProperties(),true);(a&2)>0&&this.setState(this.get_stateProperties()["On"])},addDisplayModes:function(){a:;this.addDisplayMode("Small");this.addDisplayMode("Medium")},$8c_0:function(){a:;if(!this.get_enabled())return false;var a=this.get_displayedComponent().get_$3_0();a.firstChild.focus();return true},dispose:function(){a:;CUI.Controls.ToggleButton.prototype.dispose.call(this);this.$A_2=null;this.$y_2=null;this.$o_2=null;this.$B_2=null;this.$15_2=null},get_$2_2:function(){a:;return this.$7_0}};CUI.Controls.ColorPickerCommandProperties=function(){};CUI.Controls.ColorPicker=function(a,b,c,d){this.$$d_$A6_1=Function.createDelegate(this,this.$A6_1);this.$$d_$CV_1=Function.createDelegate(this,this.$CV_1);this.$$d_$A8_1=Function.createDelegate(this,this.$A8_1);this.$$d_$A7_1=Function.createDelegate(this,this.$A7_1);CUI.Controls.ColorPicker.initializeBase(this,[a,b,c]);this.addDisplayMode("Menu");this.$75_1=d};CUI.Controls.ColorPicker.prototype={$75_1:null,createComponentForDisplayModeInternal:function(b){if(this.$Y_0.length>0)throw Error.create("Only one ControlComponent can be created for each ColorPicker Control");var a;a=this.$0_0.$4b_1(this.$6_0+"-"+b+this.$0_0.$2U_1(),b,this);return a},get_$96_0:function(){a:;return "ColorPicker"},$2Y_1:null,$Aj_1:function(k,g){for(var i=null,f=k.ownerDocument,e=0,l=g.length/10,c=0;c<g.length;c++){if(!(c%10)){i=f.createElement("tr");k.appendChild(i);e++}var b=f.createElement("td");b.className="ms-cui-colorpicker-cell";b.setAttribute("arrayPosition",c);if(e===1){b.style.padding="2px";b.style.height="16px"}i.appendChild(b);var a=f.createElement("a");a.href="javascript:";var m=g[c].Title;a.title=m;a.className="ms-cui-colorpicker-cell-a";$addHandler(a,"focus",this.$$d_$A7_1);var d=f.createElement("div"),n=g[c].DisplayColor;d.style.backgroundColor=n;d.className="ms-cui-colorpicker-celldiv";var h=13;if(e===1||e===2){d.style.borderTopWidth="1px";h--}if(e===1||e===l){d.style.borderBottomWidth="1px";h--}if(h!==13)d.style.height=h+"px";var j=f.createElement("div");j.className="ms-cui-colorpicker-cellinternaldiv";$addHandler(a,"mouseover",this.$$d_$A8_1);$addHandler(a,"mouseout",this.$$d_$CV_1);$addHandler(a,"click",this.$$d_$A6_1);b.appendChild(a);a.appendChild(d);d.appendChild(j);b.colorPickerCssClass=g[c];Array.add(this.$2Y_1,b)}},createDOMElementForDisplayMode:function(d){switch(d){case "Menu":var b=this.$0_0.get_element().ownerDocument,a=b.createElement("table");if(this.$0_0._textDirection===1)a.dir="rtl";else a.dir="ltr";a.className="ms-cui-smenu-inner";a.setAttribute("cellSpacing","0");a.setAttribute("cellPadding","0");a.setAttribute("mscui:controltype",this.get_$96_0());this.$2Y_1=[];var c=b.createElement("tbody");this.$Aj_1(c,this.$75_1);a.appendChild(c);CUI.Utility.$2C(a,true,true);return a;default:this.ensureValidDisplayMode(d)}return null},onEnabledChanged:function(){},$A6_1:function(a){a.preventDefault();if(!this.get_enabled())return;var b=a.target,c=CUI.Utility.$8B(b,"td"),d=this.$9i_1(c);this.$7p_1();this.get_displayedComponent().raiseCommandEvent(this.get_$2_1().Command,1,d)},$9i_1:function(c){var b=c.colorPickerCssClass,a=new CUI.Controls.ColorPickerResult;a.Color=b.Color;a.Style=b.Style;return a},$A8_1:function(b){if(!this.get_enabled())return;var a=CUI.Utility.$8B(b.target,"td");this.$8E_1(a,false)},$A7_1:function(b){if(!this.get_enabled())return;var a=CUI.Utility.$8B(b.target,"td");this.$8E_1(a,false)},$CV_1:function(){if(!this.get_enabled())return;this.$6v_1();CUI.Controls.ColorPicker.$9=-10},$2n_1:false,$6u_1:null,$8E_1:function(a,c){var b=parseInt(a.getAttribute("arrayPosition"));if(CUI.Controls.ColorPicker.$9===b)return;CUI.Controls.ColorPicker.$9=b;this.$AS_1(a);this.$Ao_1(a,c)},$Ao_1:function(a,b){this.$6v_1();Sys.UI.DomElement.addCssClass(a,"ms-cui-colorpicker-hoveredOver");this.$6k_1=a;b&&a.firstChild&&a.firstChild.focus()},$6k_1:null,$6v_1:function(){a:;if(this.$6k_1)this.$6k_1.className="ms-cui-colorpicker-cell"},receiveFocus:function(){a:;this.$8b_1(0)},$8b_1:function(a){if(this.$2Y_1&&this.$2Y_1.length>a){var b=this.$2Y_1[a];this.$8E_1(b,true)}},$7p_1:function(){a:;this.$2n_1=false;this.$6u_1=null},$7u_1:function(){a:;this.$2n_1&&!CUI.ScriptUtility.isNullOrEmptyString(this.get_$2_1().CommandRevert)&&this.get_displayedComponent().raiseCommandEvent(this.get_$2_1().CommandRevert,6,this.$6u_1)},$AS_1:function(b){if(!CUI.ScriptUtility.isNullOrEmptyString(this.get_$2_1().CommandPreview)){this.$2n_1=true;var a=this.$9i_1(b);this.$6u_1=a;this.get_displayedComponent().raiseCommandEvent(this.get_$2_1().CommandPreview,5,a)}},get_$2_1:function(){a:;return this.$7_0},onMenuClosed:function(){a:;this.$7u_1()},$6c_0:function(){a:;var a=1,b=window.event;if(!CUI.ScriptUtility.isNullOrUndefined(b)&&b.keyCode===38)a=10;if(CUI.Controls.ColorPicker.$9<0)CUI.Controls.ColorPicker.$9+=this.$2Y_1.length+a;if(CUI.Controls.ColorPicker.$9>=a){this.$8b_1(CUI.Controls.ColorPicker.$9-a);return true}this.$6v_1();CUI.Controls.ColorPicker.$9-=a;return false},$6b_0:function(){a:;var a=1,b=window.event;if(!CUI.ScriptUtility.isNullOrUndefined(b)&&b.keyCode===40)a=10;if(CUI.Controls.ColorPicker.$9+a<0){CUI.Controls.ColorPicker.$9=-1;a=1}if(CUI.Controls.ColorPicker.$9+a<this.$2Y_1.length){this.$8b_1(CUI.Controls.ColorPicker.$9+a);return true}this.$6v_1();CUI.Controls.ColorPicker.$9-=this.$2Y_1.length;return false}};CUI.Controls.ComboBoxCommandProperties=function(){};CUI.Controls.ComboBox=function(b,c,d,e){this.$$d_executeAutoComplete=Function.createDelegate(this,this.executeAutoComplete);this.$$d_onInputKeyDown=Function.createDelegate(this,this.onInputKeyDown);this.$$d_onInputBlur=Function.createDelegate(this,this.onInputBlur);this.$$d_onInputFocus=Function.createDelegate(this,this.onInputFocus);this.$4Q_3=-1;CUI.Controls.ComboBox.initializeBase(this,[b,c,d,e]);if(CUI.ScriptUtility.isNullOrUndefined(this.get_cbProperties().AllowFreeForm))this.$5Z_3=false;else this.$5Z_3=this.get_cbProperties().AllowFreeForm.toLowerCase()==="true";if(CUI.ScriptUtility.isNullOrEmptyString(this.get_cbProperties().AutoComplete))this.get_cbProperties().AutoComplete="true";if(!CUI.ScriptUtility.isNullOrEmptyString(this.get_cbProperties().AutoCompleteDelay))try{this.$5a_3=parseInt(this.get_cbProperties().AutoCompleteDelay)}catch(a){this.$5a_3=100}};CUI.Controls.ComboBox.prototype={$A_3:null,$J_3:null,$K_3:null,$1g_3:null,$1h_3:null,$5Z_3:false,$5a_3:100,createDOMElementForDisplayMode:function(d){switch(d){case "Medium":var b=CUI.ScriptUtility.isNullOrUndefined(this.get_cbProperties().Alt)?"":this.get_cbProperties().Alt,c=CUI.ScriptUtility.isNullOrUndefined(this.get_cbProperties().AltArrow)?b:this.get_cbProperties().AltArrow;this.$A_3=CUI.Utility.$4("span");this.$A_3.className="ms-cui-cb";this.$A_3.setAttribute("mscui:controltype",this.get_$96_0());this.$J_3=CUI.Utility.$7s("input");this.$J_3.setAttribute("name",this.get_cbProperties().Command);this.$J_3.type="text";this.$J_3.style.width=this.get_cbProperties().Width;this.$J_3.className="ms-cui-cb-input";this.$J_3.setAttribute("autocomplete","off");this.$J_3.id=this.get_cbProperties().Id;if(CUI.ScriptUtility.isNullOrUndefined(this.get_properties().ToolTipTitle))this.$J_3.title=b;CUI.Utility.$8e(this.$J_3,this.get_properties().ImeEnabled);var a=this.get_stateProperties()[CUI.Controls.ComboBoxCommandProperties.SelectedItemId];if(CUI.ScriptUtility.isNullOrUndefined(a))a=this.get_cbProperties().InitialItem;!CUI.ScriptUtility.isNullOrUndefined(a)&&this.$2p_2(a);CUI.Utility.$20(this.get_properties(),this.$J_3);this.$K_3=CUI.Utility.$4("a");CUI.Utility.ensureCSSClassOnElement(this.$K_3,"ms-cui-dd-arrow-button");CUI.Utility.$29(this.$K_3);this.$K_3.tabIndex=-1;this.$K_3.setAttribute("aria-haspopup",true);this.$1g_3=CUI.Utility.$4("img");this.$1h_3=CUI.Utility.$m(2,1,this.$0_0.$7_1.ImageDownArrow,this.$0_0.$7_1.ImageDownArrowClass,this.$1g_3,true,false,this.$0_0.$7_1.ImageDownArrowTop,this.$0_0.$7_1.ImageDownArrowLeft);if(CUI.ScriptUtility.isNullOrUndefined(this.get_properties().ToolTipTitle)){this.$1g_3.alt=c;this.$K_3.title=c}this.$Ar_0("Medium");this.$A_3.appendChild(this.$J_3);this.$A_3.appendChild(this.$K_3);this.$K_3.appendChild(this.$1h_3);return this.$A_3;default:this.ensureValidDisplayMode(d);return null}},$Aq_0:function(b){var a=$get(this.$6_0+"-"+b);this.storeElementForDisplayMode(a,b);this.get_stateProperties()[CUI.Controls.DropDownCommandProperties.SelectedItemId]=null;switch(b){case "Medium":this.$A_3=a;this.$J_3=a.childNodes[0];this.$K_3=a.childNodes[1];this.$1h_3=this.$K_3.childNodes[0];this.$1g_3=this.$1h_3.childNodes[0];CUI.Utility.$2C(this.$J_3,false,false)}},$Ar_0:function(a){switch(a){case "Medium":this.$X_3()}},$X_3:function(){a:;$addHandler(this.$J_3,"focus",this.$$d_onInputFocus);$addHandler(this.$J_3,"blur",this.$$d_onInputBlur);$addHandler(this.$J_3,"keydown",this.$$d_onInputKeyDown);$addHandler(this.$J_3,"mouseup",CUI.Utility.get_returnFalseHandler());$addHandler(this.$K_3,"mouseover",this.$$d_onArrowButtonFocus);$addHandler(this.$K_3,"mouseout",this.$$d_onArrowButtonBlur);$addHandler(this.$K_3,"click",this.$$d_onArrowButtonClick);$addHandler(this.$K_3,"focus",this.$$d_onArrowButtonFocus);$addHandler(this.$K_3,"blur",this.$$d_onArrowButtonBlur);$addHandler(this.$K_3,"keypress",this.$$d_onArrowButtonKeyPress)},onEnabledChanged:function(a){if(a){CUI.Utility.enableElement(this.$J_3);this.$J_3.disabled=false;CUI.Utility.enableElement(this.$A_3)}else{CUI.Utility.disableElement(this.$J_3);this.$J_3.disabled=true;CUI.Utility.disableElement(this.$A_3)}CUI.Controls.DropDown.prototype.onEnabledChanged.call(this,a)},get_$96_0:function(){a:;return "ComboBox"},get_$2k_0:function(){a:;return "combobox"},$3g_3:null,get_menuItems:function(){a:;if(CUI.ScriptUtility.isNullOrUndefined(this.$3g_3))this.$3g_3={};return this.$3g_3},set_menuItems:function(a){this.$3g_3=a;return a},getFirstMenuItemThatBeginsWith:function(d){var a=this.$3g_3;for(var b in a){var c={key:b,value:a[b]};if(c.key.toLowerCase().startsWith(d.toLowerCase()))return c}return null},$5F_3:null,onInputKeyDown:function(a){this.clearPendingAutoComplete();var b=this.$J_3.value;this.$g_0();if(a&&a.rawEvent)if(a.rawEvent.keyCode===40&&a.altKey){this.launchMenuInternal();return}if(CUI.ScriptUtility.isNullOrEmptyString(b))return;if(a&&a.rawEvent){var c=a.rawEvent.keyCode;switch(c){case 13:this.clearPendingAutoComplete();a.preventDefault();this.validateAndSave();return;case 27:this.clearPendingAutoComplete();!this.$k_1&&this.resetToPreviousValue();return;case 40:if(a.altKey){this.launchMenuInternal();return}break;case 8:case 127:case 46:this.clearPendingAutoComplete();this.$5F_3=null;return;case 36:case 35:case 33:case 34:case 37:case 39:case 16:case 18:case 17:case 20:return}}if(CUI.Utility.$u(this.get_cbProperties().AutoComplete)){this.clearPendingAutoComplete();this.$4Q_3=window.setTimeout(this.$$d_executeAutoComplete,this.$5a_3)}},executeAutoComplete:function(){a:;this.$4Q_3=-1;var a=this.$J_3.value,b=this.getFirstMenuItemThatBeginsWith(a);if(!b){this.$5F_3=null;return}this.$J_3.value=b.key;if(Sys.Browser.agent===Sys.Browser.InternetExplorer){var c=this.$J_3.createTextRange();c.moveStart("character",a.length);c.moveEnd("character",this.$J_3.value.length);c.select()}else this.$J_3.setSelectionRange(a.length,this.$J_3.value.length);this.$5F_3=b.value},clearPendingAutoComplete:function(){a:;this.$4Q_3!==-1&&window.clearTimeout(this.$4Q_3);this.$4Q_3=-1},$8c_0:function(){a:;if(!this.get_enabled())return false;if(!CUI.ScriptUtility.isNullOrUndefined(this.$J_3)){this.$J_3.focus();return true}return false},onInputFocus:function(a){this.$0_0.set_$q_1(this);this.onArrowButtonFocus(a);CUI.Utility.$u(this.get_cbProperties().PopulateDynamically)&&this.pollForDynamicMenu(false);CUI.Utility.$8V(this.$J_3);!CUI.ScriptUtility.isNullOrUndefined(this.$D_1)&&this.$D_1.$2A_0()},onInputBlur:function(a){this.clearPendingAutoComplete();this.onArrowButtonBlur(a)},get_$6l_3:function(){a:;return this.get_stateProperties()[CUI.Controls.ComboBoxCommandProperties.IsFreeForm]},set_$6l_3:function(a){this.get_stateProperties()[CUI.Controls.ComboBoxCommandProperties.IsFreeForm]=a;return a},validateAndSave:function(){a:;if(!this.$2p_2(this.$5F_3)){var b=this.get_displayedComponent();if(!CUI.Utility.$u(this.get_cbProperties().AutoComplete)){var a=this.$3g_3[this.$J_3.value];if(!CUI.ScriptUtility.isNullOrEmptyString(a)&&this.$2p_2(a)){this.set_$6l_3(false);b.raiseCommandEvent(this.get_cbProperties().Command,3,{IsFreeForm:false,CommandValueId:this._selectedControl.getCommandValueId(),MenuItemId:a});return}}if(this.$5Z_3){this.set_$6l_3(true);this.get_stateProperties()[CUI.Controls.ComboBoxCommandProperties.Value]=this.$J_3.value;b.raiseCommandEvent(this.get_cbProperties().Command,3,{IsFreeForm:true,Value:this.$J_3.value})}else{this.resetToPreviousValue();return}}else{this.set_$6l_3(false);this.get_displayedComponent().raiseCommandEvent(this.get_cbProperties().Command,3,{IsFreeForm:false,CommandValueId:this._selectedControl.getCommandValueId(),MenuItemId:this._selectedControl.getMenuItemId()})}},resetToPreviousValue:function(){a:;if(!CUI.ScriptUtility.isNullOrUndefined(this._selectedControl))this.$J_3.value=this._selectedControl.getTextValue();else this.$J_3.value=""},selectMenuItem:function(a){if(this._selectedControl===a)return;this._selectedControl=a;this.get_stateProperties()[CUI.Controls.ComboBoxCommandProperties.SelectedItemId]=a.getMenuItemId();var b=a;this.$J_3.value=b.getTextValue()},$AK_0:function(){a:;var a=this.get_stateProperties()[CUI.Controls.ComboBoxCommandProperties.SelectedItemId];if(CUI.ScriptUtility.isNullOrUndefined(a))this.get_stateProperties()[CUI.Controls.ComboBoxCommandProperties.SelectedItemId]=this.get_cbProperties().InitialItem;var c=this.pollForStateAndUpdateInternal(this.get_cbProperties().Command,this.get_cbProperties().QueryCommand,this.get_stateProperties(),false),b=this.get_stateProperties()[CUI.Controls.ComboBoxCommandProperties.SelectedItemId];if((c&2)>0)if(this.get_$6l_3()){this.$J_3.value=this.get_stateProperties()[CUI.Controls.ComboBoxCommandProperties.Value];this.get_stateProperties()[CUI.Controls.ComboBoxCommandProperties.SelectedItemId]=null}else if(!CUI.ScriptUtility.isNullOrUndefined(a)){if(a!==b||!this._itemEverSelected)if(!this.$2p_2(b))throw Error.create("The menu item id requested via polling does not exist")}else if(!CUI.ScriptUtility.isNullOrUndefined(this.get_stateProperties()[CUI.Controls.ComboBoxCommandProperties.Value]))this.$J_3.value=this.get_stateProperties()[CUI.Controls.ComboBoxCommandProperties.Value]},onDynamicMenuPopulated:function(){a:;var f=null,a=null,g=null,h=null,b=null,c=null;if(CUI.ScriptUtility.isNullOrUndefined(this.$D_1))return;var d=this.$D_1.$8_0.getEnumerator();while(d.moveNext()){var j=d.get_current(),e=j.$8_0.getEnumerator();while(e.moveNext()){var i=e.get_current();if(CUI.MenuItem.isInstanceOfType(i)){f=i;a=f.$N_1;if(CUI.ISelectableControl.isInstanceOfType(a)){g=a;b=g.getMenuItemId()}if(CUI.IMenuItem.isInstanceOfType(a)){h=a;c=h.getTextValue()}if(!(CUI.ScriptUtility.isNullOrUndefined(b)||CUI.ScriptUtility.isNullOrUndefined(c))){this.get_menuItems()[c]=b;c=null;b=null}}}}},launchMenuInternal:function(){a:;this.launchMenu(this.$J_3,this.$$d_sendMenuCreationCommandEvent)&&this.sendMenuCreationCommandEvent()},dispose:function(){a:;CUI.Controls.DropDown.prototype.dispose.call(this);this.$A_3=null;this.$1g_3=null;this.$1h_3=null;this.$K_3=null;this.$J_3=null},get_cbProperties:function(){a:;return this.$7_0}};CUI.Controls.DropDownCommandProperties=function(){};CUI.Controls.DropDown=function(a,b,c,d){this.$$d_onArrowButtonKeyboardFocus=Function.createDelegate(this,this.onArrowButtonKeyboardFocus);this.$$d_sendMenuCreationCommandEvent=Function.createDelegate(this,this.sendMenuCreationCommandEvent);this.$$d_onArrowButtonKeyPress=Function.createDelegate(this,this.onArrowButtonKeyPress);this.$$d_onArrowButtonClick=Function.createDelegate(this,this.onArrowButtonClick);this.$$d_onArrowButtonBlur=Function.createDelegate(this,this.onArrowButtonBlur);this.$$d_onArrowButtonFocus=Function.createDelegate(this,this.onArrowButtonFocus);CUI.Controls.DropDown.initializeBase(this,[a,b,c,d]);this.addDisplayModes();this.get_stateProperties()[CUI.Controls.DropDownCommandProperties.SelectedItemId]=null;this.get_stateProperties()[CUI.Controls.DropDownCommandProperties.Value]=null};CUI.Controls.DropDown.prototype={$A_2:null,$b_2:null,$K_2:null,$1g_2:null,$1h_2:null,$8c_0:function(){a:;if(!this.get_enabled())return false;this.$K_2.focus();return true},createDOMElementForDisplayMode:function(f){var c=CUI.ScriptUtility.isNullOrUndefined(this.get_properties().Alt)?"":this.get_properties().Alt,a=CUI.ScriptUtility.isNullOrUndefined(this.get_properties().AltArrow)?c:this.get_properties().AltArrow,d=true;if(CUI.ScriptUtility.isNullOrEmptyString(a)&&!CUI.ScriptUtility.isNullOrUndefined(this.get_properties().ToolTipTitle))a=this.get_properties().ToolTipTitle;var e=null;switch(f){case "Text":case "Medium":this.$A_2=CUI.Utility.$4("span");this.$A_2.className="ms-cui-dd";this.$A_2.setAttribute("mscui:controltype",this.get_$96_0());this.$b_2=CUI.Utility.$4("span");this.$b_2.className="ms-cui-dd-text";this.$b_2.style.width=this.get_properties().Width;var b=this.get_stateProperties()[CUI.Controls.DropDownCommandProperties.SelectedItemId];if(CUI.ScriptUtility.isNullOrUndefined(b))b=this.get_properties().InitialItem;!CUI.ScriptUtility.isNullOrUndefined(b)&&this.$2p_2(b);this.$K_2=CUI.Utility.$4("a");this.$K_2.setAttribute("role",this.get_$2k_0());this.$K_2.setAttribute("aria-haspopup",true);CUI.Utility.ensureCSSClassOnElement(this.$K_2,"ms-cui-dd-arrow-button");CUI.Utility.$20(this.get_properties(),this.$K_2);CUI.Utility.$29(this.$K_2);this.$K_2.id=this.$6_0;this.$1g_2=CUI.Utility.$4("img");this.$1h_2=CUI.Utility.$m(2,1,this.$0_0.$7_1.ImageDownArrow,this.$0_0.$7_1.ImageDownArrowClass,this.$1g_2,true,false,this.$0_0.$7_1.ImageDownArrowTop,this.$0_0.$7_1.ImageDownArrowLeft);if(CUI.ScriptUtility.isNullOrUndefined(this.get_properties().ToolTipTitle)){this.$K_2.setAttribute("title",a);this.$b_2.title=c;this.$1g_2.alt=a;d=false}this.$Ar_0("Medium");this.$A_2.appendChild(this.$b_2);this.$A_2.appendChild(this.$K_2);this.$K_2.appendChild(this.$1h_2);if(d){e=CUI.Utility.$2S(a);this.$K_2.appendChild(e)}return this.$A_2;default:this.ensureValidDisplayMode(f);return null}},$Aq_0:function(b){var a=$get(this.$6_0+"-"+b);this.storeElementForDisplayMode(a,b);switch(b){case "Text":case "Medium":this.$A_2=a;this.$b_2=a.childNodes[0];this.$K_2=a.childNodes[1];this.$1h_2=this.$K_2.childNodes[0];this.$1g_2=this.$1h_2.childNodes[0]}},$Ar_0:function(a){switch(a){case "Text":case "Medium":this.$X_2()}},$X_2:function(){a:;$addHandler(this.$A_2,"click",this.$$d_onArrowButtonClick);$addHandler(this.$A_2,"keypress",this.$$d_onArrowButtonKeyPress);$addHandler(this.$K_2,"mouseover",this.$$d_onArrowButtonFocus);$addHandler(this.$K_2,"mouseout",this.$$d_onArrowButtonBlur);$addHandler(this.$K_2,"focus",this.$$d_onArrowButtonKeyboardFocus);$addHandler(this.$K_2,"blur",this.$$d_onArrowButtonBlur)},onEnabledChanged:function(a){if(a)CUI.Utility.enableElement(this.$A_2);else CUI.Utility.disableElement(this.$A_2)},get_$96_0:function(){a:;return "DropDown"},$3J_0:function(a){if(a.$I_1===3){var d=a.$3A_1;if(!CUI.ISelectableControl.isInstanceOfType(d.$N_1))return CUI.MenuLauncher.prototype.$3J_0.call(this,a);var e=d.$N_1;!CUI.ScriptUtility.isNullOrUndefined(this._selectedControl)&&this._selectedControl.deselect();this.selectMenuItem(e)}if(a.$I_1===3||a.$I_1===7||a.$I_1===8){var b,c;switch(a.$I_1){case 3:b=this.get_properties().Command;c=1;break;case 7:b=this.get_properties().CommandPreview;c=5;break;case 8:b=this.get_properties().CommandRevert;c=6;break;default:b=this.get_properties().Command;c=1}this.get_displayedComponent().raiseCommandEvent(b,c,a.$37_1);CUI.MenuLauncher.prototype.$3J_0.call(this,a);return false}return CUI.MenuLauncher.prototype.$3J_0.call(this,a)},selectMenuItem:function(c){if(this._selectedControl===c)return;this._selectedControl=c;this.get_stateProperties()[CUI.Controls.DropDownCommandProperties.SelectedItemId]=c.getMenuItemId();var b;if(CUI.ScriptUtility.isNullOrUndefined(this.get_properties().SelectedItemDisplayMode))b="Text";else b=this.get_properties().SelectedItemDisplayMode;var a;if(b==="Text"){var d=c.getTextValue();a=CUI.Utility.$4("a");CUI.UIUtility.setInnerText(a,d)}else a=this._selectedControl.getDropDownDOMElementForDisplayMode(b);if(this.$b_2.hasChildNodes()){var e=this.$b_2.firstChild;this.$b_2.replaceChild(a,e)}else this.$b_2.appendChild(a)},_itemEverSelected:false,$2p_2:function(b){if(CUI.ScriptUtility.isNullOrUndefined(b)||CUI.ScriptUtility.isNullOrUndefined(this.$D_1))return false;var a=this.$D_1.$9l_1(b);if(CUI.ScriptUtility.isNullOrUndefined(a))return false;this.selectMenuItem(a);this._itemEverSelected=true;return true},addDisplayModes:function(){a:;this.addDisplayMode("Medium");this.addDisplayMode("Text")},onArrowButtonClick:function(b){var a=this.get_enabled();a&&CUI.PMetrics.perfMark(7192);this.$g_0();b.preventDefault();if(!a)return;this.$0_0.set_$q_1(this);this.launchMenuInternal(b);CUI.PMetrics.perfMark(7193)},launchMenuInternal:function(){this.launchMenu(this.$K_2,this.$$d_sendMenuCreationCommandEvent)&&this.sendMenuCreationCommandEvent()},sendMenuCreationCommandEvent:function(){a:;this.get_displayedComponent().raiseCommandEvent(this.get_properties().CommandMenuOpen,4,null)},onBeginFocus:function(){a:;var a=this.get_stateProperties()[CUI.Controls.DropDownCommandProperties.Value];if(CUI.ScriptUtility.isNullOrUndefined(a)){var b=this.get_stateProperties()[CUI.Controls.DropDownCommandProperties.SelectedItemId];if(CUI.ScriptUtility.isNullOrUndefined(b))b=this.get_properties().InitialItem;if(!CUI.ScriptUtility.isNullOrUndefined(b)&&!CUI.ScriptUtility.isNullOrUndefined(this.$D_1)){var c=this.$D_1.$9l_1(b);if(!CUI.ScriptUtility.isNullOrUndefined(c))a=c.getTextValue()}}if(!CUI.ScriptUtility.isNullOrUndefined(a))this.get_properties().ToolTipSelectedItemTitle=a;CUI.Control.prototype.onBeginFocus.call(this)},onArrowButtonKeyboardFocus:function(a){this.$0_0.set_$q_1(this);this.onArrowButtonFocus(a)},onArrowButtonFocus:function(){this.onBeginFocus();if(!this.get_enabled())return;this.highlight()},onArrowButtonBlur:function(){this.onEndFocus();if(!this.get_enabled()||this.$k_1)return;this.removeHighlight()},onArrowButtonKeyPress:function(b){this.$g_0();if(!this.get_enabled())return;var a=b.rawEvent.keyCode;if(a===13||a===32||a===40){this.$16_1=true;this.launchMenuInternal(b)}},highlight:function(){a:;CUI.Utility.ensureCSSClassOnElement(this.$K_2,"ms-cui-ctl-light-hoveredOver")},removeHighlight:function(){a:;CUI.Utility.removeCSSClassFromElement(this.$K_2,"ms-cui-ctl-light-hoveredOver")},onLaunchedMenuClosed:function(){a:;this.$g_0();this.removeHighlight();this.get_displayedComponent().raiseCommandEvent(this.get_properties().CommandMenuClose,10,null);CUI.MenuLauncher.prototype.onLaunchedMenuClosed.call(this)},$AK_0:function(){a:;var b=this.get_stateProperties()[CUI.Controls.DropDownCommandProperties.SelectedItemId];if(CUI.ScriptUtility.isNullOrUndefined(b))this.get_stateProperties()[CUI.Controls.DropDownCommandProperties.SelectedItemId]=this.get_properties().InitialItem;this.pollForStateAndUpdateInternal(this.get_properties().Command,this.get_properties().QueryCommand,this.get_stateProperties(),false);var a=this.get_stateProperties()[CUI.Controls.DropDownCommandProperties.SelectedItemId];if(!CUI.ScriptUtility.isNullOrUndefined(a)){if(b!==a||!this._itemEverSelected)if(!this.$2p_2(a))throw Error.create("The menu item id requested via polling does not exist")}else if(!CUI.ScriptUtility.isNullOrUndefined(this.get_stateProperties()[CUI.Controls.DropDownCommandProperties.Value])){var c=this.get_stateProperties()[CUI.Controls.DropDownCommandProperties.Value];this.$b_2.innerHTML="<a>"+CUI.Utility.$3u(c)+"</a>"}},dispose:function(){a:;CUI.MenuLauncher.prototype.dispose.call(this);this.$A_2=null;this.$1g_2=null;this.$1h_2=null;this.$K_2=null;this.$b_2=null},get_properties:function(){a:;return this.$7_0}};CUI.Controls.FlyoutAnchorCommandProperties=function(){};CUI.Controls.FlyoutAnchor=function(a,b,c,d){this.$$d_$Ch_2=Function.createDelegate(this,this.$Ch_2);this.$$d_$Cg_2=Function.createDelegate(this,this.$Cg_2);this.$$d_$Ci_2=Function.createDelegate(this,this.$Ci_2);this.$$d_$3E_2=Function.createDelegate(this,this.$3E_2);this.$$d_$6r_2=Function.createDelegate(this,this.$6r_2);this.$$d_$6s_2=Function.createDelegate(this,this.$6s_2);this.$$d_$4h_2=Function.createDelegate(this,this.$4h_2);this.$$d_$Cr_2=Function.createDelegate(this,this.$Cr_2);this.$$d_$Cq_2=Function.createDelegate(this,this.$Cq_2);this.$$d_$Cy_2=Function.createDelegate(this,this.$Cy_2);this.$$d_$AB_2=Function.createDelegate(this,this.$AB_2);this.$$d_$5T_2=Function.createDelegate(this,this.$5T_2);this.$$d_onClick=Function.createDelegate(this,this.onClick);CUI.Controls.FlyoutAnchor.initializeBase(this,[a,b,c,d]);this.addDisplayMode("Menu");this.addDisplayMode("Menu16");this.addDisplayMode("Menu32");this.addDisplayMode("Small");this.addDisplayMode("Medium");this.addDisplayMode("Large");this.addDisplayMode("Thin");this.$1Z_2=this.get_$2_2().LabelText;this.get_stateProperties()["LabelText"]=this.$1Z_2};CUI.Controls.FlyoutAnchor.prototype={$57_2:null,$58_2:null,$3X_2:null,$4A_2:null,$5t_2:null,$4B_2:null,$5u_2:null,$h_2:null,$S_2:null,$c_2:null,$G_2:null,$7A_2:null,$2b_2:null,$22_2:null,$A_2:null,$7B_2:null,$2c_2:null,$o_2:null,$B_2:null,$7C_2:null,$2d_2:null,$1M_2:null,$3a_2:null,$4E_2:null,$1Z_2:null,createDOMElementForDisplayMode:function(b){var c,a=CUI.ScriptUtility.isNullOrUndefined(this.get_$2_2().Alt)?this.get_$2_2().LabelText:this.get_$2_2().Alt;switch(b){case "Menu":this.$h_2=this.createMenuDOMElement("Menu","ms-cui-textmenuitem ms-cui-fa-menuitem ms-cui-ctl-menu",a,null,null,null,null);this.$Ar_0(b);this.$h_2.setAttribute("aria-haspopup",true);return this.$h_2;case "Menu16":this.$S_2=this.createMenuDOMElement("Menu16","ms-cui-fa-menuitem ms-cui-ctl-menu",a,this.get_$2_2().Image16by16,this.get_$2_2().Image16by16Class,this.get_$2_2().Image16by16Top,this.get_$2_2().Image16by16Left);this.$Ar_0(b);this.$S_2.setAttribute("aria-haspopup",true);return this.$S_2;case "Menu32":this.$c_2=this.createMenuDOMElement("Menu32","ms-cui-fa-menuitem ms-cui-ctl-menu",a,this.get_$2_2().Image32by32,this.get_$2_2().Image32by32Class,this.get_$2_2().Image32by32Top,this.get_$2_2().Image32by32Left);this.$c_2.setAttribute("aria-haspopup",true);this.$Ar_0(b);return this.$c_2;case "Large":var e,f,g;this.$G_2=(g=CUI.Control.createStandardControlDOMElement_OutParameters(this,this.$0_0,"Large",this.get_$2_2(),false,true,e={val:this.$22_2},f={val:c}),this.$22_2=e.val,c=f.val,g);this.$G_2.setAttribute("aria-haspopup",true);this.$5z_2&&CUI.Utility.ensureCSSClassOnElement(this.$G_2,"ms-cui-ctl-large-groupPopup");this.$Ar_0("Large");return this.$G_2;case "Medium":var h,i,j;this.$A_2=(j=CUI.Control.createStandardControlDOMElement_OutParameters(this,this.$0_0,"Medium",this.get_$2_2(),false,true,h={val:this.$o_2},i={val:c}),this.$o_2=h.val,c=i.val,j);this.$Ar_0("Medium");this.$A_2.setAttribute("aria-haspopup",true);return this.$A_2;case "Small":this.$B_2=CUI.Control.createStandardControlDOMElement(this,this.$0_0,"Small",this.get_$2_2(),false,true);this.$Ar_0("Small");this.$B_2.setAttribute("aria-haspopup",true);return this.$B_2;case "Thin":this.$1M_2=CUI.Utility.$5O();this.$1M_2.className="ms-cui-ctl-thin";this.$3a_2=CUI.Utility.$4("img");this.$3a_2.alt="";if(CUI.ScriptUtility.isNullOrEmptyString(this.get_$2_2().ToolTipTitle)){this.$1M_2.title=a;this.$3a_2.alt=a}var d=this.$0_0;this.$4E_2=CUI.Utility.$m(2,1,d.$7_1.ImageDownArrow,d.$7_1.ImageDownArrowClass,this.$3a_2,true,false,d.$7_1.ImageDownArrowTop,d.$7_1.ImageDownArrowLeft);this.$1M_2.appendChild(this.$4E_2);this.$1M_2.appendChild(CUI.Utility.$2S(a));this.$Ar_0("Thin");this.$1M_2.setAttribute("aria-haspopup",true);return this.$1M_2;default:this.ensureValidDisplayMode(b)}return null},$Aq_0:function(b){var a=$get(this.$6_0+"-"+b);!CUI.ScriptUtility.isNullOrUndefined(a)&&this.storeElementForDisplayMode(a,b);switch(b){case "Large":if(!CUI.ScriptUtility.isNullOrUndefined(a))this.$G_2=a;this.$7A_2=this.$G_2.childNodes[0].childNodes[0];this.$2b_2=this.$G_2.lastChild.lastChild.childNodes[0];break;case "Medium":if(!CUI.ScriptUtility.isNullOrUndefined(a))this.$A_2=a;this.$7B_2=this.$A_2.childNodes[0].childNodes[0];this.$2c_2=this.$A_2.lastChild.lastChild.childNodes[0];break;case "Small":if(!CUI.ScriptUtility.isNullOrUndefined(a))this.$B_2=a;this.$7C_2=this.$B_2.childNodes[0].childNodes[0];this.$2d_2=this.$B_2.childNodes[1].lastChild.childNodes[0];break;case "Thin":this.$1M_2=a;this.$4E_2=a.firstChild;this.$3a_2=this.$4E_2.firstChild}},get_$96_0:function(){a:;return "FlyoutAnchor"},$AK_0:function(){a:;if(!CUI.ScriptUtility.isNullOrUndefined(this.$7_0.Command)){var b=this.pollForStateAndUpdateInternal(this.get_$2_2().Command,this.get_$2_2().QueryCommand,this.get_stateProperties(),true);if((b&2)>0){var a=this.get_stateProperties()[CUI.Controls.FlyoutAnchorCommandProperties.LabelText];if(CUI.ScriptUtility.isNullOrUndefined(a)){a=this.get_$2_2().LabelText;this.get_stateProperties()[CUI.Controls.FlyoutAnchorCommandProperties.LabelText]=this.get_$2_2().LabelText}if(this.$1Z_2!==a){!CUI.ScriptUtility.isNullOrUndefined(this.$o_2)&&this.$Dg_2(this.$o_2,a);if(!CUI.ScriptUtility.isNullOrUndefined(this.$22_2));this.$0_0.$2D_1=true}this.$1Z_2=a}}},$Dg_2:function(a,b){a.firstChild.nodeValue=b+" "},createMenuDOMElement:function(d,j,e,f,g,h,i){var a=CUI.Utility.$5O();a.setAttribute("role",this.get_$2k_0());a.className=j;a.setAttribute("mscui:controltype",this.get_$96_0());CUI.Utility.$20(this.get_$2_2(),a);var b=null;switch(d){case "Menu16":if(CUI.ScriptUtility.isNullOrUndefined(this.$4A_2)){this.$4A_2=CUI.Utility.$4("img");this.$5t_2=CUI.Utility.$m(2,3,f,g,this.$4A_2,true,true,h,i);this.$4A_2.alt=e;b=this.$5t_2}break;case "Menu32":if(CUI.ScriptUtility.isNullOrUndefined(this.$4B_2)){this.$4B_2=CUI.Utility.$4("img");this.$5u_2=CUI.Utility.$m(2,4,f,g,this.$4B_2,true,true,h,i);this.$4B_2.alt=e;b=this.$5u_2}}this.createMenuLabelDOMElementIfNeeded(d);if(CUI.ScriptUtility.isNullOrUndefined(this.$57_2)){this.$57_2=CUI.Utility.$4("img");this.$58_2=CUI.Utility.$m(2,2,this.$0_0.$7_1.ImageSideArrow,this.$0_0.$7_1.ImageSideArrowClass,this.$57_2,false,true,this.$0_0.$7_1.ImageSideArrowTop,this.$0_0.$7_1.ImageSideArrowLeft);CUI.Utility.ensureCSSClassOnElement(this.$58_2,"ms-cui-fa-menu-arrow")}if(b){var c=CUI.Utility.$4("span");c.className="ms-cui-ctl-iconContainer";c.appendChild(b);a.appendChild(c)}a.appendChild(this.$3X_2);a.appendChild(this.$58_2);return a},createMenuLabelDOMElementIfNeeded:function(){if(CUI.ScriptUtility.isNullOrUndefined(this.$3X_2)){this.$3X_2=CUI.Utility.$4("span");this.$3X_2.className="ms-cui-ctl-mediumlabel";CUI.UIUtility.setInnerText(this.$3X_2,this.get_$2_2().LabelText)}},$Ar_0:function(c){var b=this.getDisplayedDOMElement(c);if(CUI.ScriptUtility.isNullOrUndefined(b))return;var d={click:this.$$d_onClick,blur:this.$$d_$5T_2,keypress:this.$$d_$AB_2,focus:this.$$d_$Cy_2},a;if(Sys.Browser.agent===Sys.Browser.InternetExplorer)if(c.startsWith("Menu"))a={mouseenter:this.$$d_$Cq_2,mouseleave:this.$$d_$Cr_2};else a={mouseenter:this.$$d_$4h_2,mouseleave:this.$$d_$5T_2};else if(c.startsWith("Menu"))a={mouseover:this.$$d_$6s_2,mouseout:this.$$d_$6r_2};else a={mouseover:this.$$d_$4h_2,mouseout:this.$$d_$5T_2};$addHandlers(b,d);$addHandlers(b,a)},onEnabledChanged:function(a){CUI.Utility.setEnabledOnElement(this.$h_2,a);CUI.Utility.setEnabledOnElement(this.$S_2,a);CUI.Utility.setEnabledOnElement(this.$c_2,a);CUI.Utility.setEnabledOnElement(this.$G_2,a);CUI.Utility.setEnabledOnElement(this.$A_2,a);CUI.Utility.setEnabledOnElement(this.$B_2,a);CUI.Utility.setEnabledOnElement(this.$1M_2,a)},get_menuDirection:function(){a:;return this.get_displayedComponent().get_displayMode().startsWith("Menu")?1:2},createComponentForDisplayModeInternal:function(a){var b;if(a.startsWith("Menu"))b=this.$0_0.$4b_1(this.$6_0+"-"+a+this.$0_0.$2U_1(),a,this);else b=CUI.Control.prototype.createComponentForDisplayModeInternal.call(this,a);return b},getDisplayedDOMElement:function(a){switch(a){case "Menu":return this.$h_2;case "Menu16":return this.$S_2;case "Menu32":return this.$c_2;case "Large":return this.$G_2;case "Medium":return this.$A_2;case "Small":return this.$B_2;case "Thin":return this.$1M_2;default:this.ensureValidDisplayMode(a);return null}},onClick:function(d){var a=this.get_enabled();a&&!this.$k_1&&CUI.PMetrics.perfMark(7190);this.$g_0();d.preventDefault();if(!a||this.$k_1)return;this.$0_0.set_$4f_1(this);var b=this.get_displayedComponent(),c=b.get_$3_0();this.$6o_2(c);!CUI.ScriptUtility.isNullOrUndefined(this.get_$2_2().Command)&&b.raiseCommandEvent(this.get_$2_2().Command,4,null);CUI.PMetrics.perfMark(7191)},$4h_2:function(){this.onBeginFocus();if(!this.get_enabled())return},$Cq_2:function(){this.onBeginFocus();if(!this.get_enabled()||this.$k_1)return;var a=this.get_displayedComponent(),c=a.get_$3_0();this.$6o_2(c);var b=this.get_$2_2().Command;!CUI.ScriptUtility.isNullOrUndefined(b)&&a.raiseCommandEvent(b,4,null)},$6s_2:function(e){this.onBeginFocus();if(!this.get_enabled()||this.$k_1)return;var a=e.target,b=e.rawEvent.relatedTarget;if(!(a===this.$h_2||a===this.$S_2||a===this.$c_2))return;while(b!==a){try{if(b.nodeName.toLowerCase()==="body")break}catch(f){break}b=b.parentNode}if(b===a)return;var c=this.get_displayedComponent(),g=c.get_$3_0();this.$6o_2(g);var d=this.get_$2_2().Command;!CUI.ScriptUtility.isNullOrUndefined(d)&&c.raiseCommandEvent(d,4,null)},$Ci_2:function(){var b=Array.indexOf(this.$0_0.$e_1,this),a=this.$0_0.$38_1;if(a!==-1&&b>=this.$0_0.$4R_1){window.clearTimeout(a);this.$0_0.$38_1=-1;this.$0_0.$4R_1=-1}},$Cy_2:function(){this.onBeginFocus();this.get_displayedComponent().get_displayMode().startsWith("Menu")&&this.$3t_2(this.get_enabled());this.get_enabled()&&this.$0_0.set_$q_1(this)},$5T_2:function(){this.onEndFocus();if(this.$k_1)return;this.$1d_2()},$Cr_2:function(c){this.onEndFocus();if(!this.get_enabled())return;if(this.$k_1){for(var b=Array.indexOf(this.$0_0.$e_1,this),a=b;a<this.$0_0.$e_1.length;a++)if(CUI.Utility.isDescendantOf(this.$0_0.$e_1[a].$D_1.get_$3_0(),c.rawEvent.toElement))return;this.$71_2()}},$Cg_2:function(b){this.onEndFocus();if(CUI.Utility.isDescendantOf(this.get_displayedComponent().get_$3_0(),b.rawEvent.toElement))return;if(this.$k_1){for(var c=Array.indexOf(this.$0_0.$e_1,this),a=c;a<this.$0_0.$e_1.length;a++)if(CUI.Utility.isDescendantOf(this.$0_0.$e_1[a].$D_1.get_$3_0(),b.rawEvent.toElement))return;this.$71_2()}},$6r_2:function(b){this.onEndFocus();if(!this.get_enabled()||CUI.ScriptUtility.isNullOrUndefined(this.get_displayedComponent())||CUI.Utility.isDescendantOf(this.get_displayedComponent().get_$3_0(),b.rawEvent.relatedTarget))return;if(this.$k_1){for(var c=Array.indexOf(this.$0_0.$e_1,this),a=c;a<this.$0_0.$e_1.length;a++)if(CUI.Utility.isDescendantOf(this.$0_0.$e_1[a].$D_1.get_$3_0(),b.rawEvent.relatedTarget))return;this.$71_2()}},$Ch_2:function(b){this.onEndFocus();if(CUI.Utility.isDescendantOf(this.get_displayedComponent().get_$3_0(),b.rawEvent.relatedTarget))return;if(this.$k_1){for(var c=Array.indexOf(this.$0_0.$e_1,this),a=c;a<this.$0_0.$e_1.length;a++)if(CUI.Utility.isDescendantOf(this.$0_0.$e_1[a].$D_1.get_$3_0(),b.rawEvent.relatedTarget))return;this.$71_2()}this.$1d_2()},$AB_2:function(b){this.$g_0();if(!this.get_enabled())return;var a=b.rawEvent.keyCode;if(this.$k_1)(!this.$0_0._textDirection&&a===39||this.$0_0._textDirection===1&&a===37)&&this.$D_1.$80_0();else if(a===13||a===32||(!this.$0_0._textDirection&&a===39||this.$0_0._textDirection===1&&a===37)&&(!b.ctrlKey||!b.shiftKey)){this.$16_1=true;var c=this.get_displayedComponent(),e=c.get_$3_0(),d=this.get_$2_2().Command;!CUI.ScriptUtility.isNullOrUndefined(d)&&c.raiseCommandEvent(d,4,null);this.$6o_2(e)}},$5w_2:false,onModalKeyPress:function(a){if(a)if(a.rawEvent){var b=a.rawEvent;if((!this.$0_0._textDirection&&b.keyCode===37||this.$0_0._textDirection===1&&b.keyCode===39)&&this.get_displayedComponent().get_displayMode().startsWith("Menu")||b.keyCode===27){this.$0_0.$3E_1(this);return}}if(this.$5z_2){if(this.$5w_2)return;if(this.$D_1.$8d_0())this.$5w_2=true;a.preventDefault()}else CUI.MenuLauncher.prototype.onModalKeyPress.call(this,a)},onModalBodyClick:function(){this.$0_0.$4a_1()},onLaunchedMenuClosed:function(){a:;var b=this.$0_0.$38_1;b!==-1&&window.clearTimeout(b);this.$0_0.$38_1=-1;this.$0_0.$4R_1=-1;this.$1d_2();this.$g_0();var a=this.get_displayedComponent();if(a.get_displayMode().startsWith("Menu")){var c=a.$M_0.$M_0;c.set_$AJ_1(null)}a.raiseCommandEvent(this.get_$2_2().CommandMenuClose,10,null);CUI.MenuLauncher.prototype.onLaunchedMenuClosed.call(this)},$71_2:function(){a:;var a=this.$0_0.$38_1;a!==-1&&window.clearTimeout(a);if(null===this.$5d_2)this.$5d_2=this.$$d_$3E_2;this.$0_0.$4R_1=Array.indexOf(this.$0_0.$e_1,this);this.$0_0.$38_1=window.setTimeout(this.$5d_2,500)},$5d_2:null,$3E_2:function(){a:;this.$0_0.$3E_1(this);this.$0_0.$38_1=-1;this.$0_0.$4R_1=-1},get_launcherComponent:function(){a:;var a=this.get_displayedComponent();if(!CUI.ScriptUtility.isNullOrUndefined(a)&&a.get_displayMode()==="Thin"){while(a&&!CUI.Group.isInstanceOfType(a))a=a.$M_0;if(!a)a=this.get_displayedComponent()}return a},$6B_2:null,$69_2:null,$6A_2:null,$6o_2:function(d){this.$g_0();this.$3t_2(true);this.$0_0.$34_1=false;this.$5w_2=false;var a=this.get_displayedComponent(),b=a.get_displayMode().startsWith("Menu");if(b){var c=a.$M_0.$M_0;c.set_$AJ_1(this)}this.launchMenu(d);if(!b)return;if(null===this.$6B_2)this.$6B_2=this.$$d_$Ci_2;$addHandler(this.$D_1.get_$3_0(),"mouseover",this.$6B_2);if(Sys.Browser.agent===Sys.Browser.InternetExplorer){if(null===this.$69_2)this.$69_2=this.$$d_$Cg_2;$addHandler(this.$D_1.get_$3_0(),"mouseleave",this.$69_2)}else{if(null===this.$6A_2)this.$6A_2=this.$$d_$Ch_2;$addHandler(this.$D_1.get_$3_0(),"mouseout",this.$6A_2)}},$1d_2:function(){a:;var b="ms-cui-ctl-disabledHoveredOver",a="ms-cui-ctl-hoveredOver";CUI.Utility.removeCSSClassFromElement(this.$h_2,a);CUI.Utility.removeCSSClassFromElement(this.$S_2,a);CUI.Utility.removeCSSClassFromElement(this.$c_2,a);CUI.Utility.removeCSSClassFromElement(this.$G_2,a);CUI.Utility.removeCSSClassFromElement(this.$A_2,a);CUI.Utility.removeCSSClassFromElement(this.$B_2,a);CUI.Utility.removeCSSClassFromElement(this.$1M_2,a);CUI.Utility.removeCSSClassFromElement(this.$h_2,b);CUI.Utility.removeCSSClassFromElement(this.$S_2,b);CUI.Utility.removeCSSClassFromElement(this.$c_2,b)},$3t_2:function(b){var a="ms-cui-ctl-hoveredOver";if(!b){a="ms-cui-ctl-disabledHoveredOver";CUI.Utility.ensureCSSClassOnElement(this.$h_2,a);CUI.Utility.ensureCSSClassOnElement(this.$S_2,a);CUI.Utility.ensureCSSClassOnElement(this.$c_2,a)}else{CUI.Utility.ensureCSSClassOnElement(this.$h_2,a);CUI.Utility.ensureCSSClassOnElement(this.$S_2,a);CUI.Utility.ensureCSSClassOnElement(this.$c_2,a);CUI.Utility.ensureCSSClassOnElement(this.$G_2,a);CUI.Utility.ensureCSSClassOnElement(this.$A_2,a);CUI.Utility.ensureCSSClassOnElement(this.$B_2,a);CUI.Utility.ensureCSSClassOnElement(this.$1M_2,a)}},$5z_2:false,getTextValue:function(){a:;return this.$1Z_2},$8c_0:function(){a:;if(!this.get_enabled()||!this.get_$73_0())return false;this.receiveFocus();return true},receiveFocus:function(){a:;var a=this.get_displayedComponent().get_$3_0();!CUI.ScriptUtility.isNullOrUndefined(a)&&a.focus()},onMenuClosed:function(){a:;this.$1d_2()},dispose:function(){a:;CUI.MenuLauncher.prototype.dispose.call(this);this.$1M_2=null;this.$3a_2=null;this.$4E_2=null;this.$G_2=null;this.$2b_2=null;this.$7A_2=null;this.$A_2=null;this.$2c_2=null;this.$7B_2=null;this.$h_2=null;this.$S_2=null;this.$c_2=null;this.$57_2=null;this.$58_2=null;this.$4A_2=null;this.$5t_2=null;this.$4B_2=null;this.$5u_2=null;this.$3X_2=null;this.$B_2=null;this.$2d_2=null;this.$7C_2=null},get_$2_2:function(){a:;return this.$7_0}};CUI.Controls.GalleryButtonCommandProperties=function(){};CUI.Controls.GalleryButton=function(a,b,c,d){this.$$d_$A9_1=Function.createDelegate(this,this.$A9_1);this.$$d_onBlur=Function.createDelegate(this,this.onBlur);this.$$d_onFocus=Function.createDelegate(this,this.onFocus);this.$$d_onClick=Function.createDelegate(this,this.onClick);CUI.Controls.GalleryButton.initializeBase(this,[a,b,c]);this.addDisplayMode("Large");this.addDisplayMode("Menu");this.$3Q_1=d};CUI.Controls.GalleryButton.prototype={$H_1:null,$L_1:null,$4w_1:null,$3U_1:null,$3Q_1:0,createComponentForDisplayModeInternal:function(a){var b;if(a==="Menu"){b=this.$0_0.$4b_1(this.$6_0+"-"+a+this.$0_0.$2U_1(),a,this);if(CUI.ScriptUtility.isNullOrUndefined(this.get_properties().CommandValueId))this.get_properties().CommandValueId=this.get_properties().MenuItemId}else b=CUI.Control.prototype.createComponentForDisplayModeInternal.call(this,a);return b},createDOMElementForDisplayMode:function(e){var a,b,c,d;this.$H_1=(d=this.createDOMElementForDisplayModeCore(e,false,a={val:this.$L_1},b={val:this.$4w_1},c={val:this.$3U_1}),this.$L_1=a.val,this.$4w_1=b.val,this.$3U_1=c.val,d);this.$Ar_0(e);return this.$H_1},createDOMElementForDisplayModeCore:function(g,h,a,e,i){switch(g){case "Large":case "Menu":var f=CUI.ScriptUtility.isNullOrUndefined(this.get_properties().Alt)?"":this.get_properties().Alt,c=!CUI.ScriptUtility.isNullOrUndefined(this.get_properties().InnerHTML),d=CUI.Utility.$4(c&&!h?"div":"span");d.setAttribute("mscui:controltype",this.get_$96_0());d.className="ms-cui-gallerybutton ms-cui-gallerybutton-"+CUI.Utility.$9S[this.$3Q_1];a.val=CUI.Utility.$4(c?h?"span":"div":"a");a.val.title=f;a.val.className="ms-cui-gallerybutton-a";a.val.setAttribute("role",this.get_$2k_0());if(!c)CUI.Utility.$29(a.val);else a.val.tabIndex=0;CUI.Utility.$20(this.get_properties(),a.val);d.appendChild(a.val);if(c){a.val.innerHTML=this.get_properties().InnerHTML;CUI.Utility.$2C(a.val,true,true)}else{if(CUI.ScriptUtility.isNullOrUndefined(this.get_properties().Image))throw Error.create("InnerHTML or Image must be defined for this GalleryButton");var b=4;switch(this.$3Q_1){case 1:b=3;break;case 2:b=4;break;case 3:b=5;break;case 4:b=6;break;case 5:b=7;break;case 6:b=8;break;case 7:b=9}e.val=CUI.Utility.$4("img");i.val=CUI.Utility.$m(2,b,this.get_properties().Image,this.get_properties().ImageClass,e.val,true,false,this.get_properties().ImageTop,this.get_properties().ImageLeft);e.val.alt=f;a.val.appendChild(i.val)}return d;default:this.ensureValidDisplayMode(g);return null}},$Aq_0:function(a){var b=$get(this.$6_0+"-"+a);this.storeElementForDisplayMode(b,a);switch(a){case "Large":case "Menu":this.$H_1=b;this.$L_1=this.$H_1.childNodes[0];this.$3U_1=this.$L_1.childNodes[0];this.$4w_1=this.$3U_1?this.$3U_1.childNodes[0]:null}},$Ar_0:function(a){switch(a){case "Large":case "Menu":this.$X_1()}},$X_1:function(){a:;$addHandler(this.$L_1,"click",this.$$d_onClick);$addHandler(this.$L_1,"focus",this.$$d_onFocus);$addHandler(this.$L_1,"blur",this.$$d_onBlur);if(Sys.Browser.agent===Sys.Browser.InternetExplorer){$addHandler(this.$L_1,"mouseenter",this.$$d_onFocus);$addHandler(this.$L_1,"mouseleave",this.$$d_onBlur)}else{$addHandler(this.$L_1,"mouseover",this.$$d_onFocus);$addHandler(this.$L_1,"mouseout",this.$$d_onBlur)}this.$L_1.tagName!=="A"&&$addHandler(this.$L_1,"keydown",this.$$d_$A9_1)},get_$96_0:function(){a:;return "GalleryButton"},onEnabledChanged:function(a){if(a)CUI.Utility.enableElement(this.$L_1);else CUI.Utility.disableElement(this.$L_1)},$A9_1:function(a){if(!CUI.ScriptUtility.isNullOrUndefined(a))a.keyCode===13&&this.onClick(a)},onClick:function(d){this.$g_0();d.preventDefault();if(!this.get_enabled())return;this.toggle();var b=1,c=this.get_properties().CommandType,a=this.get_stateProperties();a[CUI.Controls.GalleryButtonCommandProperties.CommandValueId]=this.get_properties().CommandValueId;a["MenuItemId"]=this.get_properties().MenuItemId;a["SourceControlId"]=this.get_properties().Id;if(!CUI.ScriptUtility.isNullOrUndefined(c)&&c==="OptionSelection")b=3;this.get_displayedComponent().raiseCommandEvent(this.get_properties().Command,b,a);if(this.$0_0.get_$5U_1())this.$AK_0();else this.$2q_1(this.get_stateProperties()[CUI.Controls.GalleryButtonCommandProperties.On])},onFocus:function(){this.onBeginFocus();if(!this.get_enabled())return;this.$0_0.set_$q_1(this);if(CUI.ScriptUtility.isNullOrUndefined(this.get_properties().CommandPreview))return;var a=5,b=this.get_properties().CommandType;this.get_stateProperties()[CUI.Controls.GalleryButtonCommandProperties.CommandValueId]=this.get_properties().CommandValueId;if(!CUI.ScriptUtility.isNullOrUndefined(b)&&b==="OptionSelection")a=7;this.get_displayedComponent().raiseCommandEvent(this.get_properties().CommandPreview,a,this.get_stateProperties())},onBlur:function(){this.onEndFocus();if(!this.get_enabled())return;if(CUI.ScriptUtility.isNullOrUndefined(this.get_properties().CommandRevert))return;var a=6,b=this.get_properties().CommandType;if(!CUI.ScriptUtility.isNullOrUndefined(b)&&b==="OptionSelection"){a=8;this.get_stateProperties()[CUI.Controls.GalleryButtonCommandProperties.CommandValueId]=this.get_properties().CommandValueId}this.get_displayedComponent().raiseCommandEvent(this.get_properties().CommandRevert,a,this.get_stateProperties())},$5o_1:null,getDropDownDOMElementForDisplayMode:function(h){if(this.$3Q_1===13){if(!this.$5o_1){var e=null,f=null,g=null,a,b,c,d;this.$5o_1=(d=this.createDOMElementForDisplayModeCore(h,true,a={val:e},b={val:g},c={val:f}),e=a.val,g=b.val,f=c.val,d)}return this.$5o_1}else return CUI.Utility.$4("span")},deselect:function(){a:;this.set_selected(false)},getMenuItemId:function(){a:;return this.get_properties().MenuItemId},getCommandValueId:function(){a:;return this.get_properties().CommandValueId},focusOnDisplayedComponent:function(){a:;this.receiveFocus()},getTextValue:function(){a:;return this.get_properties().Alt},receiveFocus:function(){a:;this.$L_1.focus()},onMenuClosed:function(){a:;CUI.Control.prototype.onMenuClosed.call(this)},$3t_1:function(){a:;CUI.Utility.ensureCSSClassOnElement(this.$H_1,"ms-cui-gallerybutton-highlighted")},$1d_1:function(){a:;CUI.Utility.removeCSSClassFromElement(this.$H_1,"ms-cui-gallerybutton-highlighted")},toggle:function(){a:;var a=!this.get_stateProperties()[CUI.Controls.GalleryButtonCommandProperties.On];this.get_stateProperties()[CUI.Controls.GalleryButtonCommandProperties.On]=a;this.$2q_1(a)},$2q_1:function(a){if(a)this.$3t_1();else this.$1d_1()},$AK_0:function(){a:;var a=this.get_stateProperties();a[CUI.Controls.GalleryButtonCommandProperties.CommandValueId]=this.get_properties().CommandValueId;a["MenuItemId"]=this.get_properties().MenuItemId;a["SourceControlId"]=this.get_properties().Id;var c=this.pollForStateAndUpdateInternal(this.get_properties().Command,this.get_properties().QueryCommand,a,false);if((c&2)>0){if(!CUI.ScriptUtility.isNullOrUndefined(this.$L_1)&&!CUI.ScriptUtility.isNullOrUndefined(this.get_stateProperties()[CUI.Controls.GalleryButtonCommandProperties.InnerHTML])){var b=CUI.Utility.$3L(this.get_stateProperties()[CUI.Controls.GalleryButtonCommandProperties.InnerHTML],this.get_properties().InnerHTML);if(this.$L_1.innerHTML!==b)this.$L_1.innerHTML=b}this.$2q_1(this.get_stateProperties()[CUI.Controls.GalleryButtonCommandProperties.On])}},get_selected:function(){a:;return this.get_stateProperties()[CUI.Controls.GalleryButtonCommandProperties.On]},set_selected:function(a){this.get_stateProperties()[CUI.Controls.GalleryButtonCommandProperties.On]=a;if(a)this.$3t_1();else this.$1d_1();return a},get_elementDimensions:function(){a:;return this.$3Q_1},set_elementDimensions:function(a){this.$3Q_1=a;return a},dispose:function(){a:;CUI.Control.prototype.dispose.call(this);this.$H_1=null;this.$L_1=null;this.$4w_1=null;this.$3U_1=null},get_properties:function(){a:;return this.$7_0}};CUI.Controls.InsertTableCommandProperties=function(){};CUI.Controls.InsertTable=function(a,b,c){this.$$d_$A6_1=Function.createDelegate(this,this.$A6_1);this.$$d_$A8_1=Function.createDelegate(this,this.$A8_1);this.$$d_$A7_1=Function.createDelegate(this,this.$A7_1);this.$$d_$CX_1=Function.createDelegate(this,this.$CX_1);this.$1t_1=-1;this.$4j_1=-1;this.$4k_1=-1;CUI.Controls.InsertTable.initializeBase(this,[a,b,c]);this.addDisplayMode("Menu")};CUI.Controls.InsertTable.prototype={$2M_1:null,$4P_1:null,createComponentForDisplayModeInternal:function(b){if(this.$Y_0.length>0)throw Error.create("Only one ControlComponent can be created for each InsertTable Control");var a;a=this.$0_0.$4b_1(this.$6_0+"-"+b+this.$0_0.$2U_1(),b,this);return a},$H_1:null,$2w_1:null,createDOMElementForDisplayMode:function(i){switch(i){case "Menu":this.$H_1=CUI.Utility.$4("table");this.$H_1.setAttribute("mscui:controltype",this.get_$96_0());this.$2w_1=CUI.Utility.$4("tbody");this.$2w_1.className="ms-cui-it";this.$H_1.setAttribute("cellspacing","0");this.$H_1.setAttribute("cellpadding","0");this.$2w_1.setAttribute("cellspacing","0");this.$2w_1.setAttribute("cellpadding","0");$addHandler(this.$H_1,"mouseout",this.$$d_$CX_1);this.$Bj_1();for(var f,a,c,d,b,e=0,g=0;g<10;g++){f=CUI.Utility.$4("tr");this.$2w_1.appendChild(f);for(var h=0;h<10;h++){a=CUI.Utility.$4("td");a.style.padding="0px";f.appendChild(a);c=CUI.Utility.$4("a");CUI.Utility.$29(c);CUI.Utility.$20(this.get_$2_1(),c);$addHandler(c,"focus",this.$$d_$A7_1);d=CUI.Utility.$4("div");d.className="ms-cui-it-inactiveCell";b=CUI.Utility.$4("div");b.id=this.$6_0+"-"+e;b.className="ms-cui-it-inactiveCellOuter";$addHandler(a,"mouseover",this.$$d_$A8_1);$addHandler(a,"click",this.$$d_$A6_1);a.appendChild(b);b.appendChild(d);d.appendChild(c);this.$2M_1[e]=d;this.$4P_1[e]=b;e++}}this.$H_1.appendChild(this.$2w_1);return this.$H_1;default:this.ensureValidDisplayMode(i)}return null},onEnabledChanged:function(){},get_$96_0:function(){a:;return "InsertTable"},$A6_1:function(b){!CUI.ScriptUtility.isNullOrUndefined(CUI.PMetrics)&&CUI.PMetrics.perfMark(7702);b.preventDefault();if(!this.get_enabled())return;var c=this.$8C_1(b.target),a=this.$8A_1(c),d=this.$5Q_1(a),e=this.$5S_1(a);this.$7p_1();this.get_commandProperties()["Rows"]=e+1;this.get_commandProperties()["Columns"]=d+1;this.get_displayedComponent().raiseCommandEvent(this.get_$2_1().Command,1,this.get_commandProperties());!CUI.ScriptUtility.isNullOrUndefined(CUI.PMetrics)&&CUI.PMetrics.perfMark(7703)},$8C_1:function(a){while(a.hasChildNodes())a=a.childNodes[0];return a.parentNode.parentNode},$Ad_1:function(b){var c=b.childNodes[0].childNodes[0],a=this.$8A_1(b);c.title=this.$9f_1(this.$5S_1(a)+1,this.$5Q_1(a)+1)},$9f_1:function(b,c){var a=this.get_$2_1().Alt;if(CUI.ScriptUtility.isNullOrUndefined(a))a=this.get_$2_1().MenuSectionTitle;a=String.format(a,c.toString(),b.toString());return a},$A8_1:function(b){if(!this.get_enabled())return;var a=this.$8C_1(b.target);this.$Ad_1(a);this.$9s_1(a)},$A7_1:function(b){if(!this.get_enabled())return;var a=this.$8C_1(b.target);this.$Ad_1(a);this.$9s_1(a)},$CX_1:function(b){var a=CUI.Utility.$9j(this.$H_1);(b.clientX<=a.x||b.clientX>=a.x+a.width||b.clientY<=a.y||b.clientY>=a.y+a.height)&&this.$6w_1()},$6w_1:function(){a:;this.$De_1();this.$7u_1();this.$4j_1=-1;this.$4k_1=-1;this.$2n_1=false},$8A_1:function(a){return parseInt(a.id.substr(this.$6_0.length+1))},$2n_1:false,$9s_1:function(b){var a=this.$8A_1(b);if(this.$1t_1===a)return;this.$CH_1(a)},$CH_1:function(a){this.$Ap_1(a);this.$1t_1=a;this.$7u_1();this.$AS_1(a)},$5S_1:function(a){return Math.floor(a/10)},$5Q_1:function(a){return a%10},$Ap_1:function(e){var c=this.$5Q_1(e),d=this.$5S_1(e),a=-1,b=-1;if(this.$1t_1!==-1){a=this.$5S_1(this.$1t_1);b=this.$5Q_1(this.$1t_1)}while(a!==d||b!==c)if(a<d)this.$Aa_1(++a,b,true);else if(a>d){this.$Aa_1(a,b,false);a--}else if(b<c)this.$AV_1(++b,a,true);else if(b>c){this.$AV_1(b,a,false);b--}this.get_$9v_1().$Ac_1(this.$9f_1(d+1,c+1))},$Aa_1:function(b,c,d){for(var a=0;a<=c;a++)this.$AU_1(b,a,d)},$AV_1:function(b,c,d){for(var a=0;a<=c;a++)this.$AU_1(a,b,d)},$AU_1:function(d,e,f){var a=d*10+e,b=this.$2M_1[a],c=this.$4P_1[a];if(f){b.className="ms-cui-it-activeCell";c.className="ms-cui-it-activeCellOuter"}else{b.className="ms-cui-it-inactiveCell";c.className="ms-cui-it-inactiveCellOuter"}},$De_1:function(){a:;for(var a=0;a<100;a++){this.$2M_1[a].className="ms-cui-it-inactiveCell";this.$4P_1[a].className="ms-cui-it-inactiveCellOuter"}this.$1t_1=-1;var b=this.get_$2_1().MenuSectionInitialTitle;if(CUI.ScriptUtility.isNullOrUndefined(b))b="";this.get_$9v_1().$Ac_1(b)},$Bj_1:function(){a:;if(CUI.ScriptUtility.isNullOrUndefined(this.$2M_1))this.$2M_1=new Array(100);if(CUI.ScriptUtility.isNullOrUndefined(this.$4P_1))this.$4P_1=new Array(100)},receiveFocus:function(){a:;var a=this.$2M_1[0];if(CUI.ScriptUtility.isNullOrUndefined(a))return;a.firstChild.focus()},$7p_1:function(){a:;this.$4j_1=-1;this.$4k_1=-1;this.$2n_1=false},$7u_1:function(){a:;if(this.$2n_1){var a=this.get_$2_1().CommandRevert;if(!CUI.ScriptUtility.isNullOrUndefined(a)){this.get_commandProperties()["Rows"]=this.$4k_1+1;this.get_commandProperties()["Columns"]=this.$4j_1+1;this.get_displayedComponent().raiseCommandEvent(a,6,this.get_commandProperties())}this.$7p_1()}},$AS_1:function(b){this.$4j_1=this.$5Q_1(b);this.$4k_1=this.$5S_1(b);this.$2n_1=true;var a=this.get_$2_1().CommandPreview;if(!CUI.ScriptUtility.isNullOrUndefined(a)){this.get_commandProperties()["Rows"]=this.$4k_1+1;this.get_commandProperties()["Columns"]=this.$4j_1+1;this.get_displayedComponent().raiseCommandEvent(a,5,this.get_commandProperties())}},get_$9v_1:function(){a:;var a=this.get_displayedComponent().$M_0;if(!CUI.MenuSection.isInstanceOfType(a))throw Error.create("InsertTable must live inside of a MenuSection.");return a},onMenuClosed:function(){a:;this.$6w_1()},$6b_0:function(){a:;if(this.$1t_1===99){this.$6w_1();return false}this.$2M_1[this.$1t_1+1].firstChild.focus();return true},$6c_0:function(){a:;if(!this.$1t_1){this.$6w_1();return false}else if(this.$1t_1===-1)this.$2M_1[99].firstChild.focus();else this.$2M_1[this.$1t_1-1].firstChild.focus();return true},dispose:function(){a:;CUI.Control.prototype.dispose.call(this);this.$H_1=null;this.$2w_1=null},get_$2_1:function(){a:;return this.$7_0}};CUI.Controls.LabelCommandProperties=function(){};CUI.Controls.Label=function(a,b,c){CUI.Controls.Label.initializeBase(this,[a,b,c]);this.addDisplayMode("Medium");this.addDisplayMode("Small")};CUI.Controls.Label.prototype={$H_1:null,$42_1:null,$2G_1:null,$B_1:null,$3Z_1:null,$6T_1:"",createDOMElementForDisplayMode:function(e){var a=this.get_$2_1().ForId,b=this.get_$2_1().LabelText;switch(e){case "Medium":if(a){this.$H_1=CUI.Utility.$4("label");if(CUI.Utility.$3v())this.$H_1.setAttribute("htmlFor",a);else this.$H_1.setAttribute("for",a)}else this.$H_1=CUI.Utility.$4("span");this.$H_1.setAttribute("mscui:controltype",this.get_$96_0());this.$H_1.className="ms-cui-ctl-small ms-cui-fslb";if(!CUI.ScriptUtility.isNullOrEmptyString(this.get_$2_1().Image16by16)){this.$42_1=CUI.Utility.$4("img");var g=CUI.Utility.$m(2,3,this.get_$2_1().Image16by16,this.get_$2_1().Image16by16Class,this.$42_1,true,false,this.get_$2_1().Image16by16Top,this.get_$2_1().Image16by16Left),d=CUI.Utility.$4("span");d.className="ms-cui-ctl-iconContainer";d.appendChild(g);this.$H_1.appendChild(d)}this.$2G_1=CUI.Utility.$4("span");this.$2G_1.className="ms-cui-ctl-mediumlabel";if(!CUI.ScriptUtility.isNullOrUndefined(this.$0_0.get_$1R_1()))this.$2G_1.style.color=this.$0_0.get_$1R_1();!CUI.ScriptUtility.isNullOrUndefined(b)&&CUI.UIUtility.setInnerText(this.$2G_1,b);this.$H_1.appendChild(this.$2G_1);return this.$H_1;case "Small":if(a){this.$B_1=CUI.Utility.$4("label");if(CUI.Utility.$3v())this.$B_1.setAttribute("htmlFor",a);else this.$B_1.setAttribute("for",a)}else this.$B_1=CUI.Utility.$4("span");this.$B_1.setAttribute("mscui:controltype",this.get_$96_0());this.$B_1.className="ms-cui-ctl-small ms-cui-fslb";if(CUI.ScriptUtility.isNullOrEmptyString(this.get_$2_1().Image16by16))throw Error.argumentNull("Image16by16","Small display mode must have an icon set");this.$3Z_1=CUI.Utility.$4("img");var f=CUI.Utility.$m(2,3,this.get_$2_1().Image16by16,this.get_$2_1().Image16by16Class,this.$3Z_1,true,false,this.get_$2_1().Image16by16Top,this.get_$2_1().Image16by16Left);if(!CUI.ScriptUtility.isNullOrUndefined(b))this.$3Z_1.alt=b;var c=CUI.Utility.$4("span");c.className="ms-cui-ctl-iconContainer";c.appendChild(f);this.$B_1.appendChild(c);return this.$B_1;default:this.ensureValidDisplayMode(e)}return null},$Aq_0:function(b){var a=$get(this.$6_0+"-"+b);this.storeElementForDisplayMode(a,b);switch(b){case "Medium":this.$H_1=a;if(!CUI.ScriptUtility.isNullOrEmptyString(this.get_$2_1().Image16by16)){this.$42_1=this.$H_1.firstChild.firstChild.firstChild;this.$2G_1=this.$H_1.childNodes[1]}else this.$2G_1=this.$H_1.firstChild;break;case "Small":this.$B_1=a;this.$3Z_1=this.$B_1.firstChild.firstChild.firstChild}},onEnabledChanged:function(a){CUI.Utility.setEnabledOnElement(this.$H_1,a);CUI.Utility.setEnabledOnElement(this.$B_1,a)},get_$96_0:function(){a:;return "Label"},pollForStateAndUpdateInternal:function(b,c,d,e){var a=this.$0_0.$3x_1(b,c,d,e);!CUI.ScriptUtility.isNullOrUndefined(this.get_$2_1().Command)&&this.set_enabled((a&1)>0);return a},$AK_0:function(){a:;var c=this.pollForStateAndUpdateInternal(this.get_$2_1().Command,this.get_$2_1().QueryCommand,this.get_stateProperties(),true);if((c&2)>0){var d=this.$6T_1,a=this.get_stateProperties()["Value"];if(CUI.ScriptUtility.isNullOrUndefined(a)){a=this.get_$2_1().LabelText;if(CUI.ScriptUtility.isNullOrUndefined(a))a=""}if(a!==d){this.$6T_1=a;CUI.UIUtility.setInnerText(this.$2G_1,this.$6T_1);this.$0_0.$2D_1=true}var b=CUI.Utility.$3L(this.get_stateProperties()["Image16by16Class"],this.get_$2_1().Image16by16Class);CUI.Utility.$2R(this.$42_1,b);CUI.Utility.$2R(this.$3Z_1,b)}},dispose:function(){a:;CUI.Control.prototype.dispose.call(this);this.$H_1=null;this.$42_1=null;this.$2G_1=null;this.$B_1=null;this.$3Z_1=null},get_$2_1:function(){a:;return this.$7_0}};CUI.Controls.MRUSplitButton=function(a,b,c,d){this.$$d_onDblClick=Function.createDelegate(this,this.onDblClick);this.$$d_$AH_3=Function.createDelegate(this,this.$AH_3);this.$$d_$Cw_3=Function.createDelegate(this,this.$Cw_3);this.$$d_$Cx_3=Function.createDelegate(this,this.$Cx_3);CUI.Controls.MRUSplitButton.initializeBase(this,[a,b,c,d])};CUI.Controls.MRUSplitButton.prototype={$G_3:null,$1D_3:null,$R_3:null,$2b_3:null,$A_3:null,$b_3:null,$U_3:null,$2c_3:null,$B_3:null,$1L_3:null,$V_3:null,$2d_3:null,$1J_3:false,$3M_3:false,$8c_0:function(){a:;if(!this.get_enabled())return false;if(this.$1J_3){this.get_displayedComponent().get_$3_0().firstChild.firstChild.focus();return true}return false},createDOMElementForDisplayMode:function(d){var b=true,a=CUI.ScriptUtility.isNullOrEmptyString(this.get_properties().Alt)?"":this.get_properties().Alt,f=d==="Medium"&&!CUI.ScriptUtility.isNullOrUndefined(this.get_properties().Width)?this.get_properties().Width:"auto",c=null,e=this.get_stateProperties()[CUI.Controls.DropDownCommandProperties.SelectedItemId];if(CUI.ScriptUtility.isNullOrUndefined(e))e=this.get_properties().InitialItem;this.$3M_3=true;switch(d){case "Large":this.$G_3=CUI.Utility.$4("span");this.$G_3.setAttribute("mscui:controltype",this.get_$96_0());CUI.Utility.ensureCSSClassOnElement(this.$G_3,"ms-cui-ctl-large");this.$1D_3=CUI.Utility.$4("span");this.$1D_3.className="ms-cui-mrusb-selecteditem";if(!this.$2p_2(e))if(!CUI.Utility.$u(this.get_properties().PopulateDynamically))throw Error.create("No menu item with id '"+this.get_properties().InitialItem+"' exists in this control's menu");else{this.$1D_3.style.width="32px";this.$1D_3.style.height="32px"}this.$R_3=CUI.Utility.$4("a");this.$R_3.className="ms-cui-ctl-a2";this.$R_3.style.display="block";this.$R_3.setAttribute("role",this.get_$2k_0());this.$R_3.setAttribute("aria-haspopup",true);CUI.Utility.$29(this.$R_3);CUI.Utility.$20(this.get_properties(),this.$R_3);this.$2b_3=CUI.Utility.$4("img");var g=CUI.Utility.$m(2,1,this.$0_0.$7_1.ImageDownArrow,this.$0_0.$7_1.ImageDownArrowClass,this.$2b_3,true,false,this.$0_0.$7_1.ImageDownArrowTop,this.$0_0.$7_1.ImageDownArrowLeft);if(CUI.ScriptUtility.isNullOrEmptyString(this.get_properties().ToolTipTitle)){b=false;this.$R_3.title=a;this.$2b_3.alt=a}this.$Ar_0(d);this.$R_3.appendChild(g);if(b){c=CUI.Utility.$2S(a);this.$R_3.appendChild(c)}this.$G_3.appendChild(this.$1D_3);this.$G_3.appendChild(this.$R_3);this.$3M_3=false;return this.$G_3;case "Medium":this.$A_3=CUI.Utility.$4("span");this.$A_3.setAttribute("mscui:controltype",this.get_$96_0());this.$A_3.className="ms-cui-ctl-medium ms-cui-ctl";this.$b_3=CUI.Utility.$4("span");this.$b_3.className="ms-cui-mrusb-selecteditem";this.$b_3.style.width=f;if(!this.$2p_2(e))throw Error.create("No menu item with id '"+this.get_properties().InitialItem+"' exists in this control's menu");this.$U_3=CUI.Utility.$4("a");CUI.Utility.$29(this.$U_3);CUI.Utility.$20(this.get_properties(),this.$U_3);this.$U_3.className="ms-cui-ctl";this.$U_3.setAttribute("role",this.get_$2k_0());this.$U_3.setAttribute("aria-haspopup",true);this.$2c_3=CUI.Utility.$4("img");if(CUI.ScriptUtility.isNullOrEmptyString(this.get_properties().ToolTipTitle)){b=false;this.$U_3.title=a;this.$2c_3.alt=a}var h=CUI.Utility.$m(2,1,this.$0_0.$7_1.ImageDownArrow,this.$0_0.$7_1.ImageDownArrowClass,this.$2c_3,true,false,this.$0_0.$7_1.ImageDownArrowTop,this.$0_0.$7_1.ImageDownArrowLeft);this.$Ar_0(d);this.$U_3.appendChild(h);if(b){c=CUI.Utility.$2S(a);this.$U_3.appendChild(c)}this.$A_3.appendChild(this.$b_3);this.$A_3.appendChild(this.$U_3);this.$3M_3=false;return this.$A_3;case "Small":this.$B_3=CUI.Utility.$4("span");this.$B_3.setAttribute("mscui:controltype",this.get_$96_0());this.$B_3.className="ms-cui-ctl-medium ms-cui-ctl";this.$1L_3=CUI.Utility.$4("span");this.$1L_3.className="ms-cui-mrusb-selecteditem";this.$1L_3.style.width=f;if(!this.$2p_2(e))throw Error.create("No menu item with id '"+this.get_properties().InitialItem+"' exists in this control's menu");this.$V_3=CUI.Utility.$4("a");CUI.Utility.$29(this.$V_3);CUI.Utility.$20(this.get_properties(),this.$V_3);this.$V_3.setAttribute("role",this.get_$2k_0());this.$V_3.setAttribute("aria-haspopup",true);this.$V_3.className="ms-cui-ctl ms-cui-mrusb-arwbtn";this.$2d_3=CUI.Utility.$4("img");if(CUI.ScriptUtility.isNullOrEmptyString(this.get_properties().ToolTipTitle)){this.$V_3.title=a;this.$2d_3.alt=a;b=false}var i=CUI.Utility.$m(2,1,this.$0_0.$7_1.ImageDownArrow,this.$0_0.$7_1.ImageDownArrowClass,this.$2d_3,true,false,this.$0_0.$7_1.ImageDownArrowTop,this.$0_0.$7_1.ImageDownArrowLeft);this.$Ar_0(d);this.$V_3.appendChild(i);if(b){c=CUI.Utility.$2S(a);this.$V_3.appendChild(c)}this.$B_3.appendChild(this.$1L_3);this.$B_3.appendChild(this.$V_3);this.$3M_3=false;return this.$B_3;default:this.$3M_3=false;this.ensureValidDisplayMode(d);return null}},$Aq_0:function(b){var a=$get(this.$6_0+"-"+b);this.storeElementForDisplayMode(a,b);switch(b){case "Large":this.$G_3=a;this.$1D_3=this.$G_3.childNodes[0];this.$R_3=this.$G_3.childNodes[1];this.$2b_3=this.$R_3.childNodes[0].childNodes[0];break;case "Medium":this.$A_3=a;this.$b_3=this.$A_3.childNodes[0];this.$U_3=this.$A_3.childNodes[1];this.$2c_3=this.$U_3.childNodes[0].childNodes[0];break;case "Small":this.$B_3=a;this.$1L_3=this.$B_3.childNodes[0];this.$V_3=this.$B_3.childNodes[1];this.$2d_3=this.$V_3.childNodes[0].childNodes[0]}},$Ar_0:function(a){this.$X_3(a)},$X_3:function(a){switch(a){case "Large":$addHandler(this.$R_3,"click",this.$$d_onArrowButtonClick);$addHandler(this.$1D_3,"mouseover",this.$$d_$Cx_3);$addHandler(this.$1D_3,"mouseout",this.$$d_$Cw_3);$addHandler(this.$R_3,"mouseover",this.$$d_onArrowButtonFocus);$addHandler(this.$R_3,"mouseout",this.$$d_onArrowButtonBlur);$addHandler(this.$R_3,"focus",this.$$d_onArrowButtonKeyboardFocus);$addHandler(this.$R_3,"blur",this.$$d_onArrowButtonBlur);$addHandler(this.$R_3,"keypress",this.$$d_onArrowButtonKeyPress);break;case "Medium":$addHandler(this.$U_3,"click",this.$$d_onArrowButtonClick);$addHandler(this.$b_3,"mouseover",this.$$d_$Cx_3);$addHandler(this.$b_3,"mouseout",this.$$d_$Cw_3);$addHandler(this.$U_3,"mouseover",this.$$d_onArrowButtonFocus);$addHandler(this.$U_3,"mouseout",this.$$d_onArrowButtonBlur);$addHandler(this.$U_3,"focus",this.$$d_onArrowButtonKeyboardFocus);$addHandler(this.$U_3,"blur",this.$$d_onArrowButtonBlur);$addHandler(this.$U_3,"keypress",this.$$d_onArrowButtonKeyPress);break;case "Small":$addHandler(this.$V_3,"click",this.$$d_onArrowButtonClick);$addHandler(this.$1L_3,"mouseover",this.$$d_$Cx_3);$addHandler(this.$1L_3,"mouseout",this.$$d_$Cw_3);$addHandler(this.$V_3,"mouseover",this.$$d_onArrowButtonFocus);$addHandler(this.$V_3,"mouseout",this.$$d_onArrowButtonBlur);$addHandler(this.$V_3,"focus",this.$$d_onArrowButtonKeyboardFocus);$addHandler(this.$V_3,"blur",this.$$d_onArrowButtonBlur);$addHandler(this.$V_3,"keypress",this.$$d_onArrowButtonKeyPress)}},get_$96_0:function(){a:;return "MRUSplitButton"},selectMenuItem:function(d){if(this._selectedControl===d&&!this.$3M_3)return;var e=!CUI.ScriptUtility.isNullOrUndefined(this.get_displayedComponent())?this.get_displayedComponent().get_title():this.$5g_0,a;switch(e){case "Large":a=this.$1D_3;break;case "Medium":a=this.$b_3;break;case "Small":a=this.$1L_3;break;default:throw Error.create("Invalid display mode on split button while selecting a menu item")}this._selectedControl=d;this.get_stateProperties()[CUI.Controls.DropDownCommandProperties.SelectedItemId]=d.getMenuItemId();var f=d;if(CUI.MenuItem.isInstanceOfType(f.get_displayedComponent()))this.$D_1.$3k_1=f.get_displayedComponent();var b=this._selectedControl.getDropDownDOMElementForDisplayMode(e);if(b.childNodes.length>1){var c=b.childNodes[1];if(c.childNodes.length>1)if(c.childNodes[1].tagName.toLowerCase()==="br"){var g=CUI.Utility.$4("span");CUI.Utility.$2B(g," ");c.replaceChild(g,c.childNodes[1])}}b.id=this.$6_0+"-SelectedItem";if(a.hasChildNodes()){var h=a.firstChild;a.replaceChild(b,h);$clearHandlers(h)}else a.appendChild(b);this.$0_0.$2D_1=true;$addHandler(b,"click",this.$$d_$AH_3);$addHandler(b,"dblclick",this.$$d_onDblClick)},addDisplayModes:function(){a:;this.addDisplayMode("Large");this.addDisplayMode("Medium");this.addDisplayMode("Small")},launchMenuInternal:function(){var a=false;this.$0_0.$34_1=false;switch(this.get_displayedComponent().get_title()){case "Large":a=this.launchMenu(this.$R_3,this.$$d_sendMenuCreationCommandEvent);break;case "Medium":a=this.launchMenu(this.$U_3,this.$$d_sendMenuCreationCommandEvent);break;case "Small":a=this.launchMenu(this.$V_3,this.$$d_sendMenuCreationCommandEvent)}a&&this.sendMenuCreationCommandEvent()},onEnabledChanged:function(b){CUI.Controls.DropDown.prototype.onEnabledChanged.call(this,b);var a="ms-cui-disabled";this.$1J_3=b;if(b){CUI.Utility.removeCSSClassFromElement(this.$G_3,a);CUI.Utility.enableElement(this.$R_3);CUI.Utility.removeCSSClassFromElement(this.$A_3,a);CUI.Utility.enableElement(this.$U_3);CUI.Utility.removeCSSClassFromElement(this.$B_3,a);CUI.Utility.enableElement(this.$V_3)}else{CUI.Utility.ensureCSSClassOnElement(this.$G_3,a);CUI.Utility.disableElement(this.$R_3);CUI.Utility.ensureCSSClassOnElement(this.$A_3,a);CUI.Utility.disableElement(this.$U_3);CUI.Utility.ensureCSSClassOnElement(this.$B_3,a);CUI.Utility.disableElement(this.$V_3)}CUI.Utility.setEnabledOnElement(this.$R_3,b);CUI.Utility.setEnabledOnElement(this.$U_3,b);CUI.Utility.setEnabledOnElement(this.$V_3,b)},onDblClick:function(a){this.$g_0();a.preventDefault();if(!this.get_enabled())return;this.$AH_3(a)},$AH_3:function(b){CUI.PMetrics.perfMark(7735);this.$g_0();b.preventDefault();if(!this.get_enabled())return;var a=3;this.get_displayedComponent().raiseCommandEvent(this.get_properties().Command,a,{CommandValueId:this._selectedControl.getCommandValueId()})},$Cx_3:function(){this.onBeginFocus();if(!this.get_enabled())return;switch(this.get_displayedComponent().get_title()){case "Large":CUI.Utility.ensureCSSClassOnElement(this.$1D_3,"ms-cui-ctl-light-hoveredOver");CUI.Utility.ensureCSSClassOnElement(this.$R_3,"ms-cui-ctl-split-hover");break;case "Medium":CUI.Utility.ensureCSSClassOnElement(this.$b_3,"ms-cui-ctl-light-hoveredOver");CUI.Utility.ensureCSSClassOnElement(this.$U_3,"ms-cui-ctl-split-hover");break;case "Small":CUI.Utility.ensureCSSClassOnElement(this.$1L_3,"ms-cui-ctl-light-hoveredOver");CUI.Utility.ensureCSSClassOnElement(this.$V_3,"ms-cui-ctl-split-hover")}if(CUI.ScriptUtility.isNullOrEmptyString(this.get_properties().CommandPreview))return;this.get_displayedComponent().raiseCommandEvent(this.get_properties().CommandPreview,5,{CommandValueId:this._selectedControl.getCommandValueId()})},$Cw_3:function(){this.onEndFocus();if(!this.get_enabled())return;switch(this.get_displayedComponent().get_title()){case "Large":CUI.Utility.removeCSSClassFromElement(this.$1D_3,"ms-cui-ctl-light-hoveredOver");CUI.Utility.removeCSSClassFromElement(this.$R_3,"ms-cui-ctl-split-hover");break;case "Medium":CUI.Utility.removeCSSClassFromElement(this.$b_3,"ms-cui-ctl-light-hoveredOver");CUI.Utility.removeCSSClassFromElement(this.$U_3,"ms-cui-ctl-split-hover");break;case "Small":CUI.Utility.removeCSSClassFromElement(this.$1L_3,"ms-cui-ctl-light-hoveredOver");CUI.Utility.removeCSSClassFromElement(this.$V_3,"ms-cui-ctl-split-hover")}if(CUI.ScriptUtility.isNullOrEmptyString(this.get_properties().CommandRevert))return;this.get_displayedComponent().raiseCommandEvent(this.get_properties().CommandRevert,6,{CommandValueId:this._selectedControl.getCommandValueId()})},highlight:function(){a:;switch(this.get_displayedComponent().get_title()){case "Large":CUI.Utility.ensureCSSClassOnElement(this.$1D_3,"ms-cui-ctl-split-hover");CUI.Utility.ensureCSSClassOnElement(this.$R_3,"ms-cui-ctl-light-hoveredOver");break;case "Medium":CUI.Utility.ensureCSSClassOnElement(this.$b_3,"ms-cui-ctl-split-hover");CUI.Utility.ensureCSSClassOnElement(this.$U_3,"ms-cui-ctl-light-hoveredOver");break;case "Small":CUI.Utility.ensureCSSClassOnElement(this.$1L_3,"ms-cui-ctl-split-hover");CUI.Utility.ensureCSSClassOnElement(this.$V_3,"ms-cui-ctl-light-hoveredOver")}},removeHighlight:function(){a:;switch(this.get_displayedComponent().get_title()){case "Large":CUI.Utility.removeCSSClassFromElement(this.$1D_3,"ms-cui-ctl-split-hover");CUI.Utility.removeCSSClassFromElement(this.$R_3,"ms-cui-ctl-light-hoveredOver");break;case "Medium":CUI.Utility.removeCSSClassFromElement(this.$b_3,"ms-cui-ctl-split-hover");CUI.Utility.removeCSSClassFromElement(this.$U_3,"ms-cui-ctl-light-hoveredOver");break;case "Small":CUI.Utility.removeCSSClassFromElement(this.$1L_3,"ms-cui-ctl-split-hover");CUI.Utility.removeCSSClassFromElement(this.$V_3,"ms-cui-ctl-light-hoveredOver")}},dispose:function(){a:;CUI.Controls.DropDown.prototype.dispose.call(this);this.$G_3=null;this.$2b_3=null;this.$R_3=null;this.$1D_3=null;this.$A_3=null;this.$2c_3=null;this.$U_3=null;this.$b_3=null;this.$B_3=null;this.$2d_3=null;this.$V_3=null;this.$1L_3=null}};CUI.Controls.Separator=function(a,b,c){CUI.Controls.Separator.initializeBase(this,[a,b,c]);this.addDisplayMode("Small")};CUI.Controls.Separator.prototype={$53_1:null,$54_1:null,$B_1:null,createDOMElementForDisplayMode:function(a){switch(a){case "Small":this.$53_1=CUI.Utility.$4("img");this.$53_1.style.cursor="default";this.$54_1=CUI.Utility.$m(2,11,this.get_$2_1().Image,this.get_$2_1().ImageClass,this.$53_1,true,false,this.get_$2_1().ImageTop,this.get_$2_1().ImageLeft);this.$B_1=CUI.Utility.$4("span");this.$B_1.className="ms-cui-ctl ms-cui-ctl-small ms-cui-separator";this.$B_1.appendChild(this.$54_1);return this.$B_1;default:this.ensureValidDisplayMode(a)}return null},$Aq_0:function(a){var b=$get(this.$6_0+"-"+a);this.storeElementForDisplayMode(b,a);switch(a){case "Small":this.$54_1=b}},onEnabledChanged:function(){},get_$96_0:function(){a:;return "Separator"},$AK_0:function(){},dispose:function(){a:;CUI.Control.prototype.dispose.call(this);this.$53_1=null;this.$54_1=null;this.$B_1=null},get_$2_1:function(){a:;return this.$7_0}};CUI.Controls.SpinnerCommandProperties=function(){};CUI.Controls.Spinner=function(a,b,c,d,e){this.$$d_$Ah_1=Function.createDelegate(this,this.$Ah_1);this.$$d_$Ai_1=Function.createDelegate(this,this.$Ai_1);this.$$d_$Da_1=Function.createDelegate(this,this.$Da_1);this.$$d_$Db_1=Function.createDelegate(this,this.$Db_1);this.$$d_$AD_1=Function.createDelegate(this,this.$AD_1);this.$$d_$Co_1=Function.createDelegate(this,this.$Co_1);this.$$d_$D2_1=Function.createDelegate(this,this.$D2_1);this.$$d_$CZ_1=Function.createDelegate(this,this.$CZ_1);this.$$d_$AE_1=Function.createDelegate(this,this.$AE_1);this.$$d_$Cp_1=Function.createDelegate(this,this.$Cp_1);this.$$d_$D3_1=Function.createDelegate(this,this.$D3_1);this.$$d_$Ca_1=Function.createDelegate(this,this.$Ca_1);this.$$d_$Cf_1=Function.createDelegate(this,this.$Cf_1);this.$$d_$Cc_1=Function.createDelegate(this,this.$Cc_1);this.$$d_$AA_1=Function.createDelegate(this,this.$AA_1);this.$$d_$6t_1=Function.createDelegate(this,this.$6t_1);this.$$d_$6q_1=Function.createDelegate(this,this.$6q_1);this.$$d_$8K_1=Function.createDelegate(this,this.$8K_1);this.$$d_$5T_1=Function.createDelegate(this,this.$5T_1);this.$$d_$4h_1=Function.createDelegate(this,this.$4h_1);CUI.Controls.Spinner.initializeBase(this,[a,b,c]);this.addDisplayMode("Medium");this.$3y_1=0;this.$3h_1=1;this.$2Q_1=d;this.$4q_1=e;this.$1P_1=parseFloat(this.get_$2_1().DefaultValue);this.get_stateProperties()["Value"]=this.$1P_1;this.$2i_1=null;this.get_stateProperties()["Text"]=null;this.$l_1=this.$9P_1(this.get_$2_1().DefaultUnit);if(CUI.ScriptUtility.isNullOrUndefined(this.$l_1))throw Error.create("The default unit is not in the list of valid units");this.get_stateProperties()["Unit"]=this.$l_1.$5E_0};CUI.Controls.Spinner.createUnit=function(a,b,c,d,e,f){return new CUI.Unit(a,b,c,d,e,f)};CUI.Controls.Spinner.$By=function(b,c){var a=Math.pow(10,c.$5i_0);return Math.round(b*a)/a};CUI.Controls.Spinner.prototype={$H_1:null,$F_1:null,$2F_1:null,$a_1:null,$Z_1:null,$4V_1:null,$3o_1:null,$41_1:null,$3S_1:null,$l_1:null,$2Q_1:null,$1P_1:0,$2i_1:null,$7k_1:false,$3y_1:0,$4o_1:0,$7U_1:0,$3h_1:0,$2g_1:0,$3m_1:0,$4r_1:null,$3O_1:false,$4q_1:null,createDOMElementForDisplayMode:function(a){switch(a){case "Medium":this.$H_1=CUI.Utility.$4("span");this.$H_1.className="ms-cui-spn";this.$H_1.setAttribute("mscui:controltype",this.get_$96_0());this.$F_1=CUI.Utility.$7s("input");this.$F_1.className="ms-cui-spn-txtbx";this.$F_1.id=this.$6_0;this.$F_1.setAttribute("role","textbox");CUI.Utility.$20(this.get_$2_1(),this.$F_1);CUI.Utility.$8e(this.$F_1,this.get_$2_1().ImeEnabled);this.$2F_1=CUI.Utility.$4("span");this.$2F_1.className="ms-cui-spn-arwbx";this.$a_1=CUI.Utility.$4("a");this.$a_1.className="ms-cui-spn-btnup";this.$a_1.setAttribute("role","spinbutton");this.$Z_1=CUI.Utility.$4("a");this.$Z_1.className="ms-cui-spn-btndown";this.$Z_1.setAttribute("role","spinbutton");this.$4V_1=CUI.Utility.$4("img");this.$4V_1.alt="";this.$3o_1=CUI.Utility.$m(2,1,this.$0_0.$7_1.ImageUpArrow,this.$0_0.$7_1.ImageUpArrowClass,this.$4V_1,true,false,this.$0_0.$7_1.ImageUpArrowTop,this.$0_0.$7_1.ImageUpArrowLeft);CUI.Utility.ensureCSSClassOnElement(this.$3o_1,"ms-cui-spn-imgcnt");if(!CUI.ScriptUtility.isNullOrUndefined(this.get_$2_1().AltUpArrow))this.$a_1.title=this.get_$2_1().AltUpArrow;this.$41_1=CUI.Utility.$4("img");this.$41_1.alt="";this.$3S_1=CUI.Utility.$m(2,1,this.$0_0.$7_1.ImageDownArrow,this.$0_0.$7_1.ImageDownArrowClass,this.$41_1,true,false,this.$0_0.$7_1.ImageDownArrowTop,this.$0_0.$7_1.ImageDownArrowLeft);CUI.Utility.ensureCSSClassOnElement(this.$3S_1,"ms-cui-spn-imgcnt");if(!CUI.ScriptUtility.isNullOrUndefined(this.get_$2_1().AltDownArrow))this.$Z_1.title=this.get_$2_1().AltDownArrow;this.$Ar_0(a);this.$H_1.appendChild(this.$F_1);this.$H_1.appendChild(this.$2F_1);this.$2F_1.appendChild(this.$a_1);this.$2F_1.appendChild(this.$Z_1);this.$a_1.appendChild(this.$3o_1);this.$Z_1.appendChild(this.$3S_1);return this.$H_1;default:this.ensureValidDisplayMode(a);return null}},$DQ_1:function(){a:;this.$DU_1(parseFloat(this.get_$2_1().DefaultValue));this.$4o_1=parseInt(this.get_$2_1().AccelerationInterval);this.$7U_1=parseInt(this.get_$2_1().MultiplierInterval);this.$4r_1=this.get_$2_1().Command},$Aq_0:function(a){var b=$get(this.$6_0+"-"+a);this.storeElementForDisplayMode(b,a);switch(a){case "Medium":this.$H_1=b;this.$F_1=this.$H_1.childNodes[0];this.$2F_1=this.$H_1.childNodes[1];this.$a_1=this.$2F_1.childNodes[0];this.$Z_1=this.$2F_1.childNodes[1];this.$3o_1=this.$a_1.childNodes[0];this.$3S_1=this.$Z_1.childNodes[0];this.$4V_1=this.$3o_1.childNodes[0];this.$41_1=this.$3S_1.childNodes[0]}},$Ar_0:function(a){switch(a){case "Medium":this.$X_1();this.$DQ_1()}},$X_1:function(){a:;$addHandler(this.$F_1,"focus",this.$$d_$4h_1);$addHandler(this.$F_1,"blur",this.$$d_$5T_1);$addHandler(this.$F_1,"change",this.$$d_$8K_1);$addHandler(this.$F_1,"mouseover",this.$$d_$6q_1);$addHandler(this.$F_1,"mouseout",this.$$d_$6t_1);$addHandler(this.$F_1,"keypress",this.$$d_$AA_1);$addHandler(this.$F_1,"keydown",this.$$d_$Cc_1);$addHandler(this.$F_1,"keyup",this.$$d_$Cf_1);$addHandler(this.$a_1,"mouseover",this.$$d_$Ca_1);$addHandler(this.$a_1,"mouseout",this.$$d_$D3_1);$addHandler(this.$a_1,"mousedown",this.$$d_$Cp_1);$addHandler(this.$a_1,"mouseup",this.$$d_$AE_1);$addHandler(this.$Z_1,"mouseover",this.$$d_$CZ_1);$addHandler(this.$Z_1,"mouseout",this.$$d_$D2_1);$addHandler(this.$Z_1,"mousedown",this.$$d_$Co_1);$addHandler(this.$Z_1,"mouseup",this.$$d_$AD_1)},get_$96_0:function(){a:;return "Spinner"},onEnabledChanged:function(a){CUI.Utility.setEnabledOnElement(this.$F_1,a)},$8c_0:function(){a:;if(!this.get_enabled())return false;this.$F_1.focus();return true},$4h_1:function(a){this.onBeginFocus();if(!this.get_enabled())return;this.$0_0.set_$q_1(this);this.$A3_1(a);CUI.Utility.$8V(this.$F_1)},$5T_1:function(a){this.onEndFocus();if(!this.get_enabled())return;this.$36_1&&this.$4m_1();this.$A3_1(a)},$3f_1:false,$A3_1:function(a){this.$3f_1=!this.$3f_1;if(this.$3f_1)this.$6q_1(a);else this.$6t_1(a)},$8K_1:function(){this.$g_0();if(!this.get_enabled())return;if(!this.$Di_1()){this.$5V_1();return}var a=1;this.get_stateProperties()["ChangeType"]="manual";this.get_stateProperties()["ChangedByMouse"]=false;this.get_displayedComponent().raiseCommandEvent(this.$4r_1,a,this.get_stateProperties())},$BI_0:function(){a:;this.$8K_1(null)},$6q_1:function(){if(!this.get_enabled())return;CUI.Utility.ensureCSSClassOnElement(this.$F_1,"ms-cui-spn-txtbx-hover");CUI.Utility.ensureCSSClassOnElement(this.$a_1,"ms-cui-spn-btnup-ctl-hover");CUI.Utility.ensureCSSClassOnElement(this.$Z_1,"ms-cui-spn-btndown-ctl-hover")},$6t_1:function(){if(!this.get_enabled())return;if(!this.$3f_1){CUI.Utility.removeCSSClassFromElement(this.$F_1,"ms-cui-spn-txtbx-hover");CUI.Utility.removeCSSClassFromElement(this.$a_1,"ms-cui-spn-btnup-ctl-hover");CUI.Utility.removeCSSClassFromElement(this.$Z_1,"ms-cui-spn-btndown-ctl-hover");CUI.Utility.removeCSSClassFromElement(this.$a_1,"ms-cui-spn-btnup-down");CUI.Utility.removeCSSClassFromElement(this.$Z_1,"ms-cui-spn-btndown-down")}},$Ca_1:function(a){if(!this.get_enabled())return;this.$6q_1(a);CUI.Utility.removeCSSClassFromElement(this.$a_1,"ms-cui-spn-btnup-ctl-hover");CUI.Utility.ensureCSSClassOnElement(this.$a_1,"ms-cui-spn-btnup-hover")},$D3_1:function(a){if(!this.get_enabled())return;!this.$36_1&&this.$AE_1(a);this.$6t_1(a);this.$3f_1&&CUI.Utility.ensureCSSClassOnElement(this.$a_1,"ms-cui-spn-btnup-ctl-hover");CUI.Utility.removeCSSClassFromElement(this.$a_1,"ms-cui-spn-btnup-hover")},$Cp_1:function(a){if(!this.get_enabled())return;this.$3O_1=true;if(a.button){this.$4m_1();return}this.$72_1(1);CUI.Utility.ensureCSSClassOnElement(this.$a_1,"ms-cui-spn-btnup-down")},$AE_1:function(){if(!this.get_enabled())return;this.$4m_1();this.$0_0.set_$q_1(this);CUI.Utility.removeCSSClassFromElement(this.$a_1,"ms-cui-spn-btnup-down")},$9z_1:function(b){if(!this.get_enabled())return;if(CUI.ScriptUtility.isNullOrUndefined(this.$2i_1))if(!this.$Dk_1(this.$l_1,this.$1P_1+b*this.$l_1.$6S_0))if(this.$1P_1<this.$l_1.$4K_0)this.$Dk_1(this.$l_1,this.$l_1.$4K_0);else{this.$5V_1();return}var a=9;this.get_stateProperties()["ChangeType"]="increase";this.get_stateProperties()["ChangedByMouse"]=this.$3O_1;this.get_displayedComponent().raiseCommandEvent(this.$4r_1,a,this.get_stateProperties())},$CZ_1:function(a){if(!this.get_enabled())return;this.$6q_1(a);CUI.Utility.removeCSSClassFromElement(this.$Z_1,"ms-cui-spn-btndown-ctl-hover");CUI.Utility.ensureCSSClassOnElement(this.$Z_1,"ms-cui-spn-btndown-hover")},$D2_1:function(a){if(!this.get_enabled())return;!this.$36_1&&this.$AD_1(a);this.$6t_1(a);this.$3f_1&&CUI.Utility.ensureCSSClassOnElement(this.$Z_1,"ms-cui-spn-btndown-ctl-hover");CUI.Utility.removeCSSClassFromElement(this.$Z_1,"ms-cui-spn-btndown-hover")},$Co_1:function(a){if(!this.get_enabled())return;this.$3O_1=true;if(a.button){this.$4m_1();return}this.$72_1(-1);CUI.Utility.ensureCSSClassOnElement(this.$Z_1,"ms-cui-spn-btndown-down")},$AD_1:function(){if(!this.get_enabled())return;this.$4m_1();this.$0_0.set_$q_1(this);CUI.Utility.removeCSSClassFromElement(this.$Z_1,"ms-cui-spn-btndown-down")},$9H_1:function(b){if(!this.get_enabled())return;if(CUI.ScriptUtility.isNullOrUndefined(this.$2i_1))if(!this.$Dk_1(this.$l_1,this.$1P_1-b*this.$l_1.$6S_0))if(this.$1P_1>this.$l_1.$4M_0)this.$Dk_1(this.$l_1,this.$l_1.$4M_0);else{this.$5V_1();return}var a=9;this.get_stateProperties()["ChangeType"]="decrease";this.get_stateProperties()["ChangedByMouse"]=this.$3O_1;this.get_displayedComponent().raiseCommandEvent(this.$4r_1,a,this.get_stateProperties())},$AA_1:function(a){if(!this.get_enabled())return;this.$3O_1=false;var b=a.rawEvent.keyCode;if(b===27)this.$5V_1();else if(b===13){this.$8K_1(a);a.preventDefault()}else return},$36_1:false,$Cc_1:function(b){if(!this.get_enabled())return;if(this.$36_1)return;this.$3O_1=false;var a=b.rawEvent.keyCode;if(a===38){this.$72_1(1);CUI.Utility.ensureCSSClassOnElement(this.$a_1,"ms-cui-spn-btnup-down")}else if(a===40){this.$72_1(-1);CUI.Utility.ensureCSSClassOnElement(this.$Z_1,"ms-cui-spn-btndown-down")}else return;this.$36_1=true},$Cf_1:function(){if(!this.get_enabled())return;if(!this.$36_1)return;this.$4m_1();CUI.Utility.removeCSSClassFromElement(this.$a_1,"ms-cui-spn-btnup-down");CUI.Utility.removeCSSClassFromElement(this.$Z_1,"ms-cui-spn-btndown-down");this.$36_1=false},$Ai_1:function(){a:;this.$3y_1++;this.$9z_1(this.$9e_1())},$Ah_1:function(){a:;this.$3y_1++;this.$9H_1(this.$9e_1())},$72_1:function(a){if(this.$2g_1>-1||this.$3m_1>-1)return;if(a===1)this.$9z_1(1);else this.$9H_1(1);if(a===1)this.$3m_1=window.setTimeout(this.$$d_$Db_1,500);else this.$3m_1=window.setTimeout(this.$$d_$Da_1,500)},$4m_1:function(){a:;if(this.$3m_1>-1){window.clearTimeout(this.$3m_1);this.$3m_1=-1}if(this.$2g_1>-1){window.clearInterval(this.$2g_1);this.$2g_1=-1;this.$3h_1=1;this.$3y_1=0}},$Db_1:function(){a:;if(this.$2g_1!==-1)return;this.$2g_1=window.setInterval(this.$$d_$Ai_1,this.$4o_1)},$Da_1:function(){a:;if(this.$2g_1!==-1)return;this.$2g_1=window.setInterval(this.$$d_$Ah_1,this.$4o_1)},$9e_1:function(){a:;var a=this.$3y_1*this.$4o_1;if(a>=this.$3h_1*this.$7U_1&&this.$3h_1<=3)this.$3h_1++;return this.$3h_1},$DU_1:function(a){this.$1P_1=a;this.$2i_1=null;this.$F_1.value=this.$9Q_1(a,this.$l_1.get_$6a_0());this.get_stateProperties()["Value"]=this.$1P_1;this.get_stateProperties()["Text"]=null},$Ab_1:function(a){if(a!==this.$2i_1){this.$2i_1=a;this.$F_1.value=a;this.get_stateProperties()["Text"]=a}},get_value:function(){a:;return this.$1P_1},set_value:function(a){if(!this.$Dk_1(this.$l_1,a))throw Error.create("Invalid value");return a},get_unitString:function(){a:;return this.$l_1.get_$6a_0()},set_unitString:function(a){if(!this.$Ag_1(this.$1P_1.toString()+a)){this.$5V_1();throw Error.create("Invalid unit")}return a},$7H_1:false,$7G_1:false,get_$8H_1:function(){a:;if(!this.$7H_1){this.$7G_1=this.$0_0._decimalSeparator===",";this.$7H_1=true}return this.$7G_1},$Di_1:function(){a:;var a=this.$F_1.value;return this.$Ag_1(a)},$Ag_1:function(b){if(this.$Dl_1(b))return true;var i="(\\-)?[0-9]*[\\.,]?[0-9]+",e=new RegExp(i);b=b.trim();if(b.search(e)<0)return false;var f=b.replace(e,""),a=b.replace(f,""),d=f.trim(),c,g,h=false;if(this.get_$8H_1()){a=a.replace(".","");if(a.indexOf(",")>-1){h=true;a=a.replace(",",".")}}else a=a.replace(",","");g=parseFloat(a);if(!CUI.ScriptUtility.isNullOrEmptyString(d))if(this.$l_1.$7q_0(d))c=this.$l_1;else c=this.$Bx_1(d);else c=this.$l_1;return this.$Dk_1(c,g,h)},$Dl_1:function(c){if(!CUI.Utility.$u(this.get_$2_1().TextEnabled))return false;for(var b=-1,a=0;a<this.$4q_1.length;a++)if(this.$4q_1[a].toLowerCase()===c.toLowerCase()){b=a;break}if(b!==-1){this.$Ab_1(this.$4q_1[b]);return true}return false},$Dk_1:function(a,b,d){if(!a)return false;var c=a.$Dj_0(b);if(c===-1)return false;else if(c===1)b=CUI.Controls.Spinner.$By(b,a);else if(c===2)b=a.$4M_0;else if(c===3)b=a.$4K_0;if(arguments.length<3)d=this.get_$8H_1();this.$7k_1=d;if(b!==this.$1P_1||a!==this.$l_1){this.$F_1.value=this.$9Q_1(b,a.get_$6a_0(),d);this.$l_1=a;this.get_stateProperties()["Unit"]=a.$5E_0;this.$1P_1=b;this.get_stateProperties()["Value"]=b}this.$2i_1=null;this.get_stateProperties()["Text"]=null;return true},$5V_1:function(){a:;this.$F_1.value=this.$2i_1||this.$9Q_1(this.$1P_1,this.$l_1.get_$6a_0(),this.$7k_1)},$7e_1:false,$7f_1:false,$5J_1:false,$9Q_1:function(e,b,d){if(arguments.length<3)d=this.get_$8H_1();var a=e.toString();if(d)a=a.replace(".",",");var c;if(!this.$7f_1){this.$7e_1=CUI.Utility.$DX(this.$0_0._percentPositivePattern);this.$7f_1=true;this.$5J_1=CUI.Utility.$DV(this.$0_0._percentPositivePattern)}if(b==="%")if(this.$7e_1)if(this.$5J_1)c=b+a;else c=b+" "+a;else if(this.$5J_1)c=a+b;else c=a+" "+b;else if(b==="%")if(this.$5J_1)c=a+" "+b;else c=a+b;else c=a+" "+b;return c},$Bx_1:function(b){for(var a=0;a<this.$2Q_1.length;a++)if(this.$2Q_1[a].$7q_0(b))return this.$2Q_1[a];return null},$9P_1:function(b){for(var a=0;a<this.$2Q_1.length;a++){if(this.$2Q_1[a].$5E_0===b)return this.$2Q_1[a];if(this.$2Q_1[a].$7q_0(b))return this.$2Q_1[a]}return null},$AK_0:function(){a:;if(CUI.ScriptUtility.isNullOrUndefined(this.$H_1))return;var c=this.pollForStateAndUpdateInternal(this.get_$2_1().Command,this.get_$2_1().QueryCommand,this.get_stateProperties(),true);if((c&2)>0){var d=!CUI.ScriptUtility.isNullOrUndefined(this.get_stateProperties()["Text"]);if(d){var g=this.get_stateProperties()["Text"];this.$Ab_1(g)}else{var h=this.$9P_1(this.get_stateProperties()["Unit"]);if(!this.$Dk_1(h,this.get_stateProperties()["Value"]))throw Error.create("Invalid value and/or unit returned when polling")}var e=this.$a_1.title,a=CUI.Utility.$3L(this.get_stateProperties()["AltUpArrow"],this.get_$2_1().AltUpArrow);if(a!==e)this.$a_1.title=a;var f=this.$Z_1.title,b=CUI.Utility.$3L(this.get_stateProperties()["AltDownArrow"],this.get_$2_1().AltDownArrow);if(b!==f)this.$Z_1.title=b}},dispose:function(){a:;CUI.Control.prototype.dispose.call(this);this.$41_1=null;this.$3S_1=null;this.$4V_1=null;this.$3o_1=null;this.$H_1=null;this.$2F_1=null;this.$Z_1=null;this.$F_1=null;this.$a_1=null},get_$2_1:function(){a:;return this.$7_0}};CUI.Controls.SplitButtonCommandProperties=function(){};CUI.Controls.SplitButton=function(a,b,c,d){this.$$d_onMenuButtonKeyPress=Function.createDelegate(this,this.onMenuButtonKeyPress);this.$$d_onMenuButtonABlur=Function.createDelegate(this,this.onMenuButtonABlur);this.$$d_onMenuButtonKeyboardFocus=Function.createDelegate(this,this.onMenuButtonKeyboardFocus);this.$$d_onMenuButtonBlur=Function.createDelegate(this,this.onMenuButtonBlur);this.$$d_onMenuButtonFocus=Function.createDelegate(this,this.onMenuButtonFocus);this.$$d_onMenuButtonClick=Function.createDelegate(this,this.onMenuButtonClick);this.$$d_onButtonKeyboardFocus=Function.createDelegate(this,this.onButtonKeyboardFocus);this.$$d_onButtonBlur=Function.createDelegate(this,this.onButtonBlur);this.$$d_onButtonFocus=Function.createDelegate(this,this.onButtonFocus);this.$$d_onMouseOut=Function.createDelegate(this,this.onMouseOut);this.$$d_onMouseOver=Function.createDelegate(this,this.onMouseOver);this.$$d_onDblClick=Function.createDelegate(this,this.onDblClick);this.$$d_onButtonClick=Function.createDelegate(this,this.onButtonClick);CUI.Controls.SplitButton.initializeBase(this,[a,b,c,d]);this.addDisplayMode("Large");this.addDisplayMode("Medium");this.addDisplayMode("Small");this.set_on(false)};CUI.Controls.SplitButton.prototype={$G_2:null,$44_2:null,$2H_2:null,$45_2:null,$A_2:null,$46_2:null,$2I_2:null,$47_2:null,$B_2:null,$4C_2:null,$2K_2:null,$4D_2:null,createDOMElementForDisplayMode:function(a){var b=CUI.ScriptUtility.isNullOrUndefined(this.get_$2_2().Alt)?this.get_$2_2().LabelText:this.get_$2_2().Alt,c=CUI.ScriptUtility.isNullOrUndefined(this.get_$2_2().MenuAlt)?b:this.get_$2_2().MenuAlt;if(CUI.ScriptUtility.isNullOrUndefined(b))b="";if(CUI.ScriptUtility.isNullOrUndefined(c))c="";switch(a){case "Large":this.$G_2=CUI.Control.createTwoAnchorControlDOMElementCore(this,this.$0_0,"Large",this.get_$2_2().Id,this.get_$2_2().Image32by32,this.get_$2_2().Image32by32Class,this.get_$2_2().Image32by32Top,this.get_$2_2().Image32by32Left,this.get_$2_2().Image16by16,this.get_$2_2().Image16by16Class,this.get_$2_2().Image16by16Top,this.get_$2_2().Image16by16Left,this.get_$2_2().LabelText,this.get_$2_2().Alt,this.get_$2_2().ToolTipTitle,true);this.$Aq_0("Large");this.$Ar_0(a);return this.$G_2;case "Medium":this.$A_2=CUI.Control.createTwoAnchorControlDOMElementCore(this,this.$0_0,"Medium",this.get_$2_2().Id,this.get_$2_2().Image32by32,this.get_$2_2().Image32by32Class,this.get_$2_2().Image32by32Top,this.get_$2_2().Image32by32Left,this.get_$2_2().Image16by16,this.get_$2_2().Image16by16Class,this.get_$2_2().Image16by16Top,this.get_$2_2().Image16by16Left,this.get_$2_2().LabelText,this.get_$2_2().Alt,this.get_$2_2().ToolTipTitle,true);this.$Aq_0("Medium");this.$Ar_0(a);return this.$A_2;case "Small":this.$B_2=CUI.Control.createTwoAnchorControlDOMElementCore(this,this.$0_0,"Small",this.get_$2_2().Id,this.get_$2_2().Image32by32,this.get_$2_2().Image32by32Class,this.get_$2_2().Image32by32Top,this.get_$2_2().Image32by32Left,this.get_$2_2().Image16by16,this.get_$2_2().Image16by16Class,this.get_$2_2().Image16by16Top,this.get_$2_2().Image16by16Left,this.get_$2_2().LabelText,this.get_$2_2().Alt,this.get_$2_2().ToolTipTitle,true);this.$Aq_0("Small");this.$Ar_0(a);return this.$B_2;default:this.ensureValidDisplayMode(a);return null}},$Aq_0:function(e){var a=$get(this.$6_0+"-"+e);this.storeElementForDisplayMode(a,e);if(CUI.ScriptUtility.isNullOrUndefined(a))switch(e){case "Large":a=this.$G_2;break;case "Medium":a=this.$A_2;break;case "Small":a=this.$B_2}if(CUI.ScriptUtility.isNullOrUndefined(a))return;var b=a.firstChild;if(CUI.ScriptUtility.isNullOrUndefined(b))return;for(var c=b,g=0;g<3;g++){c=c.firstChild;if(CUI.ScriptUtility.isNullOrUndefined(c))return}var f=c,d=a.childNodes[1];if(CUI.ScriptUtility.isNullOrUndefined(d))return;switch(e){case "Large":this.$G_2=a;this.$44_2=b;this.$2H_2=f;this.$45_2=d;break;case "Medium":this.$A_2=a;this.$46_2=b;this.$2I_2=f;this.$47_2=d;break;case "Small":this.$B_2=a;this.$4C_2=b;this.$2K_2=f;this.$4D_2=d}},$Ar_0:function(a){this.$X_2(a)},$X_2:function(c){var a=null,b=null;switch(c){case "Large":a=this.$44_2;b=this.$45_2;break;case "Medium":a=this.$46_2;b=this.$47_2;break;case "Small":a=this.$4C_2;b=this.$4D_2}$addHandler(a,"click",this.$$d_onButtonClick);$addHandler(a,"dblclick",this.$$d_onDblClick);$addHandler(a,"mouseover",this.$$d_onMouseOver);$addHandler(a,"mouseout",this.$$d_onMouseOut);$addHandler(a,"mouseover",this.$$d_onButtonFocus);$addHandler(a,"mouseout",this.$$d_onButtonBlur);$addHandler(a,"focus",this.$$d_onButtonKeyboardFocus);$addHandler(a,"blur",this.$$d_onButtonBlur);$addHandler(b,"click",this.$$d_onMenuButtonClick);$addHandler(b,"mouseover",this.$$d_onMenuButtonFocus);$addHandler(b,"mouseout",this.$$d_onMenuButtonBlur);$addHandler(b,"focus",this.$$d_onMenuButtonKeyboardFocus);$addHandler(b,"blur",this.$$d_onMenuButtonABlur);$addHandler(b,"keypress",this.$$d_onMenuButtonKeyPress)},$4c_2:false,$8c_0:function(){a:;if(!this.get_enabled())return false;var a=this.get_displayedComponent().get_$3_0();if(!CUI.ScriptUtility.isNullOrUndefined(a)){if(this.$4c_2||!this.$1J_2)a=a.childNodes[1];else a=a.childNodes[0];a.focus();return true}return false},onEnabledChanged:function(a){this.onEnabledChangedForControl(a);this.onEnabledChangedForButton(a);this.onEnabledChangedForMenu(a);this.$2q_2(this.get_on()&&a)},onStateChanged:function(){a:;this.$2q_2(this.get_on()&&this.get_enabled())},get_$96_0:function(){a:;return "SplitButton"},get_on:function(){a:;return this.get_stateProperties()["On"]&&this.get_$2_2().ToggleButtonState},set_on:function(a){this.get_stateProperties()["On"]=a&&this.get_$2_2().ToggleButtonState;this.$2q_2(a&&this.get_enabled()&&this.get_$2_2().ToggleButtonState);return a},$2q_2:function(a){CUI.Utility.toggleCSSClassOnElement(this.$44_2,"ms-cui-ctl-on",a);CUI.Utility.toggleCSSClassOnElement(this.$46_2,"ms-cui-ctl-on",a);CUI.Utility.toggleCSSClassOnElement(this.$4C_2,"ms-cui-ctl-on",a)},onEnabledChangedForControl:function(a){if(a){CUI.Utility.removeCSSClassFromElement(this.$G_2,"ms-cui-disabled");CUI.Utility.removeCSSClassFromElement(this.$A_2,"ms-cui-disabled");CUI.Utility.removeCSSClassFromElement(this.$B_2,"ms-cui-disabled")}else{CUI.Utility.ensureCSSClassOnElement(this.$G_2,"ms-cui-disabled");CUI.Utility.ensureCSSClassOnElement(this.$A_2,"ms-cui-disabled");CUI.Utility.ensureCSSClassOnElement(this.$B_2,"ms-cui-disabled")}},$24_2:true,onEnabledChangedForMenu:function(a){CUI.Utility.setEnabledOnElement(this.$45_2,a);CUI.Utility.setEnabledOnElement(this.$47_2,a);CUI.Utility.setEnabledOnElement(this.$4D_2,a);this.$8S_2();this.$24_2=a},$DT_2:function(a){CUI.Utility.setEnabledOnElement(this.$45_2,a);CUI.Utility.setEnabledOnElement(this.$47_2,a);CUI.Utility.setEnabledOnElement(this.$4D_2,a)},$1J_2:false,onEnabledChangedForButton:function(a){CUI.Utility.setEnabledOnElement(this.$44_2,a);CUI.Utility.setEnabledOnElement(this.$46_2,a);CUI.Utility.setEnabledOnElement(this.$4C_2,a);this.$8R_2();this.$1J_2=a},onButtonClick:function(b){b.preventDefault();this.$g_0();if(!this.get_enabled()||!this.$1J_2)return;this.$0_0.set_$4f_1(this);this.$4c_2=false;this.set_on(!this.get_on());var a=this.get_stateProperties();a["CommandValueId"]=this.get_$2_2().CommandValueId;this.get_displayedComponent().raiseCommandEvent(this.get_$2_2().Command,1,a)},onDblClick:function(a){a.preventDefault();this.$g_0();if(!this.get_enabled())return;this.onButtonClick(a)},onMouseOver:function(){this.onBeginFocus();if(!this.get_enabled()||!this.$1J_2)return;if(CUI.ScriptUtility.isNullOrUndefined(this.get_$2_2().CommandPreview))return;var a=this.get_stateProperties();a["CommandValueId"]=this.get_$2_2().CommandValueId;this.get_displayedComponent().raiseCommandEvent(this.get_$2_2().CommandPreview,5,a)},onButtonKeyboardFocus:function(a){this.$0_0.set_$q_1(this);this.$4c_2=false;this.onButtonFocus(a)},onButtonFocus:function(){this.onBeginFocus();if(!this.get_enabled()||!this.$1J_2)return;this.$CL_2()},onMouseOut:function(){this.onEndFocus();if(!this.get_enabled())return;if(CUI.ScriptUtility.isNullOrUndefined(this.get_$2_2().CommandRevert))return;var a=this.get_stateProperties();a["CommandValueId"]=this.get_$2_2().CommandValueId;this.get_displayedComponent().raiseCommandEvent(this.get_$2_2().CommandRevert,6,a)},onButtonBlur:function(){this.onEndFocus();if(!this.get_enabled()||!this.$1J_2)return;this.$8R_2()},onMenuButtonClick:function(a){a.preventDefault();this.$g_0();if(!this.get_enabled()||!this.$24_2)return;this.$0_0.$34_1=false;this.$0_0.set_$4f_1(this);this.$4c_2=true;var b=a.target;this.launchMenu(b);this.get_displayedComponent().raiseCommandEvent(this.get_$2_2().CommandMenuOpen,4,null)},onMenuButtonKeyboardFocus:function(a){this.onMenuButtonFocus(a);this.$4c_2=true;this.$0_0.set_$q_1(this)},onMenuButtonFocus:function(){this.onBeginFocus();if(!this.get_enabled()||!this.$24_2)return;this.$CM_2()},onMenuButtonBlur:function(){this.onEndFocus();if(!this.get_enabled()||this.$k_1||!this.$24_2)return;this.$8S_2()},onMenuButtonABlur:function(a){this.onEndFocus();if(!this.get_enabled()||!this.$24_2)return;this.onMenuButtonBlur(a)},onMenuButtonKeyPress:function(a){this.$g_0();if(!this.get_enabled()||!this.$24_2)return;if(a.rawEvent.keyCode===13)this.$16_1=true},onLaunchedMenuClosed:function(){a:;this.$g_0();this.$1d_2();this.get_displayedComponent().raiseCommandEvent(this.get_$2_2().CommandMenuClose,10,null);CUI.MenuLauncher.prototype.onLaunchedMenuClosed.call(this)},$1d_2:function(){a:;this.$8R_2();this.$8S_2()},$8R_2:function(){a:;var a=this.$6h_0();if(CUI.ScriptUtility.isNullOrUndefined(a))return;CUI.Utility.removeCSSClassFromElement(a.childNodes[0],"ms-cui-ctl-light-hoveredOver");CUI.Utility.removeCSSClassFromElement(a.childNodes[1],"ms-cui-ctl-split-hover")},$CL_2:function(){a:;var a=this.$6h_0();if(CUI.ScriptUtility.isNullOrUndefined(a))return;CUI.Utility.ensureCSSClassOnElement(a.childNodes[0],"ms-cui-ctl-light-hoveredOver");CUI.Utility.ensureCSSClassOnElement(a.childNodes[1],"ms-cui-ctl-split-hover")},$8S_2:function(){a:;var a=this.$6h_0();if(CUI.ScriptUtility.isNullOrUndefined(a))return;CUI.Utility.removeCSSClassFromElement(a.childNodes[0],"ms-cui-ctl-split-hover");CUI.Utility.removeCSSClassFromElement(a.childNodes[1],"ms-cui-ctl-light-hoveredOver")},$CM_2:function(){a:;var a=this.$6h_0();if(CUI.ScriptUtility.isNullOrUndefined(a))return;CUI.Utility.ensureCSSClassOnElement(a.childNodes[0],"ms-cui-ctl-split-hover");CUI.Utility.ensureCSSClassOnElement(a.childNodes[1],"ms-cui-ctl-light-hoveredOver")},$AK_0:function(){a:;var c=this.$0_0.$3x_1(this.get_$2_2().Command,this.get_$2_2().QueryCommand,this.get_stateProperties(),true),a=(c&1)>0,b=true;if(!CUI.ScriptUtility.isNullOrUndefined(this.get_$2_2().CommandMenuOpen)){var f=this.$0_0.$3x_1(this.get_$2_2().CommandMenuOpen,null,null,false);b=(f&1)>0}else b=a;if(b!==this.$24_2||a!==this.$1J_2){this.$1Y_0=b||a;var g=this.$24_2&&this.$1J_2,d=b&&a;g!==d&&this.onEnabledChangedForControl(d);this.$DT_2(this.$1Y_0);a!==this.$1J_2&&this.onEnabledChangedForButton(a);b!==this.$24_2&&this.onEnabledChangedForMenu(b);this.$24_2=b;this.$1J_2=a}if((c&2)>0){var h=CUI.Utility.$3L(this.get_stateProperties()["Image32by32Class"],this.get_$2_2().Image32by32Class),e=CUI.Utility.$3L(this.get_stateProperties()["Image16by16Class"],this.get_$2_2().Image16by16Class);CUI.Utility.$2R(this.$2H_2,h);CUI.Utility.$2R(this.$2I_2,e);CUI.Utility.$2R(this.$2K_2,e)}this.$2q_2(this.get_on()&&a)},dispose:function(){a:;CUI.MenuLauncher.prototype.dispose.call(this);this.$G_2=null;this.$44_2=null;this.$2H_2=null;this.$45_2=null;this.$A_2=null;this.$46_2=null;this.$2I_2=null;this.$47_2=null;this.$B_2=null;this.$4C_2=null;this.$2K_2=null;this.$4D_2=null},get_$2_2:function(){a:;return this.$7_0}};CUI.Controls.TextBoxCommandProperties=function(){};CUI.Controls.TextBox=function(a,b,c){this.$$d_$AA_1=Function.createDelegate(this,this.$AA_1);this.$$d_$6r_1=Function.createDelegate(this,this.$6r_1);this.$$d_$6s_1=Function.createDelegate(this,this.$6s_1);this.$$d_$5T_1=Function.createDelegate(this,this.$5T_1);this.$$d_$4h_1=Function.createDelegate(this,this.$4h_1);this.$$d_$8J_1=Function.createDelegate(this,this.$8J_1);CUI.Controls.TextBox.initializeBase(this,[a,b,c]);this.addDisplayMode("Medium")};CUI.Controls.TextBox.prototype={$F_1:null,get_value:function(){a:;this.$7v_1();return this.$F_1.value},set_value:function(a){this.$7v_1();if(a)this.$F_1.value=a;else this.$F_1.value="";return a},$7v_1:function(){a:;if(!this.$F_1){this.$F_1=CUI.Utility.$7s("input");this.$F_1.type="text";CUI.Utility.$8e(this.$F_1,this.get_$2_1().ImeEnabled)}},createDOMElementForDisplayMode:function(b){switch(b){case "Medium":this.$7v_1();this.$F_1.id=this.$6_0;this.$F_1.setAttribute("mscui:controltype",this.get_$96_0());this.$F_1.setAttribute("role",this.get_$2k_0());CUI.Utility.$20(this.get_$2_1(),this.$F_1);this.$F_1.className="ms-cui-tb";if(!CUI.ScriptUtility.isNullOrEmptyString(this.get_$2_1().MaxLength)){var a=parseInt(this.get_$2_1().MaxLength);a!==Number.NaN&&this.$F_1.setAttribute("maxlength",a)}if(CUI.Utility.$u(this.get_$2_1().ShowAsLabel)){CUI.Utility.ensureCSSClassOnElement(this.$F_1,"ms-cui-tb-labelmode");this.$F_1.disabled=true}if(!CUI.ScriptUtility.isNullOrUndefined(this.get_$2_1().Width))this.$F_1.style.width=this.get_$2_1().Width;this.$X_1();return this.$F_1;default:this.ensureValidDisplayMode(b);return null}},$Aq_0:function(b){var a=$get(this.$6_0);this.storeElementForDisplayMode(a,b);switch(b){case "Medium":this.$F_1=a}},$Ar_0:function(){this.$X_1()},$X_1:function(){a:;$addHandler(this.$F_1,"change",this.$$d_$8J_1);$addHandler(this.$F_1,"focus",this.$$d_$4h_1);$addHandler(this.$F_1,"blur",this.$$d_$5T_1);$addHandler(this.$F_1,"mouseup",CUI.Utility.get_returnFalseHandler());$addHandler(this.$F_1,"mouseover",this.$$d_$6s_1);$addHandler(this.$F_1,"mouseout",this.$$d_$6r_1);$addHandler(this.$F_1,"keypress",this.$$d_$AA_1)},onEnabledChanged:function(a){if(a)CUI.Utility.enableElement(this.$F_1);else CUI.Utility.disableElement(this.$F_1)},get_$96_0:function(){a:;return "TextBox"},get_$2k_0:function(){a:;return "textbox"},$8J_1:function(){this.$g_0();if(!this.get_enabled())return;this.get_stateProperties()["Value"]=this.get_value();this.get_displayedComponent().raiseCommandEvent(this.get_$2_1().Command,1,this.get_stateProperties());if(this.$0_0.get_$5U_1())this.$AK_0();else this.$2q_1(null)},$BI_0:function(){a:;this.$8J_1(null)},$2q_1:function(a){if(!CUI.ScriptUtility.isNullOrUndefined(this.$F_1))!CUI.ScriptUtility.isNullOrUndefined(a)&&this.set_value(a)},$8c_0:function(){a:;if(!this.get_enabled())return false;this.$F_1.focus();return true},$4h_1:function(){this.onBeginFocus();if(!this.get_enabled())return;CUI.Utility.$8V(this.$F_1);this.$0_0.set_$q_1(this)},$5T_1:function(){this.onEndFocus();if(!this.get_enabled())return},$6s_1:function(){this.onBeginFocus();if(!this.get_enabled())return;if(CUI.ScriptUtility.isNullOrUndefined(this.get_$2_1().CommandPreview))return;this.get_displayedComponent().raiseCommandEvent(this.get_$2_1().CommandPreview,5,this.get_stateProperties())},$6r_1:function(){this.onEndFocus();if(!this.get_enabled())return;if(CUI.ScriptUtility.isNullOrUndefined(this.get_$2_1().CommandRevert))return;this.get_displayedComponent().raiseCommandEvent(this.get_$2_1().CommandRevert,6,this.get_stateProperties())},$AA_1:function(a){if(!CUI.ScriptUtility.isNullOrUndefined(a)&&!CUI.ScriptUtility.isNullOrUndefined(a.rawEvent)){var b=a.rawEvent.keyCode;if(!this.get_enabled()&&b!==9){a.preventDefault();return}if(b===13){this.$8J_1(a);a.preventDefault()}}},$AK_0:function(){a:;var a=this.pollForStateAndUpdateInternal(this.get_$2_1().Command,this.get_$2_1().QueryCommand,this.get_stateProperties(),false);(a&2)>0&&this.$2q_1(this.get_stateProperties()["Value"])},dispose:function(){a:;CUI.Control.prototype.dispose.call(this);this.$F_1=null},get_$2_1:function(){a:;return this.$7_0}};CUI.Controls.ToggleButtonCommandProperties=function(){};CUI.Controls.ToggleButton=function(b,a,c){this.$$d_$Cb_1=Function.createDelegate(this,this.$Cb_1);this.$$d_$6r_1=Function.createDelegate(this,this.$6r_1);this.$$d_$6s_1=Function.createDelegate(this,this.$6s_1);this.$$d_onClick=Function.createDelegate(this,this.onClick);this.$$d_$5T_1=Function.createDelegate(this,this.$5T_1);this.$$d_$4h_1=Function.createDelegate(this,this.$4h_1);CUI.Controls.ToggleButton.initializeBase(this,[b,a,c]);this._id=a;this.addDisplayModes();this.get_stateProperties()["On"]=false};CUI.Controls.ToggleButton.prototype={_id:null,$G_1:null,$1r_1:null,$r_1:null,$B_1:null,$A_1:null,$h_1:null,$1X_1:null,$23_1:null,$1e_1:null,$1K_1:null,get_on:function(){a:;return this.get_stateProperties()["On"]},set_on:function(a){this.get_stateProperties()["On"]=a;this.setState(a);return a},createComponentForDisplayModeInternal:function(a){var b;if(a.startsWith("Menu")){b=this.$0_0.$4b_1(this.$6_0+"-"+a+this.$0_0.$2U_1(),a,this);this.$1r_1=this.get_$2_1().MenuItemId;this.$r_1=this.get_$2_1().CommandValueId;if(CUI.ScriptUtility.isNullOrEmptyString(this.$r_1))this.$r_1=this.$1r_1}else b=CUI.Control.prototype.createComponentForDisplayModeInternal.call(this,a);return b},createDOMElementForDisplayMode:function(a){return this.$3F_1(a,true)},$3F_1:function(b,a){switch(b){case "Large":this.$G_1=CUI.Control.createStandardControlDOMElement(this,this.$0_0,"Large",this.get_$2_1(),false,false);this.$Aq_0("Large");a&&this.$Ar_0("Large");return this.$G_1;case "Medium":this.$A_1=CUI.Control.createStandardControlDOMElement(this,this.$0_0,"Medium",this.get_$2_1(),false,false);this.$Aq_0("Medium");a&&this.$Ar_0("Medium");return this.$A_1;case "Small":this.$B_1=CUI.Control.createStandardControlDOMElement(this,this.$0_0,"Small",this.get_$2_1(),false,false);this.$Aq_0("Small");a&&this.$Ar_0("Small");return this.$B_1;case "Menu":this.$h_1=CUI.Control.createStandardControlDOMElement(this,this.$0_0,"Menu",this.get_$2_1(),true,false);a&&this.$Ar_0("Menu");return this.$h_1;case "Menu16":this.$1X_1=CUI.Control.createStandardControlDOMElement(this,this.$0_0,"Menu16",this.get_$2_1(),true,false);a&&this.$Ar_0("Menu16");return this.$1X_1;case "Menu32":this.$23_1=CUI.Control.createStandardControlDOMElement(this,this.$0_0,"Menu32",this.get_$2_1(),true,false);a&&this.$Ar_0("Menu32");return this.$23_1;default:this.ensureValidDisplayMode(b);return null}},$Aq_0:function(b){var a=$get(this.$6_0+"-"+b);this.storeElementForDisplayMode(a,b);switch(b){case "Large":if(!CUI.ScriptUtility.isNullOrUndefined(a))this.$G_1=a;break;case "Medium":if(!CUI.ScriptUtility.isNullOrUndefined(a))this.$A_1=a;break;case "Small":if(!CUI.ScriptUtility.isNullOrUndefined(a))this.$B_1=a}},$Ar_0:function(a){switch(a){case "Large":this.$X_1(this.$G_1,true);break;case "Medium":this.$X_1(this.$A_1,true);break;case "Small":this.$X_1(this.$B_1,true);break;case "Menu32":this.$X_1(this.$23_1,false);break;case "Menu16":this.$X_1(this.$1X_1,false);break;case "Menu":this.$X_1(this.$h_1,false)}},$X_1:function(a,b){if(b){$addHandler(a,"mouseover",this.$$d_$4h_1);$addHandler(a,"mouseout",this.$$d_$5T_1)}$addHandler(a,"click",this.$$d_onClick);$addHandler(a,"mouseover",this.$$d_$6s_1);$addHandler(a,"mouseout",this.$$d_$6r_1);$addHandler(a,"focus",this.$$d_$Cb_1);$addHandler(a,"blur",this.$$d_$5T_1)},$8c_0:function(){a:;if(!this.get_enabled())return false;var a=this.get_displayedComponent().get_$3_0();a.focus();return true},onEnabledChanged:function(a){CUI.Utility.setEnabledOnElement(this.$B_1,a);CUI.Utility.setEnabledOnElement(this.$A_1,a);CUI.Utility.setEnabledOnElement(this.$G_1,a);CUI.Utility.setEnabledOnElement(this.$h_1,a);CUI.Utility.setEnabledOnElement(this.$1X_1,a);CUI.Utility.setEnabledOnElement(this.$23_1,a);if(this.get_on())if(a)this.setState(true);else this.setState(false)},get_$96_0:function(){a:;return "ToggleButton"},onStateChanged:function(){a:;this.setState(this.get_stateProperties()["On"])},getDropDownDOMElementForDisplayMode:function(b){var a;switch(b){case "Menu16":a=this.$1e_1;break;case "Text":a=this.$1K_1;break;default:a=CUI.Utility.$4("span")}if(a)return a;return this.$9A_1(b)},$9A_1:function(b){switch(b){case "Menu":this.$1e_1=this.$3F_1("Menu",false).cloneNode(true);return this.$1e_1;case "Menu16":this.$1e_1=this.$3F_1("Menu16",false).cloneNode(true);return this.$1e_1;case "Text":var a=CUI.Utility.$4("a");CUI.Utility.$29(a);this.$1K_1=CUI.Utility.$4("span");this.$1K_1.className="ms-cui-textmenuitem";CUI.UIUtility.setInnerText(a,this.get_$2_1().LabelText);this.$1K_1.appendChild(a);return this.$1K_1;default:return CUI.Utility.$4("span")}},deselect:function(){},getMenuItemId:function(){a:;return this.$1r_1},getCommandValueId:function(){a:;return this.$r_1},focusOnDisplayedComponent:function(){a:;this.receiveFocus()},getTextValue:function(){a:;return this.get_$2_1().LabelText},receiveFocus:function(){a:;this.onBeginFocus();var a=this.get_displayedComponent();if(CUI.ScriptUtility.isNullOrUndefined(a))return;a.set_$1H_2(true);!CUI.ScriptUtility.isNullOrUndefined(this.$h_1)&&this.$h_1.focus();!CUI.ScriptUtility.isNullOrUndefined(this.$1X_1)&&this.$1X_1.focus()},onMenuClosed:function(){a:;this.$g_0()},onClick:function(c){!CUI.ScriptUtility.isNullOrUndefined(CUI.PMetrics)&&CUI.PMetrics.perfMark(7704);this.$g_0();c.preventDefault();if(!this.get_enabled())return;this.$0_0.set_$4f_1(this);var a=1,b=this.get_$2_1().CommandType;if(!CUI.ScriptUtility.isNullOrUndefined(b)&&b==="OptionSelection"){a=3;this.get_stateProperties()["CommandValueId"]=this.$r_1}this.get_stateProperties()["On"]=!this.get_stateProperties()["On"];this.get_displayedComponent().raiseCommandEvent(this.get_$2_1().Command,a,this.get_stateProperties());if(this.$0_0.get_$5U_1())this.$AK_0();else this.setState(this.get_stateProperties()["On"]);!CUI.ScriptUtility.isNullOrUndefined(CUI.PMetrics)&&CUI.PMetrics.perfMark(7705)},setState:function(a){if(!CUI.ScriptUtility.isNullOrUndefined(this.$B_1))if(a)CUI.Utility.ensureCSSClassOnElement(this.$B_1,"ms-cui-ctl-on");else CUI.Utility.removeCSSClassFromElement(this.$B_1,"ms-cui-ctl-on");if(!CUI.ScriptUtility.isNullOrUndefined(this.$A_1))if(a)CUI.Utility.ensureCSSClassOnElement(this.$A_1,"ms-cui-ctl-on");else CUI.Utility.removeCSSClassFromElement(this.$A_1,"ms-cui-ctl-on");if(!CUI.ScriptUtility.isNullOrUndefined(this.$G_1))if(a)CUI.Utility.ensureCSSClassOnElement(this.$G_1,"ms-cui-ctl-on");else CUI.Utility.removeCSSClassFromElement(this.$G_1,"ms-cui-ctl-on");if(!CUI.ScriptUtility.isNullOrUndefined(this.$23_1))if(a)CUI.Utility.ensureCSSClassOnElement(this.$23_1,"ms-cui-ctl-on");else CUI.Utility.removeCSSClassFromElement(this.$23_1,"ms-cui-ctl-on");if(!CUI.ScriptUtility.isNullOrUndefined(this.$h_1))if(a)CUI.Utility.ensureCSSClassOnElement(this.$h_1,"ms-cui-ctl-on");else CUI.Utility.removeCSSClassFromElement(this.$h_1,"ms-cui-ctl-on");if(!CUI.ScriptUtility.isNullOrUndefined(this.$1X_1))if(a)CUI.Utility.ensureCSSClassOnElement(this.$1X_1,"ms-cui-ctl-on");else CUI.Utility.removeCSSClassFromElement(this.$1X_1,"ms-cui-ctl-on")},$3t_1:function(){a:;!CUI.ScriptUtility.isNullOrUndefined(this.$23_1)&&CUI.Utility.removeCSSClassFromElement(this.$23_1,"ms-cui-ctl-disabledHoveredOver");!CUI.ScriptUtility.isNullOrUndefined(this.$h_1)&&CUI.Utility.removeCSSClassFromElement(this.$h_1,"ms-cui-ctl-disabledHoveredOver");!CUI.ScriptUtility.isNullOrUndefined(this.$1X_1)&&CUI.Utility.removeCSSClassFromElement(this.$1X_1,"ms-cui-ctl-disabledHoveredOver")},$Cb_1:function(a){this.$0_0.set_$q_1(this);this.$4h_1(a)},$4h_1:function(){this.onBeginFocus();if(!this.get_enabled()){this.$3t_1();return}var a=this.get_displayedComponent();CUI.MenuItem.isInstanceOfType(a)&&a.set_$1H_2(true);if(CUI.ScriptUtility.isNullOrUndefined(this.get_$2_1().CommandPreview))return;var b=5,c=this.get_$2_1().CommandType;if(!CUI.ScriptUtility.isNullOrUndefined(c)&&c==="OptionSelection"){b=7;this.get_stateProperties()["CommandValueId"]=this.$r_1}a.raiseCommandEvent(this.get_$2_1().CommandPreview,b,this.get_stateProperties())},$6s_1:function(){this.onBeginFocus();if(!this.get_enabled())return;if(CUI.ScriptUtility.isNullOrUndefined(this.get_$2_1().CommandPreview))return;var a=5,b=this.get_$2_1().CommandType;if(!CUI.ScriptUtility.isNullOrUndefined(b)&&b==="OptionSelection"){a=7;this.get_stateProperties()["CommandValueId"]=this.$r_1}this.get_displayedComponent().raiseCommandEvent(this.get_$2_1().CommandPreview,a,this.get_stateProperties())},$5T_1:function(){this.onEndFocus();if(!this.get_enabled())return;var a=this.get_displayedComponent();CUI.MenuItem.isInstanceOfType(a)&&a.set_$1H_2(false);if(CUI.ScriptUtility.isNullOrUndefined(this.get_$2_1().CommandRevert))return;var b=6,c=this.get_$2_1().CommandType;if(!CUI.ScriptUtility.isNullOrUndefined(c)&&c==="OptionSelection"){b=8;this.get_stateProperties()["CommandValueId"]=this.$r_1}a.raiseCommandEvent(this.get_$2_1().CommandRevert,b,this.get_stateProperties())},$6r_1:function(){this.onEndFocus();if(!this.get_enabled())return;if(CUI.ScriptUtility.isNullOrUndefined(this.get_$2_1().CommandRevert))return;var a=6,b=this.get_$2_1().CommandType;if(!CUI.ScriptUtility.isNullOrUndefined(b)&&b==="OptionSelection"){a=8;this.get_stateProperties()["CommandValueId"]=this.$r_1}this.get_displayedComponent().raiseCommandEvent(this.get_$2_1().CommandRevert,a,this.get_stateProperties())},$AK_0:function(){a:;if(!CUI.ScriptUtility.isNullOrUndefined(this.get_$2_1().MenuItemId))this.get_stateProperties()["MenuItemId"]=this.get_$2_1().MenuItemId;var a=this.pollForStateAndUpdateInternal(this.get_$2_1().Command,this.get_$2_1().QueryCommand,this.get_stateProperties(),false);(a&2)>0&&this.setState(this.get_stateProperties()["On"])},addDisplayModes:function(){a:;this.addDisplayMode("Small");this.addDisplayMode("Medium");this.addDisplayMode("Large");this.addDisplayMode("Menu");this.addDisplayMode("Menu16");this.addDisplayMode("Menu32")},dispose:function(){a:;CUI.Control.prototype.dispose.call(this);this.$B_1=null;this.$A_1=null;this.$h_1=null;this.$1X_1=null;this.$23_1=null;this.$1e_1=null;this.$1K_1=null},get_$2_1:function(){a:;return this.$7_0}};CUI.Controls.JewelMenuLauncher=function(a,b,c,d){this.$$d_onContextMenu=Function.createDelegate(this,this.onContextMenu);this.$$d_onKeyPress=Function.createDelegate(this,this.onKeyPress);this.$$d_onClick=Function.createDelegate(this,this.onClick);this.$$d_onBlur=Function.createDelegate(this,this.onBlur);this.$$d_onFocus=Function.createDelegate(this,this.onFocus);CUI.Controls.JewelMenuLauncher.initializeBase(this,[a,b,c,d]);this.addDisplayMode("Default")};CUI.Controls.JewelMenuLauncher.prototype={$H_2:null,$L_2:null,$21_2:null,$4x_2:null,$1E_2:null,$1W_2:null,$1F_2:null,$30_2:null,$35_2:false,createDOMElementForDisplayMode:function(a){if(a!=="Default"){this.ensureValidDisplayMode(a);return null}var b=CUI.ScriptUtility.isNullOrUndefined(this.get_properties().Alt)?"":this.get_properties().Alt;this.$H_2=CUI.Utility.$4("span");this.$H_2.id=this.get_properties().Id+"-Default";this.$H_2.className="ms-cui-jewel-jewelMenuLauncher";this.$L_2=CUI.Utility.$4("a");CUI.Utility.$29(this.$L_2);this.$35_2=!CUI.ScriptUtility.isNullOrEmptyString(this.get_properties().LabelText);if(!this.$35_2){this.$21_2=CUI.Utility.$4("img");this.$4x_2=CUI.Utility.$m(2,10,this.get_properties().Image,this.get_properties().ImageClass,this.$21_2,true,false,this.get_properties().ImageTop,this.get_properties().ImageLeft);this.$21_2.alt=b;this.$L_2.appendChild(this.$4x_2)}else{var c=!CUI.ScriptUtility.isNullOrEmptyString(this.get_properties().ImageLeftSide),d=!CUI.ScriptUtility.isNullOrEmptyString(this.get_properties().ImageRightSide);if(c){this.$1E_2=CUI.Utility.$4("span");this.$1E_2.className="ms-cui-jewel-left";this.$1E_2.id=this.get_properties().Id+"-Default-left";CUI.Utility.$1y(this.$1E_2,this.get_properties().ImageLeftSide,this.get_properties().ImageLeftSideClass,this.get_properties().ImageLeftSideTop,this.get_properties().ImageLeftSideLeft,null,this.get_properties().Height);this.$1E_2.style.width=this.get_properties().ImageLeftSideWidth+"px";this.$1E_2.style.height=this.get_properties().Height+"px";this.$L_2.appendChild(this.$1E_2)}this.$1W_2=CUI.Utility.$4("span");this.$1W_2.className="ms-cui-jewel-middle";this.$1W_2.id=this.get_properties().Id+"-Default-middle";CUI.Utility.$1y(this.$1W_2,this.get_properties().Image,this.get_properties().ImageClass,this.get_properties().ImageTop,this.get_properties().ImageLeft,null,this.get_properties().Height);this.$30_2=CUI.Utility.$4("span");if(!CUI.ScriptUtility.isNullOrUndefined(this.get_properties().LabelCss))this.$30_2.style.cssText=this.get_properties().LabelCss;this.$30_2.className="ms-cui-jewel-label";if(!CUI.ScriptUtility.isNullOrEmptyString(this.get_properties().Height))this.$30_2.style.marginTop=Math.floor(parseInt(this.get_properties().Height)-16)/2+"px";CUI.UIUtility.setInnerText(this.$30_2,this.get_properties().LabelText);this.$1W_2.appendChild(this.$30_2);this.$L_2.appendChild(this.$1W_2);if(d){this.$1F_2=CUI.Utility.$4("span");this.$1F_2.className="ms-cui-jewel-right";this.$1F_2.id=this.get_properties().Id+"-Default-right";CUI.Utility.$1y(this.$1F_2,this.get_properties().ImageRightSide,this.get_properties().ImageRightSideClass,this.get_properties().ImageRightSideTop,this.get_properties().ImageRightSideLeft,null,this.get_properties().Height);this.$1F_2.style.width=this.get_properties().ImageRightSideWidth+"px";this.$1F_2.style.height=this.get_properties().Height+"px";this.$L_2.appendChild(this.$1F_2)}}this.$Ar_0(a);this.$H_2.appendChild(this.$L_2);return this.$H_2},$Aq_0:function(a){this.ensureValidDisplayMode(a);var b=$get(this.$6_0+"-"+a);this.storeElementForDisplayMode(b,a);var c=b.childNodes[0];this.$H_2=b;this.$L_2=c;this.$35_2=!CUI.ScriptUtility.isNullOrEmptyString(this.get_properties().LabelText);if(!this.$35_2){this.$4x_2=this.$L_2.childNodes[0];this.$21_2=this.$4x_2.childNodes[0]}else{this.$1E_2=$get(this.$6_0+"-"+a+"-left");this.$1W_2=$get(this.$6_0+"-"+a+"-middle");if(this.$1W_2)this.$30_2=this.$1W_2.firstChild;this.$1F_2=$get(this.$6_0+"-"+a+"-right")}},$Ar_0:function(a){this.ensureValidDisplayMode(a);$addHandler(this.$L_2,"mouseover",this.$$d_onFocus);$addHandler(this.$L_2,"focus",this.$$d_onFocus);$addHandler(this.$L_2,"mouseout",this.$$d_onBlur);$addHandler(this.$L_2,"blur",this.$$d_onBlur);$addHandler(this.$L_2,"click",this.$$d_onClick);$addHandler(this.$L_2,"keypress",this.$$d_onKeyPress);Sys.Browser.agent===Sys.Browser.InternetExplorer&&$addHandler(this.$L_2,"contextmenu",this.$$d_onContextMenu)},onEnabledChanged:function(a){CUI.Utility.setEnabledOnElement(this.$L_2,a)},onFocus:function(){if(!this.get_enabled()||this.$k_1)return;this.$3t_2()},onBlur:function(){if(!this.get_enabled()||this.$k_1)return;this.$1d_2()},onClick:function(a){a.preventDefault();if(!this.get_enabled()||CUI.ScriptUtility.isNullOrUndefined(a)||a.button)return;if(this.$k_1){this.$5N_1();return}this.$A2_2()},onKeyPress:function(a){if(!this.get_enabled())return;if(!a||!a.rawEvent)return;var b=a.rawEvent.keyCode;if(b===13||b===32||b===40){this.$16_1=true;if(this.$k_1)this.$5N_1();else this.$A2_2();a.preventDefault()}},onContextMenu:function(a){!CUI.ScriptUtility.isNullOrUndefined(a)&&a.preventDefault()},$A2_2:function(){a:;if(CUI.ScriptUtility.isNullOrUndefined(this.get_properties().ImageDown))return;if(!this.$35_2){this.$21_2.src=this.get_properties().ImageDown;if(!CUI.ScriptUtility.isNullOrUndefined(this.get_properties().ImageDownClass))this.$21_2.className=this.get_properties().ImageDownClass}else{this.$1E_2&&CUI.Utility.$1y(this.$1E_2,this.get_properties().ImageLeftSideDown,this.get_properties().ImageLeftSideDownClass,this.get_properties().ImageLeftSideDownTop,this.get_properties().ImageLeftSideDownLeft,null,this.get_properties().Height);CUI.Utility.$1y(this.$1W_2,this.get_properties().ImageDown,this.get_properties().ImageDownClass,this.get_properties().ImageDownTop,this.get_properties().ImageDownLeft,null,this.get_properties().Height);this.$1F_2&&CUI.Utility.$1y(this.$1F_2,this.get_properties().ImageRightSideDown,this.get_properties().ImageRightSideDownClass,this.get_properties().ImageRightSideDownTop,this.get_properties().ImageRightSideDownLeft,null,this.get_properties().Height)}this.launchMenuInternal(this.$L_2)},onLaunchedMenuClosed:function(){a:;this.$1d_2();this.get_displayedComponent().raiseCommandEvent(this.get_properties().CommandMenuClose,10,null)},launchMenuInternal:function(a){this.launchMenu(a);this.get_displayedComponent().raiseCommandEvent(this.get_properties().CommandMenuOpen,4,null)},$3t_2:function(){a:;if(CUI.ScriptUtility.isNullOrUndefined(this.get_properties().ImageHover))return;if(!this.$35_2){this.$21_2.src=this.get_properties().ImageHover;if(!CUI.ScriptUtility.isNullOrUndefined(this.get_properties().ImageHoverClass))this.$21_2.className=this.get_properties().ImageHoverClass}else{this.$1E_2&&CUI.Utility.$1y(this.$1E_2,this.get_properties().ImageLeftSideHover,this.get_properties().ImageLeftSideHoverClass,this.get_properties().ImageLeftSideHoverTop,this.get_properties().ImageLeftSideHoverLeft,null,this.get_properties().Height);CUI.Utility.$1y(this.$1W_2,this.get_properties().ImageHover,this.get_properties().ImageHoverClass,this.get_properties().ImageHoverTop,this.get_properties().ImageHoverLeft,null,this.get_properties().Height);this.$1F_2&&CUI.Utility.$1y(this.$1F_2,this.get_properties().ImageRightSideHover,this.get_properties().ImageRightSideHoverClass,this.get_properties().ImageRightSideHoverTop,this.get_properties().ImageRightSideHoverLeft,null,this.get_properties().Height)}},$1d_2:function(){a:;if(CUI.ScriptUtility.isNullOrUndefined(this.get_properties().ImageHover))return;if(!this.$35_2){this.$21_2.src=this.get_properties().Image;if(!CUI.ScriptUtility.isNullOrUndefined(this.get_properties().ImageClass))this.$21_2.className=this.get_properties().ImageClass}else{this.$1E_2&&CUI.Utility.$1y(this.$1E_2,this.get_properties().ImageLeftSide,this.get_properties().ImageLeftSideClass,this.get_properties().ImageLeftSideTop,this.get_properties().ImageLeftSideLeft,null,this.get_properties().Height);CUI.Utility.$1y(this.$1W_2,this.get_properties().Image,this.get_properties().ImageClass,this.get_properties().ImageTop,this.get_properties().ImageLeft,null,this.get_properties().Height);this.$1F_2&&CUI.Utility.$1y(this.$1F_2,this.get_properties().ImageRightSide,this.get_properties().ImageRightSideClass,this.get_properties().ImageRightSideTop,this.get_properties().ImageRightSideLeft,null,this.get_properties().Height)}},get_properties:function(){a:;return this.$7_0}};Type.registerNamespace("CUI.Page");CUI.Page.CommandDispatcher=function(){a:;this.$2O_0={}};CUI.Page.CommandDispatcher.prototype={$2O_0:null,$A0_0:function(){},$5I_0:0,getNextSequenceNumber:function(){a:;if(this.$5I_0+1<0)throw Error.create("Command Dispatcher sequence numbers overflowed into negative numbers.");return ++this.$5I_0},peekNextSequenceNumber:function(){a:;return this.$5I_0+1},getLastSequenceNumber:function(){a:;return this.$5I_0},executeCommand:function(b,a){a:;return this.$Bv_0(b,a,this.getNextSequenceNumber())},$Bv_0:function(c,f,g){var a=this.$2O_0[c];if(CUI.ScriptUtility.isNullOrUndefined(a))return false;else if(Array.isInstanceOfType(a)){for(var d=a,e=false,b=0;b<d.length;b++){var h=d[b];if(this.callCommandHandler(h,c,f,g))e=true}return e}else return this.callCommandHandler(a,c,f,g)},isCommandEnabled:function(b){a:;var a=this.$2O_0[b];if(CUI.ScriptUtility.isNullOrUndefined(a))return false;else if(Array.isInstanceOfType(a)){for(var d=a,c=0;c<d.length;c++){var e=d[c];if(this.callCommandHandlerForEnabled(e,b))return true}return false}else return this.callCommandHandlerForEnabled(a,b)},$9k_0:function(a){return this.$2O_0[a]},registerCommandHandler:function(c,a){a:;if(CUI.ScriptUtility.isNullOrUndefined(c)||CUI.ScriptUtility.isNullOrUndefined(a))throw Error.create("commandId and handler may not be null or undefined");var b=this.$2O_0[c];if(CUI.ScriptUtility.isNullOrUndefined(b))this.$2O_0[c]=a;else if(Array.isInstanceOfType(b))!Array.contains(b,a)&&Array.add(b,a);else{if(b===a)return;var d=[];Array.add(d,b);Array.add(d,a);this.$2O_0[c]=d}},unregisterCommandHandler:function(b,c){a:;if(CUI.ScriptUtility.isNullOrUndefined(b)||CUI.ScriptUtility.isNullOrUndefined(c))throw Error.create("commandId and handler may not be null or undefined");var a=this.$2O_0[b];if(CUI.ScriptUtility.isNullOrUndefined(a))return;else if(Array.isInstanceOfType(a))Array.remove(a,c);else if(a===c)this.$2O_0[b]=null},registerMultipleCommandHandler:function(c,b){a:;for(var a=0;a<b.length;a++)this.registerCommandHandler(b[a],c)},unregisterMultipleCommandHandler:function(c,b){a:;for(var a=0;a<b.length;a++)this.unregisterCommandHandler(b[a],c)},callCommandHandler:function(d,c,b,a){a:;return d.handleCommand(c,b,a)},callCommandHandlerForEnabled:function(b,a){a:;return b.canHandleCommand(a)}};CUI.Page.FocusManager=function(a){CUI.Page.FocusManager.initializeBase(this);this.$1u_1=a;this.$Y_1=[];this.$2h_1={};this.$1I_1=[];this.$2e_1={}};CUI.Page.FocusManager.prototype={$1I_1:null,$2h_1:null,$1u_1:null,$2e_1:null,$A0_0:function(){},$9t_1:function(){a:;this.$2e_1={};for(var c=this.$1I_1.length,a=0;a<c;a++){var b=this.$1I_1[a];this.$2e_1[b]=b}},requestFocusForComponent:function(a){a:;if(CUI.ScriptUtility.isNullOrUndefined(a))return false;if(Array.contains(this.$1I_1,a))return true;Array.add(this.$1I_1,a);this.$9t_1();a.receiveFocus();return true},releaseFocusFromComponent:function(a){a:;if(CUI.ScriptUtility.isNullOrUndefined(a))return false;if(!Array.contains(this.$1I_1,a))return true;Array.remove(this.$1I_1,a);this.$9t_1();a.yieldFocus();return true},releaseAllFoci:function(){a:;this.$2e_1={};for(var c=this.$1I_1.length,a=c-1;a>=0;a--){var b=this.$1I_1[a];Array.remove(this.$1I_1,b);b.yieldFocus()}return true},getFocusedComponents:function(){a:;return Array.clone(this.$1I_1)},handleCommand:function(b,e,d){a:;var a=this.$9k_0(b);if(CUI.ScriptUtility.isNullOrUndefined(a))return false;else if(Array.isInstanceOfType(a)){for(var f=a,c=0;c<f.length;c++){var g=f[c];if(CUI.ScriptUtility.isNullOrUndefined(this.$2e_1[g]))continue;if(this.callCommandHandler(g,b,e,d))return true}return false}else{if(CUI.ScriptUtility.isNullOrUndefined(this.$2e_1[a]))return false;return this.callCommandHandler(a,b,e,d)}},canHandleCommand:function(b){a:;var a=this.$9k_0(b);if(CUI.ScriptUtility.isNullOrUndefined(a))return false;else if(Array.isInstanceOfType(a)){for(var d=a,c=0;c<d.length;c++){var e=d[c];if(CUI.ScriptUtility.isNullOrUndefined(this.$2e_1[e]))continue;if(this.callCommandHandlerForEnabled(e,b))return true}return false}else{if(CUI.ScriptUtility.isNullOrUndefined(this.$2e_1[a]))return false;return this.callCommandHandlerForEnabled(a,b)}},$Y_1:null,$Am_1:function(a){if(Array.contains(this.$Y_1,a))return;this.registerMultipleCommandHandler(a,a.getFocusedCommands());Array.add(this.$Y_1,a)},$DD_1:function(a){if(!Array.contains(this.$Y_1,a))return;this.unregisterMultipleCommandHandler(a,a.getFocusedCommands());this.releaseFocusFromComponent(a);Array.remove(this.$Y_1,a)},executeCommand:function(){a:;throw Error.create("ExecuteCommand should not be called on the main CommandDispatcher of the page, not the FocusManager")},registerCommandHandler:function(a,b){a:;CUI.Page.CommandDispatcher.prototype.registerCommandHandler.call(this,a,b);if(CUI.ScriptUtility.isNullOrUndefined(this.$2h_1[a])){this.$1u_1.$v_1.registerCommandHandler(a,this);this.$2h_1[a]=0}var c=this.$2h_1[a];this.$2h_1[a]=c+1},unregisterCommandHandler:function(a,c){a:;CUI.Page.CommandDispatcher.prototype.unregisterCommandHandler.call(this,a,c);var b=this.$2h_1[a];if(!CUI.ScriptUtility.isNullOrUndefined(b)&&b>0){this.$2h_1[a]=--b;if(b<=0){this.$1u_1.$v_1.unregisterCommandHandler(a,this);delete this.$2h_1[a]}}},getNextSequenceNumber:function(){a:;throw Error.create("The FocusManager does not issue command sequence numbers.  This is only done by the main CommandDispatcher of the page.")},peekNextSequenceNumber:function(){a:;throw Error.create("The FocusManager does not issue command sequence numbers.  This is only done by the main CommandDispatcher of the page.")},getLastSequenceNumber:function(){a:;throw Error.create("The FocusManager does not issue command sequence numbers.  This is only done by the main CommandDispatcher of the page.")},callCommandHandler:function(a,d,c,b){a:;if(!Array.contains(this.$1I_1,a))return false;return a.handleCommand(d,c,b)},callCommandHandlerForEnabled:function(a,b){a:;if(!Array.contains(this.$1I_1,a))return false;return a.canHandleCommand(b)}};CUI.Page.PageManager=function(){a:;this.$$d_$8M_1=Function.createDelegate(this,this.$8M_1);CUI.Page.PageManager.initializeBase(this);this.$Y_1=[];this.$2u_1={};this.$v_1=new CUI.Page.CommandDispatcher;this.$3d_1=new CUI.Page.FocusManager(this);this.$5L_1=new CUI.Page.UndoManager(this);this.$2P_1=[];this.$1a_1=this.$$d_$8M_1;$addHandler(window,"unload",this.$1a_1)};CUI.Page.PageManager.initialize=function(){a:;if(!CUI.ScriptUtility.isNullOrUndefined(CUI.Page.PageManager._instance))return;CUI.Page.PageManager._instance=CUI.Page.PageManager.createPageManager();CUI.Page.PageManager._instance.initializeInternal()};CUI.Page.PageManager.createPageManager=function(){a:;return new CUI.Page.PageManager};CUI.Page.PageManager.get_instance=function(){a:;!CUI.Page.PageManager._instance&&CUI.Page.PageManager.initialize();return CUI.Page.PageManager._instance};CUI.Page.PageManager.prototype={$1a_1:null,initializeInternal:function(){a:;this.$v_1.$A0_0();this.$5L_1.$A0_0();this.$3d_1.$A0_0();this.$v_1.registerCommandHandler("appstatechanged",this)},$8M_1:function(){this.dispose()},$3R_1:false,dispose:function(){a:;if(this.$3R_1)return;!CUI.ScriptUtility.isNullOrUndefined(this.get_ribbon())&&this.get_ribbon().$Bz_1();this.set_ribbon(null);this.$3d_1=null;this.$5L_1=null;this.$v_1=null;this.$2P_1=null;this.$Y_1=null;$removeHandler(window,"unload",this.$1a_1);CUI.Page.PageManager._instance=null;this.$3R_1=true},resetComponents:function(){a:;var a=this.$2u_1;for(var b in a){var c={key:b,value:a[b]};this.removePageComponent(c.value)}this.$2u_1={};this.$Y_1=[]},$v_1:null,get_commandDispatcher:function(){a:;return this.$v_1},$3d_1:null,get_focusManager:function(){a:;return this.$3d_1},$5L_1:null,get_undoManager:function(){a:;return this.$5L_1},$5v_1:null,get_$7x_1:function(){a:;if(!this.$5v_1)this.$5v_1=new Sys.EventHandlerList;return this.$5v_1},$3j_1:null,get_ribbon:function(){a:;return this.$3j_1},set_ribbon:function(a){a:;if(a===this.$3j_1)return a;if(CUI.ScriptUtility.isNullOrUndefined(a)&&!CUI.ScriptUtility.isNullOrUndefined(this.$3j_1)){this.removeRoot(this.$3j_1);this.$3j_1=null}else if(!Array.contains(this.$2P_1,a)){this.addRoot(a);this.$3j_1=a}return a},add_ribbonInited:function(a){a:;this.get_$7x_1().addHandler("RibbonInited",a)},remove_ribbonInited:function(a){a:;this.get_$7x_1().removeHandler("RibbonInited",a)},onComponentBuilt:function(b){a:;this.pollRootState(b);if(CUI.Ribbon.isInstanceOfType(b)){var a=this.get_$7x_1().getHandler("RibbonInited");a&&a(this,Sys.EventArgs.Empty)}},onComponentCreated:function(a){a:;if(CUI.Ribbon.isInstanceOfType(a)&&CUI.ScriptUtility.isNullOrUndefined(this.get_ribbon()))this.set_ribbon(a);else this.addRoot(a)},$2P_1:null,addRoot:function(a){a:;if(Array.contains(this.$2P_1,a))throw Error.create("This Root has already been added to the PageManager");Array.add(this.$2P_1,a);a.set_rootUser(this)},removeRoot:function(a){a:;if(!Array.contains(this.$2P_1,a))throw Error.create("This Root has not been added to the PageManager.");Array.remove(this.$2P_1,a);a.set_rootUser(null)},$Y_1:null,$2u_1:null,getPageComponentById:function(a){a:;return this.$2u_1[a]},addPageComponent:function(a){a:;!CUI.ScriptUtility.isNullOrUndefined(this.$2u_1[a.getId()])&&Error.create("A PageComponent with id: "+a.getId()+" has already been added to the PageManger.");if(!CUI.ScriptUtility.isNullOrUndefined(this.$Y_1)&&!Array.contains(this.$Y_1,a)){this.$2u_1[a.getId()]=a;a.init();this.$v_1.registerMultipleCommandHandler(a,a.getGlobalCommands());Array.add(this.$Y_1,a);a.isFocusable()&&this.$3d_1.$Am_1(a)}},removePageComponent:function(a){a:;if(CUI.ScriptUtility.isNullOrUndefined(this.$Y_1)||!Array.contains(this.$Y_1,a))return;this.$v_1.unregisterMultipleCommandHandler(a,a.getGlobalCommands());Array.remove(this.$Y_1,a);a.isFocusable()&&this.$3d_1.$DD_1(a);this.$2u_1[a.getId()]=null},executeRootCommand:function(b,a){a:;return this.$v_1.executeCommand(b,a)},isRootCommandEnabled:function(a){a:;return this.$v_1.isCommandEnabled(a)},onRootRefreshed:function(a){a:;!CUI.ScriptUtility.isNullOrUndefined(a)&&this.pollRootState(a)},$2X_1:null,$8r_1:0,registerApplicationStateChangedCallback:function(b){a:;if(CUI.ScriptUtility.isNullOrUndefined(this.$2X_1))this.$2X_1={};var a="_appStateChangedCallbackID"+this.$8r_1++;this.$2X_1[a]=b;return a},unregisterApplicationStateChangedCallback:function(a){a:;if(CUI.ScriptUtility.isNullOrUndefined(this.$2X_1)||!(a in this.$2X_1))return false;delete this.$2X_1[a];return true},handleCommand:function(e){a:;if(e==="appstatechanged"){if(!CUI.ScriptUtility.isNullOrUndefined(this.$2X_1)){var c=this.$2X_1;for(var d in c){var f={key:d,value:c[d]};f.value.call(this)}}for(var a=0;a<this.$2P_1.length;a++){var b=this.$2P_1[a];this.pollRootState(b);b.$i_0&&b.$2A_0()}return true}return false},$6K_1:false,get_rootPollingInProgress:function(){a:;return this.$6K_1},pollRootState:function(a){a:;try{this.$6K_1=true;a.pollForStateAndUpdate()}finally{this.$6K_1=false}},changeCommandContext:function(a){a:;if(!CUI.ScriptUtility.isNullOrUndefined(this.get_ribbon()))return this.get_ribbon().selectTabByCommand(a);return false},canHandleCommand:function(a){a:;return a==="appstatechanged"},restoreFocusToRibbon:function(){a:;!this.get_ribbon().restoreFocus()&&this.get_ribbon().setFocus()}};CUI.Page.UndoManager=function(a){this.$7a_0=CUI.Page.UndoManager.$2V;this.$1u_0=a;this.$1B_0=[];this.$10_0=[];this.$28_0={}};CUI.Page.UndoManager.prototype={$1u_0:null,$28_0:null,$1B_0:null,$10_0:null,$A0_0:function(){a:;this.$1u_0.$v_1.registerCommandHandler("GlobalUndo",this);this.$1u_0.$v_1.registerCommandHandler("GlobalRedo",this);this.$1u_0.$v_1.registerCommandHandler("grpedit",this)},addUndoSequenceNumber:function(a){a:;this.$D9_0(a);a!==this.$7a_0&&this.$Bh_0()},addRedoSequenceNumber:function(a){a:;this.$D8_0(a)},get_oldestSequenceNumber:function(){a:;if(!this.$1B_0.length)return CUI.Page.UndoManager.$2V;var a=CUI.Page.UndoManager.$2V,b=CUI.Page.UndoManager.$2V;if(this.$1B_0.length>0)a=this.$1B_0[this.$1B_0.length-1];if(this.$10_0.length>0)b=this.$10_0[0];if(a===CUI.Page.UndoManager.$2V)return a;else return a},$Bg_0:function(){a:;var a=this.$D6_0();if(a===CUI.Page.UndoManager.$2V)return;var b={};b["SequenceNumber"]=a;this.$1u_0.$v_1.executeCommand("Undo",b)},$Bf_0:function(){a:;var a=this.$D5_0();if(a===CUI.Page.UndoManager.$2V)return;var b={};b["SequenceNumber"]=a;this.$7a_0=this.$1u_0.$v_1.peekNextSequenceNumber();this.$1u_0.$v_1.executeCommand("Redo",b)},$D5_0:function(){a:;if(!this.$10_0.length)return CUI.Page.UndoManager.$2V;var a=this.$10_0[0];Array.removeAt(this.$10_0,0);this.$28_0[a.toString()]=null;return a},$D8_0:function(a){if(!CUI.ScriptUtility.isNullOrUndefined(this.$28_0[a.toString()])){if(this.$1B_0[0]!==a)throw Error.create("This command sequence number is already on the undo or the redo stack but it is not ontop of the redo stack.  Pushing it would result in out of sequence redo and undo stacks.");return}Array.insert(this.$10_0,0,a);this.$28_0[a.toString()]=a},$D6_0:function(){a:;if(!this.$1B_0.length)return CUI.Page.UndoManager.$2V;var a=this.$1B_0[0];Array.removeAt(this.$1B_0,0);this.$28_0[a.toString()]=null;return a},$D9_0:function(a){if(!CUI.ScriptUtility.isNullOrUndefined(this.$28_0[a.toString()])){if(this.$1B_0[0]!==a)throw Error.create("This command sequence number is already on the stack and not on top.  Pushing it would result in an out of sequence undo stack.");return}Array.insert(this.$1B_0,0,a);this.$28_0[a.toString()]=a},$Bh_0:function(){a:;for(var a=0;a<this.$10_0.length;a++){this.$28_0[this.$10_0[a].toString()]=null;Array.remove(this.$10_0,this.$10_0[a])}Array.clear(this.$10_0)},invalidateUndoSequenceNumber:function(b){a:;for(var a=this.$1B_0.length-1;a>-1;a--){var c=this.$1B_0[a];if(c<=b){Array.removeAt(this.$1B_0,a);this.$28_0[c.toString()]=null}}while(this.$10_0.length>0&&this.$10_0[0]<=b){this.$28_0[this.$10_0[0].toString()]=null;Array.removeAt(this.$10_0,0)}},canHandleCommand:function(a){a:;if(a==="GlobalUndo")return this.$1B_0.length>0;else if(a==="GlobalRedo")return this.$10_0.length>0;else if(a==="grpedit")return true;return false},handleCommand:function(a){a:;switch(a){case "GlobalUndo":this.$Bg_0();return true;case "GlobalRedo":this.$Bf_0();return true}return false}};Type.registerNamespace("Commands");Commands.CommandIds=function(){};Commands.GlobalRedoProperties=function(){};Commands.RedoProperties=function(){};Commands.GlobalUndoProperties=function(){};Commands.UndoProperties=function(){};CUI.QueryRecord.registerClass("CUI.QueryRecord");CUI.DeclarativeTemplateBuildContext.registerClass("CUI.DeclarativeTemplateBuildContext");CUI.CommandInformation.registerClass("CUI.CommandInformation");CUI.DisabledCommandInfoProperties.registerClass("CUI.DisabledCommandInfoProperties");CUI.BuildOptions.registerClass("CUI.BuildOptions");CUI.BuildContext.registerClass("CUI.BuildContext");CUI.DataNodeWrapper.registerClass("CUI.DataNodeWrapper");CUI.Builder.registerClass("CUI.Builder",null,Sys.IDisposable);CUI.Builder.SpinnerChildren.registerClass("CUI.Builder.SpinnerChildren");CUI.CommandEventArgs.registerClass("CUI.CommandEventArgs",Sys.EventArgs);CUI.Component.registerClass("CUI.Component",null,CUI.IMenuItem,Sys.IDisposable);CUI.Menu.registerClass("CUI.Menu",CUI.Component);CUI.ContextMenu.registerClass("CUI.ContextMenu",CUI.Menu);CUI.Control.registerClass("CUI.Control",null,Sys.IDisposable,CUI.IMenuItem);CUI.MenuLauncher.registerClass("CUI.MenuLauncher",CUI.Control,CUI.IModalController);CUI.ContextMenuLauncher.registerClass("CUI.ContextMenuLauncher",CUI.MenuLauncher);CUI.RootProperties.registerClass("CUI.RootProperties");CUI.StandaloneRootProperties.registerClass("CUI.StandaloneRootProperties",CUI.RootProperties);CUI.ContextMenuRootProperties.registerClass("CUI.ContextMenuRootProperties",CUI.StandaloneRootProperties);CUI.Root.registerClass("CUI.Root",CUI.Component,Sys.IDisposable);CUI.StandaloneRoot.registerClass("CUI.StandaloneRoot",CUI.Root);CUI.ContextMenuRoot.registerClass("CUI.ContextMenuRoot",CUI.StandaloneRoot);CUI.ControlProperties.registerClass("CUI.ControlProperties");CUI.ControlComponent.registerClass("CUI.ControlComponent",CUI.Component);CUI.DataQueryResult.registerClass("CUI.DataQueryResult");CUI.DataQuery.registerClass("CUI.DataQuery");CUI.DataSource.registerClass("CUI.DataSource",null,CUI.IDataSource);CUI.Gallery.registerClass("CUI.Gallery",CUI.Component);CUI.Jewel.registerClass("CUI.Jewel",CUI.Root);CUI.JewelBuildContext.registerClass("CUI.JewelBuildContext",CUI.BuildContext);CUI.JewelBuildOptions.registerClass("CUI.JewelBuildOptions",CUI.BuildOptions);CUI.JewelBuilder.registerClass("CUI.JewelBuilder",CUI.Builder);CUI.MenuItem.registerClass("CUI.MenuItem",CUI.ControlComponent);CUI.MenuLauncherControlProperties.registerClass("CUI.MenuLauncherControlProperties",CUI.ControlProperties);CUI.BrowserUtility.registerClass("CUI.BrowserUtility");CUI.MenuSection.registerClass("CUI.MenuSection",CUI.Component);CUI.StandaloneDock.registerClass("CUI.StandaloneDock",CUI.Component);CUI.QAT.registerClass("CUI.QAT",CUI.Root);CUI.QATBuildContext.registerClass("CUI.QATBuildContext",CUI.BuildContext);CUI.QATBuildOptions.registerClass("CUI.QATBuildOptions",CUI.BuildOptions);CUI.QATBuilder.registerClass("CUI.QATBuilder",CUI.Builder);CUI.RibbonPeripheralSection.registerClass("CUI.RibbonPeripheralSection");CUI.ContextualGroup.registerClass("CUI.ContextualGroup",null,Sys.IDisposable);CUI.Template.registerClass("CUI.Template");CUI.DeclarativeTemplate.registerClass("CUI.DeclarativeTemplate",CUI.Template);CUI.RibbonComponent.registerClass("CUI.RibbonComponent",CUI.Component);CUI.Group.registerClass("CUI.Group",CUI.RibbonComponent);CUI.GroupPopup.registerClass("CUI.GroupPopup",CUI.Component);CUI.Layout.registerClass("CUI.Layout",CUI.RibbonComponent);CUI.GroupPopupLayout.registerClass("CUI.GroupPopupLayout",CUI.Layout);CUI.RootEventCommandProperties.registerClass("CUI.RootEventCommandProperties");CUI.RibbonEventCommandProperties.registerClass("CUI.RibbonEventCommandProperties",CUI.RootEventCommandProperties);CUI.CommandContextSwitchCommandProperties.registerClass("CUI.CommandContextSwitchCommandProperties");CUI.ScalableRoot.registerClass("CUI.ScalableRoot",CUI.Root);CUI.Ribbon.registerClass("CUI.Ribbon",CUI.ScalableRoot);CUI.RibbonCommand.registerClass("CUI.RibbonCommand");CUI.RibbonBuildContext.registerClass("CUI.RibbonBuildContext",CUI.BuildContext);CUI.RibbonBuildOptions.registerClass("CUI.RibbonBuildOptions",CUI.BuildOptions);CUI.RibbonBuilder.registerClass("CUI.RibbonBuilder",CUI.Builder);CUI.Row.registerClass("CUI.Row",CUI.Component);CUI.ScalingStep.registerClass("CUI.ScalingStep");CUI.Scaling.registerClass("CUI.Scaling");CUI.Section.registerClass("CUI.Section",CUI.RibbonComponent);CUI.Strip.registerClass("CUI.Strip",CUI.RibbonComponent);CUI.Tab.registerClass("CUI.Tab",CUI.RibbonComponent);CUI.TemplateManager.registerClass("CUI.TemplateManager");CUI.RootUser.registerClass("CUI.RootUser",null,CUI.IRootUser);CUI.ToolTip.registerClass("CUI.ToolTip",CUI.Component);CUI.Unit.registerClass("CUI.Unit");CUI.Utility.registerClass("CUI.Utility");CUI.ScriptUtility.registerClass("CUI.ScriptUtility");CUI.UIUtility.registerClass("CUI.UIUtility");CUI.ListNode.registerClass("CUI.ListNode");CUI.List.registerClass("CUI.List",null,IEnumerable);CUI.ListEnumerator.registerClass("CUI.ListEnumerator",null,IEnumerator);CUI.JsonXmlElement.registerClass("CUI.JsonXmlElement");CUI.Controls.ColorStyle.registerClass("CUI.Controls.ColorStyle");CUI.Controls.ColorPickerResult.registerClass("CUI.Controls.ColorPickerResult");CUI.Controls.ContextMenuControlProperties.registerClass("CUI.Controls.ContextMenuControlProperties",CUI.MenuLauncherControlProperties);CUI.Controls.ContextMenuControl.registerClass("CUI.Controls.ContextMenuControl",CUI.ContextMenuLauncher);CUI.Controls.ButtonCommandProperties.registerClass("CUI.Controls.ButtonCommandProperties");CUI.Controls.Button.registerClass("CUI.Controls.Button",CUI.Control,CUI.IMenuItem,CUI.ISelectableControl);CUI.Controls.CheckBoxCommandProperties.registerClass("CUI.Controls.CheckBoxCommandProperties");CUI.Controls.ToggleButton.registerClass("CUI.Controls.ToggleButton",CUI.Control,CUI.IMenuItem,CUI.ISelectableControl);CUI.Controls.CheckBox.registerClass("CUI.Controls.CheckBox",CUI.Controls.ToggleButton);CUI.Controls.ColorPickerCommandProperties.registerClass("CUI.Controls.ColorPickerCommandProperties");CUI.Controls.ColorPicker.registerClass("CUI.Controls.ColorPicker",CUI.Control,CUI.IMenuItem);CUI.Controls.ComboBoxCommandProperties.registerClass("CUI.Controls.ComboBoxCommandProperties");CUI.Controls.DropDown.registerClass("CUI.Controls.DropDown",CUI.MenuLauncher);CUI.Controls.ComboBox.registerClass("CUI.Controls.ComboBox",CUI.Controls.DropDown);CUI.Controls.DropDownCommandProperties.registerClass("CUI.Controls.DropDownCommandProperties");CUI.Controls.FlyoutAnchorCommandProperties.registerClass("CUI.Controls.FlyoutAnchorCommandProperties");CUI.Controls.FlyoutAnchor.registerClass("CUI.Controls.FlyoutAnchor",CUI.MenuLauncher);CUI.Controls.GalleryButtonCommandProperties.registerClass("CUI.Controls.GalleryButtonCommandProperties");CUI.Controls.GalleryButton.registerClass("CUI.Controls.GalleryButton",CUI.Control,CUI.ISelectableControl);CUI.Controls.InsertTableCommandProperties.registerClass("CUI.Controls.InsertTableCommandProperties");CUI.Controls.InsertTable.registerClass("CUI.Controls.InsertTable",CUI.Control);CUI.Controls.LabelCommandProperties.registerClass("CUI.Controls.LabelCommandProperties");CUI.Controls.Label.registerClass("CUI.Controls.Label",CUI.Control);CUI.Controls.MRUSplitButton.registerClass("CUI.Controls.MRUSplitButton",CUI.Controls.DropDown);CUI.Controls.Separator.registerClass("CUI.Controls.Separator",CUI.Control);CUI.Controls.SpinnerCommandProperties.registerClass("CUI.Controls.SpinnerCommandProperties");CUI.Controls.Spinner.registerClass("CUI.Controls.Spinner",CUI.Control);CUI.Controls.SplitButtonCommandProperties.registerClass("CUI.Controls.SplitButtonCommandProperties");CUI.Controls.SplitButton.registerClass("CUI.Controls.SplitButton",CUI.MenuLauncher);CUI.Controls.TextBoxCommandProperties.registerClass("CUI.Controls.TextBoxCommandProperties");CUI.Controls.TextBox.registerClass("CUI.Controls.TextBox",CUI.Control);CUI.Controls.ToggleButtonCommandProperties.registerClass("CUI.Controls.ToggleButtonCommandProperties");CUI.Controls.JewelMenuLauncher.registerClass("CUI.Controls.JewelMenuLauncher",CUI.MenuLauncher);CUI.Page.CommandDispatcher.registerClass("CUI.Page.CommandDispatcher");CUI.Page.FocusManager.registerClass("CUI.Page.FocusManager",CUI.Page.CommandDispatcher,CUI.Page.ICommandHandler);CUI.Page.PageManager.registerClass("CUI.Page.PageManager",CUI.RootUser,CUI.Page.ICommandHandler,CUI.IRootBuildClient);CUI.Page.UndoManager.registerClass("CUI.Page.UndoManager",null,CUI.Page.ICommandHandler);Commands.CommandIds.registerClass("Commands.CommandIds");Commands.GlobalRedoProperties.registerClass("Commands.GlobalRedoProperties");Commands.RedoProperties.registerClass("Commands.RedoProperties");Commands.GlobalUndoProperties.registerClass("Commands.GlobalUndoProperties");Commands.UndoProperties.registerClass("Commands.UndoProperties");function cui_initialize(){a:;CUI.DataNodeWrapper.ATTRIBUTES="attrs";CUI.DataNodeWrapper.CHILDREN="children";CUI.DataNodeWrapper.NAME="name";CUI.DataNodeWrapper.ALIGNMENT="Alignment";CUI.DataNodeWrapper.ALT="Alt";CUI.DataNodeWrapper.CLASSNAME="Classname";CUI.DataNodeWrapper.COLOR="Color";CUI.DataNodeWrapper.COMMAND="Command";CUI.DataNodeWrapper.CONTAINERCSSCLASS="ContainerCssClass";CUI.DataNodeWrapper.CONTEXTUALGROUPID="ContextualGroupId";CUI.DataNodeWrapper.CSSCLASS="CssClass";CUI.DataNodeWrapper.DARKBLUE="DarkBlue";CUI.DataNodeWrapper.DECIMALDIGITS="DecimalDigits";CUI.DataNodeWrapper.DESCRIPTION="Description";CUI.DataNodeWrapper.DISPLAYCOLOR="DisplayColor";CUI.DataNodeWrapper.DISPLAYMODE="DisplayMode";CUI.DataNodeWrapper.DIVIDER="Divider";CUI.DataNodeWrapper.ELEMENTDIMENSIONS="ElementDimensions";CUI.DataNodeWrapper.GREEN="Green";CUI.DataNodeWrapper.GROUPID="GroupId";CUI.DataNodeWrapper.id="Id";CUI.DataNodeWrapper.INDEX="Index";CUI.DataNodeWrapper.INTERVAL="Interval";CUI.DataNodeWrapper.LABELTEXT="LabelText";CUI.DataNodeWrapper.LAYOUTTITLE="LayoutTitle";CUI.DataNodeWrapper.LIGHTBLUE="LightBlue";CUI.DataNodeWrapper.LOWSCALEWARNING="LowScaleWarning";CUI.DataNodeWrapper.MAGENTA="Magenta";CUI.DataNodeWrapper.MAXHEIGHT="MaxHeight";CUI.DataNodeWrapper.MAXIMUMVALUE="MaximumValue";CUI.DataNodeWrapper.MAXWIDTH="MaxWidth";CUI.DataNodeWrapper.MENUITEMID="MenuItemId";CUI.DataNodeWrapper.MESSAGE="Message";CUI.DataNodeWrapper.MINIMUMVALUE="MinimumValue";CUI.DataNodeWrapper.namE_CAPS="Name";CUI.DataNodeWrapper.ONEROW="OneRow";CUI.DataNodeWrapper.ORANGE="Orange";CUI.DataNodeWrapper.POPUP="Popup";CUI.DataNodeWrapper.POPUPSIZE="PopupSize";CUI.DataNodeWrapper.PURPLE="Purple";CUI.DataNodeWrapper.SCROLLABLE="Scrollable";CUI.DataNodeWrapper.SEQUENCE="Sequence";CUI.DataNodeWrapper.SIZE="Size";CUI.DataNodeWrapper.STYLE="Style";CUI.DataNodeWrapper.TEAL="Teal";CUI.DataNodeWrapper.TEMPLATEALIAS="TemplateAlias";CUI.DataNodeWrapper.THREEROW="ThreeRow";CUI.DataNodeWrapper.TITLE="Title";CUI.DataNodeWrapper.TWOROW="TwoRow";CUI.DataNodeWrapper.TYPE="Type";CUI.DataNodeWrapper.VALUE="Value";CUI.DataNodeWrapper.YELLOW="Yellow";CUI.DataNodeWrapper.RIBBON="Ribbon";CUI.DataNodeWrapper.QAT="QAT";CUI.DataNodeWrapper.JEWEL="Jewel";CUI.DataNodeWrapper.TABS="Tabs";CUI.DataNodeWrapper.CONTEXTUALTABS="ContextualTabs";CUI.DataNodeWrapper.CONTEXTUALGROUP="ContextualGroup";CUI.DataNodeWrapper.TAB="Tab";CUI.DataNodeWrapper.SCALING="Scaling";CUI.DataNodeWrapper.MAXSIZE="MaxSize";CUI.DataNodeWrapper.SCALE="Scale";CUI.DataNodeWrapper.GROUP="Group";CUI.DataNodeWrapper.GROUPS="Groups";CUI.DataNodeWrapper.LAYOUT="Layout";CUI.DataNodeWrapper.SECTION="Section";CUI.DataNodeWrapper.OVERFLOWSECTION="OverflowSection";CUI.DataNodeWrapper.ROW="Row";CUI.DataNodeWrapper.CONTROL="ControlRef";CUI.DataNodeWrapper.OVERFLOWAREA="OverflowArea";CUI.DataNodeWrapper.STRIP="Strip";CUI.DataNodeWrapper.CONTROLS="Controls";CUI.DataNodeWrapper.MENU="Menu";CUI.DataNodeWrapper.MENUSECTION="MenuSection";CUI.DataNodeWrapper.TEMPLATE="Template";CUI.DataNodeWrapper.TEMPLATES="Templates";CUI.DataNodeWrapper.RIBBONTEMPLATES="RibbonTemplates";CUI.DataNodeWrapper.GROUPTEMPLATE="GroupTemplate";CUI.DataNodeWrapper.GALLERY="Gallery";CUI.DataNodeWrapper.UNIT="Unit";CUI.DataNodeWrapper.ALLOWEDTEXT="AllowedText";CUI.DataNodeWrapper.colors="Colors";CUI.DataNodeWrapper.color="Color";CUI.DataNodeWrapper.toggleButton="ToggleButton";CUI.DataNodeWrapper.comboBox="ComboBox";CUI.DataNodeWrapper.dropDown="DropDown";CUI.DataNodeWrapper.button="Button";CUI.DataNodeWrapper.splitButton="SplitButton";CUI.DataNodeWrapper.flyoutAnchor="FlyoutAnchor";CUI.DataNodeWrapper.galleryButton="GalleryButton";CUI.DataNodeWrapper.insertTable="InsertTable";CUI.DataNodeWrapper.label="Label";CUI.DataNodeWrapper.mruSplitButton="MRUSplitButton";CUI.DataNodeWrapper.spinner="Spinner";CUI.DataNodeWrapper.textBox="TextBox";CUI.DataNodeWrapper.checkBox="CheckBox";CUI.DataNodeWrapper.colorPicker="ColorPicker";CUI.DataNodeWrapper.separator="Separator";CUI.DataNodeWrapper.jewelMenuLauncher="JewelMenuLauncher";CUI.DataNodeWrapper.BUTTONDOCK="ButtonDock";CUI.DataNodeWrapper.BUTTONDOCKS="ButtonDocks";CUI.DataNodeWrapper.CENTERALIGN="Center";CUI.DataNodeWrapper.LEFTALIGN="Left";CUI.DataNodeWrapper.RIGHTALIGN="Right";CUI.DataNodeWrapper.TOOLBAR="Toolbar";CUI.DataNodeWrapper.LARGE="Large";CUI.DataNodeWrapper.MEDIUM="Medium";CUI.DataNodeWrapper.SMALL="Small";CUI.DataNodeWrapper.DIVIDERAFTER="DividerAfter";CUI.DataNodeWrapper.DIVIDERBEFORE="DividerBefore";CUI.DataNodeWrapper.$6x=null;CUI.RibbonPeripheralSection.tabRowLeft="TabRowLeft";CUI.RibbonPeripheralSection.tabRowInline="TabRowInline";CUI.RibbonPeripheralSection.tabRowRight="TabRowRight";CUI.RibbonPeripheralSection.qatRowLeft="QATRowLeft";CUI.RibbonPeripheralSection.qatRowCenter="QATRowCenter";CUI.RibbonPeripheralSection.qatRowRight="QATRowRight";CUI.TemplateManager.$5y=null;CUI.Utility.$9y=["","ms-cui-img-5by3","ms-cui-img-13by13","ms-cui-img-16by16","ms-cui-img-32by32","ms-cui-img-48by48","ms-cui-img-64by48","ms-cui-img-72by96","ms-cui-img-96by72","ms-cui-img-96by96","ms-cui-img-56by24","ms-cui-img-2by16"];CUI.Utility.$9S=["","Size16by16","Size32by32","Size48by48","Size64by48","Size72by96","Size96by72","Size96by96","Size128by128","Size190by30","Size190by40","Size190by50","Size190by60","SizeCustom"];CUI.Utility.$9w=[0,0,0,0,0,0,0,0,0,0,7,0,0,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,0,1,0,0,0,2,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,5,0];CUI.Utility.$1C=["","&quot;","&amp;","&#39;","&lt;","&gt;"," ","<br>","&nbsp;","<b>","<i>","<p>","<u>","</b>","</i>","</p>","</u>"];CUI.Utility.$7M=false;CUI.Utility.$7L=false;CUI.Utility.$7N=false;CUI.Utility.$7I=false;CUI.Utility.$7O=false;CUI.Utility.$7J=false;CUI.Utility.$7P=false;CUI.Utility.$7K=false;CUI.Utility.$6J=null;CUI.ScriptUtility.emptyString="";CUI.Controls.ButtonCommandProperties.LabelText="LabelText";CUI.Controls.ButtonCommandProperties.Image16by16Class="Image16by16Class";CUI.Controls.ButtonCommandProperties.Image32by32Class="Image32by32Class";CUI.Controls.CheckBoxCommandProperties.On="On";CUI.Controls.CheckBoxCommandProperties.CommandValueId="CommandValueId";CUI.Controls.ColorPickerCommandProperties.Color="Color";CUI.Controls.ColorPickerCommandProperties.Style="Style";CUI.Controls.ColorPicker.$9=-10;CUI.Controls.ComboBoxCommandProperties.SelectedItemId="SelectedItemId";CUI.Controls.ComboBoxCommandProperties.IsFreeForm="IsFreeForm";CUI.Controls.ComboBoxCommandProperties.Value="Value";CUI.Controls.DropDownCommandProperties.SelectedItemId="SelectedItemId";CUI.Controls.DropDownCommandProperties.Value="Value";CUI.Controls.FlyoutAnchorCommandProperties.LabelText="LabelText";CUI.Controls.GalleryButtonCommandProperties.On="On";CUI.Controls.GalleryButtonCommandProperties.CommandValueId="CommandValueId";CUI.Controls.GalleryButtonCommandProperties.InnerHTML="InnerHTML";CUI.Controls.InsertTableCommandProperties.Rows="Rows";CUI.Controls.InsertTableCommandProperties.Columns="Columns";CUI.Controls.LabelCommandProperties.Value="Value";CUI.Controls.LabelCommandProperties.Image16by16Class="Image16by16Class";CUI.Controls.SpinnerCommandProperties.AltDownArrow="AltDownArrow";CUI.Controls.SpinnerCommandProperties.AltUpArrow="AltUpArrow";CUI.Controls.SpinnerCommandProperties.ChangedByMouse="ChangedByMouse";CUI.Controls.SpinnerCommandProperties.ChangeType="ChangeType";CUI.Controls.SpinnerCommandProperties.Value="Value";CUI.Controls.SpinnerCommandProperties.Unit="Unit";CUI.Controls.SpinnerCommandProperties.Text="Text";CUI.Controls.SplitButtonCommandProperties.Image16by16Class="Image16by16Class";CUI.Controls.SplitButtonCommandProperties.Image32by32Class="Image32by32Class";CUI.Controls.SplitButtonCommandProperties.On="On";CUI.Controls.TextBoxCommandProperties.Value="Value";CUI.Controls.ToggleButtonCommandProperties.On="On";CUI.Controls.ToggleButtonCommandProperties.CommandValueId="CommandValueId";CUI.Page.PageManager._instance=null;CUI.Page.UndoManager.$2V=-1;Commands.CommandIds.ApplicationStateChanged="appstatechanged";Commands.CommandIds.GlobalRedo="GlobalRedo";Commands.CommandIds.Redo="Redo";Commands.CommandIds.GlobalUndo="GlobalUndo";Commands.CommandIds.Undo="Undo";Commands.GlobalRedoProperties.SequenceNumber="SequenceNumber";Commands.RedoProperties.SequenceNumber="SequenceNumber";Commands.GlobalUndoProperties.SequenceNumber="SequenceNumber";Commands.UndoProperties.SequenceNumber="SequenceNumber"}cui_initialize();typeof RegisterModuleInit!="undefined"&&RegisterModuleInit("cui.js",cui_initialize);var g_cuiXMLDOMDocument=null,g_cuiXMLParser=null;CUI.NativeUtility=function(){};CUI.NativeUtility.createXMLDocFromString=function(a){a:;return CUI.NativeUtility.createXMLDocFromStringCore(a,false)};CUI.NativeUtility.createXMLDocFromStringCore=function(e,c){a:;function f(b){a:;for(var a=0;a<b.length;a++)try{var c=new ActiveXObject(b[a]);return c}catch(d){}return null}if(window.ActiveXObject){var a=c?null:g_cuiXMLDOMDocument;if(!a)try{a=f(["Msxml2.DOMDocument.6.0","Msxml2.DOMDocument"]);if(!c)g_cuiXMLDOMDocument=a}catch(g){}a!=null&&a.loadXML(e);return a}else if(DOMParser){var b=c?null:g_cuiXMLParser;if(!b){b=new DOMParser;if(!c)g_cuiXMLParser=b}return b.parseFromString(e,"text/xml")}else if(window.XMLHttpRequest){var d=new XMLHttpRequest;d.open("GET","data:text/xml;charset=utf-8,"+e,false);d.send(null);return d.responseXML()}return null};typeof Sys!="undefined"&&Sys&&Sys.Application&&Sys.Application.notifyScriptLoaded();CUI.NativeUtility.setInnerText=function(a,b){a:;var c=a.ownerDocument;if(c.createTextNode){var d=c.createTextNode(b);a.innerHTML="";a.appendChild(d)}else a.innerText=b};CUI.NativeUtility.ecmaScriptStringLiteralEncode=function(e){a:;if(null==e||typeof e=="undefined")return "";for(var d=new String(e),a=[],c=0,g=d.length,c=0;c<g;c++){var b=d.charCodeAt(c);if(b>4095)a.push("\\u"+b.toString(16).toUpperCase());else if(b>255)a.push("\\u0"+b.toString(16).toUpperCase());else if(b>127)a.push("\\u00"+b.toString(16).toUpperCase());else{var f=d.charAt(c);switch(f){case "\n":a.push("\\n");break;case "\r":a.push("\\r");break;case '"':a.push("\\u0022");break;case "%":a.push("\\u0025");break;case "&":a.push("\\u0026");break;case "'":a.push("\\u0027");break;case "(":a.push("\\u0028");break;case ")":a.push("\\u0029");break;case "+":a.push("\\u002b");break;case "/":a.push("\\u002f");break;case "<":a.push("\\u003c");break;case ">":a.push("\\u003e");break;case "\\":a.push("\\\\");break;default:a.push(f)}}}return a.join("")};CUI.NativeUtility.ffClick=function(b){a:;var a=document.createEvent("MouseEvents");a.initMouseEvent("click",true,true,window,0,0,0,0,0,false,false,false,false,0,null);b.dispatchEvent(a)};CUI.NativeUtility.getAttribute=function(a,b){a:;return a[b]};CUI.NativeUtility.returnFalse=function(){a:;return false};var g_records=[];CUI.PMetrics=function(){};CUI.PMetrics.perfMark=function(b){a:;typeof msWriteProfilerMark!=="undefined"&&msWriteProfilerMark!==null&&window.msWriteProfilerMark("perfMark: "+b);var a={};a.m=b;a.mt=new Date;if(g_records){if(g_records.length==1e3)g_records=[];g_records.push(a)}};CUI.PMetrics.perfReport=function(){a:;if(!g_records)return;var d=g_records.length;if(d>0){var a=document.getElementById("perf-markers");if(!a){a=document.createElement("div");a.id="perf-markers";a.style.display="none"}var b,c="";for(i=0;i<d;i++){b=g_records[i];if(b)c+="<p><span class='time'>"+b.mt.format("MM/dd/yyyy HH:mm:ss.fffffff")+"</span><span class='marker'>"+b.m+"</span><var class='milliseconds'>"+b.mt.getTime()+"</var></p>"}a.innerHTML+=c;document.body.appendChild(a);g_records=[]}};CUI.PMetrics.perfClear=function(){a:;g_records=[]};typeof Sys!="undefined"&&Sys&&Sys.Application&&Sys.Application.notifyScriptLoaded();typeof NotifyScriptLoadedAndExecuteWaitingJobs!="undefined"&&NotifyScriptLoadedAndExecuteWaitingJobs("CUI.js");typeof spWriteProfilerMark=="function"&&spWriteProfilerMark("perfMarkEnd_CUI.js")