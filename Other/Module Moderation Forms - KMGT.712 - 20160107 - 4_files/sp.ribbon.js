function ULS04Z(){var o=new Object;o.ULSTeamName="Microsoft SharePoint Foundation";o.ULSFileName="SP.Ribbon.js";return o;}
if("undefined"==typeof g_all_modules)g_all_modules={};g_all_modules["sp.ribbon.js"]={version:{rmj:16,rmm:0,rup:5312,rpr:1208}};typeof spWriteProfilerMark=="function"&&spWriteProfilerMark("perfMarkBegin_sp.ribbon.js");Type.registerNamespace("SP.SPGantt.InstrumentedApi");SP.SPGantt.InstrumentedApi.IJsApiImpl=function(){};SP.SPGantt.InstrumentedApi.IJsApiImpl.registerInterface("SP.SPGantt.InstrumentedApi.IJsApiImpl");SP.SPGantt.InstrumentedApi.IJsApi=function(){};SP.SPGantt.InstrumentedApi.IJsApi.registerInterface("SP.SPGantt.InstrumentedApi.IJsApi");SP.SPGantt.InstrumentedApi.ISPGanttImpl=function(){};SP.SPGantt.InstrumentedApi.ISPGanttImpl.registerInterface("SP.SPGantt.InstrumentedApi.ISPGanttImpl");SP.SPGantt.InstrumentedApi.ISPGantt=function(){};SP.SPGantt.InstrumentedApi.ISPGantt.registerInterface("SP.SPGantt.InstrumentedApi.ISPGantt");Type.registerNamespace("SP.Ribbon");SP.Ribbon.NodeType=function(){};SP.Ribbon.NodeType.prototype={Leaf:0,Expanded:1,Collapsed:2};SP.Ribbon.NodeType.registerEnum("SP.Ribbon.NodeType",false);SP.Ribbon.ControlDataRecord=function(){};SP.Ribbon.IRelatedFieldsInfoRequestor=function(){};SP.Ribbon.IRelatedFieldsInfoRequestor.registerInterface("SP.Ribbon.IRelatedFieldsInfoRequestor");SP.Ribbon.Utility=function(){};SP.Ribbon.Utility.$2Y=function(){ULS04Z:;return window.self.self};SP.Ribbon.Utility.$4E=function(b,c){ULS04Z:;var a=SP.Ribbon.Utility.$2Y();$addHandler(a,b,c)};SP.Ribbon.Utility.$4y=function(b,c){ULS04Z:;var a=SP.Ribbon.Utility.$2Y();$removeHandler(a,b,c)};SP.Ribbon.Utility.$J=function(a,b){ULS04Z:;return!!a&&!SP.UI.UIUtility.isSvgNode(a)&&!!a.className&&Sys.UI.DomElement.containsCssClass(a,b)};SP.Ribbon.Utility.get_$d=function(){ULS04Z:;return SP.PageContextInfo.get_webPermMasks()};SP.Ribbon.UtilityInternal=function(){};SP.Ribbon.UtilityInternal.$5m=function(){ULS04Z:;return Sys.Browser.agent===Sys.Browser.Firefox||Sys.Browser.name.toLowerCase().indexOf("firefox")!==-1};SP.Ribbon.UtilityInternal.$2Y=function(){ULS04Z:;return!SP.Ribbon.UtilityInternal.$5m()?document.body:window.self.self};SP.Ribbon.UtilityInternal.$4D=function(b,c){ULS04Z:;var a=SP.Ribbon.UtilityInternal.$2Y();$addHandler(a,b,c)};SP.Ribbon.UtilityInternal.$z=function(){ULS04Z:;SP.Ribbon.UtilityInternal.$2G>0&&window.clearTimeout(SP.Ribbon.UtilityInternal.$2G);SP.Ribbon.UtilityInternal.$2G=window.setTimeout(SP.Ribbon.UtilityInternal.$3p,0)};SP.Ribbon.UtilityInternal.$6F=function(){ULS04Z:;SP.Ribbon.PageManager.get_instance().get_commandDispatcher().executeCommand("appstatechanged",null);var a=window._spNextRibbonTabId;if(!SP.Ribbon.SU.$0(a)){window.SelectRibbonTab(a);window._spNextRibbonTabId=null}CUI.PMetrics.perfMark(7736)};SP.Ribbon.SU=function(){};SP.Ribbon.SU.$2=function(a){ULS04Z:;var b=null;return a===b||typeof a==="undefined"||!a.length};SP.Ribbon.SU.$0=function(a){ULS04Z:;var b=null;return a===b||typeof a==="undefined"};SP.Ribbon.SU.$1X=function(a){ULS04Z:;return typeof a==="undefined"};SP.Ribbon.CommandUIExtensionPageComponent=function(){ULS04Z:;this.$$d_onHandlersReturned=Function.createDelegate(this,this.onHandlersReturned);SP.Ribbon.CommandUIExtensionPageComponent.initializeBase(this)};SP.Ribbon.CommandUIExtensionPageComponent.get_instance=function(){ULS04Z:;if(null===SP.Ribbon.CommandUIExtensionPageComponent.$1e)SP.Ribbon.CommandUIExtensionPageComponent.$1e=new SP.Ribbon.CommandUIExtensionPageComponent;return SP.Ribbon.CommandUIExtensionPageComponent.$1e};SP.Ribbon.CommandUIExtensionPageComponent.registerWithPageManager=function(){ULS04Z:;if(!SP.Ribbon.SU.$0(SP.Ribbon.CommandUIExtensionPageComponent.get_instance().$13_1)&&!SP.Ribbon.CommandUIExtensionPageComponent.$2P){SP.Ribbon.CommandUIExtensionPageComponent.$69();return}SP.Ribbon.PageManager.get_instance().addPageComponent(SP.Ribbon.CommandUIExtensionPageComponent.get_instance());!SP.ScriptUtility.isNullOrUndefined(SP.Ribbon.PageManager.get_instance().get_ribbon())&&SP.Ribbon.PageManager.get_instance().get_commandDispatcher().executeCommand("appstatechanged",null)};SP.Ribbon.CommandUIExtensionPageComponent.$69=function(){ULS04Z:;var c=null,a=SP.Ribbon.CommandUIExtensionPageComponent.get_instance();if(!SP.Ribbon.SU.$0(a.$13_1))c=a.$13_1;else return;var e=null;if(!SP.Ribbon.SU.$0(a.$1K_1))e=a.$1K_1;var f=null;if(!SP.Ribbon.SU.$0(a.$1J_1))f=a.$1J_1;var b;if(c.indexOf("?")===-1)b=c+"?ver=";else b=c+"&ver=";b=b+e+"&lcid="+f+"&qt=commandhandlers";var d=new Sys.Net.WebRequest;d.set_httpVerb("GET");d.set_url(b);d.add_completed(a.$$d_onHandlersReturned);d.invoke()};SP.Ribbon.CommandUIExtensionPageComponent.unregisterWithPageManager=function(){ULS04Z:;null!==SP.Ribbon.CommandUIExtensionPageComponent.$1e&&SP.Ribbon.PageManager.get_instance().removePageComponent(SP.Ribbon.CommandUIExtensionPageComponent.get_instance())};SP.Ribbon.CommandUIExtensionPageComponent.prototype={$13_1:null,get_dataUrl:function(){ULS04Z:;return this.$13_1},set_dataUrl:function(a){ULS04Z:;this.$13_1=a;return a},$1J_1:null,get_dataLCID:function(){ULS04Z:;return this.$1J_1},set_dataLCID:function(a){ULS04Z:;this.$1J_1=a;return a},$1K_1:null,get_dataVersion:function(){ULS04Z:;return this.$1K_1},set_dataVersion:function(a){ULS04Z:;this.$1K_1=a;return a},$f_1:null,$1l_1:null,onHandlersReturned:function(a){ULS04Z:;try{if(a.get_responseAvailable())this.$1l_1=a.get_object();SP.Ribbon.CommandUIExtensionPageComponent.$2P=true;SP.Ribbon.CommandUIExtensionPageComponent.registerWithPageManager()}catch(b){}},$30_1:function(d){ULS04Z:;if(SP.Ribbon.SU.$0(this.$f_1))this.$f_1=[];var a=d.children;if(SP.ScriptUtility.isNullOrUndefined(a))return;for(var c=a.length,b=0;b<c;b++)this.$f_1[this.$f_1.length]=a[b].attrs},init:function(){ULS04Z:;!SP.Ribbon.SU.$0(this.$1l_1)&&this.$30_1(this.$1l_1);var a=window.g_commandUIHandlers;!SP.Ribbon.SU.$0(a)&&this.$30_1(a);this.$4u_1()},$e_1:null,get_$5Q_1:function(){ULS04Z:;if(SP.Ribbon.SU.$0(this.$e_1)){this.$e_1=[];for(var a=0;a<this.$f_1.length;a++){var b=this.$f_1[a];if(!SP.Ribbon.SU.$0(b)){var c=b.Command;if(!SP.Ribbon.SU.$0(c))this.$e_1[a]=c}}this.$e_1[this.$e_1.length]="CustomCommandsTab";this.$e_1[this.$e_1.length]="CustomCommandsGroup"}return this.$e_1},getGlobalCommands:function(){ULS04Z:;return this.get_$5Q_1()},canHandleCommand:function(a){ULS04Z:;if(a==="CustomCommandsTab"||a==="CustomCommandsGroup")return true;var b=this.get_$2Z_1()[a];if(SP.Ribbon.SU.$0(b))return false;if(Array.isInstanceOfType(b)){for(var c=0;c<b.length;c++)if(this.$39_1(b[c],a))return true}else return this.$39_1(b,a);return false},$3E_1:function(b){ULS04Z:;if(SP.Ribbon.SU.$0(b))return true;var a=SP.Ribbon.WebPartComponent.get_pageComponentIdOfActiveWebPart();return!SP.Ribbon.SU.$0(a)&&a===b},$39_1:function($p0,$p1){var $v_0=$p0.WebPartId,$v_1=$p0.EnabledScript,$v_2=$p0.CommandAction,$v_3=!SP.Ribbon.SU.$0($v_2)&&$v_2.startsWith("javascript:LaunchApp("),$v_4=$v_3&&!SP.PageContextInfo.get_isAppWeb();if(!this.$3E_1($v_0))return false;var $v_5=SP.Ribbon.Utility.get_$d();if(!SP.Ribbon.SU.$2($p0.HPerms)&&!SP.Ribbon.SU.$2($p0.LPerms)&&!SP.Ribbon.SU.$0($v_5)){var $v_6=parseInt($p0.HPerms,10),$v_7=parseInt($p0.LPerms,10);if(!$v_5.hasPermissions($v_6,$v_7))return false}if(!$v_4&&!SP.Ribbon.SU.$0($v_1)&&$v_1.toLowerCase().startsWith("javascript:")){window.g_CUIcommandId=$p1;var $v_8=eval($p0.EnabledScript);window.g_CUIcommandId=null;return $v_8}return true},$1h_1:null,get_$2Z_1:function(){ULS04Z:;if(SP.Ribbon.SU.$0(this.$1h_1))this.$1h_1={};return this.$1h_1},$4u_1:function(){ULS04Z:;for(var c=this.get_$2Z_1(),f=this.$f_1.length,d=0;d<f;d++){var a=this.$f_1[d];if(SP.Ribbon.SU.$0(a.Command))continue;var b=c[a.Command];if(SP.Ribbon.SU.$0(b))c[a.Command]=a;else if(Array.isInstanceOfType(b))Array.add(b,a);else{var e=[];Array.add(e,b);Array.add(e,a);c[a.Command]=e}}},handleCommand:function(b,d){ULS04Z:;var a=this.get_$2Z_1()[b];if(SP.Ribbon.SU.$0(a))return false;if(Array.isInstanceOfType(a)){for(var c=0;c<a.length;c++)if(this.$3V_1(a[c],b,d))return true}else return this.$3V_1(a,b,d);return false},$3V_1:function($p0,$p1,$p2){var $v_0=$p0.CommandAction,$v_1=$p0.Command,$v_2=$p0.WebPartId;if(this.$3E_1($v_2))if(!SP.Ribbon.SU.$2($v_0)){if($v_0.toLowerCase().startsWith("javascript:")){window.g_CUIcommandProperties=$p2;window.g_CUIcommandId=$p1;eval(this.$3n_1($v_0,false));window.g_CUIcommandProperties=null;window.g_CUIcommandId=null}else STSNavigate(this.$3n_1($v_0,true));return true}return false},$3n_1:function(c,i){ULS04Z:;var b="",a=null,f=SP.ListOperation.Selection.getSelectedItems();a=SP.ListOperation.Selection.getSelectedList();if(!SP.Ribbon.SU.$0(a)&&i){a=a.replace("{","%7B");a=a.replace("-","%2D");a=a.replace("}","%7D")}if(!SP.Ribbon.SU.$0(f)){var g=null,d=f;for(var e in d){var h={key:e,value:d[e]};g=h.value.id.toString();b+=g+","}b=""===b?null:b.substring(0,b.length-1)}c=c.replace(new RegExp("{SelectedListId}","g"),a);c=c.replace(new RegExp("{SelectedItemId}","g"),b);return c}};SP.Ribbon.ToolbarRibbonAdapterData=function(){};SP.Ribbon.ToolbarRibbonAdapterData.prototype={ToolbarData:null};SP.Ribbon.ToolbarRibbonAdapter=function(b,a){ULS04Z:;SP.Ribbon.ToolbarRibbonAdapter.initializeBase(this);this._data=a;this.$2O_1=b};SP.Ribbon.ToolbarRibbonAdapter.prototype={_controlData:null,_componentData:null,$2O_1:null,_data:null,get_controlData:function(){ULS04Z:;return this._controlData},ensureCommandInfoStructure:function(){ULS04Z:;for(var $v_0=eval(this._data.ToolbarData),$v_1=0;$v_1<$v_0.length;$v_1++){var $v_2=$v_0[$v_1];if(SP.Ribbon.SU.$0($v_2.Command))continue;var $v_3=this._controlData[$v_2.Command];if(SP.Ribbon.SU.$0($v_3)){this._controlData[$v_2.Command]=$v_2;if(!SP.Ribbon.SU.$0($v_2.ContextualGroupCommand))this._componentData[$v_2.ContextualGroupCommand]=true;if(!SP.Ribbon.SU.$0($v_2.TabCommand))this._componentData[$v_2.TabCommand]=true;if(!SP.Ribbon.SU.$0($v_2.GroupCommand))this._componentData[$v_2.GroupCommand]=true}}},canHandleCommand:function(commandId){ULS04Z:;if(this._componentData[commandId])return true;var $v_0=this._controlData[commandId];return SP.Ribbon.SU.$0($v_0)?false:SP.Ribbon.SU.$2($v_0.HiddenScript)||SP.Ribbon.SU.$0($v_0.HiddenScript)?true:!eval($v_0.HiddenScript)},getGlobalCommands:function(){ULS04Z:;return this.getToolbarCommands()},getFocusedCommands:function(){ULS04Z:;return[]},getToolbarCommands:function(){ULS04Z:;var a=[],b=this._componentData;for(var d in b){var f={key:d,value:b[d]};Array.add(a,f.key)}var c=this._controlData;for(var e in c){var g={key:e,value:c[e]};Array.add(a,g.key)}return a},handleCommand:function(b){ULS04Z:;var a=this._controlData[b];if(SP.Ribbon.SU.$0(a))return false;this.executeClickScript(a.ClickScript);return true},executeClickScript:function(script){ULS04Z:;eval(script)},init:function(){ULS04Z:;this._controlData={};this._componentData={};this.ensureCommandInfoStructure()},isFocusable:function(){ULS04Z:;return false},receiveFocus:function(){ULS04Z:;throw Error.create("The ToolbarRibbonAdapter cannot receive focus.");},yieldFocus:function(){ULS04Z:;throw Error.create("The ToolbarRibbonAdapter cannot receive or yield focus.");},getId:function(){ULS04Z:;return this.$2O_1}};SP.Ribbon.WebPartPageComponentData=function(){ULS04Z:;SP.Ribbon.WebPartPageComponentData.initializeBase(this)};SP.Ribbon.WebPartPageComponent=function(b,a){ULS04Z:;SP.Ribbon.WebPartPageComponent.initializeBase(this,[b,a])};SP.Ribbon.WebPartPageComponent.prototype={isFocusable:function(){ULS04Z:;return true},$1i_2:false,receiveFocus:function(){ULS04Z:;this.$1i_2=true;return this.$1i_2},yieldFocus:function(){ULS04Z:;this.$1i_2=false;return true},get_webPartIsSelected:function(){ULS04Z:;return this.getId()===SP.Ribbon.WebPartComponent.get_pageComponentIdOfActiveWebPart()},canHandleCommand:function(a){ULS04Z:;return this.get_alwaysEnabledCommands()[a]?true:SP.Ribbon.ToolbarRibbonAdapter.prototype.canHandleCommand.call(this,a)},_alwaysEnabledCommands:null,get_alwaysEnabledCommands:function(){ULS04Z:;if(SP.Ribbon.SU.$0(this._alwaysEnabledCommands)){this._alwaysEnabledCommands={};this.addAlwaysEnabledCommands()}return this._alwaysEnabledCommands},addAlwaysEnabledCommands:function(){},simulateClick:function(a){ULS04Z:;if(Sys.Browser.agent===Sys.Browser.InternetExplorer)a.click();else SP.Ribbon.NativeUtility.ffClick(a)},executeOnClick:function(b){ULS04Z:;var a=b.attributes.getNamedItem("onclick").value;if(SP.Ribbon.SU.$0(a))b.click();else this.executeClickScript(a)},getGlobalCommands:function(){ULS04Z:;return this.getCommands()},getFocusedCommands:function(){ULS04Z:;return SP.Ribbon.ToolbarRibbonAdapter.prototype.getFocusedCommands.call(this)},getCommands:function(){ULS04Z:;var c=SP.Ribbon.ToolbarRibbonAdapter.prototype.getToolbarCommands.call(this),a=this.get_alwaysEnabledCommands();for(var b in a){var d={key:b,value:a[b]};Array.add(c,d.key)}return c}};SP.Ribbon.ListViewWebPartPageComponentData=function(){ULS04Z:;SP.Ribbon.ListViewWebPartPageComponentData.initializeBase(this)};SP.Ribbon.ListViewWebPartPageComponentData.prototype={ViewId:null,ViewName:null,ViewReadOnly:null,ListId:null,ListEnableAttachments:null,BaseViewId:null,ListBaseType:null,ListTemplateType:null,ListPermissions:null,ListFolderPermissions:null,ListHasExternalDataSource:null,ServerRelativeWebUrl:null,IsAppWeb:false};SP.Ribbon.PagingInformation=function(){};SP.Ribbon.PagingInformation.prototype={NextNode:null,PreviousNode:null,CurrentRange:null};SP.Ribbon.ListViewWebPartData=function(){ULS04Z:;SP.Ribbon.ListViewWebPartData.initializeBase(this)};SP.Ribbon.ListViewWebPartData.prototype={WebPartId:null,ViewDropDownOptions:null,NewMenuData:null};SP.Ribbon.ListViewWebPartPageComponent=function(id,data){ULS04Z:;this.$$d_$5z_3=Function.createDelegate(this,this.$5z_3);this.$$d_$60_3=Function.createDelegate(this,this.$60_3);this.$1y_3="/_layouts/15/$Resources:core,Language;/images/formatmap16x16.png?rev=43".replace("$Resources:core,Language;",SP.Res.lcid);this.$1z_3="/_layouts/15/$Resources:core,Language;/images/formatmap32x32.png?rev=43".replace("$Resources:core,Language;",SP.Res.lcid);SP.Ribbon.ListViewWebPartPageComponent.initializeBase(this,[id,data]);this.$H_3=data.ViewId;this.$1c_3=new SP.Guid(this.$H_3);this.$2E_3=data.ViewName;this.$2p_3=data.ViewReadOnly==="true";this.$D_3=data.ListId;this.$2l_3=data.ListEnableAttachments;this.$3d_3=data.BaseViewId;this.$3e_3=data.ListBaseType;this.$1b_3=data.ListTemplateType;var $v_0=eval("("+data.ListPermissions+")");this.$L_3=new SP.BasePermissions;!this.$L_3.customFromJson($v_0)&&this.$L_3.fromJson($v_0);$v_0=eval("("+data.ListFolderPermissions+")");this.$1Z_3=new SP.BasePermissions;!this.$1Z_3.customFromJson($v_0)&&this.$1Z_3.fromJson($v_0);this.$1a_3=data.ListHasExternalDataSource;this.$x_3=data.ServerRelativeWebUrl;this.$29_3=data.IsAppWeb};SP.Ribbon.ListViewWebPartPageComponent.navigateToView=function(b,a){ULS04Z:;if(SP.Ribbon.PageManager.get_instance().get_ribbon()&&!SP.ScriptUtility.isNullOrEmptyString(SP.Ribbon.PageManager.get_instance().get_ribbon().get_selectedTabId())){a=SP.Utilities.UrlBuilder.replaceOrAddQueryString(a,"InitialTabId",SP.Ribbon.PageManager.get_instance().get_ribbon().get_selectedTabId());a=SP.Utilities.UrlBuilder.replaceOrAddQueryString(a,"VisibilityContext","WSSListAndLibrary")}window.STSNavigateToView(b,a)};SP.Ribbon.ListViewWebPartPageComponent.prototype={$1c_3:null,$H_3:null,$2E_3:null,$2p_3:false,$D_3:null,$2l_3:null,$3d_3:null,$3e_3:null,$1b_3:null,$x_3:null,$L_3:null,$1Z_3:null,$1a_3:null,$29_3:false,$1N_3:null,$1j_3:null,executeClickScript:function(a){ULS04Z:;SP.Ribbon.NativeUtility.executeClickScript(a,"{"+this.$H_3.toUpperCase()+"}")},$3a_3:function(){ULS04Z:;var b=window.location.search,a=b.match(SP.Ribbon.ListViewWebPartPageComponent.$3l);return!!a&&a.length>0},canHandleCommand:function(a){ULS04Z:;if(!SP.Ribbon.SU.$0(this.get_alwaysEnabledCommands()[a]))return true;if(a==="DisplayView"||a==="QueryDisplayView")return!SP.Ribbon.SU.$0(this.get_viewSelectorOptions());if(a==="DisplayDatasheetView"){var c=this.get_ctx();return c&&c.AllowGridMode?!c.inGridMode:false}else if(a==="DisplayStandardView"){var f=this.get_ctx();return f?!!f.inGridMode:false}else if(a==="ConnectToClient"){if(this.$1b_3===(171).toString()){var g=this.get_ctx().ListSchema;if(g){var l=g.ListRight_AddListItems;return!!l}}}else if(a==="ExportToProject"){var m=this.$1b_3===(171).toString();if(m)return this.$L_3.has(1)&&this.$L_3.has(13)&&SP.Ribbon.Utility.get_$d().has(38)}var k=SP.Ribbon.WebPartPageComponent.prototype.canHandleCommand.call(this,a);if(k)return true;var b=this.get_ecbAdapter().getCountOfSelectedItems();if(a==="CustomViewsGroup"||a==="ViewsTab")return true;if(a==="ModifyView"||a==="ModifyThisView"||a==="PopulateModifyViewMenu")return SP.Ribbon.SU.$0(this.get_viewSelectorOptions())||this.$3a_3()?false:this.$2p_3?false:this.get_viewSelectorOptions().showEditView;if(a==="ModifyViewInDesigner")return SP.Ribbon.SU.$0(this.get_viewSelectorOptions())?false:this.get_viewSelectorOptions().showEditView&&this.$2a_3();if(a==="LibraryPermissions")return this.$L_3.has(63);if(a==="EditList")return this.$2a_3();if(a==="ManageCopies")return this.$5o_3(b);if(a==="AttachFile")return this.$2l_3==="True"&&!window.browseris.ipad&&this.get_ecbAdapter().canHandleECBCommand("EditProperties")&&this.$5q_3();if(a==="CreateView")return SP.Ribbon.SU.$0(this.get_viewSelectorOptions())?false:this.get_viewSelectorOptions().showCreateView;if(a==="CurrentPage")return true;if(a==="PreviousPage"){var o=this.$1U_3();return!SP.Ribbon.SU.$0(o.PreviousNode)}if(a==="NextPage"){var p=this.$1U_3();return!SP.Ribbon.SU.$0(p.NextNode)}if(a==="EditDefaultForms")return this.$L_3.has(19)&&!this.$3a_3();if(a==="EditDefaultForm")return true;if(a==="PopulateDefaultFormsForList")return true;if(a==="PopulateViewDropDown")return this.get_hasViewSelectorInfo();if(a==="EmailLibraryLink")return!!this.get_ctx();if(a==="NavigateUp")return CanNavigateUp(this.get_ctx());if(a==="QueryDisplayDatasheetView")return true;if(a==="QueryDisplayStandardView")return true;if(a==="NavZoomIn"||a==="NavZoomOut"||a==="NavScrollTask")return true;if(a==="CreateReusableWorkflowInDesigner"||a==="CreateWorkflowInDesigner"||a==="AddButton")return this.$2a_3()&&this.$1a_3!=="True";if(a==="AssociateWorkflows"||a==="EditWorkflowSettings"||a==="PopulateManageWorkFlowsMenu"||a==="ManageWorkflows")return this.$5g_3()&&this.$1a_3!=="True";if(a==="ViewProperties"&&this.get_$5_3()&&this.get_$5_3().get_SelectedItems().length===1)return true;if(a==="EditProperties"&&this.get_$5_3()&&!this.get_$5_3().get_IsReadOnly()&&this.get_$5_3().get_SelectedItems().length===1)return true;if(a==="Indent"||a==="Outdent"||a==="MoveUp"||a==="MoveDown")if(this.get_$5_3()&&!this.get_$5_3().get_IsReadOnly())return this.get_$5_3().get_SelectedItems().length>0;else if(b>0){var h=this.get_ctx();return!!h&&h.AllowGridMode}if(a==="Delete"&&this.get_$5_3()&&!this.get_$5_3().get_IsReadOnly()&&this.get_$5_3().get_SelectedItemsIncludingProvisionalItems().length>0)return true;if(a==="ShowSubItems"&&this.get_$3G_3()===2)return true;if(a==="HideSubItems"&&this.get_$3G_3()===1)return true;if(a==="AddToTimeline")if(this.$L_3.has(12)&&this.$L_3.has(3))if(this.get_$5_3()){var i=this.get_$5_3().get_SelectedItems();return!!i&&i.length>0}else{var q=this.get_ctx(),j=q.ListSchema;if(!j)return false;var r=j.PropertyBag;return!!r&&this.get_ecbAdapter().getCountOfSelectedItems()>0}if(a==="MarkAsFeaturedCommand"||a==="UnmarkAsFeaturedCommand")if(b>0)if(this.$L_3.has(9)){var s=this.get_ecbAdapter().getSelectedItems(),d=s;for(var e in d){var t={key:e,value:d[e]},u=t.key.split(",");if(u[2]!=="1")return false}return true}return this.get_ecbAdapter().canHandleECBCommand(a)},$5o_3:function($p0){if($p0!==1)return false;var $v_0=this.get_ecbAdapter().getSelectedItems(),$$dict_2=$v_0;for(var $$key_3 in $$dict_2){var $v_2={key:$$key_3,value:$$dict_2[$$key_3]},$v_3=$v_2.key.split(",");if($v_3[2]==="1")return false}if(this.$1a_3==="True")return false;if(!this.$1Z_3.has(3))return false;var $v_1=eval("parseInt("+this.$1b_3+");");return $v_1===101||$v_1===109||$v_1===130||$v_1===115?true:false},$5q_3:function(){ULS04Z:;var f=this.get_ecbAdapter().getSelectedItems(),d=0,b=f;for(var c in b){var g={key:c,value:b[c]},e=g.key.split(",");if(e[2]==="1")return false;var a=e[1];if(a.indexOf(".0.")!==-1||a.indexOf(".1.")!==-1||a.indexOf(".2.")!==-1)return false;d++}return 1===d},get_$3G_3:function(){ULS04Z:;if(this.get_$5_3()){var c=this.get_$5_3().get_SelectedItems();return c.length===1?this.get_$5_3().GetNodeExpandCollapseState(c[0]):0}else if(this.get_ctx()&&this.getCountOfSelectedItems()===1){var f=this.get_ctx(),g=GetClientHierarchyManagerForWebpart(f.wpq),h=this.get_ecbAdapter().getSelectedItems(),a=h;for(var b in a){var i={key:b,value:a[b]},d=i.value;if(d){var e=d.id;if(e)return g.GetToggleStateById(parseInt(e))}}}return 0},handleCommand:function(a,b){ULS04Z:;var h=this.get_ctx(),e=this.get_ecbAdapter().getCountOfSelectedItems(),i=this._controlData[a];if(a==="QueryDisplayStandardView"){b.On=!this.canHandleCommand("DisplayStandardView");return true}else if(a==="QueryDisplayDatasheetView"){b.On=this.canHandleCommand("DisplayStandardView");return true}else if(a==="DisplayStandardView"){window.self.ExitGrid(this.$1c_3.toString("B").toUpperCase());return true}else if(a==="DisplayDatasheetView"){window.self.InitGridFromView(this.$1c_3.toString("B").toUpperCase());return true}else if(!SP.Ribbon.SU.$0(i)){this.executeClickScript(i.ClickScript);return true}else if(a==="PopulateModifyViewMenu"){b.PopulationXML=this.$5K_3();return true}else if(a==="ModifyView"||a==="ModifyThisView"){var f=new SP.Utilities.UrlBuilder(this.$1u_3("ViewEdit.aspx"));f.addKeyValueQueryString("List",this.$D_3);f.addKeyValueQueryString("View",this.$1c_3.toString("B").toUpperCase());SP.Utilities.HttpUtility.appendSourceAndNavigateTo(f.get_url())}else if(a==="ModifyViewInDesigner"){var s=window.self.ajaxNavigate;EditInSPD(s.get_href(),true)}else if(a==="CreateView"){var j=new SP.Utilities.UrlBuilder(this.$1u_3("ViewType.aspx"));j.addKeyValueQueryString("List",this.$D_3);SP.Utilities.HttpUtility.appendSourceAndNavigateTo(j.get_url())}else if(a==="DisplayView"){if(!this.get_hasViewSelectorInfo())return false;this.executeClickScript(b.CommandValueId)}else if(a==="QueryDisplayView"){b.Value=!SP.ScriptUtility.isNullOrEmptyString(this.$2E_3)?this.$2E_3:SP.Res.viewGroupDefault;return this.get_hasViewSelectorInfo()}else if(a==="QueryCurrentPage"){var k=this.$1U_3();if(!SP.Ribbon.SU.$0(k.CurrentRange))b.Value=k.CurrentRange;else b.Value="";return true}else if(a==="PreviousPage"){var l=this.$1U_3();!SP.Ribbon.SU.$0(l.PreviousNode)&&this.simulateClick(l.PreviousNode);return true}else if(a==="NextPage"){var m=this.$1U_3();!SP.Ribbon.SU.$0(m.NextNode)&&this.simulateClick(m.NextNode);return true}if(a==="EditDefaultForms")return true;if(a==="EditDefaultForm"){var t=b.CommandValueId;this.navigateToFormPageDesignMode(t);return true}else if(a==="PopulateDefaultFormsForList")if(SP.Ribbon.SU.$0(this.$14_3)){this.getDefaultFormsInfo();var u=b;u.PollAgainInterval=100;++this.$1k_3;if(SP.Ribbon.SU.$0(this.$1M_3)&&this.$1k_3>5)this.$1M_3=SP.UI.Notify.addNotification(SP.Utilities.HttpUtility.htmlEncode(SP.Res.genericLoading),true);return true}else{b.PopulationXML=this.$14_3;!SP.Ribbon.SU.$0(this.$1M_3)&&SP.UI.Notify.removeNotification(this.$1M_3);this.$1k_3=0;return true}else if(a==="PopulateViewDropDown"){if(!this.get_hasViewSelectorInfo())return false;if(SP.Ribbon.SU.$0(this.$1O_3)){this.getViewGroupInfo();var v=b;v.PollAgainInterval=100;return true}else{b.PopulationJSON=this.$1O_3;return true}}else if(a==="LibraryPermissions"){var g=this;EnsureScriptFunc("sharing.js","DisplaySharingDialog",function(){ULS04Z:;window.self.DisplaySharedWithDialog(g.$x_3,g.$D_3,null)})}else if(a==="EditList")this.$20_3("?Cmd=EditList",true);else if(a==="PopulateManageWorkFlowsMenu"){b.PopulationXML=this.$5J_3();return true}else if(a==="EditWorkflowSettings"||a==="ManageWorkflows"){var w=new SP.Guid(this.$D_3),x=this.$1u_3("wrksetng.aspx")+"?List="+SP.Utilities.HttpUtility.urlKeyValueEncode(w.toString("B").toUpperCase());SP.Utilities.HttpUtility.navigateTo(x)}else if(a==="AssociateWorkflows"){var y=new SP.Guid(this.$D_3),z=this.$1u_3("Addwrkfl.aspx")+"?List="+SP.Utilities.HttpUtility.urlKeyValueEncode(y.toString("B").toUpperCase());SP.Utilities.HttpUtility.navigateTo(z)}else if(a==="CreateWorkflowInDesigner")this.$20_3("?Cmd=NewWorkFlow",true);else if(a==="CreateReusableWorkflowInDesigner")this.$20_3("?Cmd=NewReusableWorkFlow",false);else if(a==="AddButton")this.$20_3("?Cmd=AddButton",true);else if(a==="NavigateUp"){NavigateUp(this.get_ctx());SP.Ribbon.PageManager.get_instance().get_commandDispatcher().executeCommand("appstatechanged",b)}else if(a==="ManageCopies"){if(e===1){var A=this.get_ctx();ManageCopies(A)}}else if(a==="AttachFile"){if(e===1){var B=this.get_ctx();AttachFile(B)}}else if(a==="EmailLibraryLink"){var C=h.HttpRoot,D=SP.Utilities.HttpUtility.urlPathEncode(this.$5F_3(C)),c=this.get_ecbAdapter().get_clvp().rootFolder;if(SP.Ribbon.SU.$0(c))c=h.listUrlDir;else c=SP.Utilities.HttpUtility.urlPathEncode(c);var n=new Sys.StringBuilder(D);n.append(c);SP.Ribbon.EMailLink.openMailerWithUrl(n.toString());return true}else if(a==="ExportToProject")SP.Ribbon.HierarchyTaskList.OpenSchedule(SP.ClientContext.get_current().get_web(),new SP.Guid(this.$D_3));else if(a==="MarkAsFeaturedCommand"){var E=this.selectedItemIds(),o=SP.ClientContext.get_current();SP.Utilities.Utility.markDiscussionAsFeatured(o,this.$D_3,E);o.executeQueryAsync(this.$$d_$60_3,this.$$d_$5z_3)}else if(a==="UnmarkAsFeaturedCommand"){var F=this.selectedItemIds(),p=SP.ClientContext.get_current();SP.Utilities.Utility.unmarkDiscussionAsFeatured(p,this.$D_3,F);p.executeQueryAsync(this.$$d_$60_3,this.$$d_$5z_3)}else if(a==="NavZoomIn")this.get_$5_3().ZoomInGantt();else if(a==="NavZoomOut")this.get_$5_3().ZoomOutGantt();else if(a==="NavScrollTask")this.get_$5_3().ScrollGanttToFocusedItem();else if(this.get_$5_3()&&a==="EditProperties")this.get_$5_3().LaunchEditItemFormForItem(this.get_$5_3().get_SelectedItems()[0]);else if(this.get_$5_3()&&a==="ViewProperties")this.get_$5_3().LaunchViewItemFormForItem(this.get_$5_3().get_SelectedItems()[0]);else if(this.get_$5_3()&&a==="Delete")this.get_$5_3().DeleteItems(this.get_$5_3().get_SelectedItemsIncludingProvisionalItems(),null);else if(a==="AddToTimeline")if(this.get_$5_3())this.get_$5_3().AddItemsToTimeline(this.get_$5_3().get_SelectedItems());else{var q=GetSelectedItemsNative();if(!SP.Ribbon.SU.$0(q)){var G=this.get_ctx(),H=G.ListSchema.PropertyBag,r=this;EnsureScriptFunc("sp.ui.timeline.js","SP.UI.Timeline",function(){ULS04Z:;GetTimelineView(H,function(a){ULS04Z:;AddItemsToTimeline(q,r.$D_3,a)})});return true}}else if(a==="Outdent")if(this.get_$5_3())this.get_$5_3().OutdentItems(this.get_$5_3().get_SelectedItems(),null);else OutdentItems(this.get_ctx());else if(a==="Indent")if(this.get_$5_3())this.get_$5_3().IndentItems(this.get_$5_3().get_SelectedItems(),null);else IndentItems(this.get_ctx());else if(a==="MoveUp")if(this.get_$5_3())this.get_$5_3().MoveItemsUp(this.get_$5_3().get_ContiguousSelectedItemsWithoutEntryItems(),null);else MoveItemsUp(this.get_ctx());else if(a==="MoveDown")if(this.get_$5_3())this.get_$5_3().MoveItemsDown(this.get_$5_3().get_ContiguousSelectedItemsWithoutEntryItems(),null);else MoveItemsDown(this.get_ctx());else if(a==="ShowSubItems"||a==="HideSubItems")return this.$6R_3();else{this.get_ecbAdapter().setEcbStateDirty();if(e===1&&!this.get_ecbAdapter().bulkOperationAvailableForCommand(a)&&this.get_ecbAdapter().supportsECBCommands())return this.get_ecbAdapter().executeECBCommand(a);else{var d=this.get_ctx();if(a==="CheckOut")CheckoutSelectedItems(d);else if(a==="CheckIn")CheckinSelectedItems(d);else if(a==="Delete")DeleteSelectedItems(d);else if(a==="DiscardCheckOut")DiscardCheckoutSelectedItems(d);else if(a==="Moderate")ModerateSelectedItems(d);else return false}}return false},$60_3:function(){ULS04Z:;RefreshPage(1)},$5z_3:function(){},selectedItemIds:function(){ULS04Z:;var d=this.get_ecbAdapter().getSelectedItems();if(SP.ScriptUtility.isNullOrUndefined(d))return"";var a="",e=null,b=d;for(var c in b){var f={key:c,value:b[c]};a=a+f.value.id+","}if(a.length)e=a.substring(0,a.length-1);return e},$2a_3:function(){ULS04Z:;return this.$L_3.has(12)&&this.$L_3.has(19)},$5g_3:function(){ULS04Z:;return this.$L_3.has(12)},$20_3:function(c,d){ULS04Z:;var b=new SP.Guid(this.$D_3),a=new Sys.StringBuilder;a.append(SP.PageContextInfo.get_webServerRelativeUrl());a.toString()!=="/"&&a.append("/");a.append(c);if(d){a.append("&ListId=");a.append(b.toString("B").toUpperCase())}EditInSPD(a.toString(),true)},$1u_3:function(a){ULS04Z:;return SP.Utilities.UrlBuilder.urlCombine(this.$x_3,SP.Utilities.Utility.get_layoutsLatestVersionRelativeUrl()+a)},getGlobalCommands:function(){ULS04Z:;return[]},$5F_3:function(a){ULS04Z:;if(SP.Ribbon.SU.$0(a))return"";var g=a.length,c=a.indexOf("://");if(c!==-1){var d=c+3,b=g-1,e=d<b?d:b,h=a.substr(e,b),f=h.indexOf("/");if(f!==-1)return a.substr(0,e+f)}return a},$6R_3:function(){ULS04Z:;if(this.get_$5_3()){var c=this.get_$5_3().get_SelectedItems();if(c.length===1){this.get_$5_3().ToggleExpandCollapse(parseInt(c[0]));SP.Ribbon.PageManager.get_instance().get_ribbon().refresh();return true}}else{var f=this.get_ctx(),g=GetClientHierarchyManagerForWebpart(f.wpq),h=this.get_ecbAdapter().getSelectedItems(),a=h;for(var b in a){var i={key:b,value:a[b]},d=i.value;if(d){var e=d.id;if(e){g.ToggleExpandById(parseInt(e));SP.Ribbon.PageManager.get_instance().get_ribbon().refresh();return true}}}}return false},getFocusedCommands:function(){ULS04Z:;var a=SP.Ribbon.WebPartPageComponent.prototype.getCommands.call(this);Array.add(a,"ModifyThisView");Array.add(a,"ModifyView");Array.add(a,"PopulateModifyViewMenu");Array.add(a,"ModifyViewInDesigner");Array.add(a,"PopulateViewDropDown");Array.add(a,"NextPage");Array.add(a,"CurrentPage");Array.add(a,"QueryCurrentPage");Array.add(a,"PreviousPage");Array.add(a,"LibraryPermissions");Array.add(a,"EditList");Array.add(a,"ManageCopies");Array.add(a,"AttachFile");Array.add(a,"DisplayExplorerView");Array.add(a,"EditDefaultForms");Array.add(a,"EditDefaultForm");Array.add(a,"PopulateDefaultFormsForList");Array.add(a,"EmailLibraryLink");Array.add(a,"Moderate");Array.add(a,"ChangeNewButton");Array.add(a,"QueryDisplayStandardView");Array.add(a,"QueryDisplayDatasheetView");Array.add(a,"ViewWorkflows");Array.add(a,"PopulateManageWorkFlowsMenu");Array.add(a,"ManageWorkflows");Array.add(a,"AssociateWorkflows");Array.add(a,"EditWorkflowSettings");Array.add(a,"CreateReusableWorkflowInDesigner");Array.add(a,"CreateWorkflowInDesigner");Array.add(a,"AddButton");Array.add(a,"NavigateUp");!Array.contains(a,"DisplayStandardView")&&Array.add(a,"DisplayStandardView");!Array.contains(a,"DisplayDatasheetView")&&Array.add(a,"DisplayDatasheetView");!Array.contains(a,"CreateView")&&Array.add(a,"CreateView");Array.add(a,"NavZoomIn");Array.add(a,"NavZoomOut");Array.add(a,"NavScrollTask");Array.add(a,"Indent");Array.add(a,"Outdent");Array.add(a,"MoveUp");Array.add(a,"MoveDown");Array.add(a,"ShowSubItems");Array.add(a,"HideSubItems");Array.add(a,"MarkAsFeaturedCommand");Array.add(a,"UnmarkAsFeaturedCommand");Array.add(a,"AddToTimeline");return a},$5K_3:function(){ULS04Z:;var a=new Sys.StringBuilder;a.append("<Menu Id='Ribbon.List.CustomViews.ModifyView.Menu'>");a.append("<MenuSection DisplayMode='Menu' Id='Ribbon.List.CustomViews.ModifyView.Menu.Manage'>");a.append("<Controls Id='Ribbon.List.CustomViews.ModifyView.Menu.Manage.Controls'>");a.append("<Button");a.append(" Id='Ribbon.List.CustomViews.ModifyView.Menu.Manage.ModifyView'");a.append(" Command='");a.append("ModifyView");a.append("'");a.append(" LabelText='");a.append(SP.Utilities.HttpUtility.htmlEncode(SP.Res.modifyViewLabel));a.append("'");a.append("/>");if(!this.$29_3){a.append("<Button");a.append(" Id='Ribbon.List.CustomViews.ModifyView.Menu.Manage.ModifyViewInDesigner'");a.append(" Command='");a.append("ModifyViewInDesigner");a.append("'");a.append(" LabelText='");a.append(SP.Utilities.HttpUtility.htmlEncode(SP.Res.modifyInDesignerLabel));a.append("'");a.append("/>")}a.append("</Controls>");a.append("</MenuSection>");a.append("</Menu>");return a.toString()},$5J_3:function(){ULS04Z:;var a=new Sys.StringBuilder;a.append("<Menu Id='Ribbon.List.Settings.ManageWorkflows.Menu'>");a.append("<MenuSection DisplayMode='Menu' Id='Ribbon.List.Settings.ManageWorkflows.Menu.Manage'>");a.append("<Controls Id='Ribbon.List.Settings.ManageWorkflows.Menu.Manage.Controls'>");a.append("<Button");a.append(" Id='Ribbon.List.Settings.ManageWorkflows.Menu.Manage.EditSettings'");a.append(" Command='");a.append("EditWorkflowSettings");a.append("'");a.append(" MenuItemId='Ribbon.List.Settings.ManageWorkflows.Menu.Manage.WorkflowSettings.Menu'");a.append(" LabelText='");a.append(SP.Utilities.HttpUtility.htmlEncode(SP.Res.workflowSettingsLabel));a.append("'");a.append("/>");a.append("<Button");a.append(" Id='Ribbon.List.Settings.ManageWorkflows.Menu.Manage.Associate'");a.append(" Command='");a.append("AssociateWorkflows");a.append("'");a.append(" MenuItemId='Ribbon.List.Settings.ManageWorkflows.Menu.Manage.Associate.Menu'");a.append(" LabelText='");a.append(SP.Utilities.HttpUtility.htmlEncode(SP.Res.associateWorkflowLabel));a.append("'");a.append("/>");a.append("</Controls>");a.append("</MenuSection>");if(!this.$29_3){a.append("<MenuSection DisplayMode='Menu' Id='Ribbon.List.Settings.ManageWorkflows.Menu.CreateInSP'>");a.append("<Controls Id='Ribbon.List.Settings.ManageWorkflows.Menu.CreateInSP.Controls'>");a.append("<Button");a.append(" Id='Ribbon.List.Settings.ManageWorkflows.Menu.CreateInSP.CreateWorkflowInDesigner'");a.append(" Command='");a.append("CreateWorkflowInDesigner");a.append("'");a.append(" LabelText='");a.append(SP.Utilities.HttpUtility.htmlEncode(SP.Res.createWorkflowInDesignerLabel));a.append("'");a.append("/>");a.append("<Button");a.append(" Id='Ribbon.List.Settings.ManageWorkflows.Menu.CreateInSP.CreateReusableWorkflowInDesigner'");a.append(" Command='");a.append("CreateReusableWorkflowInDesigner");a.append("'");a.append(" LabelText='");a.append(SP.Utilities.HttpUtility.htmlEncode(SP.Res.createReUsableWorkflowInDesignerLabel));a.append("'");a.append("/>");a.append("</Controls>");a.append("</MenuSection>")}a.append("</Menu>");return a.toString()},addAlwaysEnabledCommands:function(){ULS04Z:;SP.Ribbon.WebPartPageComponent.prototype.addAlwaysEnabledCommands.call(this);var a=this.get_alwaysEnabledCommands();a.ViewsTab=true;a.TrackTab=true;a.ViewFormatGroup=true;a.WorkflowGroup=true;a.DisplayView=true;a.QueryDisplayView=true;a.DatasheetGroup=true;a.ViewActionsGroup=true;a.CustomViewsGroup=true;a.NotificationsGroup=true;a.ShareGroup=true;a.GanttViewGroup=true;a.HierarchyGroup=true;a.CurrentView=true;a.ModerateDiscussionsGroup=true},get_ctx:function(){ULS04Z:;return SP.Ribbon.NativeUtility.getCtxForView("{"+this.$H_3.toUpperCase()+"}")},getCountOfSelectedItems:function(){ULS04Z:;return this.get_ecbAdapter().getCountOfSelectedItems()},$1L_3:false,$14_3:null,$1M_3:null,$1k_3:0,get_defaultFormsDropDownXml:function(){ULS04Z:;return this.$14_3},getDefaultFormsInfo:function(){ULS04Z:;if(this.$1L_3)return;this.$1L_3=true;var a=new SP.Guid(this.$D_3);SP.Application.UI.DefaultFormsMenuBuilder.getDefaultFormsInformation(this,a)},onDefaultFormsInformationRetrieveSuccess:function(a){ULS04Z:;this.$1L_3=false;this.$14_3=this.$4r_3(a)},onDefaultFormsInformationRetrieveFailure:function(){ULS04Z:;this.$1L_3=false;this.$14_3=this.$3D_3(SP.Utilities.HttpUtility.htmlEncode(SP.Res.relationships_ListFormsFetchFailed))},$31_3:function(c,a,b){ULS04Z:;if(!SP.ScriptUtility.isNullOrEmptyString(a.NewFormUrl)){var d=SP.Utilities.HttpUtility.htmlEncode(!b?SP.Res.relationships_DefaultNewForm:String.format(SP.Res.relationships_CTNewForm,a.ContentTypeName)),e="-205",f="-1",g="-409",h="-35";c.append('<Button \r\n                                    Id="Ribbon.List.Settings.EditDefaultForms.Menu.MS.EditDefaultFormNew'+b+'"\r\n                                    CommandValueId="'+SP.Utilities.HttpUtility.htmlEncode(a.NewFormUrl)+'"\r\n                                    Command="EditDefaultForm"\r\n                                    Image16by16="'+this.$1y_3+'"\r\n                                    Image16by16Top="'+e+'"\r\n                                    Image16by16Left="'+f+'"\r\n                                    Image32by32="'+this.$1z_3+'"\r\n                                    Image32by32Top="'+g+'"\r\n                                    Image32by32Left="'+h+'"\r\n                                    LabelText="'+d+'" \r\n                                />')}if(!SP.ScriptUtility.isNullOrEmptyString(a.DisplayFormUrl)){var i=SP.Utilities.HttpUtility.htmlEncode(!b?SP.Res.relationships_DefaultDisplayForm:String.format(SP.Res.relationships_CTDisplayForm,a.ContentTypeName)),j="-289",k="-127",l="-1",m="-171";c.append('<Button \r\n                                    Id="Ribbon.List.Settings.EditDefaultForms.Menu.MS.EditDefaultFormDisplay'+b+'"\r\n                                    CommandValueId="'+SP.Utilities.HttpUtility.htmlEncode(a.DisplayFormUrl)+'"\r\n                                    Command="EditDefaultForm"\r\n                                    Image16by16="'+this.$1y_3+'"\r\n                                    Image16by16Top="'+j+'"\r\n                                    Image16by16Left="'+k+'"\r\n                                    Image32by32="'+this.$1z_3+'"\r\n                                    Image32by32Top="'+l+'"\r\n                                    Image32by32Left="'+m+'"\r\n                                    LabelText="'+i+'" \r\n                                />')}if(!SP.ScriptUtility.isNullOrEmptyString(a.EditFormUrl)){var n=SP.Utilities.HttpUtility.htmlEncode(!b?SP.Res.relationships_DefaultEditForm:String.format(SP.Res.relationships_CTEditForm,a.ContentTypeName)),o="-199",p="-73",q="-1",r="-171";c.append('<Button \r\n                                    Id="Ribbon.List.Settings.EditDefaultForms.Menu.MS.EditDefaultFormEdit'+b+'"\r\n                                    CommandValueId="'+SP.Utilities.HttpUtility.htmlEncode(a.EditFormUrl)+'"\r\n                                    Command="EditDefaultForm"\r\n                                    Image16by16="'+this.$1y_3+'"\r\n                                    Image16by16Top="'+o+'"\r\n                                    Image16by16Left="'+p+'"\r\n                                    Image32by32="'+this.$1z_3+'"\r\n                                    Image32by32Top="'+q+'"\r\n                                    Image32by32Left="'+r+'"\r\n                                    LabelText="'+n+'" \r\n                                />')}},$4r_3:function(b){ULS04Z:;if(SP.ScriptUtility.isNullOrEmptyString(b.DefaultForms.DisplayFormUrl)&&SP.ScriptUtility.isNullOrEmptyString(b.DefaultForms.NewFormUrl)&&SP.ScriptUtility.isNullOrEmptyString(b.DefaultForms.EditFormUrl))return this.$3D_3(SP.Utilities.HttpUtility.htmlEncode(SP.Res.relationships_NoNewEditDisplayListForms));var a=new Sys.StringBuilder;a.append('\r\n                <Menu Id="Ribbon.List.Settings.EditDefaultForms.Menu">');a.append('\r\n                  <MenuSection Id="Ribbon.List.Settings.EditDefaultForms.Menu.Default" Scrollable="false" DisplayMode="Menu16">\r\n                    <Controls Id="Ribbon.List.Settings.EditDefaultForms.Menu.Default.Controls">');this.$31_3(a,b.DefaultForms,0);a.append("\r\n                    </Controls>\r\n                  </MenuSection>");for(var d=new Sys.StringBuilder,c=0;c<b.OtherForms.length;++c){var e=b.OtherForms[c];this.$31_3(d,e,c+1)}if(!d.isEmpty()){a.append(String.format('\r\n                  <MenuSection Title="{0}" Id="Ribbon.List.Settings.EditDefaultForms.Menu.Other" Scrollable="false" DisplayMode="Menu16">\r\n                    <Controls Id="Ribbon.List.Settings.EditDefaultForms.Menu.Other.Controls">',SP.Utilities.HttpUtility.htmlEncode(SP.Res.relationships_CTForms)));a.append(d.toString());a.append("\r\n                    </Controls>\r\n                  </MenuSection>")}a.append("\r\n                </Menu>");return a.toString()},$3D_3:function(b){ULS04Z:;var a=new Sys.StringBuilder;a.append('\r\n                <Menu Id="Ribbon.List.Settings.EditDefaultForms.Menu">');a.append('\r\n                  <MenuSection Id="Ribbon.List.Settings.EditDefaultForms.Menu.Default" Scrollable="false" DisplayMode="Menu16">\r\n                    <Controls Id="Ribbon.List.Settings.EditDefaultForms.Menu.Default.Controls">');a.append('\r\n                    <Button \r\n                        Id="Ribbon.List.Settings.EditDefaultForms.Menu.MS.ListFormFetchErrorMessage"\r\n                        Image16by16="'+SP.Utilities.Utility.get_layoutsLatestVersionUrl()+'images/edit.gif"\r\n                        Image32by32="'+SP.Utilities.Utility.get_layoutsLatestVersionUrl()+'images/placeholder32x32.png"\r\n                        LabelText="'+b+'"\r\n                    />');a.append("\r\n                    </Controls>\r\n                  </MenuSection>");a.append("\r\n                </Menu>");return a.toString()},navigateToFormPageDesignMode:function(b){ULS04Z:;var a=new SP.Utilities.UrlBuilder(b);a.addKeyValueQueryString("DisplayMode","Design");a.addKeyValueQueryString("InitialTabId","Ribbon.WebPartPage");a.addKeyValueQueryString("VisibilityContext","WSSWebPartPage");SP.Utilities.HttpUtility.appendSourceAndNavigateTo(a.get_url())},get_viewSelectorOptions:function(){ULS04Z:;if(SP.Ribbon.SU.$0(this.$1N_3)&&!SP.Ribbon.SU.$0(this.get_$1R_3().ViewDropDownOptions))this.$1N_3=eval("("+this.get_$1R_3().ViewDropDownOptions+")");return this.$1N_3},$2Q_3:null,$1g_3:false,$1O_3:null,get_viewDropDownXml:function(){ULS04Z:;return this.$1O_3},get_hasViewSelectorInfo:function(){ULS04Z:;return!SP.Ribbon.SU.$0(this.get_viewSelectorOptions())},getViewGroupInfo:function(){ULS04Z:;if(this.$1g_3)return;this.$1g_3=true;SP.Application.UI.ViewSelectorMenuBuilder.getViewInformation(this,this.$1N_3)},onViewInformationReturned:function(a){ULS04Z:;this.$2Q_3=a;this.$1g_3=false;this.$1O_3=this.$4s_3(this.$2Q_3)},$1n_3:function(g,b,c,j){ULS04Z:;var e=j.appendChild("MenuSection",{Id:b});if(!SP.Ribbon.SU.$0(g))e.get_attributes().Title=g;for(var f=e.appendChild("Controls",{Id:b+".Controls"}),a=0;a<c.length;a++){if(SP.Application.UI.ViewSelectorSubMenu.isInstanceOfType(c[a])){var i=c[a];this.$4C_3(i,b,f)}var d=c[a],h=this.$2V_3(d);this.$2R_3(d.Text,b+"."+d.Id,h,f)}},$2V_3:function(a){ULS04Z:;return a.ActionScriptText},$4C_3:function(f,m,n){ULS04Z:;var a=m+".SubMenu",g=f.Text,b=SP.Ribbon.SU.$0(g),c="";if(!b)c=g;var h=n.appendChild("FlyoutAnchor",{Id:a,Command:"PopulateViewDropDown"});if(!b)h.get_attributes().Title=c;a+=".Menu";var j=h.appendChild("Menu",{Id:a});a+=".SubMenu1";var i=j.appendChild("MenuSection",{Id:a});if(!b)i.get_attributes().Title=c;for(var k=i.appendChild("Controls",{Id:a+".Controls"}),d=0;d<f.SubMenuItems.length;d++){var e=f.SubMenuItems[d],l=this.$2V_3(e);this.$2R_3(e.Text,a+"."+e.Id,l,k)}},$2R_3:function(a,d,b,e){ULS04Z:;var c=!SP.Ribbon.SU.$2(a)?a:SP.Res.viewGroupDefault;e.appendChild("Button",{Id:d,MenuItemId:b,CommandValueId:b,CommandType:"OptionSelection",Command:"DisplayView",LabelText:c})},$4s_3:function(a){ULS04Z:;var b=new CUI.JsonXmlElement("Menu",{Id:this.get_viewDropDownIdPrefix()+".Menu"});if(a.DefaultView){var c=b.appendChild("MenuSection",{Title:SP.Res.viewGroupDefault,Id:this.get_viewDropDownIdPrefix()+".Menu.DefaultView"}).appendChild("Controls",{Id:this.get_viewDropDownIdPrefix()+".Menu.DefaultView.Controls"});this.$2R_3(a.DefaultView.Text,this.get_viewDropDownIdPrefix()+".Menu.DefaultView.DefaultView."+a.DefaultView.Id,this.$2V_3(a.DefaultView),c)}a.PersonalViews.length>0&&this.$1n_3(SP.Res.viewGroupPersonal,this.get_viewDropDownIdPrefix()+".Menu.Personal",a.PersonalViews,b);a.PublicViews.length>0&&this.$1n_3(SP.Res.viewGroupPublic,this.get_viewDropDownIdPrefix()+".Menu.Public",a.PublicViews,b);a.ModeratedViews.length>0&&this.$1n_3(SP.Res.viewGroupModerated,this.get_viewDropDownIdPrefix()+".Menu.Moderated",a.ModeratedViews,b);a.OtherViews.length>0&&this.$1n_3(SP.Res.viewGroupOther,this.get_viewDropDownIdPrefix()+".Menu.Other",a.OtherViews,b);return b},get_newMenuRecords:function(){ULS04Z:;if(SP.Ribbon.SU.$0(this.$1j_3)&&!SP.Ribbon.SU.$0(this.get_$1R_3().NewMenuData))this.$1j_3=eval(this.get_$1R_3().NewMenuData);return this.$1j_3},getDefaultNewMenuItemScript:function(){ULS04Z:;if(this.get_newMenuData().length>0){var a=this.get_newMenuData()[0];return!SP.ScriptUtility.isNullOrUndefined(a.CommandValueId)?a.CommandValueId:!SP.ScriptUtility.isNullOrUndefined(a.ClickScript)?a.ClickScript:null}return null},$p_3:null,get_newMenuData:function(){ULS04Z:;if(SP.Ribbon.SU.$0(this.$p_3))this.$p_3=eval("("+this.get_$1R_3().NewMenuData+")");return this.$p_3},getNewMenuXml:function(d,b){ULS04Z:;for(var c=new CUI.JsonXmlElement("Menu",{Id:b}),e=c.appendChild("MenuSection",{DisplayMode:"Menu32",Id:b+".Menu.ContentTypes"}).appendChild("Controls",{Id:b+".Menu.ContentTypes.Controls"}),a=0;a<this.get_newMenuData().length;a++)this.$4B_3(b+".Menu.ContentTypes."+a.toString(),d,this.$p_3[a].ClickScript,this.$p_3[a].LabelText,this.$p_3[a].Description,this.$p_3[a].Image32by32,e);return c},$4B_3:function(b,c,a,d,e,f,g){ULS04Z:;g.appendChild("Button",{Id:b,Command:c,MenuItemId:a,CommandValueId:a,CommandType:"OptionSelection",LabelText:d,Description:e,Image32by32:f})},$1U_3:function(){ULS04Z:;var b=new SP.Ribbon.PagingInformation,h="WPQ1",c=this.getId();if(c.startsWith("WebPart")&&c.length>7)h=c.substring(7,c.length);var i=$get("bottomPagingCell"+h);if(!SP.Ribbon.SU.$0(i)){var d=i.firstChild;if(d.tagName==="SCRIPT")d=d.nextSibling;for(var j=d.firstChild.firstChild,g=0;g<j.childNodes.length;g++){var a=j.childNodes[g];if(a.nodeType!==1)continue;if(a.className==="ms-paging")b.CurrentRange=SP.UI.UIUtility.getInnerText(a);else{var e=a.firstChild.firstChild.src,f=a.id;if(e&&e.endsWith("prev.gif")||f&&f.endsWith("prev"))b.PreviousNode=a.firstChild;else if(e&&e.endsWith("next.gif")||f&&f.endsWith("next"))b.NextNode=a.firstChild}}}return b},get_$5_3:function(){ULS04Z:;return window.self[this.getId()+"_JSGridController"]},get_$1R_3:function(){ULS04Z:;return this._data},$1f_3:null,get_ecbAdapter:function(){ULS04Z:;if(null===this.$1f_3)this.$1f_3=new SP.Utilities.Internal.ECBAdapter(this.get_ctx(),null,"");return this.$1f_3},get_viewDropDownIdPrefix:function(){ULS04Z:;return"Ribbon.List.CustomViews.DisplayView"}};SP.Ribbon.HierarchyTaskList=function(){};SP.Ribbon.HierarchyTaskList.OpenSchedule=function(a,c){ULS04Z:;if(SP.Ribbon.HierarchyTaskList.$6U())return;try{var d=SP.ClientContext.get_current().get_site();d.retrieve("Id");a.get_allProperties().retrieve();a.retrieve("ServerRelativeUrl","Url");a.get_lists().ensureSiteAssetsLibrary();var b=a.get_lists().getById(c);b.retrieve("Title");var e=b.get_rootFolder();e.get_properties().retrieve();SP.ClientContext.get_current().executeQueryAsync(function(){ULS04Z:;try{var e=SP.Ribbon.HierarchyTaskList.$5I(b),f=SP.Ribbon.HierarchyTaskList.$5H(a,e);SP.Ribbon.HierarchyTaskList.$5G(a,f,function(f){ULS04Z:;SP.Ribbon.HierarchyTaskList.$4G(d,a,b,c,e,f)},function(){ULS04Z:;alert(SP.Res.openScheduleGeneralFailure)})}catch(i){SP.Ribbon.HierarchyTaskList.$43(i)}},function(){ULS04Z:;alert(SP.Res.openScheduleGeneralFailure)})}catch(f){SP.Ribbon.HierarchyTaskList.$43(f)}};SP.Ribbon.HierarchyTaskList.$4G=function(d,a,e,f,g,h){ULS04Z:;var c=SP.Ribbon.HierarchyTaskList.TaskLauncher.getInstance(),b=a.get_url();if(Sys.Browser.agent!==Sys.Browser.InternetExplorer)b=SP.Utilities.HttpUtility.urlPathEncode(b);try{c.openSchedule(d.get_id().toString(),b,e.get_title(),f.toString(),g,h,SP.Ribbon.HierarchyTaskList.$2X(a,"MSPWAPROJUID"),SP.Ribbon.HierarchyTaskList.$2X(a,"DistinguishedListUid"),SP.Ribbon.HierarchyTaskList.$2X(a,"MSPWASITEUID"))}finally{}};SP.Ribbon.HierarchyTaskList.$5G=function(e,a,b,f){ULS04Z:;if(SP.ScriptUtility.isNullOrEmptyString(a)){b(false);return}var c=a.indexOf("?");if(c>=0)a=a.substr(0,c);var d=e.getFileByServerRelativeUrl(a);d.retrieve("Exists");SP.ClientContext.get_current().executeQueryAsync(function(){ULS04Z:;b(d.get_exists())},function(c,a){ULS04Z:;if(a.get_errorCode()===-2147024894)b(false);else f(Error.create(a.get_message()))})};SP.Ribbon.HierarchyTaskList.$5I=function(d){ULS04Z:;var b=d.get_rootFolder(),a;if("MppUrl"in b.get_properties().get_fieldValues()){a=b.get_properties().get_item("MppUrl");if(SP.ScriptUtility.isNullOrEmptyString(a))a="";else if(a.indexOf("/")===-1)a=SP.Ribbon.HierarchyTaskList.$6V(a);else{var c=String.format(SP.Res.openScheduleListPropertyCorrupted,"MppUrl",a);throw Error.invalidOperation(c);}}else a="";return a};SP.Ribbon.HierarchyTaskList.$5H=function(c,b){ULS04Z:;var a;if(SP.ScriptUtility.isNullOrEmptyString(b))a=b;else a=SP.Utilities.UrlBuilder.urlCombine(c.get_serverRelativeUrl(),"SiteAssets/"+b);return a};SP.Ribbon.HierarchyTaskList.$2X=function(a,b){ULS04Z:;return b in a.get_allProperties().get_fieldValues()?a.get_allProperties().get_item(b):""};SP.Ribbon.HierarchyTaskList.$6V=function(a){ULS04Z:;return window.unescapeProperly(a)};SP.Ribbon.HierarchyTaskList.$43=function(){ULS04Z:;alert(SP.Res.openScheduleGeneralFailure)};SP.Ribbon.HierarchyTaskList.$6J=function(){ULS04Z:;var b=window.event||{},a=b;return"shiftKey"in a&&a.shiftKey};SP.Ribbon.HierarchyTaskList.$6U=function(){ULS04Z:;return!SP.ULS.get_enabled()&&SP.Ribbon.HierarchyTaskList.$6J()?SP.ULS.get_enabled():false};SP.Ribbon.HierarchyTaskList.Continuation=function(){};SP.Ribbon.HierarchyTaskList.TaskLauncher=function(){};SP.Ribbon.HierarchyTaskList.TaskLauncher.getInstance=function(){ULS04Z:;return new SP.Ribbon.HierarchyTaskList.TaskLauncher};SP.Ribbon.HierarchyTaskList.TaskLauncher.prototype={get_isMSProjectAvailable:function(){ULS04Z:;return phManager.IsProtocolHandlerEnabled("ms-project")},navigate:function(a){ULS04Z:;if(!this.get_isMSProjectAvailable()){alert(SP.Res.winprojTooOld);return}if(typeof navigator.msLaunchUri=="function"){var b=this;navigator.msLaunchUri(a,null,function(){ULS04Z:;alert(SP.Res.winprojTooOld)})}else if(IsSupportedFirefoxOnWin())phManager.LaunchProtocolHandlerInIFrame(a,SP.Res.winprojTooOld);else if(IsSupportedChromeOnWin())phManager.LaunchProtocolHandler(a,SP.Res.winprojTooOld);else window.location.href=a},openSchedule:function(f,g,j,h,b,i,c,d,e){ULS04Z:;var a="ms-project:osc";a+="|u|"+g;a+="|b|"+h;if(!SP.ScriptUtility.isNullOrEmptyString(b))a+="|c|"+b;a+="|d|"+(i?"1":"0");if(!SP.ScriptUtility.isNullOrEmptyString(e))a+="|g|"+e;if(!SP.ScriptUtility.isNullOrEmptyString(c))a+="|h|"+c;if(!SP.ScriptUtility.isNullOrEmptyString(d))a+="|i|"+d;a+="|j|"+f;this.navigate(a)}};SP.Ribbon.ListFormWebPartPageComponentData=function(){ULS04Z:;SP.Ribbon.ListFormWebPartPageComponentData.initializeBase(this)};SP.Ribbon.ListFormWebPartPageComponentData.prototype={ViewId:null};SP.Ribbon.ListFormWebPartPageComponent=function(b,a){ULS04Z:;SP.Ribbon.ListFormWebPartPageComponent.initializeBase(this,[b,a]);this.$H_3=a.ViewId};SP.Ribbon.ListFormWebPartPageComponent.prototype={$H_3:null,canHandleCommand:function(a){ULS04Z:;if(a==="Ribbon.ListForm.Edit.Clipboard.Cut"||a==="Ribbon.ListForm.Edit.Clipboard.Copy"||a==="Ribbon.ListForm.Edit.Clipboard.Paste")return true;if(a==="Ribbon.ListForm.Edit.Actions.AttachFile"&&window.browseris.ipad)return false;if(!SP.Ribbon.SU.$0(this.get_alwaysEnabledCommands()[a]))return true;var b=this._controlData[a];if(!SP.Ribbon.SU.$0(b))if(b.Enabled==="False")return false;return SP.Ribbon.WebPartPageComponent.prototype.canHandleCommand.call(this,a)?true:false},handleCommand:function(a){ULS04Z:;var b=this._controlData[a];if(!SP.Ribbon.SU.$0(b)){if(a==="Ribbon.ListForm.Edit.Commit.SaveAsDraft"||a==="Ribbon.ListForm.Edit.Commit.Publish"||a==="Ribbon.ListForm.Edit.Commit.CheckIn"||a==="Ribbon.ListForm.Edit.Commit.Cancel"||a==="Ribbon.ListForm.Display.Manage.ClaimReleaseTask"||a==="Ribbon.ListForm.Display.Manage.DeleteItemVersion"||a==="Ribbon.ListForm.Display.Manage.RestoreItemVersion"||a==="Ribbon.ListForm.Display.HealthActions.HealthRuleRunNow"||a==="Ribbon.ListForm.Display.HealthActions.HealthReportRunNow"||a==="Ribbon.ListForm.Display.HealthActions.HealthReportRepair"){var h=$get(b.ElementClientId);h&&this.simulateClick(h)}else if(a==="Ribbon.ListForm.Display.Manage.DeleteItem"){var c="",e="";if(!SP.Ribbon.SU.$2(b.ClickScript))if(b.ClickScript.indexOf("DeleteInstanceConfirmation()")!==-1)e="DeleteInstanceConfirmation()";else if(b.ClickScript.indexOf("DeleteItemConfirmation()")!==-1)e="DeleteItemConfirmation()";var f=$get(b.ElementClientId);if(f&&!SP.Ribbon.SU.$2(e)){c=f.getAttribute("href");if(!SP.Ribbon.SU.$2(c)){c=c.replace("javascript:","");c="if("+e+"){"+c+";};"}}if(!SP.Ribbon.SU.$2(c))this.executeClickScript(c);else f&&this.simulateClick(f)}else if(a==="Ribbon.ListForm.Display.Solution.ActivateSolution"||a==="Ribbon.ListForm.Display.Solution.DeactivateSolution"||a==="Ribbon.ListForm.Display.Solution.UpgradeSolution"){var g=$get(b.ElementClientId),d="";if(g){d=g.getAttribute("href");if(!SP.Ribbon.SU.$2(d))d=d.replace("javascript:","")}if(!SP.Ribbon.SU.$2(d))this.executeClickScript(d);else g&&this.simulateClick(g)}else!SP.Ribbon.SU.$2(b.ClickScript)&&this.executeClickScript(b.ClickScript);return true}if(a==="Ribbon.ListForm.Edit.Clipboard.Cut"){this.executeClipboardCommand("Cut");return true}else if(a==="Ribbon.ListForm.Edit.Clipboard.Copy"){this.executeClipboardCommand("Copy");return true}else if(a==="Ribbon.ListForm.Edit.Clipboard.Paste"){this.executeClipboardCommand("Paste");return true}return false},executeClipboardCommand:function(a){ULS04Z:;try{var b=document.body.ownerDocument.execCommand(a,false,null);!b&&alert(SP.Res.errorClipboard)}catch(c){alert(SP.Res.errorClipboard)}},executeClickScript:function(a){ULS04Z:;SP.Ribbon.NativeUtility.executeClickScriptSimple(a)},getGlobalCommands:function(){ULS04Z:;var a=SP.Ribbon.WebPartPageComponent.prototype.getGlobalCommands.call(this);Array.add(a,"Ribbon.ListForm.Edit.Clipboard.Paste");Array.add(a,"Ribbon.ListForm.Edit.Clipboard.Copy");Array.add(a,"Ribbon.ListForm.Edit.Clipboard.Cut");return a},getFocusedCommands:function(){ULS04Z:;return SP.Ribbon.WebPartPageComponent.prototype.getFocusedCommands.call(this)},addAlwaysEnabledCommands:function(){ULS04Z:;var a=this.get_alwaysEnabledCommands();a["Ribbon.ListForm.Edit"]=true;a["Ribbon.ListForm.Edit.CommitGroup"]=true;a["Ribbon.ListForm.Edit.ActionsGroup"]=true;a["Ribbon.ListForm.Edit.ClipboardGroup"]=true;a["Ribbon.ListForm.Display"]=true;a["Ribbon.ListForm.Display.ManageGroup"]=true;a["Ribbon.ListForm.Display.HealthActionsGroup"]=true;a["Ribbon.ListForm.Display.Solution.SolutionGroup"]=true;a["Ribbon.ListForm.Display.ActionsGroup"]=true},isFocusable:function(){ULS04Z:;return false}};SP.Ribbon.DocLibWebPartPageComponent=function(b,a){ULS04Z:;SP.Ribbon.DocLibWebPartPageComponent.initializeBase(this,[b,a]);this.$H_4=a.ViewId;this.$D_4=a.ListId;this.$x_4=a.ServerRelativeWebUrl};SP.Ribbon.DocLibWebPartPageComponent.prototype={$C_4:null,$H_4:null,$D_4:null,$x_4:null,handleCommand:function(c,d,j){ULS04Z:;var b=this.get_ctx(),o=this.getCountOfSelectedItems();if(c==="PopulateSendToMenu"){d.PopulationXML=this.$5N_4();return true}else if(c==="PopulateNewDocumentMenu"){d.PopulationJSON=this.getNewMenuXml("NewDocument","Ribbon.Document.All.NewDocument");return true}else if(c==="NewDocument"){var k=d.CommandValueId;this.executeClickScript(k);return true}else if(c==="NewDefaultDocument"){this.executeClickScript(this.getDefaultNewMenuItemScript());return true}else if(c==="SendToOfficialFile"){var l=d.CommandValueId;this.get_ecbAdapter().executeECBCommand(l);return true}else if(c==="ShareItem"){if(this.getCountOfSelectedItems()!==1)return true;var g=this.selectedItemIds();if(!SP.Ribbon.SU.$2(g)){var m=g.split(",",1),f=m[0];if(!SP.Ribbon.SU.$2(this.$x_4)&&!SP.Ribbon.SU.$2(this.$D_4)&&!SP.Ribbon.SU.$2(f)){var e=this;EnsureScriptFunc("sharing.js","DisplaySharingDialog",function(){ULS04Z:;var a=window.self.currentItemFSObjType,c=window.self.currentItemProgId,d=b.RealHttpRoot,g=b.HttpRoot;if(SP.ScriptUtility.isNullOrUndefined(g)||SP.ScriptUtility.isNullOrUndefined(d))window.self.DisplaySharingDialogCore(e.$x_4,e.$D_4,f,0,a,c);else window.self.DisplaySharingDialogCore(g,e.$D_4,f,0,a,c,false,null,d)})}}}else if(c==="Sync"){var a=b.rootFolder;if(SP.ScriptUtility.isNullOrUndefined(a))a="";else{a=a.trim();a=a.replace(new RegExp("%2F","gi"),"/");var h=b.listUrlDir;if(!SP.ScriptUtility.isNullOrUndefined(h)){var i=h.trim();if(!a.indexOf(i))a=a.substr(i.length)}}var n=this;EnsureScriptFunc("offline.js",window.g_syncButtonUsePopup?"TakeOfflineToClientWithPopup":"TakeOfflineToClientReal",function(){ULS04Z:;window[window.g_syncButtonUsePopup?"TakeOfflineToClientWithPopup":"TakeOfflineToClientReal"](a!==""?3:2,b.SiteTemplateId,b.HttpRoot,b.listBaseType,b.ListTemplateType,b.listName,a);SP.QoS.WriteUserEngagement("DocLib_SyncRibbonBtnPressed")})}return SP.Ribbon.ListViewWebPartPageComponent.prototype.handleCommand.call(this,c,d,j)},addAlwaysEnabledCommands:function(){ULS04Z:;SP.Ribbon.ListViewWebPartPageComponent.prototype.addAlwaysEnabledCommands.call(this);var a=this.get_alwaysEnabledCommands();a.DocumentNewGroup=true;a.DocumentTab=true;a.DocumentEditCheckoutGroup=true;a.DocumentCopiesGroup=true;a.DocumentManageGroup=true;a.DocumentPublishingGroup=true;a.FormActionsGroup=true;a.DocumentsQuickStepsGroup=true;a.LibraryTab=true;a.SettingsGroup=true;a.ActionsGroup=true;a.LibraryNavigationGroup=true},canHandleCommand:function(a){ULS04Z:;if(this.get_$5n_4()){this.$62_4();if(SP.Ribbon.SU.$0(this.get_alwaysEnabledCommands()[a])&&SP.Ribbon.SU.$0(this.$C_4[a]))return false}if(a==="UploadDocumentMenuOpen")return SP.Ribbon.ListViewWebPartPageComponent.prototype.canHandleCommand.call(this,"UploadDocument");if(a==="NewDefaultDocument"||a==="PopulateNewDocumentMenu"||a==="NewDocument")return!SP.Ribbon.SU.$0(this.get_newMenuData());if(a==="NewDocumentMenuOpen")return SP.Ribbon.SU.$0(this.get_newMenuData())?false:this.get_newMenuData().length>0;if(a==="SendToOfficialFile")return this.get_ecbAdapter().canHandleECBCommand("SendToOfficialFile0");if(a==="ShareItem")return this.getCountOfSelectedItems()===1;if(a==="Sync"){var b=this.get_ctx(),c=b.ListTemplateType;return b.listBaseType===1&&(c===101||c===700)&&!b.ExcludeFromOfflineClient&&(typeof Navigator.msProtocols!=="object"||Navigator.msProtocols.grvopen)}return SP.Ribbon.ListViewWebPartPageComponent.prototype.canHandleCommand.call(this,a)},$5N_4:function(){ULS04Z:;var b,a=new Sys.StringBuilder;a.append("<Menu Id='Ribbon.Document.All.SendTo.Menu'>");a.append("<MenuSection Id='Ribbon.Document.All.SendTo.Menu.Items' DisplayMode='Menu16'>");a.append("<Controls Id='Ribbon.Document.All.SendTo.Menu.Items.Controls'>");if(this.get_ecbAdapter().canHandleECBCommand("SendToRecommendedLocation")){a.append("<Button");a.append(" Id='Ribbon.Document.All.SendTo.Menu.Items.RecommendedLocation'");a.append(" Command='");a.append("SendToRecommendedLocation");a.append("' LabelText='");b=this.get_ecbAdapter().getECBMenuItemForCommand("SendToRecommendedLocation");a.append(SP.Utilities.HttpUtility.htmlEncode(b.attributes.getNamedItem("text").value));a.append("'");a.append("/>")}if(this.get_ecbAdapter().canHandleECBCommand("SendToExistingCopies")){a.append("<Button");a.append(" Id='Ribbon.Document.All.SendTo.Menu.Items.ExistingCopies'");a.append(" Command='");a.append("SendToExistingCopies");a.append("' Image16by16='"+SP.Utilities.Utility.get_layoutsLatestVersionUrl()+"images/existingLocations.gif'");a.append(" LabelText='");b=this.get_ecbAdapter().getECBMenuItemForCommand("SendToExistingCopies");a.append(SP.Utilities.HttpUtility.htmlEncode(b.attributes.getNamedItem("text").value));a.append("'");a.append("/>")}a.append("<Button");a.append(" Id='Ribbon.Document.All.SendTo.Menu.Items.OtherLocation'");a.append(" Command='");a.append("SendToOtherLocation");a.append("' Image16by16='"+SP.Utilities.Utility.get_layoutsLatestVersionUrl()+"images/sendOtherLoc.gif'");a.append(" LabelText='");b=this.get_ecbAdapter().getECBMenuItemForCommand("SendToOtherLocation");if(!SP.Ribbon.SU.$0(b))a.append(SP.Utilities.HttpUtility.htmlEncode(b.attributes.getNamedItem("text").value));else a.append(SP.Utilities.HttpUtility.htmlEncode(SP.Res.sendToOtherLocation));a.append("'");a.append("/>");var d=0;while(true){var c="SendToOfficialFile"+d.toString();if(this.get_ecbAdapter().canHandleECBCommand(c)){a.append("<Button");a.append(" Id='Ribbon.Document.All.SendTo.Menu.Items.OfficialFile");a.append(d.toString());a.append("'");a.append(" Command='");a.append("SendToOfficialFile");a.append("'");a.append(" MenuItemId='");a.append(SP.Utilities.HttpUtility.htmlEncode(c));a.append("'");a.append(" CommandValueId='");a.append(SP.Utilities.HttpUtility.htmlEncode(c));a.append("'");a.append(" CommandType='OptionSelection'");a.append(" LabelText='");b=this.get_ecbAdapter().getECBMenuItemForCommand(c);a.append(SP.Utilities.HttpUtility.htmlEncode(b.attributes.getNamedItem("text").value));a.append("'");a.append("/>")}else break;d++}if(this.get_ecbAdapter().canHandleECBCommand("CreateDocumentWorkspace")){a.append("<Button");a.append(" Id='Ribbon.Document.All.SendTo.Menu.Items.CreateDocumentWorkspace'");a.append(" Command='");a.append("CreateDocumentWorkspace");a.append("' LabelText='");b=this.get_ecbAdapter().getECBMenuItemForCommand("CreateDocumentWorkspace");a.append(SP.Utilities.HttpUtility.htmlEncode(b.attributes.getNamedItem("text").value));a.append("'");a.append("/>")}a.append("</Controls>");a.append("</MenuSection>");a.append("</Menu>");return a.toString()},getGlobalCommands:function(){ULS04Z:;return SP.Ribbon.ListViewWebPartPageComponent.prototype.getGlobalCommands.call(this)},getFocusedCommands:function(){ULS04Z:;var a=SP.Ribbon.ListViewWebPartPageComponent.prototype.getFocusedCommands.call(this);Array.add(a,"ViewProperties");Array.add(a,"EditProperties");Array.add(a,"EditDocument");Array.add(a,"ManagePermissions");Array.add(a,"Delete");Array.add(a,"CheckOut");Array.add(a,"CheckIn");Array.add(a,"DiscardCheckOut");Array.add(a,"EmailLink");Array.add(a,"ShareItem");Array.add(a,"Publish");Array.add(a,"Unpublish");Array.add(a,"CancelApproval");Array.add(a,"ViewVersions");Array.add(a,"Subscribe");Array.add(a,"GotoSourceItem");Array.add(a,"SendTo");Array.add(a,"SendToOtherLocation");Array.add(a,"SendToExistingCopies");Array.add(a,"SendToRecommendedLocation");Array.add(a,"CreateDocumentWorkspace");Array.add(a,"PopulateSendToMenu");Array.add(a,"NewDocumentMenuOpen");Array.add(a,"DownloadCopy");Array.add(a,"EmailDocumentLink");Array.add(a,"SendToOfficialFile");Array.add(a,"NewDocument");Array.add(a,"PopulateNewDocumentMenu");Array.add(a,"NewDefaultDocument");Array.add(a,"UploadDocumentMenuOpen");Array.add(a,"Sync");return a},get_viewDropDownIdPrefix:function(){ULS04Z:;return"Ribbon.Library.CustomViews.DisplayView"},$62_4:function(){ULS04Z:;if(!this.$C_4){this.$C_4={};this.$C_4.EditDocument=true;this.$C_4.Delete=true;this.$C_4.CheckOut=true;this.$C_4.CheckIn=true;this.$C_4.DiscardCheckOut=true;this.$C_4.Publish=true;this.$C_4.Unpublish=true;this.$C_4.ViewVersions=true;this.$C_4.DownloadCopy=true;this.$C_4.NewDefaultDocument=true;this.$C_4.NewDocumentMenuOpen=true;this.$C_4.PopulateNewDocumentMenu=true;this.$C_4.NewDocument=true;this.$C_4.UploadDocument=true;this.$C_4.NewFolder=true;this.$C_4.ShareItem=true;this.$C_4.ManagePermissions=true}},get_$5n_4:function(){ULS04Z:;var a=this.get_ctx();return SP.Ribbon.SU.$0(a)?false:!SP.Ribbon.SU.$2(a.RealHttpRoot)}};SP.Ribbon.GenericListWebPartPageComponentData=function(){ULS04Z:;SP.Ribbon.GenericListWebPartPageComponentData.initializeBase(this)};SP.Ribbon.GenericListWebPartPageComponent=function(b,a){ULS04Z:;SP.Ribbon.GenericListWebPartPageComponent.initializeBase(this,[b,a])};SP.Ribbon.GenericListWebPartPageComponent.prototype={canHandleCommand:function(a){ULS04Z:;return a==="NewListItemMenuOpen"?SP.Ribbon.SU.$0(this.get_newMenuData())?false:this.get_newMenuData().length>0:a==="NewDefaultListItem"||a==="PopulateNewListItemMenu"||a==="NewListItem"?!SP.Ribbon.SU.$0(this.get_newMenuData()):SP.Ribbon.ListViewWebPartPageComponent.prototype.canHandleCommand.call(this,a)?true:false},handleCommand:function(a,b,c){ULS04Z:;if(a==="PopulateNewListItemMenu"){b.PopulationJSON=this.getNewMenuXml("NewListItem","Ribbon.Document.All.NewListItem");return true}else if(a==="NewListItem"){var d=b.CommandValueId;this.executeClickScript(d);return true}else if(a==="NewDefaultListItem"){this.executeClickScript(this.getDefaultNewMenuItemScript());return true}return SP.Ribbon.ListViewWebPartPageComponent.prototype.handleCommand.call(this,a,b,c)},getGlobalCommands:function(){ULS04Z:;return SP.Ribbon.ListViewWebPartPageComponent.prototype.getGlobalCommands.call(this)},getFocusedCommands:function(){ULS04Z:;var a=SP.Ribbon.ListViewWebPartPageComponent.prototype.getFocusedCommands.call(this);Array.add(a,"ViewProperties");Array.add(a,"EditProperties");Array.add(a,"ManagePermissions");Array.add(a,"Delete");Array.add(a,"ViewVersions");Array.add(a,"Subscribe");Array.add(a,"NewListItemMenuOpen");Array.add(a,"NewDefaultListItem");Array.add(a,"PopulateNewListItemMenu");Array.add(a,"NewListItem");return a},addAlwaysEnabledCommands:function(){ULS04Z:;SP.Ribbon.ListViewWebPartPageComponent.prototype.addAlwaysEnabledCommands.call(this);var a=this.get_alwaysEnabledCommands();a.ListItemTab=true;a.ListTab=true;a.ListItemManageGroup=true;a.ListItemNewGroup=true;a.ListItemPublishingGroup=true;a.ListItemWorkflowGroup=true;a.ListItemQuickStepsGroup=true;a.SettingsGroup=true;a.ActionsGroup=true;a.LibraryNavigationGroup=true}};SP.Ribbon.SolutionsPageComponent=function(b,a){ULS04Z:;SP.Ribbon.SolutionsPageComponent.initializeBase(this,[b,a]);this.$H_4=a.ViewId};SP.Ribbon.SolutionsPageComponent.prototype={$H_4:null,get_alwaysEnabledCommands:function(){ULS04Z:;if(SP.Ribbon.SU.$0(this._alwaysEnabledCommands)){this._alwaysEnabledCommands=SP.Ribbon.WebPartPageComponent.prototype.get_alwaysEnabledCommands.call(this);this._alwaysEnabledCommands.NewDocument=true;this._alwaysEnabledCommands.UploadDocumentMenuOpen=true;this._alwaysEnabledCommands.SolutionTab=true;this._alwaysEnabledCommands.DocumentAllGroup=true;this._alwaysEnabledCommands.DocumentNewGroup=true;this._alwaysEnabledCommands.DocumentShareGroup=true;this._alwaysEnabledCommands.DocumentManageGroup=true;this._alwaysEnabledCommands.LibraryTab=true;this._alwaysEnabledCommands.SettingsGroup=true;this._alwaysEnabledCommands.ActionsGroup=true;this._alwaysEnabledCommands.LibraryNavigationGroup=true}return this._alwaysEnabledCommands},canHandleCommand:function(a){ULS04Z:;return a==="SolutionTab"||a==="LibraryTab"?true:SP.Ribbon.ListViewWebPartPageComponent.prototype.canHandleCommand.call(this,a)},getGlobalCommands:function(){ULS04Z:;var a=SP.Ribbon.ListViewWebPartPageComponent.prototype.getGlobalCommands.call(this);Array.add(a,"Delete");Array.add(a,"ActivateSolution");Array.add(a,"DeactivateSolution");Array.add(a,"UpgradeSolution");return a},getFocusedCommands:function(){ULS04Z:;return SP.Ribbon.ListViewWebPartPageComponent.prototype.getFocusedCommands.call(this)}};SP.Ribbon.WikiPageComponent=function(){ULS04Z:;this.$$d_$6B_1=Function.createDelegate(this,this.$6B_1);this.$$d_$4U_1=Function.createDelegate(this,this.$4U_1);this.$$d_$4Q_1=Function.createDelegate(this,this.$4Q_1);this.$$d_$4J_1=Function.createDelegate(this,this.$4J_1);this.$$d_$2T_1=Function.createDelegate(this,this.$2T_1);this.$$d_$4O_1=Function.createDelegate(this,this.$4O_1);this.$$d_$4m_1=Function.createDelegate(this,this.$4m_1);this.$$d_$4f_1=Function.createDelegate(this,this.$4f_1);this.$$d_$4d_1=Function.createDelegate(this,this.$4d_1);this.$$d_$4g_1=Function.createDelegate(this,this.$4g_1);this.$$d_$1p_1=Function.createDelegate(this,this.$1p_1);this.$$d_$68_1=Function.createDelegate(this,this.$68_1);SP.Ribbon.WikiPageComponent.initializeBase(this)};SP.Ribbon.WikiPageComponent.registerWithPageManager=function(a){ULS04Z:;if(SP.Ribbon.WikiPageComponent.$3){SP.Ribbon.WikiPageComponent.unregisterWithPageManager();SP.Ribbon.WikiPageComponent.$3=null}SP.Ribbon.WikiPageComponent.$3=new SP.Ribbon.WikiPageComponent;SP.Ribbon.WikiPageComponent.$3.$2v_1(a);SP.Ribbon.PageManager.get_instance().addPageComponent(SP.Ribbon.WikiPageComponent.$3);SP.Ribbon.PageState.PageStateHandler.setHandleSaveMenu(false);if(a.editMode){SP.Ribbon.WikiPageComponent.$3Y();!SP.Ribbon.SU.$0(SP.Ribbon.WikiPageComponent.$n)&&SP.Ribbon.WikiPageComponent.$n.editingPageCallback()}!SP.Ribbon.SU.$2(a.conflictMergeTargetStatusHtml)&&SP.Ribbon.SaveConflictHandler.$6L(a.conflictMergeTargetStatusHtml)};SP.Ribbon.WikiPageComponent.unregisterWithPageManager=function(){ULS04Z:;if(SP.Ribbon.WikiPageComponent.$3){SP.Ribbon.PageManager.get_instance().removePageComponent(SP.Ribbon.WikiPageComponent.$3);SP.Ribbon.PageState.PageStateHandler.setHandleSaveMenu(true)}};SP.Ribbon.WikiPageComponent.get_instance=function(){ULS04Z:;return SP.Ribbon.WikiPageComponent.$3};SP.Ribbon.WikiPageComponent.$36=function(){ULS04Z:;return!SP.Ribbon.WikiPageComponent.$W&&SP.Ribbon.WikiPageComponent.$G()};SP.Ribbon.WikiPageComponent.$38=function(){ULS04Z:;return!SP.Ribbon.WikiPageComponent.$W&&SP.Ribbon.WikiPageComponent.$G()};SP.Ribbon.WikiPageComponent.$G=function(){ULS04Z:;var a=false,b=$get("_wikiPageMode");if(b)a=b.value==="Edit";return a};SP.Ribbon.WikiPageComponent.$3c=function(){ULS04Z:;return!SP.Ribbon.SU.$0($get("_wikiPageMode"))};SP.Ribbon.WikiPageComponent.$4h=function(f,d){ULS04Z:;var a=d[CUI.Controls.DropDownCommandProperties.SelectedItemId];if(SP.ScriptUtility.isNullOrUndefined(a))return false;var c=a.lastIndexOf(".");if(c<0)return false;var e=a.substring(0,c+1),b=e;if(SP.Ribbon.WikiPageComponent.$G())b+="SaveAndStop";else b+="Edit";d[CUI.Controls.DropDownCommandProperties.SelectedItemId]=b;return true};SP.Ribbon.WikiPageComponent.$3Y=function(){ULS04Z:;if(SP.Ribbon.WikiPageComponent.$2J)return;var a=window._spWikiPageNameEditorFlag;if(a)if(SP.Ribbon.SU.$0(SP.Ribbon.WikiPageComponent.$n)){var b=window._spWikiPageNameDisplayElemId,c=window._spWikiPageNameEditElemId,d=window._spWikiPageNameEditTextBoxId;SP.Ribbon.WikiPageComponent.$n=new SP.Application.UI.WikiPageNameInPlaceEditor(window.document,b,c,d)}SP.Ribbon.WikiPageComponent.$2J=true};SP.Ribbon.WikiPageComponent.$4i=function(b,a){ULS04Z:;a&&CUI.RibbonCommand.serverButton(a.SourceControlId,a.MenuItemId);return true};SP.Ribbon.WikiPageComponent.$5l=function(a,b,c,d){ULS04Z:;window._wikiCallback(a,b,c,d)};SP.Ribbon.WikiPageComponent.$4F=function(){ULS04Z:;var a=new Sys.StringBuilder;a.append("\r\n<table style='padding:10px;'>\r\n    <tr>\r\n        <td><img src='"+SP.Utilities.Utility.get_layoutsLatestVersionUrl()+"images/warning32by32.gif' alt='' /></td>\r\n        <td>");a.append(SP.Utilities.HttpUtility.htmlEncode(SP.Res.saveChangeDialogDesc));a.append("</td>\r\n    </tr>\r\n    <tr>\r\n        <td></td>\r\n        <td nowrap align='center'>\r\n            <input type='button' id='SaveDlgYes' class='ms-NarrowButtonHeightWidth' onclick='SP.Ribbon.WikiPageComponent.saveDialogClick(0)' value='");a.append(SP.Utilities.HttpUtility.htmlEncode(SP.Res.buttonSave));a.append("' />\r\n            <span class='ms-SpaceBetButtons'>&#160;</span>\r\n            <input type='button' id='SaveDlgNo' class='ms-NarrowButtonHeightWidth' onclick='SP.Ribbon.WikiPageComponent.saveDialogClick(1)' value='");a.append(SP.Utilities.HttpUtility.htmlEncode(SP.Res.buttonDiscardChanges));a.append("' />\r\n            <span class='ms-SpaceBetButtons'>&#160;</span>\r\n            <input type='button' id='SaveDlgCancel' class='ms-NarrowButtonHeightWidth' onclick='SP.Ribbon.WikiPageComponent.saveDialogClick(2)' value='");a.append(SP.Utilities.HttpUtility.htmlEncode(SP.Res.buttonCancel));a.append("' />\r\n        </td>\r\n    </tr>\r\n    <tr><td style='height:3px;'></td></tr>\r\n</table>\r\n");var b=document.createElement("DIV");b.innerHTML=a.toString();b=b.getElementsByTagName("table")[0];return b};SP.Ribbon.WikiPageComponent.saveDialogClick=function(a){ULS04Z:;if(!a){SP.UI.ModalDialog.get_childDialog().set_returnValue("PageStateGroupSaveAndStop");SP.UI.ModalDialog.get_childDialog().close(1)}else if(a===1){SP.UI.ModalDialog.get_childDialog().set_returnValue("PageStateGroupDontSaveAndStop");SP.UI.ModalDialog.get_childDialog().close(1)}else SP.UI.ModalDialog.get_childDialog().close(0)};SP.Ribbon.WikiPageComponent.prototype={$1_1:null,$2v_1:function(b){ULS04Z:;this.$1_1=b;var a=this.$1_1.itemPermMasks;if(!SP.BasePermissions.isInstanceOfType(a)){this.$1_1.itemPermMasks=new SP.BasePermissions;!this.$1_1.itemPermMasks.customFromJson(a)&&this.$1_1.itemPermMasks.fromJson(a)}a=this.$1_1.listPermMasks;if(!SP.BasePermissions.isInstanceOfType(a)){this.$1_1.listPermMasks=new SP.BasePermissions;!this.$1_1.listPermMasks.customFromJson(a)&&this.$1_1.listPermMasks.fromJson(a)}},getGlobalCommands:function(){ULS04Z:;if(!SP.Ribbon.WikiPageComponent.$b)SP.Ribbon.WikiPageComponent.$b=["CheckoutMenuOpen","CPEditTab","PageStateGroupEdit","EditAndCheckoutGroup","EditMobilePageMenuOpen","EditInDesigner","EditingGroup","EditingToolsContextualGroup","RenamePage","LibrarySettingsGroup","LinksGroup","MediaGroup","NotificationsGroup","PageActionsGroup","PageLayoutGroup","PageStateGroupDontSaveAndStop","PageStateGroupSave","PageStateGroupSaveAndPublish","PageStateGroupSaveAndStop","PageStateGroupStopEditing","PageStateGroupOpenMenuSave","PageStateGroupQuerySaveMenu","PageStateGroupSaveSplit","PublishingGroup","ServerButton","ShareGroup","TablesGroup","TrackTab","WebPartsGroup","WikiEditWebPart","WikiPageTab"];return SP.Ribbon.WikiPageComponent.$b},canHandleCommand:function(e){ULS04Z:;this.$5i_1();var f=this.$M_1[e];if(!SP.Ribbon.SU.$0(f)){var g=f;return g()}if(!SP.Ribbon.WikiPageComponent.$1F){SP.Ribbon.WikiPageComponent.$1F={};var a=this.getGlobalCommands();if(a)for(var h=a.length,c=0;c<h;c++)SP.Ribbon.WikiPageComponent.$1F[a[c]]=true;var b=this.getFocusedCommands();if(b)for(var i=b.length,d=0;d<i;d++)SP.Ribbon.WikiPageComponent.$1F[b[d]]=true}return!SP.Ribbon.SU.$0(SP.Ribbon.WikiPageComponent.$1F[e])},handleCommand:function(b,a,c){ULS04Z:;return this.$3T_1(b,a,c)},$3T_1:function(b,d,e){ULS04Z:;this.$3X_1();var a=this.$F_1[b];if(!SP.Ribbon.SU.$0(a)){var c=a;return c(b,d,e)}return true},getId:function(){ULS04Z:;return"WikiPageComponent"},$4O_1:function(){ULS04Z:;return this.$2T_1()||SP.Ribbon.WikiPageComponent.$36()||SP.Ribbon.WikiPageComponent.$38()},$2T_1:function(){ULS04Z:;return!SP.Ribbon.WikiPageComponent.$W&&!SP.Ribbon.WikiPageComponent.$G()&&this.$1_1.editable},$4J_1:function(){ULS04Z:;return this.$2T_1()&&this.$1_1.listPermMasks.has(12)&&this.$1_1.listPermMasks.has(19)},$4d_1:function(d,a,c){ULS04Z:;var b=a.CommandValueId;return this.$3T_1(b,a,c)},get_$3j_1:function(){ULS04Z:;return window.SPAutoSaveIsPageDirty&&window.SPAutoSaveIsPageDirty()?true:false},$4g_1:function(){ULS04Z:;if(!SP.Ribbon.WikiPageComponent.$W){CUI.PMetrics.perfMark(7111);var c='<img src="'+SP.Utilities.Utility.get_layoutsLatestVersionUrl()+'images/loadingcirclests16.gif" style="vertical-align: middle" />';c+=SP.Utilities.HttpUtility.htmlEncode(SP.Res.saving);var d=SP.UI.Notify.addNotification(c,true),a=d,b=-1,g=this,e=function($p1_0,$p1_1){window.clearTimeout(b);SP.Ribbon.WikiPageComponent.$W=false;SP.UI.Notify.removeNotification(a);SP.Ribbon.PageState.PageStateHandler.ignoreNextUnload=false;if(!SP.Ribbon.SU.$2($p1_0))eval($p1_0);CUI.PMetrics.perfMark(7112)},h=this,f=function(c){ULS04Z:;window.clearTimeout(b);SP.Ribbon.WikiPageComponent.$W=false;SP.UI.Notify.removeNotification(a);SP.Ribbon.PageState.PageStateHandler.ignoreNextUnload=false;if(SP.Ribbon.SU.$2(c))c=SP.Res.saveFailed;alert(c)};SP.Ribbon.WikiPageComponent.$W=true;var i=this;b=window.setTimeout(function(){ULS04Z:;SP.Ribbon.WikiPageComponent.$W=false;SP.UI.Notify.removeNotification(a);alert(SP.Res.wikiPageSaveTimeoutError)},6e4);SP.Ribbon.WikiPageComponent.$5l("PageStateGroupSave",e,null,f)}return true},$1p_1:function($p0,$p1,$p2){if(!SP.Ribbon.WikiPageComponent.$W){if("PageStateGroupStopEditing"===$p0)if(this.get_$3j_1()){this.$6M_1();return true}else $p0="PageStateGroupDontSaveAndStop";if($p0==="EditInDesigner"){var $v_4=window.self.ajaxNavigate;EditInSPD($v_4.get_href(),false);return true}var $v_0=null,$v_1,$v_2='<img src="'+SP.Utilities.Utility.get_layoutsLatestVersionUrl()+'images/loadingcirclests16.gif" style="vertical-align: middle" />',$v_3=false;switch($p0){case"PageStateGroupEdit":$v_1="Ribbon.WikiPageTab.EditAndCheckout.SaveEdit.Menu.SaveEdit.Edit";$v_2+=SP.Utilities.HttpUtility.htmlEncode(SP.Res.autocompleteLoading);break;case"PageStateGroupDontSaveAndStop":$v_1="Ribbon.WikiPageTab.EditAndCheckout.SaveEdit.Menu.SaveEdit.Revert";$v_2+=SP.Utilities.HttpUtility.htmlEncode(SP.Res.genericLoading);$v_3=true;break;case"PageStateGroupSaveAndStop":$v_1="Ribbon.WikiPageTab.EditAndCheckout.SaveEdit.Menu.SaveEdit.SaveAndStop";$v_2+=SP.Utilities.HttpUtility.htmlEncode(SP.Res.saving);$v_3=true;break;default:return false}if($p0==="PageStateGroupEdit"&&SP.Ribbon.PageState.ImportedNativeData&&SP.Ribbon.PageState.ImportedNativeData.PageState&&(SP.Ribbon.PageState.ImportedNativeData.PageState.DocLibCheckoutRequired||this.$1_1.missingRequiredFields)&&!SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsCheckedOutToCurrentUser)if(!confirm(window.Strings.STS.L_ConfirmCheckout_Text))return true;if($v_3)typeof window.SP.UI!=="undefined"&&typeof window.SP.UI.Rte!=="undefined"&&typeof window.SP.UI.Rte.SnapshotManager!=="undefined"&&typeof window.SP.UI.Rte.SnapshotManager.clear!=="undefined"&&window.SP.UI.Rte.SnapshotManager.clear();if(!SP.Ribbon.WebPartComponent.get_$5p()&&($p0==="PageStateGroupDontSaveAndStop"||$p0==="PageStateGroupSaveAndStop")){var $v_5=$get("_wikiPageCommand");$v_5.value=$p0;$v_5=$get("MSOWebPartPage_Shared");if($v_5)$v_5.value="";$v_5=$get("MSOLayout_InDesignMode");if($v_5)$v_5.value="0";$v_5=$get("MSOSPWebPartManager_DisplayModeName");if($v_5)$v_5.value="Browse";var $v_6=this.$1_1.postbackScript;eval($v_6);return true}if(CUI.RibbonCommand.serverQueryButton($v_1))$v_0=SP.UI.Notify.addNotification($v_2,true);CUI.PMetrics.perfMark(7111);CUI.RibbonCommand.serverButton($v_1,null);if($v_0){SP.Ribbon.WikiPageComponent.$W=true;var $v_7=null,$v_8=$v_0,$$t_J=this,$v_9=function(){ULS04Z:;$v_7&&Sys.WebForms.PageRequestManager.getInstance().remove_pageLoaded($v_7);$v_7=null;SP.Ribbon.UtilityInternal.$z();CUI.PMetrics.perfMark(7112)};$v_7=$v_9;Sys.WebForms.PageRequestManager.getInstance().add_pageLoaded($v_9);var $v_A=null,$$t_K=this,$v_B=function(b,a){ULS04Z:;SP.UI.Notify.removeNotification($v_8);SP.Ribbon.WikiPageComponent.$W=false;if(!SP.Ribbon.SU.$0(a.get_error())){$v_7&&Sys.WebForms.PageRequestManager.getInstance().remove_pageLoaded($v_7);$v_7=null;$v_A&&Sys.WebForms.PageRequestManager.getInstance().remove_endRequest($v_A);$v_A=null;if(!a.get_errorHandled()){alert(a.get_error().message);a.set_errorHandled(true)}}};$v_A=$v_B;Sys.WebForms.PageRequestManager.getInstance().add_endRequest($v_B);switch($p0){case"PageStateGroupEdit":SP.Ribbon.WikiPageComponent.$3Y();!SP.Ribbon.SU.$0(SP.Ribbon.WikiPageComponent.$n)&&SP.Ribbon.WikiPageComponent.$n.editingPageCallback();break;case"PageStateGroupSaveAndStop":!SP.Ribbon.SU.$0(SP.Ribbon.WikiPageComponent.$n)&&SP.Ribbon.WikiPageComponent.$n.savingPageCallback()}}}return true},$4Q_1:function(){ULS04Z:;return SP.Ribbon.WikiPageComponent.$2J&&window._spWikiPageNameEditorFlag},$4f_1:function(){ULS04Z:;var a=new SP.UI.DialogOptions;a.url=SP.Utilities.Utility.getLayoutsPageUrl("RenamePageDialog.aspx");var b=window._spWikiPageNameDisplayElemId;a.url+="?Source="+GetSource(document.URL);a.dialogReturnValueCallback=this.$$d_$68_1;a.title=SP.Res.renamePageDialog_Title;SP.UI.ModalDialog.showModalDialog(a);return true},$68_1:function(a,b){ULS04Z:;if(a!==-1&&!SP.Ribbon.SU.$0(b)){var c=window._spWikiPageNameEditTextBoxId;$get(c).value=b}a===1&&this.$1p_1("PageStateGroupSaveAndStop",null,0)},$4U_1:function(){ULS04Z:;return this.$1_1.editable&&!SP.Ribbon.WikiPageComponent.$G()},$4m_1:function(){ULS04Z:;window.ChangeLayoutMode(false);return true},$F_1:null,$3X_1:function(){ULS04Z:;if(this.$F_1)return;var a;this.$F_1={};a=this.$$d_$1p_1;this.$F_1.PageStateGroupEdit=a;this.$F_1.PageStateGroupSaveAndStop=a;this.$F_1.PageStateGroupSaveAndPublish=a;this.$F_1.PageStateGroupStopEditing=a;this.$F_1.PageStateGroupDontSaveAndStop=a;this.$F_1.EditInDesigner=a;a=this.$$d_$4g_1;this.$F_1.PageStateGroupSave=a;this.$F_1.PageStateGroupQuerySaveMenu=SP.Ribbon.WikiPageComponent.$4h;this.$F_1.PageStateGroupSaveSplit=this.$$d_$4d_1;this.$F_1.ServerButton=SP.Ribbon.WikiPageComponent.$4i;this.$F_1.RenamePage=this.$$d_$4f_1;this.$F_1.WikiEditWebPart=this.$$d_$4m_1},$M_1:null,$5i_1:function(){ULS04Z:;if(this.$M_1)return;var a;this.$M_1={};this.$M_1.PageStateGroupSaveSplit=this.$$d_$4O_1;this.$M_1.PageStateGroupEdit=this.$$d_$2T_1;this.$M_1.EditInDesigner=this.$$d_$4J_1;a=SP.Ribbon.WikiPageComponent.$36;this.$M_1.PageStateGroupSave=a;this.$M_1.PageStateGroupSaveAndStop=a;this.$M_1.PageStateGroupSaveAndPublish=a;this.$M_1.PageStateGroupStopEditing=SP.Ribbon.WikiPageComponent.$38;this.$M_1.EditingToolsContextualGroup=SP.Ribbon.WikiPageComponent.$G;this.$M_1.RenamePage=this.$$d_$4Q_1;a=this.$$d_$4U_1;this.$M_1.WikiEditWebPart=a},changeWikiPageMode:function(a){ULS04Z:;a&&!SP.Ribbon.WikiPageComponent.$G()&&this.$1p_1("PageStateGroupEdit",{},0)},revertToRead:function(){ULS04Z:;SP.Ribbon.SaveConflictHandler.$1Q()},$6M_1:function(){ULS04Z:;var a=new SP.UI.DialogOptions;a.html=SP.Ribbon.WikiPageComponent.$4F();a.title=SP.Res.saveChangeDialogTitle;a.dialogReturnValueCallback=this.$$d_$6B_1;SP.UI.ModalDialog.showModalDialog(a);var b=this;window.setTimeout(function(){ULS04Z:;$get("SaveDlgYes")&&$get("SaveDlgYes").focus()},0)},$6B_1:function(a,b){ULS04Z:;a===1&&this.$1p_1(b,null,0)}};SP.Ribbon.FetchedDocLibItemInfo=function(){};SP.Ribbon.FetchedDocLibItemInfo.prototype={itemIsCheckedout:false,moderationStatus:0};SP.Ribbon.DocLibAspxPageComponent=function(b){ULS04Z:;this.$$d_$4X_1=Function.createDelegate(this,this.$4X_1);this.$$d_$4a_1=Function.createDelegate(this,this.$4a_1);this.$$d_$4j_1=Function.createDelegate(this,this.$4j_1);this.$$d_$4Z_1=Function.createDelegate(this,this.$4Z_1);this.$$d_$4c_1=Function.createDelegate(this,this.$4c_1);this.$$d_$4n_1=Function.createDelegate(this,this.$4n_1);this.$$d_$4k_1=Function.createDelegate(this,this.$4k_1);this.$$d_$4e_1=Function.createDelegate(this,this.$4e_1);this.$$d_$4b_1=Function.createDelegate(this,this.$4b_1);this.$$d_$4I_1=Function.createDelegate(this,this.$4I_1);this.$$d_$4S_1=Function.createDelegate(this,this.$4S_1);this.$$d_$4L_1=Function.createDelegate(this,this.$4L_1);this.$$d_$4N_1=Function.createDelegate(this,this.$4N_1);this.$$d_$4V_1=Function.createDelegate(this,this.$4V_1);this.$$d_$4P_1=Function.createDelegate(this,this.$4P_1);this.$$d_$4M_1=Function.createDelegate(this,this.$4M_1);this.$$d_$4K_1=Function.createDelegate(this,this.$4K_1);this.$$d_$4T_1=Function.createDelegate(this,this.$4T_1);SP.Ribbon.DocLibAspxPageComponent.initializeBase(this);this.$1_1=b;var a=this.$1_1.itemPermMasks;if(!SP.BasePermissions.isInstanceOfType(a)){this.$1_1.itemPermMasks=new SP.BasePermissions;!this.$1_1.itemPermMasks.customFromJson(a)&&this.$1_1.itemPermMasks.fromJson(a)}a=this.$1_1.listPermMasks;if(!SP.BasePermissions.isInstanceOfType(a)){this.$1_1.listPermMasks=new SP.BasePermissions;!this.$1_1.listPermMasks.customFromJson(a)&&this.$1_1.listPermMasks.fromJson(a)}};SP.Ribbon.DocLibAspxPageComponent.registerWithPageManager=function(a){ULS04Z:;if(!SP.Ribbon.DocLibAspxPageComponent.$3){SP.Ribbon.DocLibAspxPageComponent.$3=new SP.Ribbon.DocLibAspxPageComponent(a);SP.Ribbon.PageManager.get_instance().addPageComponent(SP.Ribbon.DocLibAspxPageComponent.$3)}};SP.Ribbon.DocLibAspxPageComponent.get_instance=function(){ULS04Z:;return SP.Ribbon.DocLibAspxPageComponent.$3};SP.Ribbon.DocLibAspxPageComponent.$4l=function(){ULS04Z:;SP.Ribbon.WebPartComponent.$40(4,false);return true};SP.Ribbon.DocLibAspxPageComponent.$4Y=function(){ULS04Z:;if(SP.Ribbon.PageState.ImportedNativeData&&SP.Ribbon.PageState.ImportedNativeData.PageState&&SP.Ribbon.PageState.ImportedNativeData.PageState.DocLibCheckoutRequired&&!SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsCheckedOutToCurrentUser&&!SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsCheckedOutToOtherUser){var a;if(SP.PageContextInfo.get_serverRequestPath())a=SP.PageContextInfo.get_serverRequestPath();else a=document.URL;a=a.split("?")[0].split("#")[0];a=window.unescapeProperly(a);var b=window.location.protocol+"//"+window.location.host+SP.PageContextInfo.get_webServerRelativeUrl();if(b.endsWith("/"))b=b.substring(0,b.length-1);if(!CheckoutAlertBeforeNavigate(null,true,false,a,b))return true}SP.Ribbon.WebPartComponent.$40(6,true);return true};SP.Ribbon.DocLibAspxPageComponent.$3B=function(){ULS04Z:;SP.Ribbon.WebPartComponent.$5u();return true};SP.Ribbon.DocLibAspxPageComponent.$37=function(){ULS04Z:;return!!SP.Ribbon.Utility.get_$d()&&SP.Ribbon.Utility.get_$d().has(31)};SP.Ribbon.DocLibAspxPageComponent.$3A=function(){ULS04Z:;window.SetHomePage(SP.PageContextInfo.get_webServerRelativeUrl());return true};SP.Ribbon.DocLibAspxPageComponent.prototype={$1_1:null,get_allowInsertNewList:function(){ULS04Z:;return!!SP.Ribbon.Utility.get_$d()&&SP.Ribbon.Utility.get_$d().has(12)},$67_1:function(){ULS04Z:;this.$w_1=null;this.$28_1=false;this.$3H_1()},$3H_1:function(){ULS04Z:;if(this.$28_1)return;this.$28_1=true;var b=new SP.ClientContext,d=b.get_web().get_lists().getById(new SP.Guid(this.$1_1.listId)),c=d.getItemById(this.$1_1.itemId);b.load(c,"_ModerationStatus","CheckoutUser");var a=this;b.executeQueryAsync(function(){ULS04Z:;a.$w_1=new SP.Ribbon.FetchedDocLibItemInfo;if(c.get_item("CheckoutUser"))a.$w_1.itemIsCheckedout=true;else a.$w_1.itemIsCheckedout=false;a.$w_1.moderationStatus=c.get_item("_ModerationStatus");window.setTimeout(function(){ULS04Z:;SP.Ribbon.PageManager.get_instance().get_commandDispatcher().executeCommand("appstatechanged",null)},0)})},$w_1:null,$28_1:false,get_$1r_1:function(){ULS04Z:;!this.$w_1&&this.$3H_1();return this.$w_1},getGlobalCommands:function(){ULS04Z:;if(!SP.Ribbon.DocLibAspxPageComponent.$b)SP.Ribbon.DocLibAspxPageComponent.$b=["editPageProperties","pagePropertiesMenuOpen","viewPageProperties","webPartPageWorkflow","webPartPageManageWorkflow","webPartPageVerions","webPartPagePermissions","IncomingLinks","AlertMePage","EditTitleBar","ManageGroup","WikiEditProperties","LibrarySettingsGroup","PageActionsGroup","PagePropertiesMenuOpen","Permissions","SetHomePage","ShareGroup","VersionHistory","VersionsMenuOpen","VersionDiff","ViewAllPages","WikiViewProperties","WikiLibraryPermissions","WikiLibrarySettings","WorkflowGroup","PublishingGroup"];return SP.Ribbon.DocLibAspxPageComponent.$b},canHandleCommand:function(a){ULS04Z:;this.$5h_1();var b=this.$A_1[a];if(b)return b();var c=this.get_$4W_1()[a];return c?true:false},handleCommand:function(a,c,d){ULS04Z:;this.$3X_1();var b=this.$B_1[a];return b?b(a,c,d):true},getId:function(){ULS04Z:;return"DocLibAspxPageComponent"},$1Y_1:null,get_$4W_1:function(){ULS04Z:;if(!this.$1Y_1){this.$1Y_1={};for(var a=this.getGlobalCommands(),c=a.length,b=0;b<a.length;b++)this.$1Y_1[a[b]]=true}return this.$1Y_1},$A_1:null,$5h_1:function(){ULS04Z:;if(!this.$A_1){this.$A_1={};var a=this.$$d_$4T_1;this.$A_1.PagePropertiesMenuOpen=a;this.$A_1.WikiViewProperties=a;this.$A_1.pagePropertiesMenuOpen=a;this.$A_1.viewPageProperties=a;a=this.$$d_$4K_1;this.$A_1.WikiEditProperties=a;this.$A_1.editPageProperties=a;this.$A_1.LibraryPermissions=this.$$d_$4M_1;this.$A_1.WikiLibraryPermissions=this.$$d_$4M_1;a=this.$$d_$4P_1;this.$A_1.Permissions=a;this.$A_1.webPartPagePermissions=a;this.$A_1.WikiLibrarySettings=this.$$d_$4V_1;a=this.$$d_$4N_1;this.$A_1.ManageWorkflow=a;this.$A_1.webPartPageManageWorkflow=a;a=SP.Ribbon.DocLibAspxPageComponent.$37;this.$A_1.SetHomePage=a;a=this.$$d_$4L_1;this.$A_1.EditTitleBar=a;a=this.$$d_$4S_1;this.$A_1.VersionDiff=a;this.$A_1.VersionHistory=a;this.$A_1.VersionsMenuOpen=a;this.$A_1.webPartPageVerions=a;this.$A_1.AlertMePage=this.$$d_$4I_1}},$B_1:null,$3X_1:function(){ULS04Z:;if(!this.$B_1){this.$B_1={};var a=SP.Ribbon.DocLibAspxPageComponent.$3B;this.$B_1.VersionHistory=a;a=SP.Ribbon.DocLibAspxPageComponent.$4l;this.$B_1.WikiViewProperties=a;this.$B_1.viewPageProperties=a;a=SP.Ribbon.DocLibAspxPageComponent.$4Y;this.$B_1.WikiEditProperties=a;this.$B_1.editPageProperties=a;a=this.$$d_$4b_1;this.$B_1.WikiLibraryPermissions=a;a=this.$$d_$4e_1;this.$B_1.Permissions=a;this.$B_1.webPartPagePermissions=a;this.$B_1.ViewAllPages=this.$$d_$4k_1;this.$B_1.WikiLibrarySettings=this.$$d_$4n_1;a=this.$$d_$4c_1;this.$B_1.ManageWorkflow=a;this.$B_1.webPartPageManageWorkflow=a;a=SP.Ribbon.DocLibAspxPageComponent.$3A;this.$B_1.SetHomePage=a;a=this.$$d_$4Z_1;this.$B_1.EditTitleBar=a;a=SP.Ribbon.DocLibAspxPageComponent.$3B;this.$B_1.VersionHistory=a;this.$B_1.webPartPageVerions=a;a=this.$$d_$4j_1;this.$B_1.VersionDiff=a;this.$B_1.IncomingLinks=this.$$d_$4a_1;this.$B_1.AlertMePage=this.$$d_$4X_1}},$4T_1:function(){ULS04Z:;return!this.$1_1.doNotShowProperties},$4K_1:function(){ULS04Z:;var a=!!SP.Ribbon.PageState.ImportedNativeData&&!!SP.Ribbon.PageState.ImportedNativeData.PageState,b=!a||a&&!SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsCheckedOutToOtherUser;return!this.$1_1.doNotShowProperties&&this.$1_1.editable&&b&&this.$1_1.itemPermMasks.has(3)},$4V_1:function(){ULS04Z:;return this.$1_1.listPermMasks.has(12)},$4n_1:function(){ULS04Z:;var a=SP.Utilities.Utility.getLayoutsPageUrl("listedit.aspx");a=a+"?List="+this.$1_1.listId;SP.Utilities.HttpUtility.navigateTo(a);return true},$4P_1:function(){ULS04Z:;return this.$1_1.itemPermMasks.has(63)?true:false},$4e_1:function(){ULS04Z:;var a=SP.Utilities.Utility.getLayoutsPageUrl("User.aspx"),b=new SP.Utilities.UrlBuilder(a),c=new SP.Guid(this.$1_1.listId);b.addKeyValueQueryString("obj",c.toString("B")+","+this.$1_1.itemId.toString()+",LISTITEM");b.addKeyValueQueryString("List",c.toString("B"));a=b.get_url()+"&Source"+GetSource();SP.Utilities.HttpUtility.navigateTo(a);return true},$4M_1:function(){ULS04Z:;return this.$1_1.listPermMasks.has(63)?true:false},$4b_1:function(){ULS04Z:;var a=SP.Utilities.Utility.getLayoutsPageUrl("User.aspx"),b=new SP.Utilities.UrlBuilder(a),c=new SP.Guid(this.$1_1.listId);b.addKeyValueQueryString("obj",c.toString("B")+",doclib");b.addKeyValueQueryString("List",c.toString("B"));a=b.get_url()+"&Source"+GetSource();SP.Utilities.HttpUtility.navigateTo(a);return true},$4k_1:function(){ULS04Z:;this.$5s_1();return true},$5s_1:function(){ULS04Z:;var b=SP.Utilities.Utility.getLayoutsPageUrl("listform.aspx"),a=new SP.Utilities.UrlBuilder(b),c=new SP.Guid(this.$1_1.listId);a.addKeyValueQueryString("ListId",c.toString("B"));a.addKeyValueQueryString("PageType","0");SP.Utilities.HttpUtility.navigateTo(a.get_url())},$4a_1:function(){ULS04Z:;var b=SP.Utilities.Utility.getLayoutsPageUrl("BackLinks.aspx"),a=new SP.Utilities.UrlBuilder(b);a.addKeyValueQueryString("List",new SP.Guid(this.$1_1.listId).toString());a.addKeyValueQueryString("ID",this.$1_1.itemId.toString());SP.Utilities.HttpUtility.navigateTo(a.get_url());return true},$4j_1:function(){ULS04Z:;var b=SP.Utilities.Utility.getLayoutsPageUrl("VersionDiff.aspx"),a=new SP.Utilities.UrlBuilder(b),c=new SP.Guid(this.$1_1.listId);a.addKeyValueQueryString("List",c.toString("B"));a.addKeyValueQueryString("ID",this.$1_1.itemId.toString());SP.Utilities.HttpUtility.navigateTo(a.get_url());return true},$4S_1:function(){ULS04Z:;return SP.Ribbon.SU.$0(this.$1_1.itemId)?false:!this.$1_1.itemPermMasks.has(7)?false:this.$1_1.enableVersioning},$4c_1:function(){ULS04Z:;var a=new SP.Utilities.UrlBuilder(SP.Utilities.Utility.getLayoutsPageUrl("Workflow.aspx")),b=new SP.Guid(this.$1_1.listId);a.addKeyValueQueryString("ID",this.$1_1.itemId.toString());a.addKeyValueQueryString("List",b.toString("B"));var c=a.get_url()+"&Source"+GetSource();SP.Utilities.HttpUtility.navigateTo(c);return true},$4N_1:function(){ULS04Z:;return!SP.Ribbon.SU.$0(this.$1_1.itemId)&&this.$1_1.workflowsAssociated&&this.$1_1.itemPermMasks.has(3)},$4L_1:function(){ULS04Z:;return this.$1_1.editable},$4Z_1:function($p0,$p1,$p2){var $v_0=window.document.getElementById($p0);if(!$v_0)return false;var $v_1=$v_0.getAttribute("href");if($v_1&&$v_1.length>0){if($v_1.startsWith("javascript:"))$v_1=$v_1.substr(11);eval($v_1);SP.Ribbon.PageManager.get_instance().get_commandDispatcher().executeCommand("appstatechanged",null);return true}return false},$4I_1:function(){ULS04Z:;return this.$1_1.itemPermMasks.has(40)?true:false},$4X_1:function(){ULS04Z:;var a=SP.Utilities.Utility.getLayoutsPageUrl("SubNew.aspx"),b=new SP.Utilities.UrlBuilder(a);b.addKeyValueQueryString("List",this.$1_1.listId);b.addKeyValueQueryString("ID",this.$1_1.itemId.toString());a=b.get_url()+"&Source"+GetSource();var c=new SP.UI.DialogOptions;c.url=a;SP.UI.ModalDialog.showModalDialog(c);return true}};SP.Ribbon.WebPartComponent=function(){ULS04Z:;this.$$d_$66_1=Function.createDelegate(this,this.$66_1);this.$$d_$5t_1=Function.createDelegate(this,this.$5t_1);SP.Ribbon.WebPartComponent.initializeBase(this);this.$2o_1=new SP.Ribbon.RelatedFieldsHelper(false);this.$2n_1=new SP.Ribbon.RelatedFieldsHelper(true)};SP.Ribbon.WebPartComponent.get_instance=function(){ULS04Z:;return SP.Ribbon.WebPartComponent.$3};SP.Ribbon.WebPartComponent.registerWithPageManager=function(a){ULS04Z:;if(!SP.Ribbon.WebPartComponent.$3){SP.Ribbon.WebPartComponent.$3=new SP.Ribbon.WebPartComponent;SP.Ribbon.WebPartComponent.$3.$2v_1(a);SP.Ribbon.WebPartComponent.$3.$3k_1();SP.Ribbon.PageManager.get_instance().addPageComponent(SP.Ribbon.WebPartComponent.$3);SP.Ribbon.UtilityInternal.$4D("click",SP.Ribbon.WebPartComponent.$5r)}else{SP.Ribbon.PageManager.get_instance().removePageComponent(SP.Ribbon.WebPartComponent.$3);SP.Ribbon.WebPartComponent.$3.$2v_1(a);SP.Ribbon.WebPartComponent.$3.$3k_1();SP.Ribbon.PageManager.get_instance().addPageComponent(SP.Ribbon.WebPartComponent.$3)}};SP.Ribbon.WebPartComponent.$5r=function(a){ULS04Z:;if(SP.UI.UIUtility.focusValidOnThisNode(a.target)&&SP.Ribbon.WebPartComponent.$3){CUI.PMetrics.perfMark(7186);SP.Ribbon.WebPartComponent.$3.$4x_1(a.target);CUI.PMetrics.perfMark(7187)}};SP.Ribbon.WebPartComponent.$1w=function(b){ULS04Z:;var a=window._spWebPartComponents;return SP.Ribbon.SU.$0(a)?null:a[b]};SP.Ribbon.WebPartComponent.$5u=function(){ULS04Z:;var a=new Sys.StringBuilder;SP.Ribbon.WebPartComponent.$2S("versions.aspx",a);a.append("list=");a.append(SP.PageContextInfo.get_pageListId());a.append("&ID=");a.append(SP.PageContextInfo.get_pageItemId().toString());SP.Utilities.HttpUtility.navigateTo(a.toString())};SP.Ribbon.WebPartComponent.$2S=function(c,a){ULS04Z:;var b=SP.PageContextInfo.get_webServerRelativeUrl();a.append(b);!b.endsWith("/")&&a.append("/");a.append(SP.Utilities.Utility.get_layoutsLatestVersionRelativeUrl());a.append(c);a.append("?");return};SP.Ribbon.WebPartComponent.$40=function(b,c){ULS04Z:;var a=new Sys.StringBuilder;SP.Ribbon.WebPartComponent.$2S("listform.aspx",a);a.append("PageType=");a.append(b.toString());a.append("&ListId=");a.append(SP.PageContextInfo.get_pageListId());a.append("&ID=");a.append(SP.PageContextInfo.get_pageItemId().toString());if(c)if(b===6)SP.Utilities.HttpUtility.navigateTo(a.toString());else SP.Utilities.HttpUtility.appendSourceAndNavigateTo(a.toString());else window.OpenPopUpPage(a.toString())};SP.Ribbon.WebPartComponent.$1q=function(){ULS04Z:;var a=window.document.getElementById("_wpSelected");if(!SP.Ribbon.SU.$0(a)&&!SP.Ribbon.SU.$0(a.value)){var b=SP.Ribbon.PageManager.get_instance().getPageComponentById(SP.Ribbon.WebPartComponent.$3Q(a.value));!SP.Ribbon.SU.$0(b)&&SP.Ribbon.PageManager.get_instance().get_focusManager().releaseFocusFromComponent(b)}};SP.Ribbon.WebPartComponent.$3I=function(){ULS04Z:;var a=window.document.getElementById("_wpSelected");if(!SP.Ribbon.SU.$0(a)&&!SP.Ribbon.SU.$0(a.value)){var b=SP.Ribbon.PageManager.get_instance().getPageComponentById(SP.Ribbon.WebPartComponent.$3Q(a.value));!SP.Ribbon.SU.$0(b)&&SP.Ribbon.PageManager.get_instance().get_focusManager().requestFocusForComponent(b)}};SP.Ribbon.WebPartComponent.$3Q=function(a){ULS04Z:;if(!SP.Ribbon.SU.$0(a)&&a.length>12){var c=a.substring(12,a.length),b=SP.Ribbon.WebPartComponent.$1w(c);if(b&&!SP.Ribbon.SU.$2(b.pageComponentId))return b.pageComponentId}return a};SP.Ribbon.WebPartComponent.getWebPartAdder=function(){ULS04Z:;return window.WPAdder};SP.Ribbon.WebPartComponent.get_$5p=function(){ULS04Z:;var b=$get("MSOLayout_InDesignMode");if(b&&b.value==="1")return false;var a=$get("MSOSPWebPartManager_DisplayModeName");return a&&a.value&&a.value.toUpperCase()!=="BROWSE"?false:true};SP.Ribbon.WebPartComponent.get_$1W=function(){ULS04Z:;var a=$get("MSOSPWebPartManager_DisplayModeName");return a&&a.value&&a.value.toUpperCase()==="EDIT"?true:false};SP.Ribbon.WebPartComponent.get_activeWebPartId=function(){ULS04Z:;var a=null;if(SP.Ribbon.WebPartComponent.$3&&!SP.Ribbon.SU.$2(SP.Ribbon.WebPartComponent.$3.get_$Q_1()))return SP.Ribbon.WebPartComponent.$3.get_$Q_1();if(window.document.getElementById("_wpSelected")){a=window.document.getElementById("_wpSelected").value;if(!SP.Ribbon.SU.$2(a))return a.substr(12)}return null};SP.Ribbon.WebPartComponent.get_pageComponentIdOfActiveWebPart=function(){ULS04Z:;var a=SP.Ribbon.WebPartComponent.get_activeWebPartId();if(SP.Ribbon.SU.$2(a))return null;var b=SP.Ribbon.WebPartComponent.$1w(a);return!b||SP.Ribbon.SU.$2(b.pageComponentId)?a:b.pageComponentId};SP.Ribbon.WebPartComponent.get_activeWebPartZoneId=function(){ULS04Z:;return SP.Ribbon.WebPartComponent.$3&&!SP.Ribbon.SU.$2(SP.Ribbon.WebPartComponent.$3.get_$q_1())?SP.Ribbon.WebPartComponent.$3.get_$q_1():null};SP.Ribbon.WebPartComponent.fetchListViewWebPartPageComponent=function(b,a,d,e){ULS04Z:;var c=new SP.Ribbon.FetchListViewWebPartPageComponentWorker(b,a,d,e);c.fetch()};SP.Ribbon.WebPartComponent.$3F=function(b){ULS04Z:;if(SP.ScriptUtility.isNullOrEmptyString(b))return;var a=document.createElement("SCRIPT");a.setAttribute("type","text/javascript");if(Sys.Browser.agent===Sys.Browser.Safari||Sys.Browser.agent===Sys.Browser.AppleWebKit)a.innerHTML=b;else a.text=b;var c=document.getElementsByTagName("HEAD")[0];c.appendChild(a)};SP.Ribbon.WebPartComponent.prototype={$1_1:null,$2o_1:null,$2n_1:null,$2c_1:null,$2v_1:function(b){ULS04Z:;this.$1_1=b;var a=this.$1_1.itemPermissions;if(!SP.Ribbon.SU.$0(a)&&!SP.BasePermissions.isInstanceOfType(a)){this.$1_1.itemPermissions=new SP.BasePermissions;!this.$1_1.itemPermissions.customFromJson(a)&&this.$1_1.itemPermissions.fromJson(a)}},$4x_1:function(a){ULS04Z:;var b=null,c=null;while(a&&a!==document.body){if(a.tagName==="A"||a.tagName==="INPUT")return;if(!b&&(SP.Ribbon.Utility.$J(a,"s4-wpActive")||SP.Ribbon.Utility.$J(a,"s4-wpcell")))b=a;else if(!c&&SP.Ribbon.Utility.$J(a,"ms-SPZone")&&a.getAttribute("zoneID"))c=a;a=a.parentNode}this.deselectWebPartAndZone(b,c)},deselectWebPartAndZone:function(c,b){ULS04Z:;if(this.get_$6_1()&&!SP.Ribbon.SU.$0(this.get_$6_1().getAttribute("WPToolPaneOpen")))return;var a=false;if(this.$6S_1(c))a=true;if(this.$6T_1(b))a=true;a&&SP.Ribbon.UtilityInternal.$z()},$6S_1:function(c){ULS04Z:;if(!c&&this.get_$6_1()&&c!==this.get_$6_1()){var a=this.$5P_1(this.get_$6_1());if(a&&a.isDefaultWebPart)return false;Sys.UI.DomElement.removeCssClass(this.get_$6_1(),"s4-wpActive");!SP.Ribbon.Utility.$J(this.get_$6_1(),"s4-wpcell-plain")&&Sys.UI.DomElement.addCssClass(this.get_$6_1(),"s4-wpcell");DeselectAllWPItems();var d="SelectionCbx"+this.$16_1(this.get_$6_1()),b=$get(d);if(!SP.Ribbon.SU.$0(b))b.checked=false;SP.Ribbon.WebPartComponent.$1q();this.$11_1=null;this.$2s_1(null);return true}return false},$6T_1:function(a){ULS04Z:;if(this.get_$P_1()&&!a&&this.get_$I_1()){Sys.UI.DomElement.removeCssClass(this.get_$I_1(),"s4-wzActive");this.$v_1=null;this.$3m_1(null);return true}return false},selectWebPartById:function(c,a){ULS04Z:;var b=$get("MSOZoneCell_"+c);return this.selectWebPart(b,a)},selectWebPart:function(a,b){ULS04Z:;if(SP.Ribbon.SU.$0(a))return false;if(this.get_$6_1()&&this.get_$6_1()!==a&&!SP.Ribbon.SU.$0(this.get_$6_1().getAttribute("WPToolPaneOpen")))return false;this.$44_1(a,b);SP.Ribbon.UtilityInternal.$z();return true},selectWebPartZone:function(b,d){ULS04Z:;if(this.get_$6_1()&&!SP.Ribbon.SU.$0(this.get_$6_1().getAttribute("WPToolPaneOpen")))return;if(!b){var a=GetElementsByName("MSOZone");if(a&&a.length>0)for(var c=0;c<a.length;c++){var e=a[c].getAttribute("zoneId");if(d===e){b=a[c];break}}}if(b){this.$45_1(b);this.$3m_1(b)}},isFocusable:function(){ULS04Z:;return false},receiveFocus:function(){ULS04Z:;return true},yieldFocus:function(){ULS04Z:;return true},getGlobalCommands:function(){ULS04Z:;this.$3Z_1();var a=[];Array.addRange(a,SP.Ribbon.WebPartComponent.$b);Array.addRange(a,this.$19_1);return a},$3k_1:function(){ULS04Z:;var a=window._spWebPartComponents;if(SP.Ribbon.SU.$0(a))return;this.$2c_1=a;this.$19_1=null},$19_1:null,$1A_1:null,$3Z_1:function(){ULS04Z:;if(this.$19_1)return;this.$19_1=[];this.$1A_1={};var h=this.$2c_1;if(SP.Ribbon.SU.$0(h))return;var d=h;for(var f in d)for(var i={key:f,value:d[f]},c=i.value,a=0;a<c.contextualGroupCommands.length;a++){var b=this.$1A_1[c.contextualGroupCommands[a]];if(SP.Ribbon.SU.$0(b)){b=[];this.$1A_1[c.contextualGroupCommands[a]]=b}Array.add(b,i.key)}var e=this.$1A_1;for(var g in e){var j={key:g,value:e[g]};Array.add(this.$19_1,j.key)}},$5P_1:function(b){ULS04Z:;var a=this.$16_1(b);return SP.Ribbon.SU.$2(a)?null:SP.Ribbon.WebPartComponent.$1w(a)},get_$1r_1:function(){ULS04Z:;return SP.Ribbon.DocLibAspxPageComponent.$3?SP.Ribbon.DocLibAspxPageComponent.$3.get_$1r_1():null},canHandleCommand:function(a){ULS04Z:;switch(a){case"MSOMenu_Minimize":case"MSOMenu_Restore":case"MSOMenu_Close":case"MSOMenu_Edit":case"MSOMenu_Delete":return!this.get_$6_1()?false:this.$4H_1(a);case"webPartPageApproval":case"approveWebpartPage":case"rejectWebpartPage":return!SP.Ribbon.SU.$0(this.$1_1.itemId)&&this.$1_1.enableModeration&&this.$1_1.itemPermissions.has(3)&&this.$1_1.itemPermissions.has(5)&&this.get_$1r_1()&&(this.get_$1r_1().moderationStatus===2||!this.$1_1.enableMinorVersioning)&&!this.get_$1r_1().itemIsCheckedout?true:false;case"WebPartContextualGroup":return(SP.Ribbon.WikiPageComponent.$G()||this.get_$P_1()||SP.Ribbon.WebPartComponent.get_$1W())&&!SP.Ribbon.SU.$0(this.get_$6_1());case"insertTextWebPart":case"insertImageWebPart":return this.$2y_1(a,true,null)&&!SP.Ribbon.SU.$0(this.get_$I_1());case"insertExistingList":return this.$2y_1(a,true,null);case"EditMobileSharedPage":return SP.Ribbon.WikiPageComponent.$3c()||!this.$1_1.editable?false:this.$35_1();case"EditMobilePersonalPage":return SP.Ribbon.WikiPageComponent.$3c()||!this.$1_1.editable?false:this.$34_1();case"webPartPageDelete":return SP.Ribbon.SU.$0(this.$1_1.itemId)?false:!this.$1_1.itemPermissions.has(4)?false:true;case"webPartPageEdit":return this.$1_1.editable||this.$1_1.isEditMode;case"webPartPageStartEdit":return this.get_$P_1()||SP.Ribbon.WebPartComponent.get_$1W()?false:this.$1_1.editable;case"webPartPageStopEdit":return!this.get_$P_1()&&!SP.Ribbon.WebPartComponent.get_$1W()?false:true;case"Ribbon.WebPartOption":return(SP.Ribbon.WikiPageComponent.$G()||this.get_$P_1()||SP.Ribbon.WebPartComponent.get_$1W())&&!SP.Ribbon.SU.$0(this.get_$6_1());case"InsertRelatedWebPartToListViewMenuAnchor":case"InsertRelatedWebPartToListView":return(SP.Ribbon.WikiPageComponent.$G()||this.get_$P_1())&&!SP.Ribbon.SU.$0(this.get_$6_1())&&!SP.Ribbon.SU.$0(this.get_$2z_1());case"InsertRelatedWebPartToListFormMenuAnchor":case"InsertRelatedWebPartToListForm":return this.get_$P_1();case"WebPartInsertContextualGroup":return!SP.Ribbon.SU.$0(this.get_$I_1())&&this.$1_1.allowWebPartAdder;case"EditMobilePageMenuOpen":return this.$35_1()||this.$34_1();case"makeHomePage":return SP.Ribbon.DocLibAspxPageComponent.$37();case"EditInDesigner":return!SP.Ribbon.WikiPageComponent.$G()&&this.$1_1.editable&&!this.get_$P_1()&&!SP.Ribbon.WebPartComponent.get_$1W();default:this.$3Z_1();var b=this.$1A_1[a];if(!SP.Ribbon.SU.$0(b))return Array.contains(b,this.get_$Q_1())}return true},handleCommand:function(b,a,e){ULS04Z:;switch(b){case"MSOMenu_Minimize":case"MSOMenu_Restore":case"MSOMenu_Close":case"MSOMenu_Edit":case"MSOMenu_Delete":this.$46_1(b,a,e);break;case"InsertRelatedWebPartToListView":!SP.Ribbon.SU.$0(a)&&SP.Ribbon.RelatedFieldsHelper.addAndConnectRelatedWebPart(a,this.get_$q_1(),this.get_$49_1(),SP.Ribbon.WikiPageComponent.$G());break;case"GetRelatedFieldsToListViewMenuXml":if(!SP.Ribbon.SU.$0(a)){var f=a;f=this.$2o_1.getRelatedFieldsMenuXml(f,this.get_$2z_1(),this.get_$48_1())}break;case"InsertRelatedWebPartToListForm":!SP.Ribbon.SU.$0(a)&&SP.Ribbon.RelatedFieldsHelper.addAndConnectRelatedWebPart(a,"Main",null,false);break;case"GetRelatedFieldsToListFormMenuXml":if(!SP.Ribbon.SU.$0(a)){var g=a;g=this.$2n_1.getRelatedFieldsMenuXml(g,null,null)}break;case"approveWebpartPage":this.$3i_1(true);break;case"rejectWebpartPage":this.$3i_1(false);break;case"webPartPageDelete":this.$4w_1();break;case"webPartPageEdit":switch(a.CommandValueId){case"Ribbon.WebPartPage.Edit.Edit.Menu.Actions.Edit":this.handleCommand("webPartPageStartEdit",null,e);break;case"Ribbon.WebPartPage.Edit.Edit.Menu.Actions.Stop":this.handleCommand("webPartPageStopEdit",null,e)}break;case"webPartPageStartEdit":if(this.$1_1.itemId>0&&this.$1_1.forceCheckout)window.EnsureCheckoutAndChangeLayoutModeToEdit(this.$1_1.listId,this.$1_1.itemId,false);else window.ChangeLayoutMode(false,false);break;case"webPartPageStopEdit":window.ChangeLayoutMode(null,true);break;case"webPartPageEditQuery":var h=window.document.getElementById("MSOLayout_InDesignMode"),i=window.document.getElementById("MSOSPWebPartManager_DisplayModeName");if(h&&h.value!=="1"&&(!i||i.value!=="Edit"))a.SelectedItemId="Ribbon.WebPartPage.Edit.Edit.Menu.Actions.Edit";else a.SelectedItemId="Ribbon.WebPartPage.Edit.Edit.Menu.Actions.Stop";break;case"insertWebPart":case"insertExistingList":this.$6N_1(b);break;case"insertTextWebPart":case"insertImageWebPart":this.$2y_1(b,false,null);break;case"CommandContextChanged":this.$5y_1(a);break;case"EditMobileSharedPage":var c=SP.Utilities.HttpUtility.urlPathEncode(SP.PageContextInfo.get_webServerRelativeUrl());if(!c.endsWith("/"))c+="/";c+=SP.Utilities.HttpUtility.urlPathEncode(SP.Utilities.Utility.get_layoutsLatestVersionRelativeUrl()+"mwpsettings.aspx?pageview=shared&url=");c+=SP.Utilities.HttpUtility.urlPathEncode(GetSource());window.location=c;break;case"EditMobilePersonalPage":var d=SP.Utilities.HttpUtility.urlPathEncode(SP.PageContextInfo.get_webServerRelativeUrl());if(!d.endsWith("/"))d+="/";d+=SP.Utilities.HttpUtility.urlPathEncode(SP.Utilities.Utility.get_layoutsLatestVersionRelativeUrl()+"mwpsettings.aspx?pageview=personal&url=");d+=SP.Utilities.HttpUtility.urlPathEncode(GetSource());window.location=d;break;case"makeHomePage":SP.Ribbon.DocLibAspxPageComponent.$3A(b,a,e);break;case"EditInDesigner":var j=window.self.ajaxNavigate;EditInSPD(j.get_href(),false)}return true},$35_1:function(){ULS04Z:;return!!SP.Ribbon.Utility.get_$d()&&SP.Ribbon.Utility.get_$d().has(19)},$34_1:function(){ULS04Z:;return!!SP.Ribbon.Utility.get_$d()&&SP.Ribbon.Utility.get_$d().has(30)},$5y_1:function(a){ULS04Z:;if(a.ChangedByUser&&(this.get_$P_1()&&a.OldContextCommand==="Ribbon.WebPartInsert.Tab"||SP.Ribbon.WikiPageComponent.$G()&&a.OldContextCommand==="InsertTab")){var b=window.WPAdder;b&&b.hide()}},$6N_1:function(e){ULS04Z:;var a=SP.Ribbon.WebPartComponent.getWebPartAdder();if(!a){window.LoadWPAdderOnDemand();return}var b=this.$3S_1(a,e);if(a){var c=true;if(b){var d=b;a.selectCategoryByTitle(d);c=false}a._showCategoryColumn(c);a._setZone(this.get_$q_1());a.show()}},$3S_1:function(c,d){ULS04Z:;var a=null;if(c){var b=c._ribbonMap;if(b)a=b[d]}return a},$2y_1:function(g,h,f){ULS04Z:;var a=SP.Ribbon.WebPartComponent.getWebPartAdder();!a&&window.LoadWPAdderOnDemand();a=SP.Ribbon.WebPartComponent.getWebPartAdder();if(!a)return false;var b=false,c=this.$3S_1(a,g);if(a&&c){var d=c;b=d.length>0;if(!h){if(f){var e=a._getHiddenField("wpVal");if(e)e.value=f}a.addItemToPageByItemIdAndZoneId(d,this.get_$q_1())}}return b},$4w_1:function(){ULS04Z:;var b=this.$1_1.recycleBinEnabled,a;if(b)a=SP.Res.webPartPageRecycleConfirmation;else a=SP.Res.webPartPageDeleteConfirmation;if(confirm(a)){var c=new SP.ClientContext,d=c.get_web().get_lists().getById(new SP.Guid(this.$1_1.listId)).getItemById(this.$1_1.itemId);if(b)d.recycle();else d.deleteObject();c.executeQueryAsync(this.$$d_$5t_1)}},$5t_1:function(){ULS04Z:;var a=this.$1_1.rootFolderUrl;if(!a)window.navigate(SP.PageContextInfo.get_webServerRelativeUrl());else window.navigate(a)},$3i_1:function(b){ULS04Z:;var a=new Sys.StringBuilder;SP.Ribbon.WebPartComponent.$2S("approve.aspx",a);a.append("&List=");a.append(SP.PageContextInfo.get_pageListId());a.append("&ID=");a.append(SP.PageContextInfo.get_pageItemId().toString());a.append("&action=");if(b)a.append("0");else a.append("1");window.OpenPopUpPage(a.toString(),this.$$d_$66_1)},$66_1:function(a){ULS04Z:;if(a===1)SP.Ribbon.DocLibAspxPageComponent.$3&&SP.Ribbon.DocLibAspxPageComponent.$3.$67_1()},$11_1:null,$v_1:null,get_$I_1:function(){ULS04Z:;if(this.$v_1)return this.$v_1;if(this.get_$6_1()){var a=this.get_$6_1();while(a&&a!==document.body){if(SP.Ribbon.Utility.$J(a,"ms-SPZone")&&!SP.Ribbon.SU.$0(a.getAttribute("zoneID"))){this.$v_1=a;break}a=a.parentNode}}return this.$v_1},set_$I_1:function(a){ULS04Z:;this.$v_1=a;return a},get_$6_1:function(){ULS04Z:;if(!this.$11_1){var a=$get("_wpSelected");if(a){var b=a.value;if(!SP.Ribbon.SU.$2(b))this.$11_1=window.document.getElementById(b)}}return this.$11_1},set_$6_1:function(a){ULS04Z:;this.$v_1=null;this.$11_1=a;return a},$4z_1:function(b){ULS04Z:;var a=SP.Ribbon.WebPartComponent.$1w(b);return SP.Ribbon.SU.$0(a)?false:a.hasNonPromotedContextualGroups},$44_1:function($p0,$p1){var $v_0=window._spWebPartComponents;if(this.get_$6_1()!==$p0&&this.get_$6_1()){Sys.UI.DomElement.removeCssClass(this.get_$6_1(),"s4-wpActive");!SP.Ribbon.Utility.$J(this.get_$6_1(),"s4-wpcell")&&!SP.Ribbon.Utility.$J(this.get_$6_1(),"s4-wpcell-plain")&&Sys.UI.DomElement.addCssClass(this.get_$6_1(),"s4-wpcell");DeselectAllWPItems();var $v_2="SelectionCbx"+this.$16_1(this.get_$6_1()),$v_3=$get($v_2);if(!SP.Ribbon.SU.$0($v_3))$v_3.checked=false}this.set_$6_1($p0);if(!SP.Ribbon.SU.$0($v_0)&&$p1){var $v_4=$v_0[this.get_$Q_1()];if(!SP.Ribbon.SU.$0($v_4)){var $v_5=$v_4.firstTabId;if(!SP.Ribbon.SU.$0($v_5))window._spNextRibbonTabId=$v_5}}if(SP.Ribbon.WikiPageComponent.$G()||this.get_$P_1()||this.$4z_1(this.get_$Q_1())){if(!SP.Ribbon.Utility.$J($p0,"s4-wpActive")){Sys.UI.DomElement.addCssClass($p0,"s4-wpActive");SP.Ribbon.Utility.$J($p0,"s4-wpcell")&&Sys.UI.DomElement.removeCssClass($p0,"s4-wpcell")}var $v_6="SelectionCbx"+this.$16_1($p0),$v_7=$get($v_6);if(!SP.Ribbon.SU.$0($v_7))$v_7.checked=true}SP.Ribbon.WebPartComponent.$1q();this.$2s_1($p0);SP.Ribbon.WebPartComponent.$3I();if(this.get_$P_1()){var $v_8=GetElementsByName("MSOZone");if($v_8&&$v_8.length>0){for(var $v_B=0;$v_B<$v_8.length;$v_B++)Sys.UI.DomElement.removeCssClass($v_8[$v_B],"s4-wzActive");var $v_9=this.get_$I_1();$v_9&&!SP.Ribbon.Utility.$J($v_9,"s4-wzActive")&&Sys.UI.DomElement.addCssClass(this.get_$I_1(),"s4-wzActive");var $v_A=SP.Ribbon.WebPartComponent.getWebPartAdder();$v_A&&$v_A._setZone(this.get_$q_1())}}if(SP.Ribbon.SU.$0($v_0))return;var $v_1=$v_0[this.get_$Q_1()];if(SP.Ribbon.SU.$0($v_1))return;if(!SP.Ribbon.SU.$2($v_1.initPageComponentScript)&&!this.get_$6_1()._wpRibbonFetched){this.get_$6_1()._wpRibbonFetched="1";eval($v_1.initPageComponentScript)}else SP.Ribbon.UtilityInternal.$z()},$2s_1:function(b){ULS04Z:;var a=window.document.getElementById("_wpSelected");if(a)if(b){var c=b.id;a.value=c}else a.value=""},$3m_1:function(c){ULS04Z:;var a=window.document.getElementById("_wzSelected");if(a)if(c){var b=c.getAttribute("zoneID");if(SP.Ribbon.SU.$0(b))b="";a.value=b}else a.value=""},$45_1:function(b){ULS04Z:;var c=SP.Ribbon.WebPartComponent.getWebPartAdder();if(this.get_$I_1()===b){this.get_$P_1()&&!SP.Ribbon.Utility.$J(this.get_$I_1(),"s4-wzActive")&&Sys.UI.DomElement.addCssClass(this.get_$I_1(),"s4-wzActive");c&&c._setZone(this.get_$q_1());return}this.get_$I_1()&&Sys.UI.DomElement.removeCssClass(this.get_$I_1(),"s4-wzActive");this.set_$I_1(b);if(this.get_$P_1())!SP.Ribbon.Utility.$J(b,"s4-wzActive")&&Sys.UI.DomElement.addCssClass(b,"s4-wzActive");c&&c._setZone(this.get_$q_1());if(this.get_$6_1()){var a=this.get_$6_1();while(a&&a!==document.body&&a!==b)a=a.parentNode;if(a!==b){Sys.UI.DomElement.removeCssClass(this.get_$6_1(),"s4-wpActive");!SP.Ribbon.Utility.$J(this.get_$6_1(),"s4-wpcell")&&!SP.Ribbon.Utility.$J(this.get_$6_1(),"s4-wpcell-plain")&&Sys.UI.DomElement.addCssClass(this.get_$6_1(),"s4-wpcell");DeselectAllWPItems();var e="SelectionCbx"+this.$16_1(this.get_$6_1()),d=$get(e);if(!SP.Ribbon.SU.$0(d))d.checked=false;SP.Ribbon.WebPartComponent.$1q();this.$11_1=null;this.$2s_1(null)}}SP.Ribbon.UtilityInternal.$z()},get_$q_1:function(){ULS04Z:;return!this.get_$I_1()?null:this.get_$I_1().attributes.getNamedItem("ZoneID").value},get_$47_1:function(){ULS04Z:;return!this.get_$6_1()?null:window.document.getElementById(this.get_$Q_1()+"_MenuLink")},get_$2z_1:function(){ULS04Z:;if(!this.get_$6_1())return null;var a=this.get_$6_1().attributes.getNamedItem(this.get_$Q_1()+"_RelatedListId");return!a?null:a.value},get_$48_1:function(){ULS04Z:;if(!this.get_$6_1())return null;var a=this.get_$6_1().attributes.getNamedItem(this.get_$Q_1()+"_RelatedWebId");return!a?null:a.value},get_$49_1:function(){ULS04Z:;if(!this.get_$6_1())return null;var a=this.get_$6_1().attributes.getNamedItem(this.get_$Q_1()+"_WebPartStorageKey");return!a?null:a.value},get_$P_1:function(){ULS04Z:;var a=$get("MSOLayout_InDesignMode");if(a){var c=a.attributes.getNamedItem("value");if(c&&c.value==="1")return true}var b=$get("MSOSPWebPartManager_DisplayModeName");if(b){var d=b.attributes.getNamedItem("value");if(d&&d.value.toUpperCase()==="DESIGN")return true}return false},get_$1m_1:function(){ULS04Z:;var a=this.get_$47_1();return!a?null:a.getAttribute("menuid")},get_$Q_1:function(){ULS04Z:;var a=this.get_$6_1();return a?this.$16_1(this.get_$6_1()):null},$16_1:function(a){ULS04Z:;return!a?null:a.id.substr(12)},$4H_1:function(b){ULS04Z:;if(SP.Ribbon.SU.$2(this.get_$1m_1()))return false;try{window.MSOWebPartPage_OpenMenu(this.get_$1m_1(),null,this.get_$Q_1(),false,false);var a=this.$3N_1(b);return!!a&&a.style.display!=="none"}catch(c){window.OpenWebPartMenu(this.get_$1m_1(),null,this.get_$Q_1(),false,true);return false}},$3N_1:function(f){ULS04Z:;var e=this.get_$1m_1();if(SP.Ribbon.SU.$2(e))return null;var d=$get(e);if(!d)return null;for(var a=d.getElementsByTagName("ie:menuitem"),b=0;b<a.length;b++)if(a[b].id===f)return a[b];a=d.getElementsByTagName("menuitem");for(var c=0;c<a.length;c++)if(a[c].id===f)return a[c];return null},$46_1:function($p0,$p1,$p2){var $v_0=this.$3N_1($p0);if(!$v_0)return false;var $v_1=$v_0.getAttribute("onmenuclick");if($v_1&&$v_1.length>0){if($v_1.startsWith("javascript:"))$v_1=$v_1.substr(11);eval($v_1);switch($p0){case"MSOMenu_Minimize":case"MSOMenu_Restore":break;default:SP.Ribbon.PageManager.get_instance().get_commandDispatcher().executeCommand("appstatechanged",null)}return true}return false}};SP.Ribbon.FetchListViewWebPartPageComponentWorker=function(a,b,c,d){ULS04Z:;this.$$d_$52_0=Function.createDelegate(this,this.$52_0);this.$$d_$53_0=Function.createDelegate(this,this.$53_0);this.$2q_0=a;this.$2m_0=b;this.$i_0=c;this.$2D_0=d};SP.Ribbon.FetchListViewWebPartPageComponentWorker.prototype={$j_0:null,$2q_0:null,$2m_0:null,$i_0:null,$2D_0:null,fetch:function(){ULS04Z:;this.$j_0=SP.UI.Notify.addNotification(SP.Utilities.HttpUtility.htmlEncode(SP.Res.genericLoading),false);var d=null,e=SP.Ribbon.NativeUtility.getCtxForView("{"+this.$2D_0.toUpperCase()+"}");if(e)d=e.HttpRoot;if(SP.ScriptUtility.isNullOrUndefined(d))d=SP.PageContextInfo.get_webServerRelativeUrl();var b=new SP.Utilities.UrlBuilder(d);b.combinePath(SP.Utilities.Utility.get_layoutsLatestVersionRelativeUrl()+"wpribbon.aspx");b.addKeyValueQueryString("GetFormName","0");b.addKeyValueQueryString("WebPartId",this.$2q_0);b.addKeyValueQueryString("PageComponentId",this.$2m_0);b.addKeyValueQueryString("List",this.$i_0);b.addKeyValueQueryString("View",this.$2D_0);var i=window.self.ajaxNavigate,a=i.get_href(),f=GetUrlKeyValue("RootFolder",false,a);!SP.ScriptUtility.isNullOrEmptyString(f)&&b.addKeyValueQueryString("RootFolder",f);var g=GetUrlKeyValue("FolderCTID",false,a);!SP.ScriptUtility.isNullOrEmptyString(g)&&b.addKeyValueQueryString("FolderCTID",g);var h=GetUrlKeyValue("Source",false,a);!SP.ScriptUtility.isNullOrEmptyString(h)&&b.addKeyValueQueryString("Source",h);var c=a.indexOf("?");if(c>0)a=a.substr(0,c);c=a.indexOf("#");if(c>0)a=a.substr(0,c);c=a.indexOf("//");if(c>0){a=a.substr(c+2);c=a.indexOf("/");if(c<0)throw Error.invalidOperation();a=a.substr(c)}a=unescape(a);b.addKeyValueQueryString("FileUrl",a);SP.PageRequest.doGet(b.get_url(),"text/html",this.$$d_$53_0,this.$$d_$52_0)},$53_0:function(f,e){ULS04Z:;SP.UI.Notify.removeNotification(this.$j_0);var b=e.get_executor().get_responseData(),a=b.indexOf("function _initTRA");if(a<0)return;a=b.indexOf("<script ");a=b.indexOf(">",a)+1;var c=b.indexOf("<\/script>",a);if(c<0)return;var d=b.substring(a,c);SP.Ribbon.WebPartComponent.$3F(d);a=c+9;while((a=b.indexOf("<script ",a))>0){a=b.indexOf(">",a);if(a<0)break;a++;c=b.indexOf("<\/script>",a);if(c<0)break;d=b.substring(a,c);SP.Ribbon.WebPartComponent.$3F(d);a=c+9}SP.Ribbon.WebPartComponent.$1q();SP.Ribbon.WebPartComponent.$3I();SP.Ribbon.UtilityInternal.$z()},$52_0:function(){ULS04Z:;SP.UI.Notify.removeNotification(this.$j_0)}};SP.Ribbon.StateDetails=function(){};SP.Ribbon.StateDetails.prototype={viewCtx:null,contactingServerMsg:null,successMsg:null,failureMsg:null};SP.Ribbon.AccessRequestsWebPartPageComponent=function(b,a){ULS04Z:;SP.Ribbon.AccessRequestsWebPartPageComponent.initializeBase(this,[b,a]);this.$H_4=a.ViewId};SP.Ribbon.AccessRequestsWebPartPageComponent.prototype={$H_4:null,handleCommand:function(b){ULS04Z:;var c=this.get_ctx();if(b==="CheckUsrPerm"){var m=c.HttpRoot,n=GetSelectedItemsDict(c),g=this.$1v_4(n,c);if(g&&g.length>0){var d=g[0],o=d.ReqForUser,p=o[0],h=p.title,q=d.RequestedWebId,i=d.RequestedListId,k=d.RequestedListItemId,f="";if(k!==SP.Guid.get_empty().toString("B"))f=i+","+k+",DOCUMENT";else if(i!==SP.Guid.get_empty().toString("B"))f=i+",LIST";else f=q+",WEB";if(!h)h=d.RequestedForDisplayName;var r=String.format("javascript:OpenPopUpPage('{0}{1}chkperm.aspx?obj={2}&users={3}');",m,SP.Utilities.Utility.get_layoutsLatestVersionUrl(),f,SP.Utilities.HttpUtility.urlKeyValueEncode(h));this.executeClickScript(r)}return true}else if(b==="Resend"||b==="Revoke"||b==="Approve"||b==="Deny"){var e=0,a=new SP.Ribbon.StateDetails;a.viewCtx=c;if(b==="Resend"){e=0;a.contactingServerMsg=window.self.Strings.STS.L_AccReqResendingInv;a.successMsg=window.self.Strings.STS.L_AccReqResendingInvSuccess;a.failureMsg=window.self.Strings.STS.L_AccReqResendingInvFail}else if(b==="Revoke"){e=5;a.contactingServerMsg=window.self.Strings.STS.L_AccReqRevokingInv;a.successMsg=window.self.Strings.STS.L_AccReqRevokingInvSuccess;a.failureMsg=window.self.Strings.STS.L_AccReqRevokingInvFail}else if(b==="Approve"){e=1;a.contactingServerMsg=window.self.Strings.STS.L_AccReqSendingApproval;a.successMsg=window.self.Strings.STS.L_AccReqApprovalSuccess;a.failureMsg=window.self.Strings.STS.L_AccReqApprovalFail}else if(b==="Deny"){e=3;a.contactingServerMsg=window.self.Strings.STS.L_AccReqSendingDenial;a.successMsg=window.self.Strings.STS.L_AccReqDenialSuccess;a.failureMsg=window.self.Strings.STS.L_AccReqDenialFail}var l=null;l=GetSelectedItemsDict(c);var j=this.$1v_4(l,c);j&&j.length>0&&SP.Ribbon.NativeUtility.updateStatus(j,e,a);return true}else return false},getFocusedCommands:function(){ULS04Z:;var a=SP.Ribbon.ListViewWebPartPageComponent.prototype.getFocusedCommands.call(this);Array.add(a,"Resend");Array.add(a,"Revoke");Array.add(a,"Approve");Array.add(a,"Deny");Array.add(a,"CheckUsrPerm");return a},canHandleCommand:function(a){ULS04Z:;if(a==="Ribbon.AccessRequestsContextualGroup.Edit"||a==="Ribbon.AccessRequestsContextualGroup.Edit.InvitationsGroup"||a==="Ribbon.AccessRequestsContextualGroup.Edit.RequestsGroup"||a==="Ribbon.AccessRequestsContextualGroup.Edit.CheckGroup")return true;else if(a==="CheckUsrPerm"){var d=true,j=null,k=this.get_ctx();j=GetSelectedItemsDict(k);var e=this.$1v_4(j,k);if(e.length===1){var r=e[0],s=r.IsInvitation;if(s==="Yes")d=false}else if(e.length>1)d=false;return d}else{var l=null,f=this.get_ctx(),m=f.BaseViewID;if(m===1||m===2){l=GetSelectedItemsDict(f);for(var t=this.$1v_4(l,f),b=false,i=t,q=i.length,c=0;c<q;++c){var g=i[c],n=g.IsInvitation,o=g.PermissionType,p=g.PermissionLevelRequested,h=null;if(o==="SharePoint Group"){var u=window.self.g_accReqCSRBridgeSPGroups;h=u[p]}else if(o==="Role Definition"){var v=window.self.g_accReqCSRBridgeSPIndvPerms;h=v[p]}if(!h&&a==="Approve"){b=false;break}if(a==="Resend"||a==="Revoke")if(n==="Yes")b=true;else{b=false;break}else if(a==="Approve"||a==="Deny")if(n==="No")b=true;else{b=false;break}}return b}return false}},$1v_4:function(r,s){ULS04Z:;var i=this.getCountOfSelectedItems(),j=0,e=new Array(i),b=r;for(var d in b){for(var k={key:d,value:b[d]},l=k.key.split(","),m=l[1],n=s.ListData,f=n.Row,g=0,c=f,h=c.length,a=0;a<h;++a){var p=c[a],q=p.ID;if(q===m)break;g++}var o=f[g];e[j++]=o}return e},getGlobalCommands:function(){ULS04Z:;var c=SP.Ribbon.ListViewWebPartPageComponent.prototype.getGlobalCommands.call(this),a=this.get_alwaysEnabledCommands();for(var b in a){var d={key:b,value:a[b]};Array.add(c,d.key)}return c},get_alwaysEnabledCommands:function(){ULS04Z:;this._alwaysEnabledCommands=SP.Ribbon.WebPartPageComponent.prototype.get_alwaysEnabledCommands.call(this);this._alwaysEnabledCommands["Ribbon.AccessRequestsContextualGroup.Edit"]=true;this._alwaysEnabledCommands["Ribbon.AccessRequestsContextualGroup.Edit.InvitationsGroup"]=true;this._alwaysEnabledCommands["Ribbon.AccessRequestsContextualGroup.Edit.RequestsGroup"]=true;this._alwaysEnabledCommands["Ribbon.AccessRequestsContextualGroup.Edit.CheckGroup"]=true;return this._alwaysEnabledCommands}};SP.Ribbon.BlogPostWebPartPageComponent=function(b,a){ULS04Z:;SP.Ribbon.BlogPostWebPartPageComponent.initializeBase(this,[b,a]);this.$H_5=a.ViewId};SP.Ribbon.BlogPostWebPartPageComponent.prototype={$H_5:null,handleCommand:function(a,b,c){ULS04Z:;var d=this.get_ctx(),e=this.getCountOfSelectedItems();if(a==="NewListItem"){this.executeClickScript(this.getDefaultNewMenuItemScript());return true}return SP.Ribbon.DocLibWebPartPageComponent.prototype.handleCommand.call(this,a,b,c)},get_alwaysEnabledCommands:function(){ULS04Z:;this._alwaysEnabledCommands=SP.Ribbon.WebPartPageComponent.prototype.get_alwaysEnabledCommands.call(this);this._alwaysEnabledCommands["Ribbon.Blog.Posts"]=true;this._alwaysEnabledCommands["Ribbon.Blog.Posts.NewGroup"]=true;this._alwaysEnabledCommands["Ribbon.Blog.Posts.PostsGroup"]=true;this._alwaysEnabledCommands["Ribbon.Blog.Posts.StateGroup"]=true;this._alwaysEnabledCommands.NewListItem=true;this._alwaysEnabledCommands["Ribbon.Blog.Comments"]=true;this._alwaysEnabledCommands["Ribbon.Blog.Comments.CommentsGroup"]=true;this._alwaysEnabledCommands["Ribbon.Blog.Comments.StateGroup"]=true;this._alwaysEnabledCommands["Ribbon.Blog.Categories"]=true;this._alwaysEnabledCommands["Ribbon.Blog.Categories.NewGroup"]=true;this._alwaysEnabledCommands["Ribbon.Blog.Categories.CategoriesGroup"]=true;this._alwaysEnabledCommands["Ribbon.Blog.Categories.StateGroup"]=true;this._alwaysEnabledCommands["Ribbon.Blog.Lists"]=true;this._alwaysEnabledCommands["Ribbon.Blog.Lists.Settings.SettingsGroup"]=true;this._alwaysEnabledCommands["Ribbon.Blog.Lists.Actions.ActionsGroup"]=true;return this._alwaysEnabledCommands},canHandleCommand:function(a){ULS04Z:;return SP.Ribbon.DocLibWebPartPageComponent.prototype.canHandleCommand.call(this,a)},getGlobalCommands:function(){ULS04Z:;return SP.Ribbon.DocLibWebPartPageComponent.prototype.getGlobalCommands.call(this)},getFocusedCommands:function(){ULS04Z:;return SP.Ribbon.DocLibWebPartPageComponent.prototype.getFocusedCommands.call(this)}};SP.Ribbon.PageManager=function(){ULS04Z:;SP.Ribbon.PageManager.initializeBase(this)};SP.Ribbon.PageManager.get_instance=function(){ULS04Z:;if(SP.ScriptUtility.isNullOrUndefined(SP.Ribbon.PageManager.$15)){SP.Ribbon.PageManager.$15=new SP.Ribbon.PageManager;SP.Ribbon.PageManager.$15.initializeInternal()}return SP.Ribbon.PageManager.$15};SP.Ribbon.PageManager.prototype={dispose:function(){ULS04Z:;CUI.Page.PageManager.prototype.dispose.call(this);SP.Ribbon.PageManager.$15=null},executeRootCommand:function(a,c,e,g){ULS04Z:;var f;if(!SP.ScriptUtility.isNullOrUndefined(e)&&a!=="RibbonEvent"&&(a!=="CommandContextChanged"||!SP.ScriptUtility.isNullOrUndefined(c)&&c.ChangedByUser)){var b=0,d=0;if(typeof Date!=="undefined"){var h=new Date;b=h.getTime()}f=CUI.Page.PageManager.prototype.executeRootCommand.call(this,a,c,e,g);if(a&&a!=="PreRibbonTabSwitch")if(c&&c.NewContextCommand&&a==="CommandContextChanged")SP.QoS.WriteUserEngagement("RibbonTabChange_"+c.NewContextCommand);else if(SP.Guid.isValid(a))SP.QoS.WriteUserEngagement("RibbonButtonClickGuid",{guid:a});else SP.QoS.WriteUserEngagement("RibbonButtonClick_"+a);if(typeof Date!=="undefined"){var i=new Date;d=i.getTime()-b;if(b){b=b&4294967295;d=d&4294967295;if(b<0)b+=4294967296;if(d<0)d+=4294967296;SP.Ribbon.NativeUtility.addCommandStreamToWSA(e,b,d)}}}else f=CUI.Page.PageManager.prototype.executeRootCommand.call(this,a,c,e,g);return f}};SP.Ribbon.PageStateActionButton=function(){};SP.Ribbon.PageStateActionButton.updateState=function(){ULS04Z:;var d=SP.Ribbon.PageManager.get_instance(),g=window._spPageStateActionControlId;if(d&&!SP.Ribbon.SU.$2(g)){var a=$get(g);if(a){var b=a.querySelector("span:first-child > img"),c=a.querySelector(".ms-promotedActionButton-text");if(d.get_commandDispatcher().isCommandEnabled("PageStateGroupEdit")){var e=a.getAttribute("_edittooltip").toString();a.setAttribute("_action","edit");a.title=e;if(b){b.style.left="-"+a.getAttribute("_editoffsetx")+"px";b.style.top="-"+a.getAttribute("_editoffsety")+"px";b.alt=e}c&&SP.UI.UIUtility.setInnerText(c,e)}else if(d.get_commandDispatcher().isCommandEnabled("PageStateGroupSaveAndStop")){var f=a.getAttribute("_savetooltip").toString();a.setAttribute("_action","save");a.title=f;if(b){b.style.left="-"+a.getAttribute("_saveoffsetx")+"px";b.style.top="-"+a.getAttribute("_saveoffsety")+"px";b.alt=f}c&&SP.UI.UIUtility.setInnerText(c,f)}}}};SP.Ribbon.PageStateActionButton.sendCommand=function(){ULS04Z:;var a=SP.Ribbon.PageManager.get_instance();if(a)if(a.get_commandDispatcher().isCommandEnabled("PageStateGroupEdit"))a.get_commandDispatcher().executeCommand("PageStateGroupEdit",null);else a.get_commandDispatcher().isCommandEnabled("PageStateGroupSaveAndStop")&&a.get_commandDispatcher().executeCommand("PageStateGroupSaveAndStop",null)};SP.Ribbon.RelatedFieldsFetcher=function(a,b){ULS04Z:;this.$$d_fetchFailure=Function.createDelegate(this,this.fetchFailure);this.$$d_fetchSuccess=Function.createDelegate(this,this.fetchSuccess);this.$21_0=a;this.$22_0=b};SP.Ribbon.RelatedFieldsFetcher.prototype={$2B_0:null,$i_0:null,$18_0:null,$U_0:null,$21_0:null,$22_0:null,getSelectedListValue:function(){ULS04Z:;var a=null;if(this.$U_0.getIsListForm()){var b=$get("currentListForRelationshipsRibbon");if(!SP.Ribbon.SU.$0(b))a=b.value}else if(!SP.Ribbon.SU.$0(this.$21_0))a=this.$21_0;return a},fetchRelatedFieldsBegin:function(e){ULS04Z:;this.$U_0;this.$U_0=e;var b=this.getSelectedListValue();if(SP.Ribbon.SU.$2(b)){this.$U_0.fetchRelatedFieldsFailure(SP.Utilities.HttpUtility.htmlEncode(SP.Res.relationships_UnknownError));return true}if(!this.$18_0)this.$18_0=new SP.ClientContext;var a=null;if(!this.$U_0.getIsListForm()&&!SP.Ribbon.SU.$0(this.$22_0))a=this.$18_0.get_site().openWebById(new SP.Guid(this.$22_0));else a=this.$18_0.get_web();var d=new SP.Guid(b);this.$i_0=a.get_lists().getById(d);this.$i_0.retrieve("Title","BaseType");this.$2B_0=this.$i_0.getRelatedFieldsExtendedData();var c=this.$2B_0.retrieveItems();c.retrieve.call(c,"WebId","ListId","FieldId","ResolvedListTitle","ToolTipDescription","ListImageUrl");this.$18_0.executeQueryAsync(this.$$d_fetchSuccess,this.$$d_fetchFailure);return false},fetchSuccess:function(){ULS04Z:;if(!SP.Ribbon.SU.$0(this.$U_0)){var a=this.$i_0.get_baseType()===1;this.$U_0.fetchRelatedFieldsSuccess(this.$i_0.get_title(),a,this.$2B_0)}this.$U_0=null},fetchFailure:function(b,a){ULS04Z:;a&&!SP.Ribbon.SU.$0(a.get_message());!SP.Ribbon.SU.$0(this.$U_0)&&this.$U_0.fetchRelatedFieldsFailure(SP.Utilities.HttpUtility.htmlEncode(SP.Res.relationships_RelatedFieldsFetchFailed));this.$U_0=null}};SP.Ribbon.RelatedFieldsHelper=function(a){ULS04Z:;this.$1E_0=-1;this.$2b_0=a;if(a)this.$c_0="ListForm";else this.$c_0="ListView"};SP.Ribbon.RelatedFieldsHelper.addAndConnectRelatedWebPart=function(properties,activeZoneId,activeStorageKeyId,bInWikiEditMode){ULS04Z:;var $v_0=properties.CommandValueId,$v_1=$v_0.split(";");if($v_1.length>=2){var $v_2=$v_1[0],$v_3=$v_1[1],$v_4=$v_1[2],$v_5=activeZoneId,$v_6=activeStorageKeyId,$v_7=bInWikiEditMode&&!$v_5,$v_8=String.format("RelatedAdder_addItemAndConnect('{0}', '{1}', '{2}', '{3}', '{4}', {5})",$v_5,$v_2,$v_3,$v_4,$v_6,$v_7);eval($v_8)}};SP.Ribbon.RelatedFieldsHelper.prototype={$k_0:null,$1C_0:false,$2j_0:null,$j_0:null,$c_0:null,$2b_0:false,getIsListForm:function(){ULS04Z:;return this.$2b_0},$3R_0:function(){ULS04Z:;return'\r\n                <Menu Id="Ribbon.Page.InsertRelatedDataTo'+this.$c_0+'.RelatedWebPart.Menu">\r\n                  <MenuSection Id="Ribbon.Page.InsertRelatedDataTo'+this.$c_0+'.RelatedWebPart.Menu.MS" Scrollable="false" DisplayMode="Menu16">\r\n                    <Controls Id="Ribbon.Page.InsertRelatedDataTo'+this.$c_0+'.RelatedWebPart.Menu.MS.Controls">\r\n                  '},$2r_0:"\r\n                    </Controls>\r\n                  </MenuSection>\r\n                </Menu>\r\n        ",fetchRelatedFieldsSuccess:function(g,f,c){ULS04Z:;if(!SP.Ribbon.SU.$0(this.$k_0))return;this.$1C_0=false;var b=new Sys.StringBuilder;b.append(this.$3R_0());if(!c||!c.get_count()){var e=null;if(f)e=SP.Res.relationships_DocLibHasNoRelatedLists;else e=SP.Res.relationships_ListHasNoRelatedLists;var h=String.format(e,g);b.append('\r\n                    <Button \r\n                        Id="Ribbon.Page.InsertRelatedDataTo'+this.$c_0+'.RelatedWebPart.Menu.MS.InsertRelatedPartMessage"\r\n                        Image16by16="'+SP.Utilities.Utility.get_layoutsLatestVersionUrl()+'images/edit.gif"\r\n                        Image32by32="'+SP.Utilities.Utility.get_layoutsLatestVersionUrl()+'images/placeholder32x32.png"\r\n                        LabelText="'+SP.Utilities.HttpUtility.htmlEncode(h)+'"\r\n                    />')}else for(var i=c.get_count(),d=0;d<i;++d){var a=c.itemAt(d),j=a.get_webId().toString("B"),k=a.get_listId().toString("B"),l=a.get_fieldId().toString("B"),m=j+";"+k+";"+l;b.append('\r\n                        <Button \r\n                            Id="Ribbon.Page.InsertRelatedDataTo'+this.$c_0+".RelatedWebPart.Menu.MS.InsertRelatedPart"+d+'"\r\n                            CommandValueId="'+SP.Utilities.HttpUtility.htmlEncode(m)+'"\r\n                            Command="InsertRelatedWebPartTo'+this.$c_0+'"\r\n                            Image16by16="'+a.get_listImageUrl()+'"\r\n                            Image32by32="'+SP.Utilities.Utility.get_layoutsLatestVersionUrl()+'images/placeholder32x32.png"\r\n                            LabelText="'+SP.Utilities.HttpUtility.htmlEncode(a.get_resolvedListTitle())+'" \r\n                            ToolTipTitle="'+SP.Utilities.HttpUtility.htmlEncode(a.get_resolvedListTitle())+'"\r\n                            ToolTipDescription="'+SP.Utilities.HttpUtility.htmlEncode(a.get_toolTipDescription())+'"\r\n                        />')}b.append(this.$2r_0);this.$k_0=b.toString()},fetchRelatedFieldsFailure:function(b){ULS04Z:;if(!SP.Ribbon.SU.$0(this.$k_0))return;this.$1C_0=false;var a=new Sys.StringBuilder;a.append(this.$3R_0());a.append('\r\n                <Button \r\n                    Id="Ribbon.Page.InsertRelatedDataTo'+this.$c_0+'.RelatedWebPart.Menu.MS.InsertRelatedPartMessage"\r\n                    Image16by16="'+SP.Utilities.Utility.get_layoutsLatestVersionUrl()+'"images/edit.gif"\r\n                    Image32by32="'+SP.Utilities.Utility.get_layoutsLatestVersionUrl()+'"images/placeholder32x32.png"\r\n                    LabelText="'+SP.Utilities.HttpUtility.htmlEncode(b)+'"\r\n                />');a.append(this.$2r_0);this.$k_0=a.toString()},getRelatedFieldsMenuXml:function(a,b,c){ULS04Z:;this.$1E_0>=200&&this.fetchRelatedFieldsFailure(SP.Utilities.HttpUtility.htmlEncode(SP.Res.relationships_RelatedFetchFieldsTookTooLong));if(SP.Ribbon.SU.$0(this.$k_0)){this.$1E_0=this.$1E_0+1;if(!this.$1C_0){this.$1C_0=true;this.$2j_0=new SP.Ribbon.RelatedFieldsFetcher(b,c);var d=this.$2j_0.fetchRelatedFieldsBegin(this);if(d){a.PopulationXML=this.$k_0;this.$3o_0();return a}}if(SP.Ribbon.SU.$0(this.$j_0)&&this.$1E_0>5)this.$j_0=SP.UI.Notify.addNotification(SP.Utilities.HttpUtility.htmlEncode(SP.Res.genericLoading),true);a.PollAgainInterval=100;return a}else{a.PopulationXML=this.$k_0;this.$3o_0();!SP.Ribbon.SU.$0(this.$j_0)&&SP.UI.Notify.removeNotification(this.$j_0);return a}},$3o_0:function(){ULS04Z:;this.$k_0=null;this.$1E_0=0;this.$1C_0=false}};SP.Ribbon.UsageReportPageComponent=function(){ULS04Z:;SP.Ribbon.UsageReportPageComponent.initializeBase(this)};SP.Ribbon.UsageReportPageComponent.initialize=function(){ULS04Z:;var a=SP.Ribbon.PageManager.get_instance();a&&a.addPageComponent(SP.Ribbon.UsageReportPageComponent.$2I)};SP.Ribbon.UsageReportPageComponent.prototype={init:function(){},getFocusedCommands:function(){ULS04Z:;return[]},getGlobalCommands:function(){ULS04Z:;return[]},isFocusable:function(){ULS04Z:;return true},receiveFocus:function(){ULS04Z:;return true},yieldFocus:function(){ULS04Z:;return true},canHandleCommand:function(a){ULS04Z:;return commandEnabled(a)},handleCommand:function(b,a,c){ULS04Z:;return handleCommand(b,a,c)}};SP.Ribbon.GroupBoardWebPartPageComponent=function(b,a){ULS04Z:;this.$8_5={};SP.Ribbon.GroupBoardWebPartPageComponent.initializeBase(this,[b,a]);this.$6I_5()};SP.Ribbon.GroupBoardWebPartPageComponent.prototype={$6I_5:function(){ULS04Z:;var a,b=this;a=function(){ULS04Z:;return b.$41_5("CirculationConfirm.aspx")};this.$8_5.CirculationConfirm=a;this.$8_5.CirculationDisconfirm=a;var c=this;a=function(){ULS04Z:;return c.$41_5("CalltrackMark.aspx")};this.$8_5.CallTrackResolve=a;this.$8_5.CallTrackUnresolve=a},handleCommand:function(a,b,c){ULS04Z:;if(this.$8_5[a]){var d=this.$8_5[a];return d(a,b,c)}return SP.Ribbon.GenericListWebPartPageComponent.prototype.handleCommand.call(this,a,b,c)},$41_5:function(h){ULS04Z:;if(this.getCountOfSelectedItems()!==1)return false;var c=this.get_ctx(),d=this.$1V_5(c),g=this.$3P_5(c,d),e=window.location,b=e.pathname,f=e.search;if(!SP.ScriptUtility.isNullOrEmptyString(f))b+=f;b=SP.Utilities.HttpUtility.urlKeyValueEncode(b);var a=new Sys.StringBuilder;a.append('SubmitFormPost("');a.append(SP.Utilities.Utility.getLayoutsPageUrl(h));a.append("?List=");a.append(c.listName);a.append("&Cmd=");a.append(g);a.append("&ID=");a.append(d);a.append("&Source=");a.append(b);a.append('")');this.executeClickScript(a.toString());return true},canHandleCommand:function(b){ULS04Z:;if(this.$8_5[b]){var c=this.get_ctx();if(this.getCountOfSelectedItems()===1){var a=this.$3P_5(c,this.$1V_5(c));if(!SP.Ribbon.SU.$0(a))switch(b){case"CirculationConfirm":return a==="Confirm";case"CirculationDisconfirm":return a==="Disconfirm";case"CallTrackResolve":return a==="Resolve";case"CallTrackUnresolve":return a==="Unresolve"}}}return SP.Ribbon.GenericListWebPartPageComponent.prototype.canHandleCommand.call(this,b)},$1V_5:function(f){ULS04Z:;var c=GetSelectedItemsDict(f);if(!SP.Ribbon.SU.$0(c)){var a=c;for(var b in a){var d={key:b,value:a[b]},e=d.key.split(",");return e[1]}}return null},$3P_5:function(c,d){ULS04Z:;var b="Action#"+c.listName+"#"+d,a=$get(b);return SP.Ribbon.SU.$0(a)?null:a.value},getGlobalCommands:function(){ULS04Z:;var a=SP.Ribbon.GenericListWebPartPageComponent.prototype.getGlobalCommands.call(this);Array.add(a,"CirculationConfirm");Array.add(a,"CirculationDisconfirm");Array.add(a,"CallTrackResolve");Array.add(a,"CallTrackUnresolve");return a},getFocusedCommands:function(){ULS04Z:;return SP.Ribbon.GenericListWebPartPageComponent.prototype.getFocusedCommands.call(this)},addAlwaysEnabledCommands:function(){ULS04Z:;SP.Ribbon.GenericListWebPartPageComponent.prototype.addAlwaysEnabledCommands.call(this);var a=this.get_alwaysEnabledCommands();a.TimecardTab=true;a.TimecardActions=true;a.TimecardManage=true;a.TimecardSettings=true;a.CirculationMenuOpen=true;a.CallTrackMenuOpen=true}};SP.Ribbon.CalendarPageComponentData=function(){ULS04Z:;SP.Ribbon.CalendarPageComponentData.initializeBase(this)};SP.Ribbon.CalendarPageComponentData.prototype={CurrentUserInfo:null,EnablePeopleSelector:false,EnableResourceSelector:false};SP.Ribbon.CalendarListPageComponent=function(c,a){ULS04Z:;this.$$d_$6E_5=Function.createDelegate(this,this.$6E_5);this.$$d_$4R_5=Function.createDelegate(this,this.$4R_5);this.$$d_$2U_5=Function.createDelegate(this,this.$2U_5);this.$$d_$5d_5=Function.createDelegate(this,this.$5d_5);this.$$d_$5e_5=Function.createDelegate(this,this.$5e_5);this.$$d_$5R_5=Function.createDelegate(this,this.$5R_5);this.$$d_$5w_5=Function.createDelegate(this,this.$5w_5);this.$$d_$5v_5=Function.createDelegate(this,this.$5v_5);this.$$d_$65_5=Function.createDelegate(this,this.$65_5);this.$$d_$6C_5=Function.createDelegate(this,this.$6C_5);this.$$d_$51_5=Function.createDelegate(this,this.$51_5);this.$$d_$6D_5=Function.createDelegate(this,this.$6D_5);this.$$d_$4A_5=Function.createDelegate(this,this.$4A_5);this.$$d_$4v_5=Function.createDelegate(this,this.$4v_5);this.$$d_$55_5=Function.createDelegate(this,this.$55_5);this.$54_5=GetImageUrlWithRevision(SP.Utilities.Utility.get_layoutsLatestVersionUrl()+SP.Res.lcid+"/images/formatmap32x32.png");this.$9_5={};this.$8_5={};SP.Ribbon.CalendarListPageComponent.initializeBase(this,[c,a]);var b=this.get_ctx();if(!b)return;this.$17_5=b.ctxId;this.$K_5=a.CurrentUserInfo;this.$10_5=a.EnablePeopleSelector;this.$s_5=a.EnableResourceSelector;this.$R_5="106"===this.get_ctx().listTemplate;this.$5k_5();this.$5j_5()};SP.Ribbon.CalendarListPageComponent.prototype={$1o_5:null,$17_5:null,$2K_5:null,$12_5:null,$K_5:null,$s_5:false,$10_5:false,$R_5:false,get_$r_5:function(){ULS04Z:;if(!this.$1o_5)this.$1o_5=SP.UI.ApplicationPages.CalendarInstanceRepository.lookupInstance(this.$17_5);return this.$1o_5},$5j_5:function(){ULS04Z:;if(!this.get_ctx())return;var a;a=this.$$d_$55_5;this.$8_5.Subscribe=a;this.$8_5.ViewProperties=a;this.$8_5.EditProperties=a;this.$8_5.ManagePermissions=a;this.$8_5.ViewVersions=a;this.$8_5.Moderate=a;this.$8_5.ViewWorkflows=a;this.$8_5.AttachFile=a;this.$8_5.Delete=this.$$d_$4v_5;this.$8_5.CalendarAddCalendar=this.$$d_$4A_5;a=this.$$d_$6D_5;this.$8_5.CalendarPeopleSelect=a;this.$8_5.CalendarResourceSelect=a;a=this.$$d_$51_5;this.$8_5.CalendarExpand=a;this.$8_5.CalendarCollapse=a;a=this.$$d_$6C_5;this.$8_5.CalendarScopeDay=a;this.$8_5.CalendarScopeWeek=a;this.$8_5.CalendarScopeMonth=a;this.$8_5.CalendarScopeWeekGroup=a;this.$8_5.CalendarScopeDayGroup=a;a=this.$$d_$65_5;this.$8_5.QueryCalendarScopeWeekGroup=a;this.$8_5.QueryCalendarScopeDayGroup=a;this.$8_5.QueryCalendarScopeDay=a;this.$8_5.QueryCalendarScopeWeek=a;this.$8_5.QueryCalendarScopeMonth=a;if(this.$R_5)a=this.$$d_$5v_5;else a=this.$$d_$5w_5;this.$8_5.NewListItem=a;this.$8_5.NewDefaultListItem=a;var c=this;this.$8_5.PopulateNewDocumentMenu=function(b,a){ULS04Z:;a.PopulationJSON=c.getNewMenuXml("NewDocument","Ribbon.Document.All.NewDocument");return true};var d=this;this.$8_5.NewDocument=function(c,a){ULS04Z:;var b=a.CommandValueId;d.executeClickScript(b);return true};var b=this;this.$8_5.NewDefaultDocument=function(){ULS04Z:;b.executeClickScript(b.getDefaultNewMenuItemScript());return true};if(this.$R_5)this.$8_5.ConnectToClient=this.$$d_$5R_5;this.$8_5.PopulatePeopleMenu=this.$$d_$5e_5;this.$8_5.CalendarPeopleMenuSelect=this.$$d_$5d_5},$4A_5:function(){ULS04Z:;var a=this.get_ctx(),b=String.format("STSNavigate('{0}"+SP.Utilities.Utility.get_layoutsLatestVersionUrl()+"aggregationsettings.aspx?List={1}&View={2}&Source={3}')",a.HttpRoot,a.listName,a.view,GetSource());SP.Ribbon.NativeUtility.executeECBCommand(b,a);return true},$5d_5:function(f,e){ULS04Z:;for(var d=e.CommandValueId,a=0;a<this.$K_5.length;a++)if(this.$K_5[a].id===d){var c=SP.UI.ApplicationPages.CalendarSelector.instance().getSelector(3,this.$17_5);if(!SP.Ribbon.SU.$0(c)){var b=new SP.UI.ApplicationPages.ResolveEntity;b.entityType="1";b.displayName=this.$K_5[a].displayName;b.id=this.$K_5[a].id;if(a){b.needResolve=true;b.isGroup=true}else{b.email=this.$K_5[a].email;b.accountName=this.$K_5[a].loginName}c.setEntity(b)}break}return true},$5e_5:function(d,c){ULS04Z:;var a=new Sys.StringBuilder;a.append("<Menu Id='");a.append(SP.Utilities.HttpUtility.htmlEncode("Ribbon.Calendar.Selector.People"));a.append(".Menu'>");a.append("<MenuSection Id='");a.append("Ribbon.Calendar.Selector.People");a.append(".Menu.ContentTypes'>");a.append("<Controls Id='");a.append(SP.Utilities.HttpUtility.htmlEncode("Ribbon.Calendar.Selector.People"));a.append(".Menu.ContentTypes.Controls'>");this.$32_5(a,"Ribbon.Calendar.Selector.People.Menu.Entities.AddPerson","CalendarPeopleSelect","CalendarPeopleSelect","CalendarPeopleSelect",SP.Res.cui_AddPerson);if(!SP.Ribbon.SU.$0(this.$K_5))for(var b=0;b<this.$K_5.length;b++)this.$32_5(a,"Ribbon.Calendar.Selector.People.Menu.Entities."+b.toString(),"CalendarPeopleMenuSelect",this.$K_5[b].id,this.$K_5[b].id,this.$K_5[b].displayName);a.append("</Controls>");a.append("</MenuSection>");a.append("</Menu>");c.PopulationXML=a.toString();return true},$32_5:function(a,b,c,d,e,f){ULS04Z:;a.append("<Button Id='");a.append(SP.Utilities.HttpUtility.htmlEncode(b));a.append("' Command='");a.append(SP.Utilities.HttpUtility.htmlEncode(c));a.append("' MenuItemId='");a.append(SP.Utilities.HttpUtility.htmlEncode(d));a.append("' CommandValueId='");a.append(SP.Utilities.HttpUtility.htmlEncode(e));a.append("' CommandType='OptionSelection' LabelText='");a.append(SP.Utilities.HttpUtility.htmlEncode(f));a.append("'/>")},$5R_5:function(e){ULS04Z:;if(SP.Ribbon.SU.$0(this.$12_5)){var f=this._controlData[e];this.executeClickScript(f.ClickScript)}else{window.self.offlineBtnUser=this.$12_5.id;var d=this._controlData[e];if(!SP.Ribbon.SU.$0(d)){for(var c=d.ClickScript.split("','"),a=new Sys.StringBuilder(c[0]),b=1;b<c.length;b++){a.append("','");if(b===4)a.append(SP.Utilities.HttpUtility.ecmaScriptStringLiteralEncode(EEDecodeSpecialChars(this.$12_5.displayName)));else a.append(c[b])}this.executeClickScript(a.toString())}}return true},$55_5:function(e){ULS04Z:;var a=this.get_ctx(),b=this.$1V_5(a);if(!b||!this.$2U_5(e))return true;var c=b;if(b.indexOf(".0.")!==-1||b.indexOf(".1.")!==-1)c=b.substr(0,b.indexOf("."));var d=null;switch(e){case"AttachFile":AttachFile(a);break;case"Subscribe":this.$2F_5(String.format("{0}"+SP.Utilities.Utility.get_layoutsLatestVersionUrl()+"SubNew.aspx?List={1}&ID={2}&Source={3}",a.HttpRoot,SP.Utilities.HttpUtility.urlKeyValueEncode(a.listName),SP.Utilities.HttpUtility.urlKeyValueEncode(c),GetSource()),false);break;case"ViewProperties":this.$2F_5(String.format("{0}&ID={1}",a.displayFormUrl,SP.Utilities.HttpUtility.urlKeyValueEncode(b)),true);break;case"EditProperties":this.$2F_5(String.format("{0}&ID={1}",a.editFormUrl,SP.Utilities.HttpUtility.urlKeyValueEncode(b)),true);break;case"ManagePermissions":d=String.format("EnsureScriptFunc('sharing.js', 'DisplaySharedWithDialog', function () {{ULS04Z:; DisplaySharedWithDialog('{0}','{1}','{2}') }})",a.HttpRoot,SP.Utilities.HttpUtility.urlKeyValueEncode(a.listName),SP.Utilities.HttpUtility.urlKeyValueEncode(c));break;case"ViewVersions":d=String.format("NavigateToVersionsAspxV4(event,'{0}','List={1}&ID={2}')",a.HttpRoot,SP.Utilities.HttpUtility.urlKeyValueEncode(a.listName),SP.Utilities.HttpUtility.urlKeyValueEncode(c));break;case"Moderate":d=String.format("NavigateToApproveRejectAspx(event,'{0}"+SP.Utilities.Utility.get_layoutsLatestVersionUrl()+"approve.aspx?List={1}&ID={2}&Source={3}')",a.HttpRoot,SP.Utilities.HttpUtility.urlKeyValueEncode(a.listName),SP.Utilities.HttpUtility.urlKeyValueEncode(c),GetSource());break;case"ViewWorkflows":d=String.format("STSNavigate('{0}"+SP.Utilities.Utility.get_layoutsLatestVersionUrl()+"Workflow.aspx?List={1}&ID={2}&Source={3}')",a.HttpRoot,SP.Utilities.HttpUtility.urlKeyValueEncode(a.listName),SP.Utilities.HttpUtility.urlKeyValueEncode(c),GetSource())}d&&SP.Ribbon.NativeUtility.executeECBCommand(d,a);return true},$2F_5:function(c,d){ULS04Z:;var a=new SP.UI.DialogOptions;a.url=c;if(d&&this.get_$r_5()){var b=this;a.dialogReturnValueCallback=function(a){ULS04Z:;a===1&&b.get_$r_5().refreshItems()}}SP.UI.ModalDialog.showModalDialog(a)},$4v_5:function(d){ULS04Z:;var a=this.get_$r_5(),c=this.get_ctx(),b=this.$1V_5(c);if(!b||!this.$2U_5(d)||!a)return true;a.deleteItem(b);return true},$5v_5:function(c,b){ULS04Z:;var a=this.get_$r_5();a&&a.newItemDialog(this.$3O_5(b.CommandValueId));return true},$5w_5:function(e,d){ULS04Z:;var c=this.get_ctx(),a=c.newFormUrl,b=this.$3O_5(d.CommandValueId);if(!SP.Ribbon.SU.$2(b)){a+="&ContentTypeId=";a+=SP.Utilities.HttpUtility.urlKeyValueEncode(b)}this.$2F_5(a,true);return true},$3O_5:function(c){ULS04Z:;var d=null;if(!SP.Ribbon.SU.$0(c)){var e=c.toUpperCase(),a=e.lastIndexOf("CONTENTTYPEID="),b=e.lastIndexOf("')");if(a!==-1&&b!==-1&&a+14<b)d=c.substring(a+14,b)}return d},$6C_5:function(c){ULS04Z:;var b=this.$3C_5(c),a=this.get_$r_5();a&&a.moveToView(b);return true},$51_5:function(b){ULS04Z:;var a=this.get_$r_5();if(!a)return true;if(b==="CalendarExpand")a.expandAll();else b==="CalendarCollapse"&&a.collapseAll();return true},$6D_5:function(f){ULS04Z:;var c=this.get_$r_5();if(!c)return true;var b;if(f==="CalendarPeopleSelect")b=2;else b=1;var d=c.getActiveScope(),e=d===5||d===2,a=new Sys.StringBuilder;a.append("__spPickerDialogFunc(");a.append(b.toString());a.append(",'");a.append(this.$17_5);a.append("',");a.append(e?"true":"false");a.append(");");this.executeClickScript(a.toString());return true},$65_5:function(b,c){ULS04Z:;var a=this.$3C_5(b);c.On=this.$3M_5()===a;return true},$3C_5:function(a){ULS04Z:;switch(a){case"QueryCalendarScopeDayGroup":case"CalendarScopeDayGroup":return 5;case"QueryCalendarScopeWeekGroup":case"CalendarScopeWeekGroup":return 2;case"QueryCalendarScopeDay":case"CalendarScopeDay":return 3;case"QueryCalendarScopeWeek":case"CalendarScopeWeek":return 4;case"QueryCalendarScopeMonth":case"CalendarScopeMonth":return 1}return 0},$2U_5:function(k){ULS04Z:;var b=this.get_ctx(),c=this.$1V_5(b);if(!c)return false;var d=c.indexOf(".0.")!==-1,g=c.indexOf(".1.")!==-1,h=GetSelectedItemsDict(b),e=h;for(var f in e){var i={key:f,value:e[f]},j=i.value,a=this.$4t_5(j.Permissions);switch(k){case"Subscribe":if(!d)return a.has(40);break;case"ViewProperties":return a.has(1)&&a.has(13);case"Delete":return a.has(4)&&this.$R_5;case"EditProperties":return a.has(3)&&this.$R_5;case"AttachFile":return!window.browseris.ipad&&a.has(3)&&this.$R_5&&!d&&!g;case"ManagePermissions":if(!d&&!g)return a.has(63)&&this.$R_5;break;case"ViewVersions":return b.verEnabled===1&&a.has(7)&&this.$R_5;case"Moderate":return b.isModerated&&a.has(3)&&a.has(5)&&a.has(18)&&a.has(13)&&this.$R_5;case"ViewWorkflows":return a.has(3)&&this.$R_5}return false}return false},$4t_5:function(b){ULS04Z:;var c=new SP.BasePermissions;if(SP.Ribbon.SU.$2(b))return c;var d=0,a=0,e=b.length;if(e<8)a=parseInt(b,16);else{a=parseInt(b.substr(e-8),16);d=parseInt(b.substr(0,e-8),16)}for(var f=1;a>0;f++,a>>>=1)(a&1)===1&&c.set(f);for(var g=33;d>0;g++,d>>>=1)(d&1)===1&&c.set(g);return c},$5k_5:function(){ULS04Z:;if(!this.get_ctx())return;var a=this.$$d_$2U_5,h=this,g=function(){ULS04Z:;var a=h.$3M_5();return a===1||a===2},k=this,b=function(){ULS04Z:;return false},l=this,c=function(){ULS04Z:;return true};this.$9_5.CalendarAddCalendar=this.$R_5?c:b;this.$9_5.CalendarScopeDayGroup=!!(this.$10_5|this.$s_5)?c:b;this.$9_5.CalendarScopeWeekGroup=!!(this.$10_5|this.$s_5)?c:b;this.$9_5.QueryCalendarScopeDayGroup=!!(this.$10_5|this.$s_5)?c:b;this.$9_5.QueryCalendarScopeWeekGroup=!!(this.$10_5|this.$s_5)?c:b;this.$9_5.Subscribe=a;this.$9_5.ViewProperties=a;this.$9_5.Delete=a;this.$9_5.EditProperties=a;this.$9_5.ManagePermissions=a;this.$9_5.ViewVersions=a;this.$9_5.Moderate=a;this.$9_5.ViewWorkflows=a;this.$9_5.AttachFile=a;this.$9_5.UploadDocumentMenuOpen=this.$$d_$4R_5;var f=this,d=function(){ULS04Z:;return!SP.Ribbon.SU.$0(f.get_newMenuData())&&f.get_newMenuData().length>0};this.$9_5.NewDefaultDocument=d;this.$9_5.PopulateNewDocumentMenu=d;this.$9_5.NewDocument=d;this.$9_5.NewDocumentMenuOpen=d;this.$9_5.CalendarExpand=g;this.$9_5.CalendarCollapse=g;var e=SP.Ribbon.SU.$1X(this.$K_5)?b:c;this.$9_5.CalendarPeopleSelect=e;this.$9_5.PopulatePeopleMenu=e;this.$9_5.CalendarPeopleMenuOpen=e;this.$9_5.CalendarPeopleMenuSelect=e;this.$9_5.CalendarResourceSelect=this.$s_5?c:b;this.$9_5.TasksTab="171"===this.get_ctx().listTemplate?c:b;if(!!(this.$10_5|this.$s_5)){this.$9_5.ConnectToClient=this.$$d_$6E_5;var j=SP.UI.ApplicationPages.CalendarSelector.instance(),i=this;j.addHandler(this.$17_5,true,true,function(b,a){ULS04Z:;i.$2K_5=a.get_entities();SP.Ribbon.UtilityInternal.$z()})}},$6E_5:function(){ULS04Z:;for(var b=[],e=this.$2K_5.length,d=0;d<e;d++){var a=this.$2K_5[d];if(a.entityType!=="1")return false;if(a.isGroup){if(a.needResolve)return false;for(var c=0;c<a.members.length;c++)a.members[c]&&Array.add(b,a.members[c])}else Array.add(b,a)}if(b.length===1){this.$12_5=b[0];if(this.$12_5.id)return true}this.$12_5=null;return false},$4R_5:function(){ULS04Z:;return SP.Ribbon.GenericListWebPartPageComponent.prototype.canHandleCommand.call(this,"UploadDocument")},handleCommand:function(a,b,c){ULS04Z:;var d=this.$8_5[a];return!SP.Ribbon.SU.$0(d)&&d(a,b,c)?true:SP.Ribbon.GenericListWebPartPageComponent.prototype.handleCommand.call(this,a,b,c)},canHandleCommand:function(a){ULS04Z:;var b=this.$9_5[a];return!SP.Ribbon.SU.$0(b)?b(a):SP.Ribbon.GenericListWebPartPageComponent.prototype.canHandleCommand.call(this,a)},getGlobalCommands:function(){ULS04Z:;var a=SP.Ribbon.GenericListWebPartPageComponent.prototype.getGlobalCommands.call(this);Array.add(a,"CalendarPeopleSelect");Array.add(a,"CalendarResourceSelect");Array.add(a,"CalendarPeopleMenuOpen");Array.add(a,"PopulatePeopleMenu");Array.add(a,"CalendarPeopleMenuSelect");Array.add(a,"CalendarExpand");Array.add(a,"CalendarCollapse");Array.add(a,"CalendarAddCalendar");Array.add(a,"CalendarScopeDayGroup");Array.add(a,"CalendarScopeWeekGroup");Array.add(a,"QueryCalendarScopeDayGroup");Array.add(a,"QueryCalendarScopeWeekGroup");Array.add(a,"NewDocument");Array.add(a,"PopulateNewDocumentMenu");Array.add(a,"NewDefaultDocument");Array.add(a,"UploadDocumentMenuOpen");Array.add(a,"NewDocumentMenuOpen");Array.add(a,"TasksTab");return a},getFocusedCommands:function(){ULS04Z:;return SP.Ribbon.GenericListWebPartPageComponent.prototype.getFocusedCommands.call(this)},addAlwaysEnabledCommands:function(){ULS04Z:;SP.Ribbon.GenericListWebPartPageComponent.prototype.addAlwaysEnabledCommands.call(this);var a=this.get_alwaysEnabledCommands();a.CalendarTab=true;a.DocumentTab=true;a.LibraryTab=true;a.DocumentNewGroup=true;a.DocumentManageGroup=true;a.CalendarSelectorGroup=true;a.CalendarScopeGroup=true;a.CalendarExpanderGroup=true;a.CalendarScopeDay=true;a.CalendarScopeWeek=true;a.CalendarScopeMonth=true;a.QueryCalendarScopeDay=true;a.QueryCalendarScopeWeek=true;a.QueryCalendarScopeMonth=true},$3M_5:function(){ULS04Z:;var a=this.get_$r_5();return a?a.getActiveScope():0},$1V_5:function(f){ULS04Z:;var c=GetSelectedItemsDict(f);if(!SP.Ribbon.SU.$0(c)){var a=c;for(var b in a){var d={key:b,value:a[b]},e=d.key.split(",");return e[1]}}return null}};SP.Ribbon.HelpCommandNames=function(){};SP.Ribbon.HelpPageComponent=function(){ULS04Z:;SP.Ribbon.HelpPageComponent.initializeBase(this)};SP.Ribbon.HelpPageComponent.get_instance=function(){ULS04Z:;if(!SP.Ribbon.HelpPageComponent.$3)SP.Ribbon.HelpPageComponent.$3=new SP.Ribbon.HelpPageComponent;return SP.Ribbon.HelpPageComponent.$3};SP.Ribbon.HelpPageComponent.registerWithPageManager=function(){ULS04Z:;if(SP.Ribbon.HelpPageComponent.$V)return;SP.Ribbon.PageManager.get_instance().addPageComponent(SP.Ribbon.HelpPageComponent.get_instance());SP.Ribbon.HelpPageComponent.$V=true};SP.Ribbon.HelpPageComponent.unregisterWithPageManager=function(){ULS04Z:;if(SP.Ribbon.HelpPageComponent.$3){SP.Ribbon.PageManager.get_instance().removePageComponent(SP.Ribbon.HelpPageComponent.get_instance());SP.Ribbon.HelpPageComponent.$V=false}};SP.Ribbon.HelpPageComponent.prototype={$2k_1:null,$a_1:null,init:function(){ULS04Z:;this.$2k_1=["RequestContextualHelp"];this.$a_1=["RequestContextualHelp"]},getFocusedCommands:function(){ULS04Z:;return this.$2k_1},getGlobalCommands:function(){ULS04Z:;return this.$a_1},canHandleCommand:function(a){ULS04Z:;return a==="RequestContextualHelp"?true:false},getId:function(){ULS04Z:;return"HelpComponent"},$h_1:false,handleCommand:function(b,a,c){ULS04Z:;if(SP.Ribbon.SU.$2(b)||SP.Ribbon.SU.$0(a)||SP.Ribbon.SU.$0(c))return false;if(b==="RequestContextualHelp"){this.$h_1=true;HelpWindowKey(a.HelpKeyword);this.$h_1=false}else return false;return true},isFocusable:function(){ULS04Z:;return true},receiveFocus:function(){ULS04Z:;return true},yieldFocus:function(){ULS04Z:;return true}};SP.Ribbon.SaveConflictHandler=function(){};SP.Ribbon.SaveConflictHandler.$1Q=function(){ULS04Z:;if(!SP.Ribbon.SU.$2(SP.Ribbon.SaveConflictHandler.$1G)){SP.UI.Status.removeStatus(SP.Ribbon.SaveConflictHandler.$1G);SP.Ribbon.SaveConflictHandler.$1G=null}if(!SP.Ribbon.SU.$2(SP.Ribbon.SaveConflictHandler.$1H)){SP.UI.Status.removeStatus(SP.Ribbon.SaveConflictHandler.$1H);SP.Ribbon.SaveConflictHandler.$1H=null}if(!SP.Ribbon.SU.$2(SP.Ribbon.SaveConflictHandler.$1I)){SP.UI.Status.removeStatus(SP.Ribbon.SaveConflictHandler.$1I);SP.Ribbon.SaveConflictHandler.$1I=null}};SP.Ribbon.SaveConflictHandler.$6L=function(a){ULS04Z:;SP.Ribbon.SaveConflictHandler.$1I=SP.UI.Status.addStatus(SP.Utilities.HttpUtility.htmlEncode(SP.Res.saveConflictStatusBarTitle),a,true);SP.UI.Status.setStatusPriColor(SP.Ribbon.SaveConflictHandler.$1I,"yellow")};SP.Ribbon.SaveConflictHandler.showSaveConflictDialog=function(g,f,h,e,c,b){ULS04Z:;var i=SP.Utilities.Utility.getLayoutsPageUrl("saveconflict.aspx"),d=new SP.Utilities.UrlBuilder(i);d.addKeyValueQueryString("UserId",g.toString());var a=new SP.UI.DialogOptions;a.args=h;a.url=d.get_url();a.showClose=false;a.dialogReturnValueCallback=function(a,d){ULS04Z:;if(a===1){var g=d;switch(g){case"continue":SP.Ribbon.SaveConflictHandler.$1Q();SP.Ribbon.SaveConflictHandler.$1G=SP.UI.Status.addStatus(SP.Utilities.HttpUtility.htmlEncode(SP.Res.saveConflictStatusBarTitle),f,true);SP.UI.Status.setStatusPriColor(SP.Ribbon.SaveConflictHandler.$1G,"red");break;case"merge":SP.Ribbon.SaveConflictHandler.$1Q();SP.Ribbon.SaveConflictHandler.$1H=SP.UI.Status.addStatus(SP.Utilities.HttpUtility.htmlEncode(SP.Res.saveConflictStatusBarTitle),e,true);SP.UI.Status.setStatusPriColor(SP.Ribbon.SaveConflictHandler.$1H,"red");break;case"discard":SP.Ribbon.SaveConflictHandler.$1Q();!SP.Ribbon.SU.$2(c)&&window.setTimeout(function(){ULS04Z:;eval(c)},0);break;case"overwrite":SP.Ribbon.SaveConflictHandler.$1Q();!SP.Ribbon.SU.$2(b)&&window.setTimeout(function(){ULS04Z:;eval(b)},0)}}};var j=SP.UI.ModalDialog.showModalDialog(a);return j};SP.Ribbon.TrackTabPageComponent=function(){ULS04Z:;SP.Ribbon.TrackTabPageComponent.initializeBase(this)};SP.Ribbon.TrackTabPageComponent.registerWithPageManager=function(){ULS04Z:;if(!SP.Ribbon.TrackTabPageComponent.$3){SP.Ribbon.TrackTabPageComponent.$3=new SP.Ribbon.TrackTabPageComponent;SP.Ribbon.PageManager.get_instance().addPageComponent(SP.Ribbon.TrackTabPageComponent.$3)}};SP.Ribbon.TrackTabPageComponent.prototype={getGlobalCommands:function(){ULS04Z:;if(!SP.Ribbon.TrackTabPageComponent.$2H)SP.Ribbon.TrackTabPageComponent.$2H=["EmailPageUrl","EmailPageLink","ShareGroup","ManageAlerts"];return SP.Ribbon.TrackTabPageComponent.$2H},canHandleCommand:function(a){ULS04Z:;return a==="ManageAlerts"?window._spPageContextInfo&&window._spPageContextInfo.userId?true:false:true},handleCommand:function(b){ULS04Z:;var a=false;switch(b){case"EmailPageUrl":SP.Ribbon.EMailLink.openMailerWithUrl(document.URL);a=true;break;case"EmailPageLink":window.navigateMailToLink(document.URL);a=true;break;case"ManageAlerts":SP.Utilities.HttpUtility.navigateTo(SP.Utilities.Utility.getLayoutsPageUrl("MySubs.aspx"));a=true}return a}};SP.Ribbon.UserInterfacePageComponent=function(){ULS04Z:;SP.Ribbon.UserInterfacePageComponent.initializeBase(this);var a=window.g_spribbon;this.$3h_1=a.minimizedHeight;this.$3g_1=a.maximizedHeight};SP.Ribbon.UserInterfacePageComponent.get_instance=function(){ULS04Z:;if(!SP.Ribbon.UserInterfacePageComponent.$3)SP.Ribbon.UserInterfacePageComponent.$3=new SP.Ribbon.UserInterfacePageComponent;return SP.Ribbon.UserInterfacePageComponent.$3};SP.Ribbon.UserInterfacePageComponent.registerWithPageManager=function(){ULS04Z:;if(SP.Ribbon.UserInterfacePageComponent.$V)return;SP.Ribbon.PageManager.get_instance().addPageComponent(SP.Ribbon.UserInterfacePageComponent.get_instance());SP.Ribbon.UserInterfacePageComponent.$V=true};SP.Ribbon.UserInterfacePageComponent.unregisterWithPageManager=function(){ULS04Z:;if(SP.Ribbon.UserInterfacePageComponent.$3){SP.Ribbon.PageManager.get_instance().removePageComponent(SP.Ribbon.UserInterfacePageComponent.get_instance());SP.Ribbon.UserInterfacePageComponent.$V=false}};SP.Ribbon.UserInterfacePageComponent.prototype={$a_1:null,$3h_1:null,$3g_1:null,$1D_1:null,init:function(){ULS04Z:;this.$a_1=["RibbonEvent","CommandContextChanged","PreRibbonTabSwitch","PreToggleMinimized"]},getGlobalCommands:function(){ULS04Z:;return this.$a_1},canHandleCommand:function(a){ULS04Z:;return a==="RibbonEvent"||a==="CommandContextChanged"||a==="PreRibbonTabSwitch"||a==="PreToggleMinimized"?true:false},getId:function(){ULS04Z:;return"UIComponent"},$h_1:false,handleCommand:function(c,b,h){ULS04Z:;var d=false;this.$h_1=true;if(SP.Ribbon.SU.$2(c)||SP.Ribbon.SU.$0(b)||SP.Ribbon.SU.$0(h))return false;if(c==="RibbonEvent"){var i=b;d=this.$3W_1(i.Minimized||this.$1D_1==="Ribbon.Read")}else if(c==="CommandContextChanged"){var a=b;!SP.Ribbon.SU.$0(a.ChangedByUser)&&a.ChangedByUser&&MenuHtc_hide();if(!SP.Ribbon.SU.$0(a.NewContextId)&&a.NewContextId==="Ribbon.Read"||this.$1D_1==="Ribbon.Read")d=this.$3W_1(a.NewContextId==="Ribbon.Read");this.$1D_1=a.NewContextId}else if(c==="PreRibbonTabSwitch"){var e=b;if(!SP.Ribbon.SU.$0(e.NewContextId)&&e.NewContextId==="Ribbon.Read"||this.$1D_1==="Ribbon.Read"||!this.$1D_1)d=this.$5f_1(e.NewContextId==="Ribbon.Read")}else if(c==="PreToggleMinimized"){var f=b;if(f.Cancelable){var g=window.location.search;f.CancelAction=!SP.Ribbon.SU.$0(g)&&g.indexOf("IsDlg=1")!==-1}d=true}this.$h_1=false;return d},isFocusable:function(){ULS04Z:;return false},$3W_1:function(a){ULS04Z:;OnRibbonMinimizedChanged(a);return true},$5f_1:function(a){ULS04Z:;PreRibbonTabSwitched(a);return true}};SP.Ribbon.EMailLink=function(){};SP.Ribbon.EMailLink.get_$33=function(){ULS04Z:;return!SP.Ribbon.SU.$2(SP.Ribbon.EMailLink.$23)?SP.Ribbon.EMailLink.$23:SP.Res.emailDefaultBody};SP.Ribbon.EMailLink.openMailerWithUrl=function(a){ULS04Z:;SP.Ribbon.EMailLink.$24=new SP.ClientContext;SP.Ribbon.EMailLink.$2C=SP.Utilities.Utility.createEmailBodyForInvitation(SP.Ribbon.EMailLink.$24,a);SP.Ribbon.EMailLink.$24.executeQueryAsync(SP.Ribbon.EMailLink.onSucceededEmailBody,SP.Ribbon.EMailLink.onFailed)};SP.Ribbon.EMailLink.onSucceededEmailBody=function(){ULS04Z:;if(SP.Ribbon.EMailLink.$2C)SP.Ribbon.EMailLink.$23=SP.Ribbon.EMailLink.$2C.get_value();window.navigateMailToLinkWithMessage("",SP.Ribbon.EMailLink.get_$33())};SP.Ribbon.EMailLink.onFailed=function(){ULS04Z:;window.navigateMailToLinkWithMessage("",SP.Ribbon.EMailLink.get_$33())};SP.Ribbon.TasksWebPartPageComponent=function(b,a){ULS04Z:;SP.Ribbon.TasksWebPartPageComponent.initializeBase(this,[b,a])};SP.Ribbon.TasksWebPartPageComponent.prototype={handleCommand:function(a,b,c){ULS04Z:;switch(a){case"Insert":if(this.get_$5_3()){this.get_$5_3().InsertProvisionalItemBeforeFocusedItem();return true}else{InsertProvisionalItem(this.get_ctx());return true}default:return SP.Ribbon.GenericListWebPartPageComponent.prototype.handleCommand.call(this,a,b,c)}},getFocusedCommands:function(){ULS04Z:;var a=SP.Ribbon.GenericListWebPartPageComponent.prototype.getFocusedCommands.call(this);Array.add(a,"Insert");return a},canHandleCommand:function(a){ULS04Z:;switch(a){case"TasksTab":case"TasksManageGroup":case"TasksNewGroup":case"TasksActionsGroup":return true;case"Insert":return this.get_$5_3()?this.get_$5_3().get_IsInsertProvisionalItemBeforeFocusEnabled():this.getCountOfSelectedItems()>0&&SP.Ribbon.GenericListWebPartPageComponent.prototype.canHandleCommand.call(this,"NewDefaultListItem");default:return SP.Ribbon.GenericListWebPartPageComponent.prototype.canHandleCommand.call(this,a)}},getGlobalCommands:function(){ULS04Z:;var c=SP.Ribbon.GenericListWebPartPageComponent.prototype.getGlobalCommands.call(this),a=this.get_alwaysEnabledCommands();for(var b in a){var d={key:b,value:a[b]};Array.add(c,d.key)}return c},addAlwaysEnabledCommands:function(){ULS04Z:;SP.Ribbon.GenericListWebPartPageComponent.prototype.addAlwaysEnabledCommands.call(this);var a=this.get_alwaysEnabledCommands();a.TasksTab=true;a.TasksManageGroup=true;a.TasksNewGroup=true;a.TasksActionsGroup=true;a.OutlineLevels=true}};SP.Ribbon.DesignBuilderPageComponent=function(){ULS04Z:;SP.Ribbon.DesignBuilderPageComponent.initializeBase(this)};SP.Ribbon.DesignBuilderPageComponent.get_instance=function(){ULS04Z:;if(!SP.Ribbon.DesignBuilderPageComponent.$3)SP.Ribbon.DesignBuilderPageComponent.$3=new SP.Ribbon.DesignBuilderPageComponent;return SP.Ribbon.DesignBuilderPageComponent.$3};SP.Ribbon.DesignBuilderPageComponent.registerWithPageManager=function(){ULS04Z:;if(SP.Ribbon.DesignBuilderPageComponent.$V)return;SP.Ribbon.PageManager.get_instance().addPageComponent(SP.Ribbon.DesignBuilderPageComponent.get_instance());SP.Ribbon.DesignBuilderPageComponent.$V=true};SP.Ribbon.DesignBuilderPageComponent.unregisterWithPageManager=function(){ULS04Z:;if(SP.Ribbon.DesignBuilderPageComponent.$3){SP.Ribbon.PageManager.get_instance().removePageComponent(SP.Ribbon.DesignBuilderPageComponent.get_instance());SP.Ribbon.DesignBuilderPageComponent.$V=false}};SP.Ribbon.DesignBuilderPageComponent.prototype={$a_1:null,$3f_1:"none",$X_1:"none",$m_1:null,$l_1:null,$Y_1:null,$2e_1:null,$2i_1:null,$2f_1:null,$2d_1:null,$2h_1:null,$2g_1:null,$26_1:null,$27_1:null,$25_1:null,$1B_1:null,$2A_1:null,init:function(){ULS04Z:;this.$a_1=["QueryAlwaysTrue","ImagePickerFileSelected","ImagePickerFileDismissed","PalettePickerSelected","PalettePickerPreview","PalettePickerPreviewRevert","PalettePickerQuery","LayoutPickerSelected","LayoutPickerPreview","LayoutPickerPreviewRevert","LayoutPickerQuery","FontSchemePickerSelected","FontSchemePickerQuery"];this.$2e_1=$get("ms-designbuilder-hidSelectedImage");this.$2i_1=$get("ms-designbuilder-hidSelectedPalette");this.$2f_1=$get("ms-designbuilder-hidSelectedLayout");this.$2d_1=$get("ms-designbuilder-hidSelectedFontScheme");this.$2h_1=$get("ms-designbuilder-hidSelectedLayoutDefaultTheme");this.$2g_1=$get("ms-designbuilder-hidSelectedLayoutDefaultFontScheme");this.$26_1=$get("ms-designbuilder-imagecontrol-placeholdertext");this.$27_1=$get("ms-designbuilder-imagecontrol-progress");this.$25_1=$get("ms-designbuilder-imagecontrol-errortext");this.$1B_1=$get("ms-designbuilder-imagecontrol-image")},getGlobalCommands:function(){ULS04Z:;return this.$a_1},canHandleCommand:function(a){ULS04Z:;return Array.contains(this.$a_1,a)},getId:function(){ULS04Z:;return"DesignBuilderPageComponent"},$h_1:false,set_$3r_1:function(a){ULS04Z:;this.$3f_1=a;this.$2e_1.value=a;return a},set_$3t_1:function(a){ULS04Z:;this.$m_1=a;this.$2i_1.value=a;return a},set_$3s_1:function(a){ULS04Z:;this.$l_1=a;this.$2f_1.value=a;var b=this.get_$63_1()[a];this.$2h_1.value=b.defaultColorPalette;this.$2g_1.value=b.defaultFontScheme;return a},set_$3q_1:function(a){ULS04Z:;this.$Y_1=a;this.$2d_1.value=a;return a},get_$63_1:function(){ULS04Z:;if(!this.$2A_1){var a=window.g_designData;this.$2A_1=a.preview}return this.$2A_1},handleCommand:function(c,b,d){ULS04Z:;var a=false;this.$h_1=true;if(SP.Ribbon.SU.$2(c)||SP.Ribbon.SU.$0(b)||SP.Ribbon.SU.$0(d))return false;switch(c){case"QueryAlwaysTrue":a=true;break;case"ImagePickerFileSelected":a=this.$5U_1(b);break;case"ImagePickerFileDismissed":a=this.$3U_1(b);break;case"PalettePickerSelected":a=this.$5c_1(b);break;case"PalettePickerPreview":a=this.$5Z_1(b);break;case"PalettePickerPreviewRevert":a=this.$5a_1(b);break;case"PalettePickerQuery":a=this.$5b_1(b);break;case"LayoutPickerSelected":a=this.$5Y_1(b);break;case"LayoutPickerPreview":a=this.$5V_1(b);break;case"LayoutPickerPreviewRevert":a=this.$5W_1(b);break;case"LayoutPickerQuery":a=this.$5X_1(b);break;case"FontSchemePickerSelected":a=this.$5T_1(b);break;case"FontSchemePickerQuery":a=this.$5S_1(b)}this.$h_1=false;return a},$5U_1:function(b){ULS04Z:;var a=b.FileUrl;if(a==="none")return this.$3U_1(b);this.set_$3r_1(a);var c=this.$X_1=a+"?x="+(+new Date).toString();this.$1B_1.src=c;this.$1B_1.style.display="inline-block";this.$26_1.style.display="none";this.$25_1.style.display="none";this.$27_1.style.display="none";var d=b.UpdatePreview;d&&UpdateDesignBuilderPreview(this.$l_1,this.$m_1,c,this.$Y_1);return true},$3U_1:function(){ULS04Z:;this.set_$3r_1("none");this.$X_1="none";this.$1B_1.src="";this.$1B_1.style.display="none";this.$26_1.style.display="inline-block";this.$25_1.style.display="none";this.$27_1.style.display="none";UpdateDesignBuilderPreview(this.$l_1,this.$m_1,this.$X_1,this.$Y_1);return true},$5c_1:function(b){ULS04Z:;var a=this.set_$3t_1(b.CommandValueId);UpdateDesignBuilderPreview(this.$l_1,a,this.$X_1,this.$Y_1);return true},$5Z_1:function(b){ULS04Z:;var a=b.CommandValueId;UpdateDesignBuilderPreview(this.$l_1,a,this.$X_1,this.$Y_1);return true},$5a_1:function(){ULS04Z:;UpdateDesignBuilderPreview(this.$l_1,this.$m_1,this.$X_1,this.$Y_1);return true},$5b_1:function(a){ULS04Z:;this.set_$3t_1(a.SelectedItemId);return true},$5Y_1:function(b){ULS04Z:;var a=this.set_$3s_1(b.CommandValueId);UpdateDesignBuilderPreview(a,this.$m_1,this.$X_1,this.$Y_1);return true},$5V_1:function(b){ULS04Z:;var a=b.CommandValueId;UpdateDesignBuilderPreview(a,this.$m_1,this.$X_1,this.$Y_1);return true},$5W_1:function(){ULS04Z:;UpdateDesignBuilderPreview(this.$l_1,this.$m_1,this.$X_1,this.$Y_1);return true},$5X_1:function(a){ULS04Z:;this.set_$3s_1(a.SelectedItemId);return true},$5T_1:function(a){ULS04Z:;var b=this.set_$3q_1(a.CommandValueId);UpdateDesignBuilderPreview(this.$l_1,this.$m_1,this.$X_1,this.$Y_1);return true},$5S_1:function(a){ULS04Z:;this.set_$3q_1(a.SelectedItemId);return true},isFocusable:function(){ULS04Z:;return false}};Type.registerNamespace("SP.Ribbon.PageState");SP.Ribbon.PageState.PageStateStrings=function(){};SP.Ribbon.PageState.PageStateCommands=function(){};SP.Ribbon.PageState.PageStateHandler=function(){ULS04Z:;SP.Ribbon.PageState.PageStateHandler.initializeBase(this)};SP.Ribbon.PageState.PageStateHandler.getButtonId=function(a){ULS04Z:;if(!SP.Ribbon.PageState.PageStateHandler.$y){SP.Ribbon.PageState.PageStateHandler.$y={};SP.Ribbon.PageState.PageStateHandler.$y.PageStateGroupPublish="Publish";SP.Ribbon.PageState.PageStateHandler.$y.PageStateGroupUnpublish="Unpublish";SP.Ribbon.PageState.PageStateHandler.$y.PageStateGroupSubmitForApproval="SubmitForApproval";SP.Ribbon.PageState.PageStateHandler.$y.PageStateGroupCancelApproval="CancelApproval"}return SP.Ribbon.PageState.PageStateHandler.$y[a]};SP.Ribbon.PageState.PageStateHandler.setHandleSaveMenu=function(a){ULS04Z:;SP.Ribbon.PageState.PageStateHandler.$1x=a};SP.Ribbon.PageState.PageStateHandler.$5L=function($p0){var $v_0=null,$v_1=false;if(!SP.Ribbon.SU.$0(SP.Ribbon.PageState.PageStateHandler.$1P[$p0]))for(var $v_2=SP.Ribbon.PageState.PageStateHandler.$1P[$p0],$v_3=0;$v_3<$v_2.length&&!$v_1;$v_3++)if(eval(SP.Ribbon.PageState.ImportedNativeData.EnabledHandlers[$v_2[$v_3]]))if(!$v_0)$v_0=$v_2[$v_3];else{$v_0=null;$v_1=true}return $v_0};SP.Ribbon.PageState.PageStateHandler.$5M=function(c){ULS04Z:;var a=c[CUI.Controls.DropDownCommandProperties.SelectedItemId],b=a.lastIndexOf(".");return b<0?null:a.substring(0,b+1)};SP.Ribbon.PageState.PageStateHandler.$6K=function(){ULS04Z:;var a=false;if(SP.Ribbon.PageState.ImportedNativeData.PageState.ForceHideStatus)a=false;else if(SP.Ribbon.PageState.ImportedNativeData.PageState.DocLibMinorVersionsEnabled&&SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsMinorVersion||SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsRejected||SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsPendingApproval||SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsScheduled||SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsCheckedOutToCurrentUser||SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsCheckedOutToOtherUser||SP.Ribbon.PageState.ImportedNativeData.PageState.ForceShowStatus)a=true;return a};SP.Ribbon.PageState.PageStateHandler.showPageStatus=function(){ULS04Z:;if(SP.Ribbon.PageState.PageStateHandler.$6K()){for(var b="",a=0;a<SP.Ribbon.PageState.ImportedNativeData.StatusBody.length;a++)if(!SP.Ribbon.SU.$2(SP.Ribbon.PageState.ImportedNativeData.StatusTitle[a])&&!SP.Ribbon.SU.$2(SP.Ribbon.PageState.ImportedNativeData.StatusBody[a]))if(!SP.Ribbon.SU.$2(SP.Ribbon.PageState.PageStateHandler.$E[a])&&$get(SP.Ribbon.PageState.PageStateHandler.$E[a]+"_body")){SP.UI.Status.updateStatus(SP.Ribbon.PageState.PageStateHandler.$E[a],SP.Ribbon.PageState.ImportedNativeData.StatusBody[a]);SP.UI.Status.setStatusPriColor(SP.Ribbon.PageState.PageStateHandler.$E[a],SP.Ribbon.PageState.ImportedNativeData.StatusPriority);if(SP.Ribbon.SU.$2(b))b=SP.Ribbon.PageState.PageStateHandler.$E[a]}else{if(SP.Ribbon.SU.$2(b)){SP.Ribbon.PageState.PageStateHandler.$E[a]=SP.UI.Status.addStatus(SP.Ribbon.PageState.ImportedNativeData.StatusTitle[a],SP.Ribbon.PageState.ImportedNativeData.StatusBody[a],false);b=SP.Ribbon.PageState.PageStateHandler.$E[a]}else SP.Ribbon.PageState.PageStateHandler.$E[a]=SP.UI.Status.appendStatus(b,SP.Ribbon.PageState.ImportedNativeData.StatusTitle[a],SP.Ribbon.PageState.ImportedNativeData.StatusBody[a]);SP.UI.Status.setStatusPriColor(SP.Ribbon.PageState.PageStateHandler.$E[a],SP.Ribbon.PageState.ImportedNativeData.StatusPriority)}else if(!SP.Ribbon.SU.$2(SP.Ribbon.PageState.PageStateHandler.$E[a])){SP.UI.Status.removeStatus(SP.Ribbon.PageState.PageStateHandler.$E[a]);SP.Ribbon.PageState.PageStateHandler.$E[a]=null}}else for(var c=0;c<SP.Ribbon.PageState.PageStateHandler.$E.length;c++)if(!SP.Ribbon.SU.$2(SP.Ribbon.PageState.PageStateHandler.$E[c])){SP.UI.Status.removeStatus(SP.Ribbon.PageState.PageStateHandler.$E[c]);SP.Ribbon.PageState.PageStateHandler.$E[c]=null}};SP.Ribbon.PageState.PageStateHandler.showErrorDialog=function(){ULS04Z:;if(SP.Ribbon.SU.$2(SP.Ribbon.PageState.NativeErrorState.ShowErrorDialogScript)){for(var $v_0="<p>"+SP.Ribbon.PageState.NativeErrorState.Message+"</p><center><ul class='ms-noList'>",$v_3=0;$v_3<SP.Ribbon.PageState.NativeErrorState.ButtonCount;$v_3++)$v_0+='<li class="ms-dlgErrItem"><input type="button" onclick="'+SP.Ribbon.PageState.NativeErrorState.ButtonCommand[$v_3]+'" value="'+SP.Ribbon.PageState.NativeErrorState.ButtonText[$v_3]+'" /></li>';$v_0+="</ul></center>";var $v_1=document.createElement("DIV");$v_1.className="s4-dlg-err-itm";$v_1.style.paddingLeft="11px";$v_1.style.paddingRight="11px";$v_1.style.paddingTop="11px";$v_1.style.paddingBottom="0px";$v_1.style.minWidth="200px";$v_1.innerHTML=$v_0;var $v_2=new SP.UI.DialogOptions;$v_2.html=$v_1;$v_2.title=SP.Ribbon.PageState.NativeErrorState.Title;$v_2.dialogReturnValueCallback=null;SP.Ribbon.PageState.PageStateHandler.ignoreNextUnload=true;SP.Ribbon.PageState.NativeErrorState.ErrorDialog=SP.UI.ModalDialog.showModalDialog($v_2)}else SP.Ribbon.PageState.NativeErrorState.ErrorDialog=eval(SP.Ribbon.PageState.NativeErrorState.ShowErrorDialogScript)};SP.Ribbon.PageState.PageStateHandler.dismissErrorDialog=function(){ULS04Z:;!SP.Ribbon.SU.$0(SP.Ribbon.PageState.NativeErrorState.ErrorDialog)&&SP.Ribbon.PageState.NativeErrorState.ErrorDialog.close(1)};SP.Ribbon.PageState.PageStateHandler.popupWaitScreen=function(a,b){ULS04Z:;SP.Ribbon.PageState.PageStateHandler.ignoreNextUnload=true;SP.Ribbon.PageState.ImportedNativeData.WaitScreen=SP.UI.ModalDialog.showWaitScreenWithNoClose(a,b);SP.Ribbon.PageState.PageStateHandler.ignoreNextUnload=false};SP.Ribbon.PageState.PageStateHandler.dismissWaitScreen=function(){ULS04Z:;!SP.Ribbon.SU.$0(SP.Ribbon.PageState.ImportedNativeData.WaitScreen)&&SP.Ribbon.PageState.ImportedNativeData.WaitScreen.close(1)};SP.Ribbon.PageState.PageStateHandler.EnableSaveBeforeNavigate=function(c){ULS04Z:;if(c){if(!SP.Ribbon.PageState.PageStateHandler.$1d){SP.Ribbon.Utility.$4E("beforeunload",SP.Ribbon.PageState.PageStateHandler.$2u);SP.Ribbon.PageState.PageStateHandler.$1d=true;var a=Sys.WebForms.PageRequestManager.getInstance();a&&a.add_pageLoaded(SP.Ribbon.PageState.PageStateHandler.$2t);SP.Ribbon.PageState.PageStateHandler.ignoreNextUnload=false}}else try{if(SP.Ribbon.PageState.PageStateHandler.$1d){SP.Ribbon.PageState.PageStateHandler.$1d=false;var b=Sys.WebForms.PageRequestManager.getInstance();b&&b.remove_pageLoaded(SP.Ribbon.PageState.PageStateHandler.$2t);SP.Ribbon.Utility.$4y("beforeunload",SP.Ribbon.PageState.PageStateHandler.$2u)}}catch(d){}};SP.Ribbon.PageState.PageStateHandler.$61=function(){ULS04Z:;SP.Ribbon.PageState.PageStateHandler.ignoreNextUnload=false};SP.Ribbon.PageState.PageStateHandler.pageStateOnSubmit=function(){ULS04Z:;SP.Ribbon.PageState.PageStateHandler.ignoreNextUnload=true};SP.Ribbon.PageState.PageStateHandler.SaveBeforeNavigateCallback=function(callbackResponse){ULS04Z:;eval(callbackResponse);SP.Ribbon.PageState.PageStateHandler.saveCallbackError=SP.Ribbon.PageState.NativeErrorState.Message};SP.Ribbon.PageState.PageStateHandler.WikiSaveBeforeNavigateCallback=function(a,b){ULS04Z:;if(b)SP.Ribbon.PageState.PageStateHandler.saveCallbackError=a};SP.Ribbon.PageState.PageStateHandler.$64=function(){ULS04Z:;return SP.Ribbon.SU.$1X(SP.Ribbon.PageState.ImportedNativeData.PageState)?true:!!SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsWikiPage||!SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsWikiPage&&!SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsCheckedOutToCurrentUser};SP.Ribbon.PageState.PageStateHandler.$3j=function(){ULS04Z:;return SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsWikiPage?eval("SPAutoSaveIsPageDirty();"):true};SP.Ribbon.PageState.PageStateHandler.$3z=function(b,a){ULS04Z:;if(!SP.Ribbon.SU.$1X(window.event))if(!SP.Ribbon.SU.$2(a))window.event.returnValue=a;else window.event.returnValue=undefined;else if(!SP.Ribbon.SU.$2(a))b.rawEvent.returnValue=a};SP.Ribbon.PageState.PageStateHandler.saveBeforeNavigate=function(evt){ULS04Z:;if(!SP.Ribbon.PageState.PageStateHandler.ignoreNextUnload&&SP.Ribbon.PageState.Handlers.isInEditMode()&&SP.Ribbon.PageState.PageStateHandler.$3j()){if(SP.Ribbon.PageState.PageStateHandler.$64())if(!confirm(SP.Res.pageStateSaveBeforeNavigateNotCheckedOutWarning)){SP.Ribbon.PageState.PageStateHandler.$3z(evt,SP.Res.pageStateSaveBeforeNavigateLastChanceWarning);return SP.Res.pageStateSaveBeforeNavigateLastChanceWarning;return}SP.Ribbon.PageState.PageStateHandler.saveCallbackError=SP.Res.pageStateSaveBeforeNavigateUnknownError15;eval("\r\n                var __xmlHttpRequest = window.XMLHttpRequest;\r\n                window.XMLHttpRequest = XMLHttpRequest = function() {ULS04Z:;\r\n                    var _xmlHttp = null;\r\n                    if (!__xmlHttpRequest) {\r\n                        try {\r\n                            _xmlHttp = new ActiveXObject('Microsoft.XMLHTTP');\r\n                        }\r\n                        catch(ex) {}\r\n                    }\r\n                    else {\r\n                        _xmlHttp = new __xmlHttpRequest();\r\n                    }\r\n                    \r\n                    if (!_xmlHttp) return null;\r\n                    \r\n                    this.abort = function() {ULS04Z:;return _xmlHttp.abort();}\r\n\r\n                    this.getAllResponseHeaders = function() {ULS04Z:;return _xmlHttp.getAllResponseHeaders();}\r\n                    this.getResponseHeader = function(header) {ULS04Z:;return _xmlHttp.getResponseHeader(header);}\r\n                    this.open = function(method, url, async, user, password) {ULS04Z:;\r\n                        return _xmlHttp.open(method, url, false, user, password);\r\n                    }\r\n                    this.send = function(body) {ULS04Z:;\r\n                        if (_xmlHttp.timeout != undefined)\r\n                        {\r\n                            _xmlHttp.timeout = 15000;\r\n                        }\r\n                        _xmlHttp.send(body);\r\n                        this.readyState = _xmlHttp.readyState;\r\n                        if (this.readyState == 4)\r\n                        {\r\n                            this.responseBody = _xmlHttp.responseBody;\r\n                            this.responseStream = _xmlHttp.responseStream;\r\n                            this.responseText = _xmlHttp.responseText;\r\n                            this.responseXML = _xmlHttp.responseXML;\r\n                            this.status = ScriptImports.IsXhrAborted(_xmlHttp) ? 0 : _xmlHttp.status;\r\n                            this.statusText = _xmlHttp.statusText;\r\n                        }\r\n                        this.onreadystatechange();\r\n                    }\r\n                    this.setRequestHeader = function(name, value) {ULS04Z:;return _xmlHttp.setRequestHeader(name, value);}\r\n                }");eval(SP.Ribbon.PageState.ImportedNativeData.CommandHandlers.PageStateSaveBeforeNavigate);eval("window.XMLHttpRequest = __xmlHttpRequest;");SP.Ribbon.PageState.PageStateHandler.$3z(evt,SP.Ribbon.PageState.PageStateHandler.saveCallbackError);SP.Ribbon.PageState.PageStateHandler.ignoreNextUnload=false;if(!SP.Ribbon.SU.$2(SP.Ribbon.PageState.PageStateHandler.saveCallbackError))return SP.Ribbon.PageState.PageStateHandler.saveCallbackError}};SP.Ribbon.PageState.PageStateHandler.updatePageState=function(){ULS04Z:;var $v_0="PageStateUpdatePageState";if(!SP.Ribbon.PageState.ImportedNativeData||!SP.Ribbon.PageState.ImportedNativeData.CommandHandlers||!SP.Ribbon.PageState.ImportedNativeData.CommandHandlers[$v_0])return;eval(SP.Ribbon.PageState.ImportedNativeData.CommandHandlers[$v_0])};SP.Ribbon.PageState.PageStateHandler.prototype={getFocusedCommands:function(){ULS04Z:;return null},getGlobalCommands:function(){ULS04Z:;return["appstatechanged","CPEditTab","EditAndCheckoutGroup","WikiPageTab","PublishTab","ApproveGroup","PageStateGroupOpenMenuSave","PageStateGroupOpenMenuCheckin","PageStateGroupOpenMenuPublish","PageStateGroupQuerySaveMenu","PageStateGroupQueryCheckinMenu","PageStateGroupQueryPublishMenu","PageStateGroupQueryPagePublishMenu","PageStateGroupSaveSplit","PageStateGroupCheckinSplit","PageStateGroupPublishSplit","PageStateGroupPagePublishSplit","PageStateGroupSave","PageStateGroupSaveAndStop","PageStateGroupSaveAndPublish","PageStateGroupEdit","PageStateGroupDontSaveAndStop","PageStateGroupCheckin","PageStateGroupCheckout","PageStateGroupDiscardCheckout","PageStateGroupOverrideCheckout","PageStateGroupPublish","PageStateGroupUnpublish","PageStateGroupSubmitForApproval","PageStateGroupCancelApproval","PageStateGroupApprove","PageStateGroupReject","ManageGroup","DeletePage","PageStateGroupStopEditing","PublishingGroup"]},canHandleCommand:function(commandId){ULS04Z:;if(!SP.Ribbon.PageState.PageStateHandler.$1x&&(commandId==="PageStateGroupSaveSplit"||commandId==="PageStateGroupOpenMenuSave"||commandId==="PageStateGroupQuerySaveMenu"||commandId==="PageStateGroupSave"||commandId==="PageStateGroupSaveAndStop"||commandId==="PageStateGroupSaveAndPublish"||commandId==="PageStateGroupEdit"||commandId==="PageStateGroupDontSaveAndStop"||commandId==="PageStateGroupStopEditing"))return false;if("PageStateGroupStopEditing"===commandId)commandId="PageStateGroupSaveAndStop";if(!SP.Ribbon.SU.$0(SP.Ribbon.PageState.ImportedNativeData.EnabledHandlers[commandId]))return eval(SP.Ribbon.PageState.ImportedNativeData.EnabledHandlers[commandId]);else if(!SP.Ribbon.SU.$0(SP.Ribbon.PageState.PageStateHandler.$1P[commandId])){for(var $v_0=false,$v_1=SP.Ribbon.PageState.PageStateHandler.$1P[commandId],$v_2=0;$v_2<$v_1.length&&!$v_0;$v_2++)$v_0=eval(SP.Ribbon.PageState.ImportedNativeData.EnabledHandlers[$v_1[$v_2]]);return $v_0}return true},handleCommand:function(a,b){ULS04Z:;if(!SP.Ribbon.PageState.PageStateHandler.$1x&&(a==="PageStateGroupSaveSplit"||a==="PageStateGroupOpenMenuSave"||a==="PageStateGroupQuerySaveMenu"||a==="PageStateGroupSave"||a==="PageStateGroupSaveAndStop"||a==="PageStateGroupEdit"||a==="PageStateGroupDontSaveAndStop"||a==="PageStateGroupStopEditing"))return false;if("appstatechanged"===a){SP.Ribbon.PageStateActionButton.updateState();return true}if("PageStateGroupStopEditing"===a)if(confirm(SP.Res.pageStateSaveBeforeNavigateNotCheckedOutWarning))a="PageStateGroupSaveAndStop";else a="PageStateGroupDontSaveAndStop";if(a.startsWith("PageStateGroupQuery")){var c=SP.Ribbon.PageState.PageStateHandler.$5M(b);if(!c)return false;switch(a){case"PageStateGroupQuerySaveMenu":if(SP.Ribbon.PageState.Handlers.isInEditMode())b[CUI.Controls.DropDownCommandProperties.SelectedItemId]=c+"SaveAndStop";else b[CUI.Controls.DropDownCommandProperties.SelectedItemId]=c+"Edit";break;case"PageStateGroupQueryCheckinMenu":if(SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsCheckedOutToOtherUser)b[CUI.Controls.DropDownCommandProperties.SelectedItemId]=c+"OverrideCheckout";else if(!SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsCheckedOutToCurrentUser)b[CUI.Controls.DropDownCommandProperties.SelectedItemId]=c+"Checkout";else b[CUI.Controls.DropDownCommandProperties.SelectedItemId]=c+"Checkin";break;case"PageStateGroupQueryPublishMenu":if(!this.$3y_1(false,b,c,"PageStateGroupPublishSplit"))return false;break;case"PageStateGroupQueryPagePublishMenu":if(!this.$3y_1(true,b,c,"PageStateGroupPagePublishSplit"))return false}return true}else if(!SP.Ribbon.SU.$0(SP.Ribbon.PageState.ImportedNativeData.CommandHandlers[a]))return SP.Ribbon.PageState.Handlers.showStateChangeDialog(a,SP.Ribbon.PageState.ImportedNativeData.CommandHandlers[a]);else if(b&&!SP.Ribbon.SU.$2(b.CommandValueId))return SP.Ribbon.PageState.Handlers.showStateChangeDialog(b.CommandValueId,SP.Ribbon.PageState.ImportedNativeData.CommandHandlers[b.CommandValueId]);return false},$3y_1:function(d,a,b,e){ULS04Z:;var c=null;if(c=SP.Ribbon.PageState.PageStateHandler.$5L(e))a[CUI.Controls.DropDownCommandProperties.SelectedItemId]=b+SP.Ribbon.PageState.PageStateHandler.getButtonId(c);else if(SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsMajorVersion)if(SP.Ribbon.PageState.ImportedNativeData.PageState.UserHasApproverRights&&!d)a[CUI.Controls.DropDownCommandProperties.SelectedItemId]=b+"Unpublish";else a[CUI.Controls.DropDownCommandProperties.SelectedItemId]=b+"Publish";else if(SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsPendingApproval&&SP.Ribbon.PageState.ImportedNativeData.PageState.DocLibWorkflowEnabled)a[CUI.Controls.DropDownCommandProperties.SelectedItemId]=b+"CancelApproval";else if(SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsCheckedOutToCurrentUser||SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsRejected)if(!SP.Ribbon.PageState.ImportedNativeData.PageState.DocLibWorkflowEnabled&&(!SP.Ribbon.PageState.ImportedNativeData.PageState.DocLibApprovalEnabled||SP.Ribbon.PageState.ImportedNativeData.PageState.UserHasApproverRights))a[CUI.Controls.DropDownCommandProperties.SelectedItemId]=b+"Publish";else a[CUI.Controls.DropDownCommandProperties.SelectedItemId]=b+"SubmitForApproval";else if(SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsCheckedOutToOtherUser)a[CUI.Controls.DropDownCommandProperties.SelectedItemId]=b+"Publish";else if(SP.Ribbon.PageState.ImportedNativeData.PageState.ItemHasCheckedInVersion)if(!SP.Ribbon.PageState.ImportedNativeData.PageState.DocLibWorkflowEnabled&&(!SP.Ribbon.PageState.ImportedNativeData.PageState.DocLibApprovalEnabled||SP.Ribbon.PageState.ImportedNativeData.PageState.UserHasApproverRights))a[CUI.Controls.DropDownCommandProperties.SelectedItemId]=b+"Publish";else a[CUI.Controls.DropDownCommandProperties.SelectedItemId]=b+"SubmitForApproval";else if(SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsPendingApproval)if(!SP.Ribbon.PageState.ImportedNativeData.PageState.DocLibWorkflowEnabled&&SP.Ribbon.PageState.ImportedNativeData.PageState.UserHasApproverRights)a[CUI.Controls.DropDownCommandProperties.SelectedItemId]=b+"Publish";else a[CUI.Controls.DropDownCommandProperties.SelectedItemId]=b+"CancelApproval";else if(SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsScheduled&&!d)a[CUI.Controls.DropDownCommandProperties.SelectedItemId]=b+"Unpublish";else return false;return true},isFocusable:function(){ULS04Z:;return false},receiveFocus:function(){ULS04Z:;return true},yieldFocus:function(){ULS04Z:;return true},init:function(){ULS04Z:;(SP.Ribbon.PageState.NativeErrorState.ButtonCount>0||!SP.Ribbon.SU.$2(SP.Ribbon.PageState.NativeErrorState.ShowErrorDialogScript))&&SP.Ribbon.PageState.PageStateHandler.showErrorDialog();SP.Ribbon.PageState.PageStateHandler.showPageStatus()},getId:function(){ULS04Z:;return"PageState"}};SP.Ribbon.PageState.StateChangeDialogHandler=function(){};SP.Ribbon.PageState.StateChangeDialogHandler.prototype={enabled:null,initialize:null,abort:null,validate:null};SP.Ribbon.PageState.Handlers=function(){};SP.Ribbon.PageState.Handlers.isInEditMode=function(){ULS04Z:;var a=SP.Ribbon.WikiPageComponent.$G();return SP.Ribbon.SU.$1X(SP.Ribbon.PageState.ImportedNativeData)||SP.Ribbon.SU.$1X(SP.Ribbon.PageState.ImportedNativeData.PageState)?a:!!SP.Ribbon.PageState.ImportedNativeData.PageState.ViewModeIsEdit||!!SP.Ribbon.PageState.ImportedNativeData.PageState.ViewModeIsWebPartDesign||a};SP.Ribbon.PageState.Handlers.isSaveEnabled=function(){ULS04Z:;return SP.Ribbon.PageState.Handlers.isInEditMode()&&SP.Ribbon.PageState.ImportedNativeData.PageState.UserHasContributorRights&&SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsInSharedView&&!SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsFormsPage&&!SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsCheckedOutToOtherUser?true:false};SP.Ribbon.PageState.Handlers.isEditEnabled=function(){ULS04Z:;return!SP.Ribbon.PageState.Handlers.isInEditMode()&&SP.Ribbon.PageState.ImportedNativeData.PageState.UserHasContributorRights&&!SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsFormsPage&&SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsInSharedView&&!SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsCheckedOutToOtherUser?true:false};SP.Ribbon.PageState.Handlers.isDontSaveAndStopEnabled=function(){ULS04Z:;return SP.Ribbon.PageState.ImportedNativeData.PageState.ViewModeIsEdit&&!SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsFormsPage&&!SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsCheckedOutToOtherUser?true:false};SP.Ribbon.PageState.Handlers.isSaveAndStopEditEnabled=function(){ULS04Z:;return SP.Ribbon.PageState.Handlers.isInEditMode()&&!SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsFormsPage&&!SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsCheckedOutToOtherUser&&SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsInSharedView?true:false};SP.Ribbon.PageState.Handlers.isSaveAndPublishEnabled=function(){ULS04Z:;return SP.Ribbon.PageState.Handlers.isSaveAndStopEditEnabled()&&SP.Ribbon.PageState.Handlers.$3b()};SP.Ribbon.PageState.Handlers.isCheckoutEnabled=function(){ULS04Z:;return!SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsCheckedOutToCurrentUser&&!SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsFormsPage&&SP.Ribbon.PageState.ImportedNativeData.PageState.UserHasContributorRights&&!SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsCheckedOutToOtherUser&&SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsInLibrary&&SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsInSharedView?true:false};SP.Ribbon.PageState.Handlers.isCheckinEnabled=function(){ULS04Z:;return SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsCheckedOutToCurrentUser&&!SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsCheckedOutToOtherUser&&!SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsFormsPage&&SP.Ribbon.PageState.ImportedNativeData.PageState.UserHasContributorRights&&SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsInLibrary&&SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsInSharedView?true:false};SP.Ribbon.PageState.Handlers.isDiscardCheckoutEnabled=function(){ULS04Z:;return SP.Ribbon.PageState.ImportedNativeData.PageState.ItemHasCheckedInVersion&&!SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsFormsPage&&SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsInSharedView&&!SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsCheckedOutToOtherUser&&SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsCheckedOutToCurrentUser?true:false};SP.Ribbon.PageState.Handlers.isOverrideCheckoutEnabled=function(){ULS04Z:;return SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsCheckedOutToOtherUser&&!SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsFormsPage&&!SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsCheckedOutToCurrentUser&&!SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsCheckedOutToSystemUser&&SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsInLibrary&&SP.Ribbon.PageState.ImportedNativeData.PageState.UserHasOverrideCheckoutRights?true:false};SP.Ribbon.PageState.Handlers.$3b=function(){ULS04Z:;return!SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsFormsPage&&!SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsCheckedOutToOtherUser&&!SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsPendingApproval&&!SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsScheduled&&SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsInLibrary&&SP.Ribbon.PageState.ImportedNativeData.PageState.DocLibMinorVersionsEnabled&&!SP.Ribbon.PageState.ImportedNativeData.PageState.DocLibWorkflowEnabled&&SP.Ribbon.PageState.ImportedNativeData.PageState.UserHasContributorRights&&(SP.Ribbon.PageState.ImportedNativeData.PageState.UserHasApproverRights||!SP.Ribbon.PageState.ImportedNativeData.PageState.DocLibApprovalEnabled)&&SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsInSharedView?true:false};SP.Ribbon.PageState.Handlers.isPublishEnabled=function(){ULS04Z:;return SP.Ribbon.PageState.Handlers.$3b()&&!SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsMajorVersion?true:false};SP.Ribbon.PageState.Handlers.isUnpublishEnabled=function(){ULS04Z:;return!SP.Ribbon.PageState.Handlers.isInEditMode()&&!SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsFormsPage&&!SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsScheduled&&SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsInLibrary&&SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsMajorVersion&&SP.Ribbon.PageState.ImportedNativeData.PageState.DocLibMinorVersionsEnabled&&SP.Ribbon.PageState.ImportedNativeData.PageState.UserHasApproverRights&&SP.Ribbon.PageState.ImportedNativeData.PageState.UserHasContributorRights&&SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsInSharedView&&!SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsCheckedOutToSystemUser?true:false};SP.Ribbon.PageState.Handlers.isSubmitForApprovalEnabled=function(){ULS04Z:;return!SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsMajorVersion&&!SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsFormsPage&&!SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsCheckedOutToOtherUser&&SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsInSharedView&&!SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsPendingApproval&&SP.Ribbon.PageState.ImportedNativeData.PageState.DocLibApprovalEnabled&&SP.Ribbon.PageState.ImportedNativeData.PageState.UserHasContributorRights?true:false};SP.Ribbon.PageState.Handlers.isCancelApprovalEnabled=function(){ULS04Z:;return!SP.Ribbon.PageState.ImportedNativeData.PageState.ViewModeIsEdit&&!SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsFormsPage&&SP.Ribbon.PageState.ImportedNativeData.PageState.UserHasContributorRights&&SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsPendingApproval&&!SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsCheckedOutToOtherUser&&SP.Ribbon.PageState.ImportedNativeData.PageState.DocLibMinorVersionsEnabled&&SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsInSharedView?true:false};SP.Ribbon.PageState.Handlers.isApproveEnabled=function(){ULS04Z:;return!SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsMajorVersion&&!SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsFormsPage&&!SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsCheckedOutToOtherUser&&SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsInSharedView&&SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsPendingApproval&&SP.Ribbon.PageState.ImportedNativeData.PageState.UserHasApproverRights&&SP.Ribbon.PageState.ImportedNativeData.PageState.UserHasContributorRights?true:false};SP.Ribbon.PageState.Handlers.isRejectEnabled=function(){ULS04Z:;return!SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsMajorVersion&&!SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsFormsPage&&!SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsCheckedOutToOtherUser&&SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsInSharedView&&SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsPendingApproval&&SP.Ribbon.PageState.ImportedNativeData.PageState.UserHasApproverRights&&SP.Ribbon.PageState.ImportedNativeData.PageState.UserHasContributorRights?true:false};SP.Ribbon.PageState.Handlers.isDeleteEnabled=function(){ULS04Z:;return SP.Ribbon.PageState.ImportedNativeData.PageState.UserHasDeleteRights&&!SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsCheckedOutToOtherUser&&!SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsDefaultPage?true:false};SP.Ribbon.PageState.Handlers.GenericCompleteHandler=function(cbr){ULS04Z:;SP.Ribbon.PageState.PageStateHandler.dismissWaitScreen();eval(cbr);SP.Ribbon.PageManager.get_instance().get_commandDispatcher().executeCommand("appstatechanged",null);var $v_0=SP.Ribbon.PageState.ImportedNativeData.CallbackResult.Notification;if(!SP.Ribbon.SU.$2($v_0)){SP.UI.Notify.addNotification($v_0,false);SP.Ribbon.PageState.ImportedNativeData.CallbackResult.Notification=""}SP.Ribbon.PageState.PageStateHandler.showPageStatus();SP.Ribbon.PageState.NativeErrorState.ButtonCount>0&&SP.Ribbon.PageState.PageStateHandler.showErrorDialog()};SP.Ribbon.PageState.Handlers.GenericError=function(){ULS04Z:;alert("callback failed")};SP.Ribbon.PageState.Handlers.addStateChangeDialogHandler=function(a){ULS04Z:;SP.Ribbon.PageState.Handlers.$2M.push(a)};SP.Ribbon.PageState.Handlers.setStateChangeDialogFocusOnNode=function(a){ULS04Z:;if(a)SP.Ribbon.PageState.Handlers.$2w=a};SP.Ribbon.PageState.Handlers.onOkButton=function(){ULS04Z:;SP.Ribbon.PageState.Handlers.$6Q()};SP.Ribbon.PageState.Handlers.onCancelButton=function(){ULS04Z:;SP.Ribbon.PageState.Handlers.$6P()};SP.Ribbon.PageState.Handlers.showStateChangeDialog=function(commandId,func){ULS04Z:;SP.Ribbon.PageState.Handlers.$S=new Array(0);for(var $v_3=0;$v_3<SP.Ribbon.PageState.Handlers.$2M.length;$v_3++){var $v_4=true,$v_5=SP.Ribbon.PageState.Handlers.$2M[$v_3];if($v_5.enabled)$v_4=$v_5.enabled(commandId);$v_4&&SP.Ribbon.PageState.Handlers.$S.push($v_5)}if(!SP.Ribbon.PageState.Handlers.$S.length)return eval(func);SP.Ribbon.PageState.PageStateHandler.ignoreNextUnload=true;SP.Ribbon.PageState.Handlers.$2x=func;for(var $v_0=document.createElement("DIV"),$v_6=0;$v_6<SP.Ribbon.PageState.Handlers.$S.length;$v_6++){var $v_7=SP.Ribbon.PageState.Handlers.$S[$v_6];$v_7.initialize(commandId,$v_0)}var $v_1=document.createElement("DIV");$v_1.className="ms-core-form-bottomButtonBox";var $v_8=document.createElement("INPUT");$v_8.value=SP.Res.continueButtonText;$v_8.type="button";$addHandler($v_8,"click",SP.Ribbon.PageState.Handlers.onOkButton);$v_8.id="statechangedialog_okbutton";var $v_9=document.createElement("INPUT");$v_9.value=SP.Res.cancelButtonText;$v_9.type="button";$addHandler($v_9,"click",SP.Ribbon.PageState.Handlers.onCancelButton);$v_9.id="statechangedialog_cancelbutton";$v_1.appendChild($v_8);$v_1.appendChild($v_9);$v_0.appendChild($v_1);var $v_2=new SP.UI.DialogOptions;$v_2.html=$v_0;$v_2.autoSizeStartWidth=400;$v_2.autoSize=true;$v_2.includeScrollBarPadding=false;$v_2.title=SP.Ribbon.PageState.Handlers.$5O(commandId);$v_2.dialogReturnValueCallback=SP.Ribbon.PageState.Handlers.$6O;SP.Ribbon.PageState.Handlers.$2L=SP.UI.ModalDialog.showModalDialog($v_2);SP.Ribbon.PageState.Handlers.$2w.focus();$v_0.parentNode.parentNode.id="statechangedialog";return true};SP.Ribbon.PageState.Handlers.$5O=function(a){ULS04Z:;if(!SP.Ribbon.PageState.Handlers.$2N)SP.Ribbon.PageState.Handlers.$2N={PageStateGroupApprove:SP.Res.pageStateApproveLabel,PageStateGroupCancelApproval:SP.Res.pageStateCancelApprovalLabel,PageStateGroupCheckin:SP.Res.pageStateCheckinLabel,PageStateGroupCheckout:SP.Res.pageStateCheckoutLabel,PageStateGroupDiscardCheckout:SP.Res.pageStateDiscardCheckoutLabel,PageStateGroupDontSaveAndStop:SP.Res.pageStateDontSaveLabel,PageStateGroupEdit:SP.Res.pageStateEditLabel,PageStateGroupOverrideCheckout:SP.Res.pageStateOverrideCheckoutLabel,PageStateGroupPublish:SP.Res.pageStatePublishLabel,PageStateGroupReject:SP.Res.pageStateRejectLabel,PageStateGroupSave:SP.Res.pageStateSaveLabel,PageStateGroupSaveAndStop:SP.Res.pageStateSaveAndStopEditingLabel,PageStateGroupSubmitForApproval:SP.Res.pageStateSubmitForApprovalLabel,PageStateGroupUnpublish:SP.Res.pageStateUnpublishLabel};return SP.Ribbon.PageState.Handlers.$2N[a]};SP.Ribbon.PageState.Handlers.$6O=function($p0,$p1){if($p0===1){for(var $v_0=0;$v_0<SP.Ribbon.PageState.Handlers.$S.length;$v_0++){var $v_1=SP.Ribbon.PageState.Handlers.$S[$v_0];if($v_1.validate)if(!$v_1.validate())return}for(var $v_2=0;$v_2<SP.Ribbon.PageState.Handlers.$S.length;$v_2++){var $v_3=SP.Ribbon.PageState.Handlers.$S[$v_2];$v_3.abort&&$v_3.abort()}eval(SP.Ribbon.PageState.Handlers.$2x)}else if(!$p0)for(var $v_4=0;$v_4<SP.Ribbon.PageState.Handlers.$S.length;$v_4++){var $v_5=SP.Ribbon.PageState.Handlers.$S[$v_4];$v_5.abort&&$v_5.abort()}};SP.Ribbon.PageState.Handlers.$6Q=function(){ULS04Z:;SP.Ribbon.PageState.Handlers.$2L.close(1)};SP.Ribbon.PageState.Handlers.$6P=function(){ULS04Z:;SP.Ribbon.PageState.Handlers.$2L.close(0)};SP.Ribbon.PageState.Handlers.$4p=function(e,d){ULS04Z:;if(!d)return 0;var a=document.createElement("DIV");a.style.width="100%";a.style.marginBottom="10px";d.appendChild(a);var c=document.createElement("DIV");a.appendChild(c);var b=document.createElement("LABEL");b.appendChild(document.createTextNode(SP.Res.checkInComments));c.appendChild(b);SP.Ribbon.PageState.Handlers.$g=document.createElement("TEXTAREA");SP.Ribbon.PageState.Handlers.$g.className="ms-fullWidth";SP.Ribbon.PageState.Handlers.$g.rows=6;SP.Ribbon.PageState.Handlers.$g.id="checkincomments";a.appendChild(SP.Ribbon.PageState.Handlers.$g);SP.Ribbon.PageState.Handlers.setStateChangeDialogFocusOnNode(SP.Ribbon.PageState.Handlers.$g);b.htmlFor=SP.Ribbon.PageState.Handlers.$g.id;return 148};SP.Ribbon.PageState.Handlers.$4q=function(){ULS04Z:;var a=$get("InputComments");a.value=SP.Ribbon.PageState.Handlers.$g.value;return true};SP.Ribbon.PageState.Handlers.$4o=function(a){ULS04Z:;return(a==="PageStateGroupCheckin"||a==="PageStateGroupSubmitForApproval"||a==="PageStateGroupPublish")&&!!SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsCheckedOutToCurrentUser||(a==="PageStateGroupApprove"||a==="PageStateGroupReject")&&!!SP.Ribbon.PageState.ImportedNativeData.PageState.ItemIsPendingApproval};SP.Ribbon.PageState.Handlers.registerCommentsHandler=function(){ULS04Z:;var a=new SP.Ribbon.PageState.StateChangeDialogHandler;a.initialize=SP.Ribbon.PageState.Handlers.$4p;a.enabled=SP.Ribbon.PageState.Handlers.$4o;a.validate=SP.Ribbon.PageState.Handlers.$4q;SP.Ribbon.PageState.Handlers.addStateChangeDialogHandler(a)};Type.registerNamespace("SP.Ribbon.TenantAdmin");SP.Ribbon.TenantAdmin.TenantAdminPageComponent=function(){ULS04Z:;SP.Ribbon.TenantAdmin.TenantAdminPageComponent.initializeBase(this)};SP.Ribbon.TenantAdmin.TenantAdminPageComponent.initialize=function(){ULS04Z:;var a=SP.Ribbon.PageManager.get_instance();null!==a&&a.addPageComponent(SP.Ribbon.TenantAdmin.TenantAdminPageComponent.$2I)};SP.Ribbon.TenantAdmin.TenantAdminPageComponent.$50=function(a){ULS04Z:;__doPostBack("__Page",a);return true};SP.Ribbon.TenantAdmin.TenantAdminPageComponent.$5x=function(){ULS04Z:;location.reload(null)};SP.Ribbon.TenantAdmin.TenantAdminPageComponent.prototype={canHandleCommand:function(a){ULS04Z:;return a==="SiteCollectionsTab"||a==="SiteCollectionsContributeGroup"||a==="CreateSiteCollectionClick"||a==="SiteCollectionsReviewGroup"||a==="SiteCollectionsManageGroup"?true:commandEnabled(a)},getGlobalCommands:function(){ULS04Z:;return["SiteCollectionsTab","SiteCollectionsContributeGroup","CreateSiteCollectionClick","DeleteSiteCollectionsClick","SiteCollectionsReviewGroup","ViewPropertiesClick","SiteCollectionsManageGroup","OwnersClick","DiskQuotaClick"]},handleCommand:function(a){ULS04Z:;if(a==="CreateSiteCollectionClick"){var b=new SP.UI.DialogOptions;b.url="TA_CreateSiteCollection.aspx";b.width=850;b.height=480;b.title=SP.Res.tenantAdmin_SiteCollectionNewDialogTitle;b.dialogReturnValueCallback=SP.Ribbon.TenantAdmin.TenantAdminPageComponent.$5x;SP.UI.ModalDialog.showModalDialog(b);return true}if(a==="DeleteSiteCollectionsClick"){var c=new SP.UI.DialogOptions;c.url="TA_DeleteSiteCollectionDialog.aspx";c.width=600;c.height=200;c.title=SP.Res.tenantAdmin_SiteCollectionDeleteDialogTitle;c.dialogReturnValueCallback=null;SP.UI.ModalDialog.showModalDialog(c);return true}if(a==="ViewPropertiesClick"){var f=new SP.UI.DialogOptions,g=document.getElementById("ctl00_PlaceHolderMain_singleSelectedSite");f.url="TA_ViewSiteCollectionPropertiesDialog.aspx?site="+g.getAttribute("value");f.title=SP.Res.tenantAdmin_SiteCollectionPropertiesDialogTitle;f.dialogReturnValueCallback=null;SP.UI.ModalDialog.showModalDialog(f);return true}if(a==="OwnersClick"){var d=new SP.UI.DialogOptions,h=document.getElementById("ctl00_PlaceHolderMain_singleSelectedSite");d.url="TA_SiteCollectionOwnersDialog.aspx?site="+h.getAttribute("value");d.width=640;d.height=340;d.title=SP.Res.tenantAdmin_SiteCollectionOwnersDialogTitle;d.dialogReturnValueCallback=null;SP.UI.ModalDialog.showModalDialog(d);return true}if(a==="DiskQuotaClick"){var e=new SP.UI.DialogOptions,i=document.getElementById("ctl00_PlaceHolderMain_singleSelectedSite");e.url="TA_SiteCollectionDiskQuotaDialog.aspx?site="+i.getAttribute("value");e.width=640;e.height=280;e.title=SP.Res.tenantAdmin_SiteCollectionDiskQuotaDialogTitle;e.dialogReturnValueCallback=null;SP.UI.ModalDialog.showModalDialog(e);return true}return SP.Ribbon.TenantAdmin.TenantAdminPageComponent.$50(a)}};SP.Ribbon.ControlDataRecord.registerClass("SP.Ribbon.ControlDataRecord");SP.Ribbon.Utility.registerClass("SP.Ribbon.Utility");SP.Ribbon.UtilityInternal.registerClass("SP.Ribbon.UtilityInternal");SP.Ribbon.SU.registerClass("SP.Ribbon.SU");SP.Ribbon.CommandUIExtensionPageComponent.registerClass("SP.Ribbon.CommandUIExtensionPageComponent",CUI.Page.PageComponent);SP.Ribbon.ToolbarRibbonAdapterData.registerClass("SP.Ribbon.ToolbarRibbonAdapterData");SP.Ribbon.ToolbarRibbonAdapter.registerClass("SP.Ribbon.ToolbarRibbonAdapter",CUI.Page.PageComponent);SP.Ribbon.WebPartPageComponentData.registerClass("SP.Ribbon.WebPartPageComponentData",SP.Ribbon.ToolbarRibbonAdapterData);SP.Ribbon.WebPartPageComponent.registerClass("SP.Ribbon.WebPartPageComponent",SP.Ribbon.ToolbarRibbonAdapter);SP.Ribbon.ListViewWebPartPageComponentData.registerClass("SP.Ribbon.ListViewWebPartPageComponentData",SP.Ribbon.WebPartPageComponentData);SP.Ribbon.PagingInformation.registerClass("SP.Ribbon.PagingInformation");SP.Ribbon.ListViewWebPartData.registerClass("SP.Ribbon.ListViewWebPartData",SP.Ribbon.ToolbarRibbonAdapterData);SP.Ribbon.ListViewWebPartPageComponent.registerClass("SP.Ribbon.ListViewWebPartPageComponent",SP.Ribbon.WebPartPageComponent,SP.Application.UI.ViewInformationRequestor,SP.Application.UI.DefaultFormsInformationRequestor);SP.Ribbon.HierarchyTaskList.registerClass("SP.Ribbon.HierarchyTaskList");SP.Ribbon.HierarchyTaskList.Continuation.registerClass("SP.Ribbon.HierarchyTaskList.Continuation");SP.Ribbon.HierarchyTaskList.TaskLauncher.registerClass("SP.Ribbon.HierarchyTaskList.TaskLauncher");SP.Ribbon.ListFormWebPartPageComponentData.registerClass("SP.Ribbon.ListFormWebPartPageComponentData",SP.Ribbon.WebPartPageComponentData);SP.Ribbon.ListFormWebPartPageComponent.registerClass("SP.Ribbon.ListFormWebPartPageComponent",SP.Ribbon.WebPartPageComponent);SP.Ribbon.DocLibWebPartPageComponent.registerClass("SP.Ribbon.DocLibWebPartPageComponent",SP.Ribbon.ListViewWebPartPageComponent);SP.Ribbon.GenericListWebPartPageComponentData.registerClass("SP.Ribbon.GenericListWebPartPageComponentData",SP.Ribbon.ListViewWebPartPageComponentData);SP.Ribbon.GenericListWebPartPageComponent.registerClass("SP.Ribbon.GenericListWebPartPageComponent",SP.Ribbon.ListViewWebPartPageComponent);SP.Ribbon.SolutionsPageComponent.registerClass("SP.Ribbon.SolutionsPageComponent",SP.Ribbon.ListViewWebPartPageComponent);SP.Ribbon.WikiPageComponent.registerClass("SP.Ribbon.WikiPageComponent",CUI.Page.PageComponent);SP.Ribbon.FetchedDocLibItemInfo.registerClass("SP.Ribbon.FetchedDocLibItemInfo");SP.Ribbon.DocLibAspxPageComponent.registerClass("SP.Ribbon.DocLibAspxPageComponent",CUI.Page.PageComponent);SP.Ribbon.WebPartComponent.registerClass("SP.Ribbon.WebPartComponent",CUI.Page.PageComponent);SP.Ribbon.FetchListViewWebPartPageComponentWorker.registerClass("SP.Ribbon.FetchListViewWebPartPageComponentWorker");SP.Ribbon.StateDetails.registerClass("SP.Ribbon.StateDetails");SP.Ribbon.AccessRequestsWebPartPageComponent.registerClass("SP.Ribbon.AccessRequestsWebPartPageComponent",SP.Ribbon.ListViewWebPartPageComponent);SP.Ribbon.BlogPostWebPartPageComponent.registerClass("SP.Ribbon.BlogPostWebPartPageComponent",SP.Ribbon.DocLibWebPartPageComponent);SP.Ribbon.PageManager.registerClass("SP.Ribbon.PageManager",CUI.Page.PageManager);SP.Ribbon.PageStateActionButton.registerClass("SP.Ribbon.PageStateActionButton");SP.Ribbon.RelatedFieldsFetcher.registerClass("SP.Ribbon.RelatedFieldsFetcher");SP.Ribbon.RelatedFieldsHelper.registerClass("SP.Ribbon.RelatedFieldsHelper",null,SP.Ribbon.IRelatedFieldsInfoRequestor);SP.Ribbon.UsageReportPageComponent.registerClass("SP.Ribbon.UsageReportPageComponent",CUI.Page.PageComponent);SP.Ribbon.GroupBoardWebPartPageComponent.registerClass("SP.Ribbon.GroupBoardWebPartPageComponent",SP.Ribbon.GenericListWebPartPageComponent);SP.Ribbon.CalendarPageComponentData.registerClass("SP.Ribbon.CalendarPageComponentData",SP.Ribbon.GenericListWebPartPageComponentData);SP.Ribbon.CalendarListPageComponent.registerClass("SP.Ribbon.CalendarListPageComponent",SP.Ribbon.GenericListWebPartPageComponent);SP.Ribbon.HelpCommandNames.registerClass("SP.Ribbon.HelpCommandNames");SP.Ribbon.HelpPageComponent.registerClass("SP.Ribbon.HelpPageComponent",CUI.Page.PageComponent);SP.Ribbon.SaveConflictHandler.registerClass("SP.Ribbon.SaveConflictHandler");SP.Ribbon.TrackTabPageComponent.registerClass("SP.Ribbon.TrackTabPageComponent",CUI.Page.PageComponent);SP.Ribbon.UserInterfacePageComponent.registerClass("SP.Ribbon.UserInterfacePageComponent",CUI.Page.PageComponent);SP.Ribbon.EMailLink.registerClass("SP.Ribbon.EMailLink");SP.Ribbon.TasksWebPartPageComponent.registerClass("SP.Ribbon.TasksWebPartPageComponent",SP.Ribbon.GenericListWebPartPageComponent);SP.Ribbon.DesignBuilderPageComponent.registerClass("SP.Ribbon.DesignBuilderPageComponent",CUI.Page.PageComponent);SP.Ribbon.PageState.PageStateStrings.registerClass("SP.Ribbon.PageState.PageStateStrings");SP.Ribbon.PageState.PageStateCommands.registerClass("SP.Ribbon.PageState.PageStateCommands");SP.Ribbon.PageState.PageStateHandler.registerClass("SP.Ribbon.PageState.PageStateHandler",CUI.Page.PageComponent,CUI.Page.ICommandHandler);SP.Ribbon.PageState.StateChangeDialogHandler.registerClass("SP.Ribbon.PageState.StateChangeDialogHandler");SP.Ribbon.PageState.Handlers.registerClass("SP.Ribbon.PageState.Handlers");SP.Ribbon.TenantAdmin.TenantAdminPageComponent.registerClass("SP.Ribbon.TenantAdmin.TenantAdminPageComponent",CUI.Page.PageComponent);function sp_ribbon_initialize(){ULS04Z:;SP.Ribbon.UtilityInternal.$2G=0;SP.Ribbon.UtilityInternal.$3p=SP.Ribbon.UtilityInternal.$6F;SP.Ribbon.CommandUIExtensionPageComponent.$1e=null;SP.Ribbon.CommandUIExtensionPageComponent.$2P=false;SP.Ribbon.ListViewWebPartPageComponent._LibraryNavigationGroup="LibraryNavigationGroup";SP.Ribbon.ListViewWebPartPageComponent.$3l=new RegExp("[?&]IsDlg=1");SP.Ribbon.ListFormWebPartPageComponent._DispFormActionsGroup="Ribbon.ListForm.Display.ActionsGroup";SP.Ribbon.WikiPageComponent.$W=false;SP.Ribbon.WikiPageComponent.$n=null;SP.Ribbon.WikiPageComponent.$3=null;SP.Ribbon.WikiPageComponent.$b=null;SP.Ribbon.WikiPageComponent.$1F=null;SP.Ribbon.WikiPageComponent.$2J=false;SP.Ribbon.DocLibAspxPageComponent.$3=null;SP.Ribbon.DocLibAspxPageComponent.$b=null;SP.Ribbon.WebPartComponent.$3=null;SP.Ribbon.WebPartComponent.$6A=[];SP.Ribbon.WebPartComponent.$b=["approveWebpartPage","EditInDesigner","EditMobileSharedPage","EditMobilePersonalPage","EditMobilePageMenuOpen","insertExistingList","insertImageWebPart","insertTextWebPart","insertWebPart","makeHomePage","MSOMenu_Close","MSOMenu_Delete","MSOMenu_Edit","MSOMenu_Minimize","MSOMenu_Restore","rejectWebpartPage","Ribbon.WebPartInsert.Tab","Ribbon.WebPartOption","Ribbon.WebPartPage","webPartCommands","WebPartContextualGroup","WebPartInsertContextualGroup","webPartInsertMedia","webPartInserts","webPartInsertText","webPartPageActions","webPartPageApproval","webPartPageDelete","webPartPageEdit","webPartPageEditConsole","webPartPageEditMenuOpen","webPartPageEditQuery","webPartPageManage","webPartPageStartEdit","webPartPageStopEdit","webPartProperties","RelatedDataToListViewGroup","InsertRelatedWebPartToListViewMenuAnchor","InsertRelatedWebPartToListView","GetRelatedFieldsToListViewMenuXml","RelatedDataToListFormGroup","InsertRelatedWebPartToListFormMenuAnchor","InsertRelatedWebPartToListForm","GetRelatedFieldsToListFormMenuXml","CommandContextChanged"];SP.Ribbon.PageManager.$15=null;SP.Ribbon.UsageReportPageComponent.$2I=new SP.Ribbon.UsageReportPageComponent;SP.Ribbon.HelpCommandNames.requestContextualHelp="RequestContextualHelp";SP.Ribbon.HelpPageComponent.$V=false;SP.Ribbon.HelpPageComponent.$3=null;SP.Ribbon.SaveConflictHandler.$1I=null;SP.Ribbon.SaveConflictHandler.$1G=null;SP.Ribbon.SaveConflictHandler.$1H=null;SP.Ribbon.TrackTabPageComponent.$3=null;SP.Ribbon.TrackTabPageComponent.$2H=null;SP.Ribbon.UserInterfacePageComponent.$V=false;SP.Ribbon.UserInterfacePageComponent.$3=null;SP.Ribbon.EMailLink.$2C=null;SP.Ribbon.EMailLink.$23=null;SP.Ribbon.EMailLink.$24=null;SP.Ribbon.DesignBuilderPageComponent.$3=null;SP.Ribbon.DesignBuilderPageComponent.$V=false;SP.Ribbon.PageState.PageStateStrings.itemIsWebPartPageStateName="ItemIsWebPartPage";SP.Ribbon.PageState.PageStateStrings.itemIsWikiPageStateName="ItemIsWikiPage";SP.Ribbon.PageState.PageStateStrings.itemIsFormsPageStateName="ItemIsFormsPage";SP.Ribbon.PageState.PageStateStrings.itemIsInLibraryStateName="ItemIsInLibrary";SP.Ribbon.PageState.PageStateStrings.itemIsMajorVersionStateName="ItemIsMajorVersion";SP.Ribbon.PageState.PageStateStrings.itemIsMinorVersionStateName="ItemIsMinorVersion";SP.Ribbon.PageState.PageStateStrings.itemHasCheckedInVersionStateName="ItemHasCheckedInVersion";SP.Ribbon.PageState.PageStateStrings.itemIsCheckedOutToCurrentUserStateName="ItemIsCheckedOutToCurrentUser";SP.Ribbon.PageState.PageStateStrings.itemIsCheckedOutToOtherUserStateName="ItemIsCheckedOutToOtherUser";SP.Ribbon.PageState.PageStateStrings.itemIsCheckedOutToSystemUserStateName="ItemIsCheckedOutToSystemUser";SP.Ribbon.PageState.PageStateStrings.itemIsRejectedStateName="ItemIsRejected";SP.Ribbon.PageState.PageStateStrings.itemHasWorkflowRunningStateName="ItemHasWorkflowRunning";SP.Ribbon.PageState.PageStateStrings.itemIsPendingApprovalStateName="ItemIsPendingApproval";SP.Ribbon.PageState.PageStateStrings.itemIsScheduledStateName="ItemIsScheduled";SP.Ribbon.PageState.PageStateStrings.itemIsInPersonalViewStateName="ItemIsInPersonalView";SP.Ribbon.PageState.PageStateStrings.itemIsInSharedViewStateName="ItemIsInSharedView";SP.Ribbon.PageState.PageStateStrings.itemIsDefaultPageStateName="ItemIsDefaultPage";SP.Ribbon.PageState.PageStateStrings.itemIsMasterPageGalleryFileStateName="ItemIsMasterPageGalleryFile";SP.Ribbon.PageState.PageStateStrings.itemCancelWorkflowEnabledStateName="ItemCancelWorkflowEnabled";SP.Ribbon.PageState.PageStateStrings.itemHasFieldControlsStateName="ItemHasFieldControls";SP.Ribbon.PageState.PageStateStrings.itemHasPersonalizableZonesStateName="ItemHasPersonalizableZones";SP.Ribbon.PageState.PageStateStrings.itemHasCustomizableZonesStateName="ItemHasCustomizableZones";SP.Ribbon.PageState.PageStateStrings.userHasContributorRightsStateName="UserHasContributorRights";SP.Ribbon.PageState.PageStateStrings.userHasOverrideCheckoutRightsStateName="UserHasOverrideCheckoutRights";SP.Ribbon.PageState.PageStateStrings.userHasApproverRightsStateName="UserHasApproverRights";SP.Ribbon.PageState.PageStateStrings.userHasDeleteRightsStateName="UserHasDeleteRights";SP.Ribbon.PageState.PageStateStrings.docLibVersioningEnabledStateName="DocLibVersioningEnabled";SP.Ribbon.PageState.PageStateStrings.docLibCheckoutRequiredStateName="DocLibCheckoutRequired";SP.Ribbon.PageState.PageStateStrings.docLibMinorVersionsEnabledStateName="DocLibMinorVersionsEnabled";SP.Ribbon.PageState.PageStateStrings.docLibApprovalEnabledStateName="DocLibApprovalEnabled";SP.Ribbon.PageState.PageStateStrings.docLibWorkflowEnabledStateName="DocLibWorkflowEnabled";SP.Ribbon.PageState.PageStateStrings.viewModeIsEditStateName="ViewModeIsEdit";SP.Ribbon.PageState.PageStateStrings.viewModeHasSaveConflictStateName="ViewModeHasSaveConflict";SP.Ribbon.PageState.PageStateStrings.viewModeIsWebPartDesignStateName="ViewModeIsWebPartDesign";SP.Ribbon.PageState.PageStateStrings.forceShowStatus="ForceShowStatus";SP.Ribbon.PageState.PageStateStrings.forceHideStatus="ForceHideStatus";SP.Ribbon.PageState.PageStateStrings.save="Save";SP.Ribbon.PageState.PageStateStrings.edit="Edit";SP.Ribbon.PageState.PageStateStrings.saveAndStop="SaveAndStop";SP.Ribbon.PageState.PageStateStrings.overrideCheckout="OverrideCheckout";SP.Ribbon.PageState.PageStateStrings.checkout="Checkout";SP.Ribbon.PageState.PageStateStrings.checkin="Checkin";SP.Ribbon.PageState.PageStateStrings.publish="Publish";SP.Ribbon.PageState.PageStateStrings.unpublish="Unpublish";SP.Ribbon.PageState.PageStateStrings.submit="SubmitForApproval";SP.Ribbon.PageState.PageStateStrings.cancelApproval="CancelApproval";SP.Ribbon.PageState.PageStateCommands.pageStateGroupReject="PageStateGroupReject";SP.Ribbon.PageState.PageStateCommands.pageStateGroupApprove="PageStateGroupApprove";SP.Ribbon.PageState.PageStateCommands.pageStateGroupCancelApproval="PageStateGroupCancelApproval";SP.Ribbon.PageState.PageStateCommands.pageStateGroupSubmitForApproval="PageStateGroupSubmitForApproval";SP.Ribbon.PageState.PageStateCommands.pageStateGroupUnpublish="PageStateGroupUnpublish";SP.Ribbon.PageState.PageStateCommands.pageStateGroupPublish="PageStateGroupPublish";SP.Ribbon.PageState.PageStateCommands.pageStateGroupOverrideCheckout="PageStateGroupOverrideCheckout";SP.Ribbon.PageState.PageStateCommands.pageStateGroupDiscardCheckout="PageStateGroupDiscardCheckout";SP.Ribbon.PageState.PageStateCommands.pageStateGroupCheckout="PageStateGroupCheckout";SP.Ribbon.PageState.PageStateCommands.pageStateGroupCheckin="PageStateGroupCheckin";SP.Ribbon.PageState.PageStateCommands.pageStateGroupDontSaveAndStop="PageStateGroupDontSaveAndStop";SP.Ribbon.PageState.PageStateCommands.pageStateGroupEdit="PageStateGroupEdit";SP.Ribbon.PageState.PageStateCommands.pageStateGroupSaveAndStop="PageStateGroupSaveAndStop";SP.Ribbon.PageState.PageStateCommands.pageStateGroupSaveAndPublish="PageStateGroupSaveAndPublish";SP.Ribbon.PageState.PageStateCommands.pageStateGroupSave="PageStateGroupSave";SP.Ribbon.PageState.PageStateCommands.pageStateGroupStopEditing="PageStateGroupStopEditing";SP.Ribbon.PageState.PageStateHandler.$1P={PageStateGroupSaveSplit:["PageStateGroupSave","PageStateGroupSaveAndStop","PageStateGroupEdit","PageStateGroupDontSaveAndStop","PageStateGroupStopEditing"],PageStateGroupCheckinSplit:["PageStateGroupCheckin","PageStateGroupCheckout","PageStateGroupDiscardCheckout","PageStateGroupOverrideCheckout"],PageStateGroupPublishSplit:["PageStateGroupPublish","PageStateGroupUnpublish","PageStateGroupSubmitForApproval","PageStateGroupCancelApproval"],PageStateGroupPagePublishSplit:["PageStateGroupPublish","PageStateGroupSubmitForApproval","PageStateGroupCancelApproval"]};SP.Ribbon.PageState.PageStateHandler.$y=null;SP.Ribbon.PageState.PageStateHandler.$1x=true;SP.Ribbon.PageState.PageStateHandler.$E=[];SP.Ribbon.PageState.PageStateHandler.$2u=SP.Ribbon.PageState.PageStateHandler.saveBeforeNavigate;SP.Ribbon.PageState.PageStateHandler.$2t=SP.Ribbon.PageState.PageStateHandler.$61;SP.Ribbon.PageState.PageStateHandler.$1d=false;SP.Ribbon.PageState.PageStateHandler.ignoreNextUnload=false;SP.Ribbon.PageState.PageStateHandler.saveCallbackError=null;SP.Ribbon.PageState.Handlers.$2M=new Array(0);SP.Ribbon.PageState.Handlers.$S=null;SP.Ribbon.PageState.Handlers.$2w=null;SP.Ribbon.PageState.Handlers.$2N=null;SP.Ribbon.PageState.Handlers.$2L=null;SP.Ribbon.PageState.Handlers.$2x=null;SP.Ribbon.PageState.Handlers.$g=null;SP.Ribbon.TenantAdmin.TenantAdminPageComponent.$2I=new SP.Ribbon.TenantAdmin.TenantAdminPageComponent}sp_ribbon_initialize();RegisterBeginEndFunctions("sp.ribbon.js","sp.ribbon.js",sp_ribbon_initialize,function(){ULS04Z:;SP.Ribbon.TrackTabPageComponent.registerWithPageManager()},null);SP.Ribbon.NativeUtility=function(){};SP.Ribbon.NativeUtility.getCtxForView=function(b){ULS04Z:;var a=g_ViewIdToViewCounterMap[b];return typeof a!="undefined"&&a!=null?window["ctx"+a]:null};SP.Ribbon.NativeUtility.executeClickScript=function(script,viewId){ULS04Z:;script=script.replace(/javascript:return false/g,"");script=script.replace(/return false/g,"");var currentCtxId=g_ViewIdToViewCounterMap[viewId],strCode="var event = new Object(); event.fromRibbon=true; ";if(!SP.ScriptUtility.isNullOrUndefined(currentCtxId))strCode+="event.currentCtx = eval('ctx' + currentCtxId); ";eval(strCode+script+";")};SP.Ribbon.NativeUtility.executeClickScriptSimple=function(script){ULS04Z:;script=script.replace(/javascript:return false/g,"");script=script.replace(/return false/g,"");eval(script)};SP.Ribbon.NativeUtility.createXMLDocFromString=CUI.NativeUtility.createXMLDocFromString;SP.Ribbon.NativeUtility.createXMLDocFromStringCore=CUI.NativeUtility.createXMLDocFromStringCore;SP.Ribbon.NativeUtility.getWSA=function(){ULS04Z:;return GetWSA()};SP.Ribbon.NativeUtility.addCommandStreamToWSA=function(a,i,j){ULS04Z:;if(typeof a=="undefined"||!a)return;if(!WSAEnabled()&&!WSAQoSEnabled())return;var g=GetWSA();if(!g)return;var e=0;if(a.CommandId)e=SP.BWsaClient.calcActionId(a.CommandId);else return;var f=0;if(a.TabId)f=SP.BWsaClient.calcActionId(a.TabId);var d=SP.BWsaClient.getSQMLocationFromCUICommandInfo(a);if(d==0)return;var b=0,c=0;if(g_wsaListTemplateId){b=1;c=g_wsaListTemplateId}var h=(0<<0)+(0<<5)+(d<<9)+(b<<16);g.addToStreamDw(8327,h,f,e,c,i,j,0,0)};SP.Ribbon.NativeUtility.ffClick=function(b){ULS04Z:;var a=document.createEvent("MouseEvents");a.initMouseEvent("click",true,true,window,0,0,0,0,0,false,false,false,false,0,null);b.dispatchEvent(a)};SP.Ribbon.NativeUtility.executeECBCommand=function(code,myctx){ULS04Z:;eval("var event = new Object();event.fromRibbon = true; event.currentCtx = myctx;"+code+";")};SP.Ribbon.NativeUtility.updateStatus=function(a,c,b){ULS04Z:;EnsureScriptParams("accessrequestscontrol.js","_UpdateStatus",a,c,b)};typeof Sys!="undefined"&&Sys&&Sys.Application&&Sys.Application.notifyScriptLoaded();function DeselectWpWz(){ULS04Z:;var a=SP.Ribbon.WebPartComponent.get_instance();a&&a.deselectWebPartAndZone(null,null)}function SelectWp(b){ULS04Z:;var a=SP.Ribbon.WebPartComponent.get_instance();a&&a.selectWebPart(b,true)}function SelectWz(c,b){ULS04Z:;var a=SP.Ribbon.WebPartComponent.get_instance();a&&a.selectWebPartZone(c,b)}function ChangeWikiPageMode(b){ULS04Z:;var a=SP.Ribbon.WikiPageComponent.get_instance();a&&a.changeWikiPageMode(b)}function showSaveConflictDialogRibbon(c,b,d,a,f,e){ULS04Z:;return SP.Ribbon.SaveConflictHandler.showSaveConflictDialog(c,b,d,a,f,e)}var ribbon={SelectWp:SelectWp,SelectWz:SelectWz,DeselectWpWz:DeselectWpWz,ChangeWikiPageMode:ChangeWikiPageMode,showSaveConflictDialog:showSaveConflictDialogRibbon};typeof Sys!="undefined"&&Sys&&Sys.Application&&Sys.Application.notifyScriptLoaded();typeof NotifyScriptLoadedAndExecuteWaitingJobs=="function"&&NotifyScriptLoadedAndExecuteWaitingJobs("sp.ribbon.js");SP.Ribbon.TrackTabPageComponent.registerWithPageManager();typeof spWriteProfilerMark=="function"&&spWriteProfilerMark("perfMarkEnd_sp.ribbon.js");