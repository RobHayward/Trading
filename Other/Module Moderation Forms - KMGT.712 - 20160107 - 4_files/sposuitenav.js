function RenderSuiteLinksFromShellData(g,a,o,l){var K="ShellDocuments",S="ShellSites",V="ShellSharepoint",j=4e3,f=false,h=false,W="javascript:",n="SPSuiteThemeInfo",F=54,C=21,E=16,L=64;if(typeof a!="number"||a<1)a=1;function m(a){if(typeof BrowserStorage!="undefined")return BrowserStorage.local.getItem(a);try{return localStorage[a]}catch(b){return null}}function t(b,a){if(typeof BrowserStorage!="undefined"){BrowserStorage.local.setItem(b,a);return}try{localStorage[b]=a}catch(c){}}function D(a){BrowserStorage.local.removeItem(a)}function p(a){window.console!=null&&console.warn!=null&&console.warn(a)}function U(a){SP.QoS.WriteStart(a,null,SP.QoS.LogType.Diagnostic)}function z(a){SP.QoS.WriteSuccess(a,null,SP.QoS.LogType.Diagnostic)}function k(b){var a=typeof Flighting!=="undefined"&&Flighting.VariantConfiguration!=null&&Flighting.VariantConfiguration.IsExpFeatureClientEnabled!=null&&Flighting.VariantConfiguration.IsExpFeatureClientEnabled(b);return a}function y(){return SuiteNavRendering.GetWebTemplate()}function q(d,c,e){for(var f=!k(760),b=0;b<d.length;b++){var a=d[b];if(Boolean(a)){if(c!=null&&a.Id==K)a.Url=c;if(f)if(e!=null&&a.Id==S)a.Url=e}}}function J(){try{var a=JSON.parse(m("SPMySiteLinks")),b=Date.parse(a.CacheDate);if(b>0&&(new Date).getTime()-b<24*60*60*1e3&&GetCurrentUserKey()==a.UserKey)return a}catch(c){}return null}function N(d,b){var a=null,c=null;function f(b,c,d){var a={};a.AllDocumentsLink=c;a.AllSitesLink=d;b(JSON.stringify(a))}function h(b){var c=_spPageContextInfo.webServerRelativeUrl=="/"?"":_spPageContextInfo.webServerRelativeUrl,d=escapeUrlForCallback(c)+"/_api/Microsoft.SharePoint.Portal.UserProfiles.MySiteLinks.GetMySiteLinks",a=new XMLHttpRequest;a.open("GET",d,true);a.setRequestHeader("Content-Type","application/x-www-form-urlencoded");a.setRequestHeader("ACCEPT","application/json; odata=verbose");a.onreadystatechange=function(){if(a.readyState==4){if(a.status==200){var c=null;try{c=JSON.parse(a.responseText)}catch(g){if(typeof Sys!=="undefined"&&typeof Sys.Debug!=="undefined");}if(Boolean(c)&&Boolean(c.d)&&(Boolean(c.d.AllDocumentsLink)||Boolean(c.d.AllSitesLink))){var e=Boolean(c.d.AllDocumentsLinkHref)?c.d.AllDocumentsLinkHref:c.d.AllDocumentsLink,d=Boolean(c.d.AllSitesLinkHref)?c.d.AllSitesLinkHref:c.d.AllSitesLink;f(b,e,d);return}}f(b,null,null)}};a.send()}function i(g){if(!Boolean(g)){if(typeof Sys!=="undefined"&&typeof Sys.Debug!=="undefined");b(d);return}var e=JSON.parse(g);if(e!=null){var f=e.AllDocumentsLink,h=e.AllSitesLink;try{t("SPMySiteLinks",JSON.stringify({Docs:f,Sites:h,CacheDate:new Date,UserKey:GetCurrentUserKey()}))}catch(j){}q(c,f,h)}var i=JSON.stringify(a);b(i)}try{a=JSON.parse(d)}catch(j){if(typeof Sys!=="undefined"&&typeof Sys.Debug!=="undefined");}if(a!=null){var g=ExtractSuiteNavBarData(a);c=g!=null?g.WorkloadLinks:a.WorkloadLinks}var e=J();if(c==null)b(d);else if(e!=null){q(c,e.Docs,e.Sites);b(JSON.stringify(a))}else h(i)}function e(d){if(window.XMLHttpRequest==null)return;function g(){if(j<30*60*1e3){var a=setTimeout(function(){e(d)},j);AddEvtHandler(window,"onunload",function(){clearTimeout(a)});j=j*2}}if(h)return;h=true;var i=_spPageContextInfo.webServerRelativeUrl=="/"?"":_spPageContextInfo.webServerRelativeUrl,b=new XMLHttpRequest;b.onreadystatechange=function(){if(b.readyState!=4)return;h=false;if(f)return;if(b.status==200){f=true;var c=false;if(a>=2&&!Boolean(l)){var e=b.getResponseHeader("Content-Type");if(e==null&&e.indexOf("application/json")<0){p("SuiteNav: Invalid Shell data recieved.");c=true}}!c&&N(b.responseText,d)}else g()};b.ontimeout=g;var c="/_layouts/online/handlers/SpoSuiteLinks.ashx";c=escapeUrlForCallback(i)+(typeof ajaxNavigate!=="undefined"?ajaxNavigate._fixLayoutsUrl(c):typeof FixLayoutsUrl!=="undefined"?FixLayoutsUrl(c):c);b.open("POST",c+"?Locale="+escapeUrlForCallback(_spPageContextInfo.currentUICultureName)+"&v="+String(a)+"&mobilereq="+String(l===true?1:0),true);b.send("");return null}function u(a){SuiteNavRendering.UpdateActiveLink(a)}function v(a){if(typeof a!="string"||a=="")return false;return true}function H(a){SuiteNavRendering.AddMenuItemsFromDOM(a)}function T(a){SuiteNavRendering.UpdateHelpLink(a)}function R(b){if(k(364)){var a;if(typeof _spPageContextInfo=="undefined"||!Boolean(a=_spPageContextInfo.env)||a.toUpperCase()!="EDOG")b.FeedbackLink=null}}function G(){var a=O365Shell.Host.OnContextMenuPopup(function(a){a&&MenuHtc_hide()});O365Shell.OnDataChanged&&O365Shell.OnDataChanged(O);AddEvtHandler(window,"onunload",function(){O365Shell.Host.RemoveOnContextMenuPopup(a);O365Shell.Host.FlushTaskRunnerQueue()})}function x(){try{var a=m("SPSuiteNavHeight");if(a!=null)document.getElementById(g).style.height=a}catch(b){}}function Q(){var b=m(n);if(b!=null){if(SPThemeUtils.UseClientSideTheming()){D(n);return []}for(var c=JSON.parse(b),a=0;a<document.styleSheets.length;a++){var d=document.styleSheets[a];if(c.Url==d.href)return c.Colors}}return []}function P(){var a=y(),b=a==F||a==C||a==L;return b}function M(s){var e=ExtractSuiteNavBarData(s),K=P();if(e==null)return;if(!K)e.UseSPOBehaviors=true;if(RenderSuiteLinksFromShellData.ShouldUseSuiteTheme(s)||K&&Boolean(e.HasTenantBranding)||y()==E)return;if(k(516)){if(Boolean(e.HasTenantBranding)&&(s.TenantPrimaryColorShades!=null||e.TenantLogoUrl!=null))return}else if(Boolean(e.HasTenantBranding)&&typeof SPThemeUtils!=="undefined"&&!SPThemeUtils.IsSiteThemed())return;var a=Q();if(a==null||a.length==0)a=[];else{e.ThemeColors=a;return}function N(b,c){if(b>=0)a[b]=c}function g(e,c){var a=c.backgroundColor,d=Boolean(a);if(d){if(a.toLowerCase()=="transparent"&&c.filter!=null){var b=/startColorstr=(#[0-9A-F]*),/ig.exec(c.filter);if(b!=null&&b.length>1)a="#"+b[1].substr(3)}N(e,a)}return d}function h(c,b){var a=Boolean(b.color);a&&N(c,b.color);return a}var q={},r=0;function d(b,c){for(var a=0;a<b.length;a++)q[b[a]]=c;r++}var T=browseris.ie8down,f=T?".ms-core-neediefilter ":"",M=e.Dimensions==null||e.Dimensions.Top<40,W=[2,-1,4,9,5,6,7,1,8,10,3,-1];function c(a){return M?a:W[a]}var i=c(0),C=c(1),x=c(2),z=c(3),p=c(4),H=c(5),A=c(6),I=c(7),J=c(8),F=c(9),G=c(10),B=c(11);function L(){if(!M&&a[i]!=null)a[0]=a[i];e.ThemeColors=a}if(SPThemeUtils.UseClientSideTheming()){var b=SPThemeUtils.GetThemeColor,O=1,l=T?O:void 0,Y=a[i]=b("SuiteBarBackground",l);if(Y==null)return;a[C]=b("SuiteBarHoverBackground",l);var D=b("SuiteBarHoverText"),V="#92c0e0";a[x]=D==null?V:D;a[z]=b("HoverBackground",l);a[p]=b("TopBarBackground",l);a[H]=b("TopBarText");a[A]=b("TopBarHoverText");a[I]=b("BodyText");a[J]=b("BackgroundOverlay",O);a[F]=b("DialogBorder");a[G]=b("SuiteBarText");a[B]=b("SubtleLines");L();return}d(["#suitebarleft"],function(a){f===""&&g(i,a);return h(G,a)});f!==""&&d([f+"#suitebarleft"],function(a){return g(i,a)});d([f+".ms-core-suitelink-a:hover"],function(a){return g(C,a)});d(["a.ms-core-suitelink-disabled, a.ms-core-suitelink-disabled:hover","a.ms-core-suitelink-disabled"],function(a){return !Boolean(a.padding)&&h(x,a)});d([f+".ms-core-menu-item:hover, "+f+".ms-core-menu-itemselected",f+".ms-core-menu-item:hover"],function(a){return g(z,a)});f!==""&&d([f+"#suitebarright"],function(a){return g(p,a)});d(["#suitebarright"],function(a){f===""&&g(p,a);return h(H,a)});d(["a.ms-core-menu-link"],function(a){return h(I,a)});d(["a.ms-core-suitelink-active, a.ms-core-suitelink-active:hover, .ms-core-neediefilter a.ms-core-suitelink-active, .ms-core-neediefilter a.ms-core-suitelink-active:hover","a.ms-core-suitelink-active"],function(b){var c=b.borderRightColor;a[F]=c!=null&&c!=""?c:b.borderLeftColor;h(A,b);return g(J,b)});d([".ms-core-menu-separatorhr"],function(a){return h(B,a)});for(var j=0,R="",u=0;u<document.styleSheets.length&&j<r;u++){j=0;var m=document.styleSheets[u];R=m.href;var v=m.rules!=null?m.rules:m.cssRules;if(!Boolean(v))continue;for(var w=v.length-1;w>0&&j<r;w--){var o=v[w];if(o.style!=null&&o.selectorText!=null){var U=o.selectorText.toLowerCase(),S=q[U];if(S!=null&&S(o.style)){q[U]=null;j++}}}}if(j>0){L();var X={Url:R,Colors:a};t(n,JSON.stringify(X))}}function A(a){var b="display";while(a!=null){if(IE8Support.getComputedStyle(a,b,b)==="none")return true;if(a.nodeName.toLowerCase()==="body")break;a=a.parentNode}return false}function r(b){var a=null;try{if(b!=null)a=ExtractSuiteMetadata(b)}catch(c){}return a}var c=false,d=false,b=false,i=null;function w(c){if(b&&f)i=function(){w(c)};if(g==null||d||b)return;var a=r(c);if(Boolean(RenderSuiteLinksFromShellData.ShellJson)&&Boolean(RenderSuiteLinksFromShellData.ShellJsUrl)&&RenderSuiteLinksFromShellData.ShellJsUrl!==a.JsUrl)a=r(RenderSuiteLinksFromShellData.ShellJson);if(a==null||!v(a.CssUrl)||!v(a.JsUrl))p("SuiteNav: Valid JsUrl and CssUrl not found.");else B(a)}function B(e){if(d||b)return;try{var B=JSON.stringify(e),a=ExtractSuiteNavBarData(e);if(a==null)return;u(a);var C=e.CssUrl,t=e.JsUrl;registerCssLink(C,null,true);var w=10,v=50,r=0;function o(){b=false;if(d||typeof O365Shell!="undefined")return;if(typeof O365Shell=="undefined"&&r<w){r++;b=true;setTimeout(l,v);return}if(!c&&!f){c=true;if(!h){ClearSuiteLinksCache();s()}}else if(!c&&i!=null){c=true;i();i=null}else{c=true;p("SuiteNav: Unable to load Shell scripts.")}}function q(){try{x();H(a);T(a);M(e);R(a)}catch(b){}}function l(){b=false;if(d)return;if(typeof O365Shell=="undefined"){o();return}else c=false;RenderSuiteLinksFromShellData.ShellJson=B;if(!Boolean(RenderSuiteLinksFromShellData.ShellJsUrl))RenderSuiteLinksFromShellData.ShellJsUrl=t;function e(){q();var b=document.getElementById(g);b!=null&&typeof RemoveCssClassFromElement!="undefined"&&RemoveCssClassFromElement(b,"ms-TopBarBackground-bgColor");O365Shell.SetData(a);var c=k(366),d={top:g,disableDelayLoad:true,disableShellPlus:c,layout:"Mouse"};if(!A(b))if(c){O365Shell.Render(d,n);j();setTimeout(function(){O365Shell.LoadShellPlus!=null&&O365Shell.LoadShellPlus()},2e3)}else O365Shell.Render(d,function(){j();n()});else z("SuiteNav_SuccessRender")}SPThemeUtils.WhenThemeReady(e);d=true}function n(){G();SP.SOD.notifyEventAndExecuteWaitingJobs("SPShellPlusLoaded",[a])}function j(){z("SuiteNav_SuccessRender");SP.SOD.notifyEventAndExecuteWaitingJobs("SPSuiteLinksRendered",[a]);RenderSuiteLinksFromShellData.ShouldUseSuiteTheme(e)&&SPThemeUtils.GetCurrentThemeCacheToken()!=e.ShellRequestId&&setTimeout(SPThemeUtils.ApplyCurrentTheme,0)}var y=typeof GetUrlKeyValue=="function"&&Boolean(GetUrlKeyValue("unsuitened"));if(y){q();j()}else if(typeof O365Shell=="undefined"){if(typeof RenderSuiteLinksFromShellData.JsVer=="undefined")RenderSuiteLinksFromShellData.JsVer=0;var m="o365shell_js"+RenderSuiteLinksFromShellData.JsVer++;if(e.JsKey==null)SP.SOD.registerSod(m,t);else m=e.JsKey;b=true;SP.SOD.executeFunc(m,"O365Shell",l,o)}else l();SP.SOD.execute("core.js","UpdateCompanyDisplayName",a)}catch(D){}}function I(){f=false;h=false}function O(){I();GetSuiteLinks(e,null,a,false,true)}function s(){GetSuiteLinks(e,Boolean(o)?o:w,a,l)}if(a<2)if(typeof EnsureScriptParams!=="undefined")EnsureScriptParams("suitelinks.js","RenderSuiteLinks",g,e,u);else typeof GetSuiteLinks!=="undefined"&&GetSuiteLinks(e,o);else{!l&&U("SuiteNav_StartRender");x();s()}}function RetrieveAndProcessSuiteNavData(a,b){RenderSuiteLinksFromShellData(null,b,a,true)}(function(){RenderSuiteLinksFromShellData.ShouldUseSuiteTheme=e;var d=54,c=21;function f(){return SuiteNavRendering.GetWebTemplate()}function e(b){return typeof SPThemeUtils!="undefined"&&SPThemeUtils!=null&&SPThemeUtils.UseShellThemes()&&!SPThemeUtils.IsSiteThemed()&&a(b)!=null}function b(h,b){if(b==null||b.length<7)return;for(var f=[["HyperlinkActive","CommandLinksPressed","NavigationPressed","EmphasisHoverBorder","TopBarPressedText","HeaderNavigationPressedText","Hyperlinkfollowed"],["EmphasisHoverBackground","EmphasisBorder"],["AccentText","CommandLinksHover","RowAccent","NavigationAccent","NavigationHover","EmphasisBackground","HeaderNavigationHoverText","HeaderNavigationSelectedText","SuiteBarBackground","Hyperlink","ContentAccent1"],["AccentLines","HeaderAccentLines","ButtonPressedBorder"],["SuiteBarHoverBackground"],["StrongLines","HeaderStrongLines","SuiteBarHoverText","ButtonPressedBackground","ButtonHoverBorder"],["ButtonHoverBackground"],["SelectionBackground"],["HoverBackground","NavigationHoverBackground"]],d,g,c,i=f.length,a=0;a<i;a++){if(a==7)c="#7F"+b[5];else if(a==8)c="#7F"+b[6];else c="#"+b[a];d=f[a];g=d.length;for(var e=0;e<g;e++)h.SetColor(d[e],c)}}function a(a){var b=null;if(a!=null&&Boolean(a.ThemeVersion)){var h=a.TenantPrimaryColorShades!=null,i=a.UserThemePrimaryColorShades!=null,g=Boolean(a.UserPersonalizationAllowed),e=f(),j=e==d||e==c;if(j&&(!h||g&&i))b=a.UserThemePrimaryColorShades;else b=a.TenantPrimaryColorShades;if(b==null||b.length<6)b=null}return b}function g(c){if(!SPThemeUtils.UseShellThemes()||SPThemeUtils.IsSiteThemed())SPThemeUtils.WithSiteTheme(c);else GetSuiteLinks(null,d,2);function d(f){var e=f!=null?ExtractSuiteMetadata(f):null,d=null;if(e!=null&&e.ShellRequestId!=null)d=a(e);function g(a){var f=null;if(d!=null&&a!=null){b(a,d);a.CacheToken=e.ShellRequestId;a.IsDefault=false;a.NoImageRecoloring=false}c(a)}d!=null&&SPThemeUtils.LoadThemableResources();SPThemeUtils.WithSiteTheme(g)}}typeof SPThemeUtils!="undefined"&&SPThemeUtils!=null&&SPThemeUtils.SetThemeRetriever(g)})();typeof NotifyScriptLoadedAndExecuteWaitingJobs!=="undefined"&&NotifyScriptLoadedAndExecuteWaitingJobs("SpoSuiteNav.js")